<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759508453">
<link rel="stylesheet" href="assets/overrides.css?v=1759511690">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header"><div><h1>Tables Viewer v2.1</h1></div><div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" type="search" placeholder="Search" aria-label="Search tables" style="min-width:420px; width:44ch;"/>
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllMdBtn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy all tables as markdown">Copy All Tables (Markdown)</button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset all tables">Reset All Tables</button>
</div></div>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#table-1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#table-2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#table-3">Table 3</a></li></ul></div></div>
<div class="table-wrapper" data-table-id="table-1"><h3 id="table-1">Table 1</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Component**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Component</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Explanation &amp; recommendation**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Explanation & recommendation</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Component"><strong>Summary (what this <code>script.js</code> does)</strong>           </td><td data-label="Explanation &amp; recommendation">The file is a single self-contained IIFE that implements the full client-side UI for the Tables Viewer: configuration, normalization & debounce helpers, clipboard (with legacy fallback), toast/notification system, copy modal, safe DOM helpers, row snapshot + sort state, sorting & toggle controls, row-counts, many export functions (CSV, Markdown, JSON, XLSX, PDF), reset/search/highlight with Unicode-aware normalization, initialization wiring (DOMContentLoaded), delegated click handlers, TOC scrolling, back-to-top behavior and public API exposure on <code>window</code>. It is robust and defensive (lots of try/catch), polyfill-like fallbacks, and integrates SheetJS when present.                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Component"><strong>Main responsibilities (single-file map)</strong>        </td><td data-label="Explanation &amp; recommendation">1) Config & helpers: normalizeForSearch, debounce.  <br>2) Clipboard & fallback: copyToClipboard, tryLegacyCopy.  <br>3) Notifications/UI: showToast + queue, toast container styling.  <br>4) Copy modal UI: showCopyModal (dialog with copy/download).  <br>5) DOM utilities: getSearchEl, getTableFromButton, safeGetTBody.  <br>6) State: originalTableRows, sortStates.  <br>7) Sorting & toggle functions: sortTableByColumn, toggleTable, toggleAllTables.  <br>8) Row counts: updateRowCounts.  <br>9) Copy/export implementations: copy/csv/md/json/xlsx/pdf/all-tables.  <br>10) Reset, search, highlight: complex Unicode-normalization + mark insertion.  <br>11) Init & event wiring: DOMContentLoaded, delegated click handlers, keybinds, scroll behavior.  <br>12) Public API exposure: assign many functions onto <code>window</code>. </td></tr><tr><td data-label="Component"><strong>Should it be split? (short answer)</strong>             </td><td data-label="Explanation &amp; recommendation"><strong>Yes.</strong> The file mixes many orthogonal concerns (UI widgets, clipboard, export formats, search/highlight, DOM wiring). Splitting increases readability, testability, smaller incremental maintenance, and enables lazy-loading heavy features (SheetJS, worker), while keeping a small runtime bootstrap.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Component"><strong>Why split? (concrete benefits)</strong>                 </td><td data-label="Explanation &amp; recommendation">- Single responsibility: each module is focused and smaller.  <br>- Easier review and testing: unit-test toast, clipboard, export logic separately.  <br>- Lazy-loading: large or infrequently used code (XLSX export, worker, modal) can be loaded only when needed.  <br>- Reuse: other pages can import the toast/clipboard utilities.  <br>- Security & audit: smaller files are easier to audit for DOM/innerHTML/encoding issues.  <br>- Build optimizations: tree-shaking & bundling/minification become straightforward.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Component"><strong>Where to split (suggested modules / filenames)</strong> </td><td data-label="Explanation &amp; recommendation">1. <strong>tv.config.js</strong> — small: config object + setter.  <br>2. <strong>tv.utils.js</strong> — helpers: <code>normalizeForSearch</code>, <code>debounce</code>, <code>safeGetTBody</code>, <code>getTableFromButton</code>, <code>getSearchEl</code>.  <br>3. <strong>tv.clipboard.js</strong> — <code>copyToClipboard</code>, <code>tryLegacyCopy</code> + small public wrapper.  <br>4. <strong>tv.toast.js</strong> — toast queue, <code>_ensureToastContainer</code>, <code>showToast</code>, <code>_processToastQueue</code> (depends on tv.utils only).  <br>5. <strong>tv.copymodal.js</strong> — <code>showCopyModal</code> (depends on clipboard + toast).  <br>6. <strong>tv.exports.js</strong> — all export functions (CSV, MD, JSON, XLSX, PDF, exportAll). Heavy: candidate to lazy-load or to split further (<code>xlsx</code> submodule).  <br>7. <strong>tv.search.js</strong> — <code>searchTable</code>, highlight helpers, <code>buildNormalizedMapForCell</code>, <code>highlightMatches</code>, <code>clearHighlights</code>.  <br>8. <strong>tv.sorting.js</strong> — sorting, header UI updates, row snapshots, resetAllTables.  <br>9. <strong>tv.init.js</strong> — DOMContentLoaded wiring, delegated event listeners, keybindings, expose public API on <code>window</code>.  <br>10. <strong>tv.inline_shim.js</strong> (optional) — the legacy inline-shim string for environments without script.js; only injected when needed. </td></tr><tr><td data-label="Component"><strong>How to split (practical plan, step-by-step)</strong>    </td><td data-label="Explanation &amp; recommendation">1. Create the modules with the suggested separation, keeping exports as plain functions (no top-level DOM run).  <br>2. Convert shared state (originalTableRows, sortStates) into a small <code>tvState</code> object exported from <code>tv.state.js</code> or pass as argument to functions.  <br>3. Replace direct <code>window</code> writes with an explicit <code>init</code> function in <code>tv.init.js</code> that accepts an interface object or attaches to <code>window</code> at the end for compatibility.  <br>4. Wire modules with ES modules (preferred) or simple concatenation in a build step to preserve older environments.  <br>5. Provide a single build artifact for distribution (bundle + minify) that concatenates modules in correct order — keep an <code>esm</code> build and a <code>umd/iife</code> build for widest compatibility.  <br>6. Add lazy-loading hooks: export <code>loadXLSX()</code> which dynamically imports the xlsx-submodule or loads <code>assets/xlsx.full.min.js</code> only when <code>exportTableXLSX</code> is first invoked.  <br>7. Add tests for key pure functions (normalizeForSearch, csv generation, markdown serialization, highlight map builder). </td></tr><tr><td data-label="Component"><strong>Backward-compatibility approach</strong>                </td><td data-label="Explanation &amp; recommendation">- Keep existing <code>window.*</code> public API names by re-exporting wrappers from <code>tv.init.js</code>.  <br>- Initially ship both: the refactored module files and a single concatenated <code>script.js</code> (build step) so consumers with no bundler continue to work.  <br>- Provide a small migration README that shows how to import modules (ESM) for advanced users.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Component"><strong>Security, encoding & small gotchas found</strong>       </td><td data-label="Explanation &amp; recommendation">- Some literal characters look mojibake (e.g. <code>â†‘</code>, <code>âœ•</code>) — ensure file encoding is UTF-8 without BOM; replace with proper characters (↑, ✓).  <br>- Many <code>.innerHTML</code> assignments are used (to inject <code>mark</code> icons, inline shim). Those are generally safe here (only using sanitized SVG strings), but review any dynamic content inserted into HTML templates to avoid injection.  <br>- <code>normalizeForSearch</code> uses Unicode <code>\p{L}</code> with <code>u</code> flag in a try/catch — good fallback present.  <br>- <code>exportTablePDF</code> opens a new window and writes HTML; browsers will block popups in some environments — fallback messaging is present.  <br>- Consider <code>rel=&quot;noopener noreferrer&quot;</code> for any created anchor downloads if applicable.  <br>- Worker usage assumes <code>assets/worker.js</code> path — after splitting, make sure relative paths are preserved. </td></tr><tr><td data-label="Component"><strong>Performance & UX suggestions</strong>                   </td><td data-label="Explanation &amp; recommendation">- <strong>Lazy-load</strong> SheetJS and heavy code paths only when user requests XLSX export.  <br>- Consider debouncing or chunking <code>highlightMatches</code> for extremely large cells; currently it operates per-cell and is heavy for huge documents.  <br>- Use <code>requestIdleCallback</code> (when available) to build <code>originalTableRows</code> snapshot to avoid jank during initial render.  <br>- For very large tables, integrate or expose a virtualization hook (<code>window.tableVirtualizer</code>) — the current code already checks for it.  <br>- Avoid repeatedly setting <code>innerHTML</code> on the same cells; where possible use data attributes or precomputed nodes. </td></tr><tr><td data-label="Component"><strong>Testing & maintenance</strong>                          </td><td data-label="Explanation &amp; recommendation">- Add unit tests for: CSV/JSON/MD generation, XLSX fallback generation, normalizeForSearch, buildNormalizedMapForCell matching logic, showToast queue logic.  <br>- Add linting (ESLint) and Prettier config for consistent style (fix the weird encodings).  <br>- Add a small integration test page to exercise the exports and copying in headless browsers (Puppeteer).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Component"><strong>Recommendation / final call</strong>                    </td><td data-label="Explanation &amp; recommendation">Split the file into logical modules as suggested. Start with a minimal split: <code>tv.utils.js</code>, <code>tv.toast.js</code>, <code>tv.clipboard.js</code>, <code>tv.exports.js</code>, <code>tv.init.js</code> — that yields immediate maintainability wins. Keep a build step that emits a single <code>script.js</code> for distribution. Prioritize lazy-loading XLSX/worker and fix encoding characters.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   </td></tr></tbody></table></div><div class='row-count'></div></div><div class="table-wrapper" data-table-id="table-2"><h3 id="table-2">Table 2</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Topic**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Topic</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Details**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Details</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Topic"><strong>Purpose</strong>                          </td><td data-label="Details">Convert and normalize cell-level textual patterns into safer, structured HTML fragments for table rendering. <br><br>Provides list normalization, bullet-to-<code>&lt;ul&gt;</code> conversion, bracket unescaping, lightweight streaming helpers, column-type detection, and a full <code>render_table</code> implementation that chains many converters.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Topic"><strong>Import strategy & fallbacks</strong>      </td><td data-label="Details">Attempts two import strategies for project helpers (<code>..utils</code> then <code>utils</code>). <br>If imports fail it defines local fallback implementations for <code>_strip_tags</code>, <code>sanitize_bold_html</code>, <code>convert_markdown_lists</code>, and <code>_escape_unmatched_markers</code>. <br>This makes the module robust to execution context but can hide missing/incorrect helper behavior.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Topic"><strong>Key functions (surface)</strong>          </td><td data-label="Details">- <code>_normalize_leading_bullet</code> — normalize various bullet glyphs to <code>- </code> prefix. <br>- <code>convert_bullets_to_ul</code> — convert multi-line bullet text into <code>&lt;ul&gt;&lt;li&gt;</code> blocks with several heuristics (skip pure bullets, heading-inline patterns, bracket-preserved lines). <br>- <code>_normalize_list_markers</code> — normalize many bullet-like unicode chars into <code>- </code>. <br>- <code>_unescape_brackets_outside_code</code> — unescape <code>\[ \]</code> outside <code>&lt;pre&gt;/&lt;code&gt;</code> blocks. <br>- <code>_take_and_stream</code> — buffer-first-N then iterator for remainder. <br>- <code>_detect_column_types</code> — heuristic numeric/text detector over sample rows. <br>- <code>_clean_label_for_datalabel</code>, <code>_apply_left_col_heading</code> — tidy labels and optionally wrap left-column lead text in <code>&lt;strong&gt;</code>. <br>- <code>render_table</code> — orchestrates column discovery, per-row conversion pipeline, and HTML assembly (buttons, headers, table, row-count). </td></tr><tr><td data-label="Topic"><strong>Conversion pipeline in <code>render_table</code></strong> </td><td data-label="Details">For each cell: <br>1) convert bullets -> UL <br>2) normalize list markers <br>3) convert markdown lists via <code>convert_markdown_lists</code> or <code>md</code> callable <br>4) unescape bracket markers outside code <br>5) sanitize bold HTML (non-destructive) <br>6) apply left-column heading heuristic <br>7) escape unmatched markers <br>8) insert into TD with <code>data-label</code>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Topic"><strong>Heuristics & strengths</strong>           </td><td data-label="Details">- Good coverage of varied bullet characters and ad-hoc source patterns. <br>- Preserves bracketed lines (links/references) rather than consuming them into lists. <br>- Attempts to keep the first sentence/phrase in left column visually emphasized. <br>- Degrades gracefully to fallback helpers if project <code>utils</code> missing.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Topic"><strong>Correctness risks & edge cases</strong>   </td><td data-label="Details">- Heavy reliance on regex heuristics will fail for many edge Markdown cases (nested lists, fenced code, tables inside cells, complex inline HTML). <br>- <code>convert_bullets_to_ul</code> may mis-detect inline <code>-</code> usage (dates, ranges, dash punctuation) and split content incorrectly. <br>- <code>_detect_column_types</code> ignores locale-specific decimals/thousands and may misclassify numeric text (commas as thousands, parentheses for negative). <br>- <code>_unescape_brackets_outside_code</code> splits on <code>&lt;pre&gt;</code>/<code>&lt;code&gt;</code> naively and may fail for nested or attribute-containing tags.                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Topic"><strong>Security & sanitization</strong>          </td><td data-label="Details">- Module assumes downstream <code>sanitize_html</code> / <code>sanitize_bold_html</code> will handle XSS. <br>- Some conversion functions return raw HTML fragments assembled from input; untrusted input must be sanitized before final write. <br>- Fallback <code>sanitize_bold_html</code> in this file is simplistic and can produce unexpected <code>&lt;strong&gt;</code> wrappers around HTML; treat as non-secure.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Topic"><strong>Performance characteristics</strong>      </td><td data-label="Details">- Many regex operations per cell; cost scales with total cells. <br>- <code>convert_bullets_to_ul</code> and list normalization iterate per-line and use multiple regexes; precompiling patterns would reduce overhead. <br>- <code>_detect_column_types</code> inspects sample rows and attempts numeric parsing; this is O(sample × cols). For wide tables this is potentially expensive but acceptable for modest samples.                                                                                                                                                                                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Topic"><strong>Robustness & fault tolerance</strong>     </td><td data-label="Details">- Extensive try/except blocks keep pipeline running on malformed inputs. <br>- Returns sanitized defaults and logs exceptions. <br>- However excessive swallowing of errors can make debugging hard unless debug logs are enabled.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Topic"><strong>Maintainability</strong>                  </td><td data-label="Details">- Logic is concentrated and complex; many heuristics without unit-test coverage would be brittle. <br>- Several regexes are repeated; extract and precompile common patterns. <br>- Comments are present but not exhaustive; add docstrings for major helpers.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Topic"><strong>Interoperability & contracts</strong>     </td><td data-label="Details">- Expects a callable <code>markdown_to_html</code> (or <code>md</code>) that converts inline markdown. <br>- Integrates with <code>render.core_table</code> and <code>core_renderer</code> via <code>render_table</code> signature. <br>- When project <code>utils</code> exist those should be authoritative; otherwise local fallbacks are used — ensure behavior parity via tests.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Topic"><strong>Testing suggestions</strong>              </td><td data-label="Details">- Exhaustive unit tests for <code>convert_bullets_to_ul</code> covering: single bullets, nested-like lines, heading-inline patterns, bracketed lines, edge punctuation, and unicode bullets. <br>- Tests for <code>_normalize_list_markers</code> with a wide set of bullet glyphs. <br>- <code>_unescape_brackets_outside_code</code> tests with nested <code>&lt;code&gt;</code>, <code>&lt;pre&gt;</code>, and inline code. <br>- Property tests for <code>_detect_column_types</code> across localized numeric strings. <br>- Integration tests for full <code>render_table</code> with DataFrame, list-of-dicts, and generators. </td></tr><tr><td data-label="Topic"><strong>Immediate, low-risk improvements</strong> </td><td data-label="Details">- Precompile frequently used regex patterns at module scope. <br>- Add explicit unit tests for all heuristics to lock behavior. <br>- Replace ad-hoc <code>re.split</code> on code blocks with a small parser that is robust to attributes and nested tags. <br>- Make numeric parsing in <code>_detect_column_types</code> accept locale configuration or use <code>locale</code>-aware parsing.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Topic"><strong>Medium-term enhancements</strong>         </td><td data-label="Details">- Consider delegating Markdown->HTML to a library (e.g., <code>markdown-it-py</code>) for better fidelity, then post-process lists only when necessary. <br>- Introduce a configurable sanitizer pipeline that is invoked after conversion but before HTML insertion. <br>- Add an option to disable heuristic bullet conversion when input is known to be already HTML or well-formed Markdown.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Topic"><strong>Operational suggestions</strong>          </td><td data-label="Details">- Log at INFO when fallback helper implementations are used so operators notice missing <code>utils</code>. <br>- Add a diagnostics mode that returns a per-cell transformation trace for debugging problematic inputs. <br>- Provide a toggle to limit conversion work (e.g., skip complex regexes for very large tables).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Topic"><strong>Summary judgement</strong>                </td><td data-label="Details">Powerful, pragmatic converter for messy source text. <br><br>Suitable for controlled input sets and incremental improvement. <br><br>For production exposed to untrusted or highly variable Markdown, harden with robust Markdown parsing, explicit sanitization, precompiled regexes, and more unit tests.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       </td></tr></tbody></table></div><div class='row-count'></div></div><div class="table-wrapper" data-table-id="table-3"><h3 id="table-3">Table 3</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Topic**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Topic</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Details**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Details</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Topic"><strong>Filename</strong>                             </td><td data-label="Details"><code>assets/overrides.css</code> (theme / table-layout overrides provided by you)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Topic"><strong>Purpose</strong>                              </td><td data-label="Details">Provide compact theme variables and targeted CSS rules to harmonize header, sticky first column, zebra rows, hover behavior and list markers inside table cells. Intended as a focused override layer that sits on top of the base <code>style.css</code>.                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Topic"><strong>Theme variables (top)</strong>                </td><td data-label="Details">Defines defaults for light mode: <code>--header-bg</code>, <code>--header-color</code>, <code>--row-odd-bg</code>, <code>--row-even-bg</code>, <code>--row-hover-bg</code>, <code>--muted</code>, <code>--text</code>. <br> These drive consistent look & feel and make dark-mode overrides easy.                                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Topic"><strong>Dark-mode overrides</strong>                  </td><td data-label="Details">Supports <code>[data-theme=&quot;dark&quot;]</code> and <code>body.dark-mode</code>. <br> Sets darker header/row colors and distinct <code>--header-highlight-bg</code>/<code>--header-highlight-color</code> to ensure header hover contrast. <br> Uses color variables rather than hard-coded colors for easier tuning.                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Topic"><strong>Header & alignment</strong>                   </td><td data-label="Details">Ensures <code>table-layout: fixed</code> and normalized header cell padding/white-space. <br> <code>.th-with-sort</code> inner wrapper uses flex to vertically center content. <br> Keeps header semantics (no flex on <code>&lt;tr&gt;</code>), preserving accessibility and layout stability.                                                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Topic"><strong>Sticky first column (header & cells)</strong> </td><td data-label="Details"><code>thead th:first-child</code> and <code>tbody td:first-child</code> are sticky with <code>left:0</code> and z-index tweaks. <br> Header and first column background colors are forced to match (<code>!important</code> where needed) to avoid stacking artifacts. <br> Box-shadow applied to first column for separation.                                                                                                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Topic"><strong>Zebra rows & hover</strong>                   </td><td data-label="Details">Row backgrounds set using <code>tr:nth-child(odd/even) td</code> (applies per cell) so sticky first column can copy same colors. <br> Hover uses <code>:hover td</code> to highlight whole row including the sticky cell.                                                                                                                                                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Topic"><strong>Header hover / focus (dark mode)</strong>     </td><td data-label="Details">Targeted rules for header hover/focus in dark mode with <code>outline</code> + subtle transition to improve keyboard visibility and contrast. <br> Sticky first column header respects same highlight.                                                                                                                                                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Topic"><strong>Proportional widths</strong>                  </td><td data-label="Details">First column width and other columns are expressed as fixed percentages (28.57% / 71.43%) to mirror the <code>total_units</code> 2:5 layout used elsewhere — keeps left/right proportions predictable.                                                                                                                                                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Topic"><strong>Lists inside table cells</strong>             </td><td data-label="Details">Strong, explicit rules to normalize list markers: <br> - top-level UL uses en-dash (“– ”) via <code>::before</code> <br> - nested UL uses bullet (“• ”) <br> - OL uses CSS counter for numbers <br> Debug fallback rules use <code>!important</code> to survive heavy upstream rules.                                                                                                                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Topic"><strong>Cross-mode list color sync</strong>           </td><td data-label="Details">Ensures markers inherit readable colors in dark mode (<code>[data-theme=&quot;dark&quot;] td &gt; ul &gt; li::before</code>).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Topic"><strong>Debug / fallback</strong>                     </td><td data-label="Details">Additional <code>!important</code> rules at bottom to force list marker styling if other stylesheets override them — pragmatic for embedding in diverse host pages.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Topic"><strong>Accessibility & focus</strong>                </td><td data-label="Details">Header hover/focus rules include outline and transition. The CSS preserves native semantics (no role/ARIA toggles here), so JavaScript should manage keyboard controls.                                                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Topic"><strong>Responsive behavior</strong>                  </td><td data-label="Details">Table uses <code>table-layout: fixed</code> and width:100%; no mobile-specific reflow in this snippet — relies on outer layout to handle small screens. Sticky column widths are percentage-based so they scale.                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Topic"><strong>Compatibility notes</strong>                  </td><td data-label="Details">Uses modern CSS (custom properties, <code>:first-child</code>, <code>nth-child</code>) — works in all evergreen browsers. <code>!important</code> used sparingly only in debug fallback sections.                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Topic"><strong>Maintainability</strong>                      </td><td data-label="Details">Small, focused override file — good for injecting last in cascade. Variables centralized for quick theme tweaks. Keep in sync with base <code>style.css</code> variables to avoid surprises.                                                                                                                                                                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Topic"><strong>Potential improvements</strong>               </td><td data-label="Details">Consider: <br> 1) adding a small mobile override to collapse or stack first column on very narrow screens; <br> 2) offering <code>--tv-left-width</code>/<code>--tv-right-width</code> aliases to align with runtime overrides; <br> 3) ensuring high-contrast fallbacks for accessibility (WCAG) tests.                                                                                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Topic"><strong>Risks / gotchas</strong>                      </td><td data-label="Details">- If host page applies global <code>background</code> or <code>color</code> rules to <code>td:first-child</code>, even <code>!important</code> may be needed in extreme cases. <br> - Fixed percentage widths can cause truncation on extremely narrow viewports. <br> - Relying on <code>:nth-child()</code> for zebra keeps semantics but may mismatch if rows are injected/hidden by JS; tests recommended.                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Topic"><strong>Where it fits in workflow</strong>            </td><td data-label="Details">Designed as <code>overrides.css</code> produced after computing left/right widths. It complements <code>style.css</code> (base) and should be loaded after it so overrides take effect.                                                                                                                                                                                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Topic"><strong>CI / Testing suggestions</strong>             </td><td data-label="Details">Test in: latest Chrome, Firefox, Edge, Safari on desktop & iOS Safari. <br> Check: sticky header + first column stacking, keyboard focus outline, list marker rendering in dark mode, small-width truncation.                                                                                                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Topic"><strong>Recommendation (short)</strong>               </td><td data-label="Details">Keep this file as a small override layer. Do not merge into a huge monolith; keep it separate so runtime (Python) can regenerate per-output <code>overrides.css</code> easily.                                                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr></tbody></table></div><div class='row-count'></div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1758856620" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>