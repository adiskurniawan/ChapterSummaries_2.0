<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;}</style>
<link rel="stylesheet" href="assets/style.css?v=1759436736">
<link rel="stylesheet" href="assets/overrides.css?v=1759436736">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header"><div><h1>Tables Viewer v2.1</h1></div><div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" type="search" placeholder="Search" aria-label="Search tables" style="min-width:420px; width:44ch;"/>
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllMdBtn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy all tables as markdown">Copy All Tables (Markdown)</button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset all tables">Reset All Tables</button>
</div></div>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#table-1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#table-2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#table-3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#table-4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#table-5">Table 5</a></li></ul></div></div>
<div class="tv-fragment" id="frag-1">
<div class="table-wrapper" data-table-id="table-1"><h3 id="table-1">Table 1</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th style="width:28.57%;" role="button" aria-label="Sort by Priority"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Priority</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th style="width:71.43%;" role="button" aria-label="Sort by Adi (inputs/decisions)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Adi (inputs/decisions)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th style="width:71.43%;" role="button" aria-label="Sort by Assistant (actions/patches)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Assistant (actions/patches)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th style="width:71.43%;" role="button" aria-label="Sort by Files (touchpoints)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Files (touchpoints)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Priority"><strong>1. Math rendering (\$…\$, $…$)</strong> </td><td data-label="Adi (inputs/decisions)">• Confirm that all math expressions inside source tables should render visually as formulas rather than appear as literal `$…$` text. <br> • Decide whether to use inline math only (`$E=mc^2$`) or also support display math blocks (`$$…$$`). <br> • Approve whether external rendering libraries (KaTeX, MathJax) are allowed or whether a lightweight fallback (custom CSS span + monospace style) is sufficient. <br> • Provide at least one or two Book pages containing math-heavy content for verification. </td><td data-label="Assistant (actions/patches)">• Extend `render/markdown.py` to include math-friendly Markdown extensions (e.g. `markdown-katex` if available). <br> • If no external library is permitted, implement a fallback pipeline: detect `$…$` inline and wrap in `<span class="math">…</span>`; detect `$$…$$` blocks and wrap in `<div class="math-block">…</div>`. <br> • Patch `render/sanitize.py` so it does not strip out these wrapper tags, while continuing to block malicious inline HTML. <br> • Ensure CSS support in `assets/style.css` by defining `.math { font-family: "Times New Roman", serif; font-style: italic; }` and `.math-block { display:block; text-align:center; margin:0.5em 0; }`. <br> • Conduct regression check to confirm existing tables without math are unaffected. </td><td data-label="Files (touchpoints)">`render/markdown.py`, `render/sanitize.py`, `assets/style.css`</td></tr><tr><td data-label="Priority"><strong>2. Footnotes support</strong>           </td><td data-label="Adi (inputs/decisions)"> • Decide if footnotes should appear inline at the bottom of each table or collected at the end of the full HTML page. <br> • Approve style of footnote markers (e.g. superscript numbers `[1]`, `[a]`, or dagger symbols). <br> • Provide samples of current Book pages where `[ ^1 ]` or `[ ^a ]` notation causes errors.                                                                                                                                                                                          </td><td data-label="Assistant (actions/patches)">• Enable `footnotes` extension in `render/markdown.py`. <br> • Ensure footnotes render as `<sup id="fnref1">1</sup>` links and that corresponding definitions appear in a separate section with `<div class="footnotes">`. <br> • Adjust `render/sanitize.py` to allow safe `<sup>` tags and `id`/`href` attributes. <br> • Add `.footnotes { font-size:0.85em; color:var(--muted); }` in `assets/style.css`. <br> • Validate output by rendering Book_0002.html after patching.                                                                                                                                                                                                                                                                                   </td><td data-label="Files (touchpoints)">`render/markdown.py`, `render/sanitize.py`, `assets/style.css`</td></tr><tr><td data-label="Priority"><strong>3. Inline HTML safe tags</strong>       </td><td data-label="Adi (inputs/decisions)">• Approve whitelist: `<sup>`, `<sub>`, `<mark>`, `<details>`, `<summary>`. <br> • Approve allowed attributes (`aria-expanded`, `open`) for `<details>`. <br> • Decide whether inline styles (e.g. `<span style="color:red">`) should always be stripped or partially preserved.                                                                                                                                                                                                                                     </td><td data-label="Assistant (actions/patches)">• Patch `render/sanitize.py` whitelist rules to retain approved tags and attributes. <br> • Reject `on*` event handlers (`onclick`, `onerror`). <br> • Ensure nested tags such as `<mark><b>bold</b></mark>` remain safe. <br> • Extend test content with edge cases like `<details><summary>Click</summary>Hidden text</details>`. <br> • Add style rules in `assets/style.css`: `mark { background:yellow; } details { margin:0.5em 0; } summary { cursor:pointer; font-weight:bold; }`.                                                                                                                                                                                                                                                                          </td><td data-label="Files (touchpoints)">`render/sanitize.py`, `assets/style.css`</td></tr><tr><td data-label="Priority"><strong>4. Nested emphasis parsing</strong>     </td><td data-label="Adi (inputs/decisions)">• Provide failing snippets such as `<strong><em>~~layered emphasis~~</em></strong>` that currently break rendering. <br> • Decide whether strict Markdown behavior (reject invalid nesting) or “forgiving” rendering is desired.                                                                                                                                                                                                                                                                                                        </td><td data-label="Assistant (actions/patches)">• Tune parser configuration in `render/markdown.py` (likely using `markdown-it-py` or `mistune` if integrated). <br> • Add preprocessing step to normalize mismatched emphasis markers before sending to the parser. <br> • Ensure consistent HTML output for combinations of bold, italic, strike, and underline. <br> • Cross-check with Book_0002.html to confirm readability.                                                                                                                                                                                                                                                                                                                                                                                  </td><td data-label="Files (touchpoints)">`render/markdown.py`</td></tr><tr><td data-label="Priority"><strong>5. RTL & Unicode handling</strong>      </td><td data-label="Adi (inputs/decisions)">• Approve normalization form (NFC) so that characters like `e\u0301` and `é` render identically. <br> • Decide if explicit `dir="rtl"` attributes should be injected into table cells containing Arabic/Hebrew. <br> • Provide test snippets in Arabic and Hebrew for verification.                                                                                                                                                                                                                                 </td><td data-label="Assistant (actions/patches)">• Add Unicode normalization (NFC) in `utils.py` function, applied before rendering cells. <br> • Optionally auto-detect RTL scripts (using `unicodedata.bidirectional`) and wrap affected text in `<span dir="rtl">`. <br> • Ensure `render/core.py` calls normalization function on every cell. <br> • Verify with long mixed-text cells.                                                                                                                                                                                                                                                                                                                                                                                                                          </td><td data-label="Files (touchpoints)">`utils.py`, `render/core.py`</td></tr><tr><td data-label="Priority"><strong>6. Hidden comments policy</strong>      </td><td data-label="Adi (inputs/decisions)">• Decide if HTML comments (`<!-- … -->`) and Markdown comments (`[//]: #`) must be completely stripped from output or preserved in some way. <br> • Confirm whether hidden metadata inside comments should be accessible in final HTML.                                                                                                                                                                                                                                                                             </td><td data-label="Assistant (actions/patches)">• Standardize stripping in `render/sanitize.py`: remove both HTML and Markdown comment styles. <br> • Ensure nothing leaks into HTML output. <br> • Verify Book_0002.html pages compile without stray comment artifacts.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           </td><td data-label="Files (touchpoints)">`render/sanitize.py`</td></tr><tr><td data-label="Priority"><strong>7. Long cells & performance</strong>    </td><td data-label="Adi (inputs/decisions)">• Approve wrapping strategy: `word-break: break-word; white-space: pre-wrap;` for long words. <br> • Confirm maximum recommended cell length (e.g. 500 chars). <br> • Provide a sample table with extremely long cell text for stress testing.                                                                                                                                                                                                                                                                      </td><td data-label="Assistant (actions/patches)">• Add CSS in `assets/style.css`: `td { word-wrap: break-word; white-space: pre-wrap; }`. <br> • In `render/core.py`, implement logic to split long unbroken strings with zero-width space or soft hyphen to avoid layout breakage. <br> • Run performance checks to ensure rendering time remains acceptable.                                                                                                                                                                                                                                                                                                                                                                                                                                                       </td><td data-label="Files (touchpoints)">`render/core.py`, `assets/style.css`</td></tr></tbody></table></div><div class='row-count'></div></div>
</div><div class="tv-fragment" id="frag-2">
<div class="table-wrapper" data-table-id="table-2"><h3 id="table-2">Table 2</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th style="width:28.57%;" role="button" aria-label="Sort by **Summary**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Summary</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th style="width:71.43%;" role="button" aria-label="Sort by **Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Summary"><strong>Morning Fog Simulation: Operators Under Stress</strong>     </td><td data-label="Notes">The chapter opens with a U.S. Special Forces training simulation near Cape Fear, North Carolina. A bomb detonates while Operators are meeting a guerrilla chieftain, testing their response under uncertainty. Their reactions highlight agility, decisiveness, and imagination.</td></tr><tr><td data-label="Summary"><strong>Operators’ Uncommon Responses</strong>                      </td><td data-label="Notes">Each Operator reacts differently: one persuades the chieftain to lead, another goes solo to solve the bomb situation, another delegates to the chieftain entirely. This variability demonstrates their flexible problem-solving capacity.</td></tr><tr><td data-label="Summary"><strong>Training as the Key to Imagination</strong>                 </td><td data-label="Notes">Operators’ actions stem from rigorous training. Unlike untrained soldiers (or business leaders), they avoid default responses: fright, fight, or dependence. Training cultivates imagination, enabling fast, adaptive decision‐making.</td></tr><tr><td data-label="Summary"><strong>Defining Imagination</strong>                               </td><td data-label="Notes">Imagination is the ability to “see things that the eyes don’t see.” It allows individuals to anticipate future events, envision unseen outcomes, and creatively generate solutions beyond immediate sensory input.</td></tr><tr><td data-label="Summary"><strong>Why Logic Alone Fails to Explain Imagination</strong>       </td><td data-label="Notes">Logic may attribute imagination to hallucination or faster cognitive processing. Both explanations fail: hallucination cannot account for accuracy, and fast processing requires data—yet Operators had minimal data about the bomb, child, or environment.</td></tr><tr><td data-label="Summary"><strong>Historical and Linguistic Origins of Imagination</strong>   </td><td data-label="Notes">Imagination entered English in the 14th century, denoting the mind’s capacity to produce images. Mental images are computational, like computer-generated visuals. Yet images themselves are secondary; imagination begins with an intention or “script” guiding those images.</td></tr><tr><td data-label="Summary"><strong>Story as the Biological Root of Imagination</strong>        </td><td data-label="Notes">Ancient writings (fables, myths, tales) identify story as the primary mechanism for imaginative thought. Story enables humans to simulate scenarios, envision alternative futures, and predict outcomes—both spatially and temporally.</td></tr><tr><td data-label="Summary"><strong>School vs. Biological Function of Story</strong>            </td><td data-label="Notes">Modern schooling emphasizes story for communication (writing essays, persuasive speech), yet story evolved millions of years before language.</td></tr><tr><td data-label="Summary"><strong>Story in Ancient Contexts</strong>                          </td><td data-label="Notes">Courts in ancient Athens and Rome: lawyers discovered that facts alone failed to persuade juries, leading them to spin narratives (narratio). Cicero codified these methods, linking story with rhetoric, but misrepresenting its primal function: cognition, not communication.</td></tr><tr><td data-label="Summary"><strong>Storythinking in Children and Animals</strong>              </td><td data-label="Notes">Anna Craft’s research: preschoolers naturally engage in storythinking (“being a dog digging a hole,” “a doctor healing bones”). Later studies show adults, chimpanzees, mice, and crows also engage in story-based reasoning.</td></tr><tr><td data-label="Summary"><strong>Story vs. Logic</strong>                                    </td><td data-label="Notes">Logic identifies the probable; story identifies the possible. Probable events rely on historical data; possible events explore scenarios that have never occurred but are consistent with environmental rules. This flexibility promotes initiative, innovation, and resilience.</td></tr><tr><td data-label="Summary"><strong>Operators’ Storythinking Methods</strong>                   </td><td data-label="Notes">Two main types of storythinking:<br>- <br>1. Past (causal “why”) – analyzing previous events and their causes.<br>- <br>2. Future (counterfactual “what if”) – imagining alternative outcomes.<br>These are linked in a feedback loop: diverse “why”s enhance “what if”s and vice versa.</td></tr><tr><td data-label="Summary"><strong>Mental Narrative Shape</strong>                             </td><td data-label="Notes">Operators’ cognition resembles: one integrated past (clarifying purpose) + branching future (exploring multiple tactical possibilities). This structure underlies their ability to act decisively in uncertainty, mirroring improvisation in sports, surgery, or comedy.</td></tr><tr><td data-label="Summary"><strong>Storythinking in Improvisers</strong>                       </td><td data-label="Notes">Effective improvisers share this mental model: athletes, surgeons, and comedians adapt to dynamic situations while maintaining their overarching objectives. Integrated past = stability; branching future = flexibility. Example: a surgeon improvising in the OR without violating biological rules.</td></tr><tr><td data-label="Summary"><strong>Training Imagination through Planning</strong>              </td><td data-label="Notes">Special Forces instructors explain: “Planning is the main use of imagination.” Imagination enables the creation of sequences of actions (plans) that anticipate multiple contingencies. Story = plot = plan.</td></tr><tr><td data-label="Summary"><strong>Features of Effective Plans</strong>                        </td><td data-label="Notes">1. Single long-term goal – defines the overarching objective.<br>2. Multiple possible paths – generates tactical flexibility.<br>Example: Operators’ goal “build rapport with chieftain” allows multiple rescue strategies for the child.</td></tr><tr><td data-label="Summary"><strong>Comparison with Untrained Individuals</strong>              </td><td data-label="Notes">Most people have multiple conflicting goals (e.g., “capture the hill” + “don’t get anyone killed”) and pursue Plan A exclusively. Lack of tactical flexibility leads to indecision and inefficiency. Operators avoid this by defining strategy and multiplying tactics.</td></tr><tr><td data-label="Summary"><strong>Defined Strategy, Unlimited Tactics</strong>                </td><td data-label="Notes">Strategy = integrated past, clarified “why.” Tactics = branching future, expanded “what if”s. This combination produces adaptive, goal-aligned decision-making, allowing Operators to respond to unforeseen events without losing strategic focus.</td></tr><tr><td data-label="Summary"><strong>Historical Examples: Effective Planning</strong>            </td><td data-label="Notes">Admiral Horatio Nelson: unified strategy + tactical independence; deployed at Battle of Trafalgar. Despite being outnumbered, his fleet captured two-thirds of enemy ships. Beethoven: classical structure + harmonic innovation in Fifth Symphony; balanced overarching design with spontaneous creativity.</td></tr><tr><td data-label="Summary"><strong>Life Story as Personal Plan</strong>                        </td><td data-label="Notes">Individual life story = personal strategic plan. Integrated past clarifies purpose and values (why). Branching future creates multiple possibilities and pathways (what if). This structure reduces hesitation, accelerates decision-making, and enhances adaptation.</td></tr><tr><td data-label="Summary"><strong>Emotion as a Cognitive Tool</strong>                        </td><td data-label="Notes">Emotion enhances story-based cognition. It integrates past experiences and anticipates future possibilities, making decisions faster, more intuitive, and adaptable. Operators’ rapid response to the bomb exemplifies emotion-guided imagination in action.</td></tr><tr><td data-label="Summary"><strong>Practical Implications for Everyday Life</strong>           </td><td data-label="Notes">Everyone can train imagination by:<br>- Defining a clear, single objective.<br>- Practicing multiple possible tactical responses.<br>- Observing exceptional information and leveraging intuition.<br>Applications: business, healthcare, education, parenting, athletics.</td></tr><tr><td data-label="Summary"><strong>Integration of Past and Future for Adaptive Action</strong> </td><td data-label="Notes">Operators’ integrated past provides momentum and clarity. Branching future enables adaptability to unforeseen challenges. The mental narrative allows efficient real-time decision-making in dynamic environments, whether foggy woods or organizational crises.</td></tr><tr><td data-label="Summary"><strong>Conclusion: Story as Planning Engine</strong>               </td><td data-label="Notes">Story is not merely a vehicle for entertainment or communication; it evolved as a cognitive mechanism for planning, predicting, and problem-solving. Training imagination through story-thinking enhances resilience, creativity, and effectiveness under uncertainty.</td></tr></tbody></table></div><div class='row-count'></div></div>
</div><div class="tv-fragment" id="frag-3">
<div class="table-wrapper" data-table-id="table-3"><h3 id="table-3">Table 3</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th style="width:28.57%;" role="button" aria-label="Sort by **Topic**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Topic</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th style="width:71.43%;" role="button" aria-label="Sort by **Details**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Details</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Topic"><strong>Filename</strong>                             </td><td data-label="Details">`assets/overrides.css` (theme / table-layout overrides provided by you)</td></tr><tr><td data-label="Topic"><strong>Purpose</strong>                              </td><td data-label="Details">Provide compact theme variables and targeted CSS rules to harmonize header, sticky first column, zebra rows, hover behavior and list markers inside table cells. Intended as a focused override layer that sits on top of the base `style.css`.</td></tr><tr><td data-label="Topic"><strong>Theme variables (top)</strong>                </td><td data-label="Details">Defines defaults for light mode: `--header-bg`, `--header-color`, `--row-odd-bg`, `--row-even-bg`, `--row-hover-bg`, `--muted`, `--text`. <br> These drive consistent look & feel and make dark-mode overrides easy.</td></tr><tr><td data-label="Topic"><strong>Dark-mode overrides</strong>                  </td><td data-label="Details">Supports `[data-theme="dark"]` and `body.dark-mode`. <br> Sets darker header/row colors and distinct `--header-highlight-bg`/`--header-highlight-color` to ensure header hover contrast. <br> Uses color variables rather than hard-coded colors for easier tuning.</td></tr><tr><td data-label="Topic"><strong>Header & alignment</strong>                   </td><td data-label="Details">Ensures `table-layout: fixed` and normalized header cell padding/white-space. <br> `.th-with-sort` inner wrapper uses flex to vertically center content. <br> Keeps header semantics (no flex on `<tr>`), preserving accessibility and layout stability.</td></tr><tr><td data-label="Topic"><strong>Sticky first column (header & cells)</strong> </td><td data-label="Details">`thead th:first-child` and `tbody td:first-child` are sticky with `left:0` and z-index tweaks. <br> Header and first column background colors are forced to match (`!important` where needed) to avoid stacking artifacts. <br> Box-shadow applied to first column for separation.</td></tr><tr><td data-label="Topic"><strong>Zebra rows & hover</strong>                   </td><td data-label="Details">Row backgrounds set using `tr:nth-child(odd/even) td` (applies per cell) so sticky first column can copy same colors. <br> Hover uses `:hover td` to highlight whole row including the sticky cell.</td></tr><tr><td data-label="Topic"><strong>Header hover / focus (dark mode)</strong>     </td><td data-label="Details">Targeted rules for header hover/focus in dark mode with `outline` + subtle transition to improve keyboard visibility and contrast. <br> Sticky first column header respects same highlight.</td></tr><tr><td data-label="Topic"><strong>Proportional widths</strong>                  </td><td data-label="Details">First column width and other columns are expressed as fixed percentages (28.57% / 71.43%) to mirror the `total_units` 2:5 layout used elsewhere — keeps left/right proportions predictable.</td></tr><tr><td data-label="Topic"><strong>Lists inside table cells</strong>             </td><td data-label="Details">Strong, explicit rules to normalize list markers: <br> <br>- top-level UL uses en-dash (“– ”) via `::before` <br> <br>- nested UL uses bullet (“• ”) <br> <br>- OL uses CSS counter for numbers <br> Debug fallback rules use `!important` to survive heavy upstream rules.</td></tr><tr><td data-label="Topic"><strong>Cross-mode list color sync</strong>           </td><td data-label="Details">Ensures markers inherit readable colors in dark mode (`[data-theme="dark"] td > ul > li::before`).</td></tr><tr><td data-label="Topic"><strong>Debug / fallback</strong>                     </td><td data-label="Details">Additional `!important` rules at bottom to force list marker styling if other stylesheets override them — pragmatic for embedding in diverse host pages.</td></tr><tr><td data-label="Topic"><strong>Accessibility & focus</strong>                </td><td data-label="Details">Header hover/focus rules include outline and transition. The CSS preserves native semantics (no role/ARIA toggles here), so JavaScript should manage keyboard controls.</td></tr><tr><td data-label="Topic"><strong>Responsive behavior</strong>                  </td><td data-label="Details">Table uses `table-layout: fixed` and width:100%; no mobile-specific reflow in this snippet — relies on outer layout to handle small screens. Sticky column widths are percentage-based so they scale.</td></tr><tr><td data-label="Topic"><strong>Compatibility notes</strong>                  </td><td data-label="Details">Uses modern CSS (custom properties, `:first-child`, `nth-child`) — works in all evergreen browsers. `!important` used sparingly only in debug fallback sections.</td></tr><tr><td data-label="Topic"><strong>Maintainability</strong>                      </td><td data-label="Details">Small, focused override file — good for injecting last in cascade. Variables centralized for quick theme tweaks. Keep in sync with base `style.css` variables to avoid surprises.</td></tr><tr><td data-label="Topic"><strong>Potential improvements</strong>               </td><td data-label="Details">Consider: <br> <br>1) adding a small mobile override to collapse or stack first column on very narrow screens; <br> <br>2) offering `--tv-left-width`/`--tv-right-width` aliases to align with runtime overrides; <br> <br>3) ensuring high-contrast fallbacks for accessibility (WCAG) tests.</td></tr><tr><td data-label="Topic"><strong>Risks / gotchas</strong>                      </td><td data-label="Details">- If host page applies global `background` or `color` rules to `td:first-child`, even `!important` may be needed in extreme cases. <br> <br>- Fixed percentage widths can cause truncation on extremely narrow viewports. <br> <br>- Relying on `:nth-child()` for zebra keeps semantics but may mismatch if rows are injected/hidden by JS; tests recommended.</td></tr><tr><td data-label="Topic"><strong>Where it fits in workflow</strong>            </td><td data-label="Details">Designed as `overrides.css` produced after computing left/right widths. It complements `style.css` (base) and should be loaded after it so overrides take effect.</td></tr><tr><td data-label="Topic"><strong>CI / Testing suggestions</strong>             </td><td data-label="Details">Test in: latest Chrome, Firefox, Edge, Safari on desktop & iOS Safari. <br> Check: sticky header + first column stacking, keyboard focus outline, list marker rendering in dark mode, small-width truncation.</td></tr><tr><td data-label="Topic"><strong>Recommendation (short)</strong>               </td><td data-label="Details">Keep this file as a small override layer. Do not merge into a huge monolith; keep it separate so runtime (Python) can regenerate per-output `overrides.css` easily.</td></tr></tbody></table></div><div class='row-count'></div></div>
</div><div class="tv-fragment" id="frag-4">
<div class="table-wrapper" data-table-id="table-4"><h3 id="table-4">Table 4</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th style="width:28.57%;" role="button" aria-label="Sort by **Topic**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Topic</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th style="width:71.43%;" role="button" aria-label="Sort by **Details**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Details</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Topic"><strong>Purpose</strong>                          </td><td data-label="Details">Convert and normalize cell-level textual patterns into safer, structured HTML fragments for table rendering. <br><br>Provides list normalization, bullet-to-`<ul>` conversion, bracket unescaping, lightweight streaming helpers, column-type detection, and a full `render_table` implementation that chains many converters.</td></tr><tr><td data-label="Topic"><strong>Import strategy & fallbacks</strong>      </td><td data-label="Details">Attempts two import strategies for project helpers (`..utils` then `utils`). <br>If imports fail it defines local fallback implementations for `_strip_tags`, `sanitize_bold_html`, `convert_markdown_lists`, and `_escape_unmatched_markers`. <br>This makes the module robust to execution context but can hide missing/incorrect helper behavior.</td></tr><tr><td data-label="Topic"><strong>Key functions (surface)</strong>          </td><td data-label="Details">- `_normalize_leading_bullet` — normalize various bullet glyphs to `- ` prefix. <br>- `convert_bullets_to_ul` — convert multi-line bullet text into `<ul><li>` blocks with several heuristics (skip pure bullets, heading-inline patterns, bracket-preserved lines). <br>- `_normalize_list_markers` — normalize many bullet-like unicode chars into `- `. <br>- `_unescape_brackets_outside_code` — unescape `[ ]` outside `<pre>/<code>` blocks. <br>- `_take_and_stream` — buffer-first-N then iterator for remainder. <br>- `_detect_column_types` — heuristic numeric/text detector over sample rows. <br>- `_clean_label_for_datalabel`, `_apply_left_col_heading` — tidy labels and optionally wrap left-column lead text in `<strong>`. <br>- `render_table` — orchestrates column discovery, per-row conversion pipeline, and HTML assembly (buttons, headers, table, row-count).</td></tr><tr><td data-label="Topic"><strong>Conversion pipeline in `render_table`</strong> </td><td data-label="Details">For each cell: <br>1) convert bullets -> UL <br>2) normalize list markers <br>3) convert markdown lists via `convert_markdown_lists` or `md` callable <br>4) unescape bracket markers outside code <br>5) sanitize bold HTML (non-destructive) <br>6) apply left-column heading heuristic <br>7) escape unmatched markers <br>8) insert into TD with `data-label`</td></tr><tr><td data-label="Topic"><strong>Heuristics & strengths</strong>           </td><td data-label="Details">- Good coverage of varied bullet characters and ad-hoc source patterns. <br>- Preserves bracketed lines (links/references) rather than consuming them into lists. <br>- Attempts to keep the first sentence/phrase in left column visually emphasized. <br>- Degrades gracefully to fallback helpers if project `utils` missing.</td></tr><tr><td data-label="Topic"><strong>Correctness risks & edge cases</strong>   </td><td data-label="Details">- Heavy reliance on regex heuristics will fail for many edge Markdown cases (nested lists, fenced code, tables inside cells, complex inline HTML). <br>- `convert_bullets_to_ul` may mis-detect inline `-` usage (dates, ranges, dash punctuation) and split content incorrectly. <br>- `_detect_column_types` ignores locale-specific decimals/thousands and may misclassify numeric text (commas as thousands, parentheses for negative). <br>- `_unescape_brackets_outside_code` splits on `<pre>`/`<code>` naively and may fail for nested or attribute-containing tags.</td></tr><tr><td data-label="Topic"><strong>Security & sanitization</strong>          </td><td data-label="Details">- Module assumes downstream `sanitize_html` / `sanitize_bold_html` will handle XSS. <br>- Some conversion functions return raw HTML fragments assembled from input; untrusted input must be sanitized before final write. <br>- Fallback `sanitize_bold_html` in this file is simplistic and can produce unexpected `<strong>` wrappers around HTML; treat as non-secure.</td></tr><tr><td data-label="Topic"><strong>Performance characteristics</strong>      </td><td data-label="Details">- Many regex operations per cell; cost scales with total cells. <br>- `convert_bullets_to_ul` and list normalization iterate per-line and use multiple regexes; precompiling patterns would reduce overhead. <br>- `_detect_column_types` inspects sample rows and attempts numeric parsing; this is O(sample × cols). For wide tables this is potentially expensive but acceptable for modest samples.</td></tr><tr><td data-label="Topic"><strong>Robustness & fault tolerance</strong>     </td><td data-label="Details">- Extensive try/except blocks keep pipeline running on malformed inputs. <br>- Returns sanitized defaults and logs exceptions. <br>- However excessive swallowing of errors can make debugging hard unless debug logs are enabled.</td></tr><tr><td data-label="Topic"><strong>Maintainability</strong>                  </td><td data-label="Details">- Logic is concentrated and complex; many heuristics without unit-test coverage would be brittle. <br>- Several regexes are repeated; extract and precompile common patterns. <br>- Comments are present but not exhaustive; add docstrings for major helpers.</td></tr><tr><td data-label="Topic"><strong>Interoperability & contracts</strong>     </td><td data-label="Details">- Expects a callable `markdown_to_html` (or `md`) that converts inline markdown. <br>- Integrates with `render.core_table` and `core_renderer` via `render_table` signature. <br>- When project `utils` exist those should be authoritative; otherwise local fallbacks are used — ensure behavior parity via tests.</td></tr><tr><td data-label="Topic"><strong>Testing suggestions</strong>              </td><td data-label="Details">- Exhaustive unit tests for `convert_bullets_to_ul` covering: single bullets, nested-like lines, heading-inline patterns, bracketed lines, edge punctuation, and unicode bullets. <br>- Tests for `_normalize_list_markers` with a wide set of bullet glyphs. <br>- `_unescape_brackets_outside_code` tests with nested `<code>`, `<pre>`, and inline code. <br>- Property tests for `_detect_column_types` across localized numeric strings. <br>- Integration tests for full `render_table` with DataFrame, list-of-dicts, and generators.</td></tr><tr><td data-label="Topic"><strong>Immediate, low-risk improvements</strong> </td><td data-label="Details">- Precompile frequently used regex patterns at module scope. <br>- Add explicit unit tests for all heuristics to lock behavior. <br>- Replace ad-hoc `re.split` on code blocks with a small parser that is robust to attributes and nested tags. <br>- Make numeric parsing in `_detect_column_types` accept locale configuration or use `locale`-aware parsing.</td></tr><tr><td data-label="Topic"><strong>Medium-term enhancements</strong>         </td><td data-label="Details">- Consider delegating Markdown->HTML to a library (e.g., `markdown-it-py`) for better fidelity, then post-process lists only when necessary. <br>- Introduce a configurable sanitizer pipeline that is invoked after conversion but before HTML insertion. <br>- Add an option to disable heuristic bullet conversion when input is known to be already HTML or well-formed Markdown.</td></tr><tr><td data-label="Topic"><strong>Operational suggestions</strong>          </td><td data-label="Details">- Log at INFO when fallback helper implementations are used so operators notice missing `utils`. <br>- Add a diagnostics mode that returns a per-cell transformation trace for debugging problematic inputs. <br>- Provide a toggle to limit conversion work (e.g., skip complex regexes for very large tables).</td></tr><tr><td data-label="Topic"><strong>Summary judgement</strong>                </td><td data-label="Details">Powerful, pragmatic converter for messy source text. <br><br>Suitable for controlled input sets and incremental improvement. <br><br>For production exposed to untrusted or highly variable Markdown, harden with robust Markdown parsing, explicit sanitization, precompiled regexes, and more unit tests.</td></tr></tbody></table></div><div class='row-count'></div></div>
</div><div class="tv-fragment" id="frag-5">
<div class="table-wrapper" data-table-id="table-5"><h3 id="table-5">Table 5</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th style="width:28.57%;" role="button" aria-label="Sort by **Topic**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Topic</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th style="width:71.43%;" role="button" aria-label="Sort by **Details**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Details</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Topic"><strong>Purpose</strong>                          </td><td data-label="Details">Convert and normalize cell-level textual patterns into safer, structured HTML fragments for table rendering. <br><br>Provides list normalization, bullet-to-`<ul>` conversion, bracket unescaping, lightweight streaming helpers, column-type detection, and a full `render_table` implementation that chains many converters.</td></tr><tr><td data-label="Topic"><strong>Import strategy & fallbacks</strong>      </td><td data-label="Details">Attempts two import strategies for project helpers (`..utils` then `utils`). <br>If imports fail it defines local fallback implementations for `_strip_tags`, `sanitize_bold_html`, `convert_markdown_lists`, and `_escape_unmatched_markers`. <br>This makes the module robust to execution context but can hide missing/incorrect helper behavior.</td></tr><tr><td data-label="Topic"><strong>Key functions (surface)</strong>          </td><td data-label="Details">- `_normalize_leading_bullet` — normalize various bullet glyphs to `- ` prefix. <br>- `convert_bullets_to_ul` — convert multi-line bullet text into `<ul><li>` blocks with several heuristics (skip pure bullets, heading-inline patterns, bracket-preserved lines). <br>- `_normalize_list_markers` — normalize many bullet-like unicode chars into `- `. <br>- `_unescape_brackets_outside_code` — unescape `[ ]` outside `<pre>/<code>` blocks. <br>- `_take_and_stream` — buffer-first-N then iterator for remainder. <br>- `_detect_column_types` — heuristic numeric/text detector over sample rows. <br>- `_clean_label_for_datalabel`, `_apply_left_col_heading` — tidy labels and optionally wrap left-column lead text in `<strong>`. <br>- `render_table` — orchestrates column discovery, per-row conversion pipeline, and HTML assembly (buttons, headers, table, row-count).</td></tr><tr><td data-label="Topic"><strong>Conversion pipeline in `render_table`</strong> </td><td data-label="Details">For each cell: <br>1) convert bullets -> UL <br>2) normalize list markers <br>3) convert markdown lists via `convert_markdown_lists` or `md` callable <br>4) unescape bracket markers outside code <br>5) sanitize bold HTML (non-destructive) <br>6) apply left-column heading heuristic <br>7) escape unmatched markers <br>8) insert into TD with `data-label`</td></tr><tr><td data-label="Topic"><strong>Heuristics & strengths</strong>           </td><td data-label="Details">- Good coverage of varied bullet characters and ad-hoc source patterns. <br>- Preserves bracketed lines (links/references) rather than consuming them into lists. <br>- Attempts to keep the first sentence/phrase in left column visually emphasized. <br>- Degrades gracefully to fallback helpers if project `utils` missing.</td></tr><tr><td data-label="Topic"><strong>Correctness risks & edge cases</strong>   </td><td data-label="Details">- Heavy reliance on regex heuristics will fail for many edge Markdown cases (nested lists, fenced code, tables inside cells, complex inline HTML). <br>- `convert_bullets_to_ul` may mis-detect inline `-` usage (dates, ranges, dash punctuation) and split content incorrectly. <br>- `_detect_column_types` ignores locale-specific decimals/thousands and may misclassify numeric text (commas as thousands, parentheses for negative). <br>- `_unescape_brackets_outside_code` splits on `<pre>`/`<code>` naively and may fail for nested or attribute-containing tags.</td></tr><tr><td data-label="Topic"><strong>Security & sanitization</strong>          </td><td data-label="Details">- Module assumes downstream `sanitize_html` / `sanitize_bold_html` will handle XSS. <br>- Some conversion functions return raw HTML fragments assembled from input; untrusted input must be sanitized before final write. <br>- Fallback `sanitize_bold_html` in this file is simplistic and can produce unexpected `<strong>` wrappers around HTML; treat as non-secure.</td></tr><tr><td data-label="Topic"><strong>Performance characteristics</strong>      </td><td data-label="Details">- Many regex operations per cell; cost scales with total cells. <br>- `convert_bullets_to_ul` and list normalization iterate per-line and use multiple regexes; precompiling patterns would reduce overhead. <br>- `_detect_column_types` inspects sample rows and attempts numeric parsing; this is O(sample × cols). For wide tables this is potentially expensive but acceptable for modest samples.</td></tr><tr><td data-label="Topic"><strong>Robustness & fault tolerance</strong>     </td><td data-label="Details">- Extensive try/except blocks keep pipeline running on malformed inputs. <br>- Returns sanitized defaults and logs exceptions. <br>- However excessive swallowing of errors can make debugging hard unless debug logs are enabled.</td></tr><tr><td data-label="Topic"><strong>Maintainability</strong>                  </td><td data-label="Details">- Logic is concentrated and complex; many heuristics without unit-test coverage would be brittle. <br>- Several regexes are repeated; extract and precompile common patterns. <br>- Comments are present but not exhaustive; add docstrings for major helpers.</td></tr><tr><td data-label="Topic"><strong>Interoperability & contracts</strong>     </td><td data-label="Details">- Expects a callable `markdown_to_html` (or `md`) that converts inline markdown. <br>- Integrates with `render.core_table` and `core_renderer` via `render_table` signature. <br>- When project `utils` exist those should be authoritative; otherwise local fallbacks are used — ensure behavior parity via tests.</td></tr><tr><td data-label="Topic"><strong>Testing suggestions</strong>              </td><td data-label="Details">- Exhaustive unit tests for `convert_bullets_to_ul` covering: single bullets, nested-like lines, heading-inline patterns, bracketed lines, edge punctuation, and unicode bullets. <br>- Tests for `_normalize_list_markers` with a wide set of bullet glyphs. <br>- `_unescape_brackets_outside_code` tests with nested `<code>`, `<pre>`, and inline code. <br>- Property tests for `_detect_column_types` across localized numeric strings. <br>- Integration tests for full `render_table` with DataFrame, list-of-dicts, and generators.</td></tr><tr><td data-label="Topic"><strong>Immediate, low-risk improvements</strong> </td><td data-label="Details">- Precompile frequently used regex patterns at module scope. <br>- Add explicit unit tests for all heuristics to lock behavior. <br>- Replace ad-hoc `re.split` on code blocks with a small parser that is robust to attributes and nested tags. <br>- Make numeric parsing in `_detect_column_types` accept locale configuration or use `locale`-aware parsing.</td></tr><tr><td data-label="Topic"><strong>Medium-term enhancements</strong>         </td><td data-label="Details">- Consider delegating Markdown->HTML to a library (e.g., `markdown-it-py`) for better fidelity, then post-process lists only when necessary. <br>- Introduce a configurable sanitizer pipeline that is invoked after conversion but before HTML insertion. <br>- Add an option to disable heuristic bullet conversion when input is known to be already HTML or well-formed Markdown.</td></tr><tr><td data-label="Topic"><strong>Operational suggestions</strong>          </td><td data-label="Details">- Log at INFO when fallback helper implementations are used so operators notice missing `utils`. <br>- Add a diagnostics mode that returns a per-cell transformation trace for debugging problematic inputs. <br>- Provide a toggle to limit conversion work (e.g., skip complex regexes for very large tables).</td></tr><tr><td data-label="Topic"><strong>Summary judgement</strong>                </td><td data-label="Details">Powerful, pragmatic converter for messy source text. <br><br>Suitable for controlled input sets and incremental improvement. <br><br>For production exposed to untrusted or highly variable Markdown, harden with robust Markdown parsing, explicit sanitization, precompiled regexes, and more unit tests.</td></tr></tbody></table></div><div class='row-count'></div></div>
</div><script src="assets/xlsx.full.min.js?v=1759436736" defer></script>
<script src="assets/inlineblock_guard.js?v=1759436736" defer></script>
<script src="assets/script.js?v=1759436736" defer></script>
<script src="assets/worker.js?v=1759436736" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
</script>

<script>
  (function(){
    function startGuard() {
      try {
        if (window.inlineBlockGuard) {
          window.inlineBlockGuard({ root: document.body, maxRetries: 3, retryDelay: 100, observeDynamic: true, telemetry: function(r){ try{ console.info('inlineBlockGuard report', r); }catch(e){} }});
        } else if (window.inlineBlockObserver) {
          try { window.inlineBlockObserver(document.body); } catch(e) {}
        }
      } catch(e) {}
    }
    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', startGuard);
    else startGuard();
  })();
</script>

</div>
</body>
</html>