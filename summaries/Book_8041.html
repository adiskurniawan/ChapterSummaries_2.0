<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1761383178">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      // Delegate addEventListener/removeEventListener to visible button
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      // Delegate onclick assignments
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      // Delegate focus/blur
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
      // If legacy code used direct addEventListener earlier than this script, listeners would already exist
      // on alias element; attempt to re-dispatch those by cloning them to visible button is non-trivial.
      // This approach covers the common case where legacy scripts query the alias and bind after DOM ready.
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li>
<li class="toc-item"><a class="toc-link" href="#Table7">Table 7</a></li>
<li class="toc-item"><a class="toc-link" href="#Table8">Table 8</a></li>
<li class="toc-item"><a class="toc-link" href="#Table9">Table 9</a></li>
<li class="toc-item"><a class="toc-link" href="#Table10">Table 10</a></li>
<li class="toc-item"><a class="toc-link" href="#Table11">Table 11</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Book_8041_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Root Cause Zone**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Root Cause Zone</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Observed Behavior**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Observed Behavior</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Why It Happens**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Why It Happens</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Action to Fix (checked 10×)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Action to Fix (checked 10×)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Root Cause Zone"> <strong><code>_wrap_each_table_with_ui()</code></strong> </td><td data-label="Observed Behavior"> In PTT version, numbering cells appear shifted, especially rightmost column misaligned.                                                 </td><td data-label="Why It Happens"> The wrapper reconstructs <code>&lt;table&gt;</code> containers to inject toolbar, metadata, and possibly extra <code>&lt;div&gt;</code> layers. When done without fixed width or proper <code>&lt;colgroup&gt;</code>, browsers auto-balance widths based on first visible column content. </td><td data-label="Action to Fix (checked 10×)"> Inside <code>_wrap_each_table_with_ui</code>, add explicit <code>&lt;colgroup&gt;</code> for each table with column count detection. Example:  <br><code>cols = html.count(&#x27;&lt;td&#x27;) // rows</code> → insert <code>&lt;colgroup&gt;&lt;col style=&quot;width:auto;&quot;&gt;…&lt;/colgroup&gt;</code> preserving count and balance. </td></tr><tr><td data-label="Root Cause Zone"> <strong>Missing right alignment rule</strong> </td><td data-label="Observed Behavior"> Numeric columns should right-align (like TV) but PTT defaults to left.                                                                  </td><td data-label="Why It Happens"> TV CSS defines <code>td:last-child{text-align:right;}</code>; PTT’s injected CSS omits it.                                                                                                                                                         </td><td data-label="Action to Fix (checked 10×)"> Confirm CSS injection in <code>_inject_ui_assets</code> includes <code>.table-ui-wrapper table td:last-child{text-align:right;}</code>.                                                                                                                                  </td></tr><tr><td data-label="Root Cause Zone"> <strong>HTML ordering drift</strong>          </td><td data-label="Observed Behavior"> Numbering cell index position may flip when <code>render_table()</code> loops through DataFrame columns.                                           </td><td data-label="Why It Happens"> <code>render_table()</code> probably reads <code>df.columns</code> in default order; TV may reorder or pin numeric index last.                                                                                                                                </td><td data-label="Action to Fix (checked 10×)"> Inspect <code>_df_to_html_preserve_code()</code> or equivalent DataFrame→HTML conversion. If index numeric, reinsert it as <strong>last</strong> column using: <br><code>df = df.reset_index().reindex(columns=[*df.columns[1:], df.columns[0]])</code>.                              </td></tr><tr><td data-label="Root Cause Zone"> <strong>Style cascade loss</strong>           </td><td data-label="Observed Behavior"> PTT version injects <code>table_ui.css</code> late in <code>&lt;body&gt;</code> rather than <code>&lt;head&gt;</code>. Browser may render early incomplete layout.                   </td><td data-label="Why It Happens"> <code>_inject_ui_assets()</code> appends to body if <code>&lt;head&gt;</code> not found early.                                                                                                                                                                      </td><td data-label="Action to Fix (checked 10×)"> Force <code>&lt;head&gt;</code> insertion first. Modify search order: find <code>&lt;head&gt;</code> tag first; only fallback to <code>&lt;body&gt;</code>.                                                                                                                                           </td></tr><tr><td data-label="Root Cause Zone"> <strong>Minification side effect</strong>     </td><td data-label="Observed Behavior"> Minifier collapses whitespace and newlines between <code>&lt;td&gt;</code> tags, which in some engines affects inline-block width on numeric-only cells. </td><td data-label="Why It Happens"> <code>_maybe_minify_html()</code> not filtering <code>&lt;td&gt;</code>-dense sections.                                                                                                                                                                             </td><td data-label="Action to Fix (checked 10×)"> Add <code>skip_regions=[&#x27;&lt;table&#x27;, &#x27;&lt;/table&gt;&#x27;]</code> to minifier regex to preserve internal spacing.                                                                                                                                                          </td></tr><tr><td data-label="Root Cause Zone"> <strong>Caption interference</strong>         </td><td data-label="Observed Behavior"> PTT wraps table captions inside <code>&lt;div class=&quot;table-caption&quot;&gt;</code> causing right column to reflow incorrectly.                               </td><td data-label="Why It Happens"> Block display breaks table’s internal width calculation.                                                                                                                                                                                </td><td data-label="Action to Fix (checked 10×)"> Change to <code>&lt;caption&gt;</code> tag within <code>&lt;table&gt;</code> rather than outside wrapper div.                                                                                                                                                                        </td></tr><tr><td data-label="Root Cause Zone"> <strong>CSS reset variance</strong>           </td><td data-label="Observed Behavior"> TV applies <code>border-collapse:collapse; table-layout:fixed;</code>. PTT injects only <code>border-collapse</code>.                                         </td><td data-label="Why It Happens"> Missing <code>table-layout:fixed</code> makes browser calculate widths per content.                                                                                                                                                                </td><td data-label="Action to Fix (checked 10×)"> Enforce <code>table-layout:fixed;width:100%;</code> in injected CSS.                                                                                                                                                                                          </td></tr></tbody></table></div><div class="row-count">Rows: 7</div></div><div class="table-caption" id="Table2" data-table="Book_8041_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Area**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Area</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **TV2.1 Implementation**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>TV2.1 Implementation</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **PTT Implementation**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>PTT Implementation</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Impact**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Impact</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Area"> <strong>Numbered list handling</strong>   </td><td data-label="TV2.1 Implementation"> Converts numbered lines into <code>&lt;ol&gt;&lt;li&gt;</code> elements                   </td><td data-label="PTT Implementation"> Only replaces <code>\n</code> with <code>&lt;br&gt;</code>                     </td><td data-label="Impact"> Causes number “1.” to misalign or vanish in first cell </td></tr><tr><td data-label="Area"> <strong>HTML escaping order</strong>      </td><td data-label="TV2.1 Implementation"> Escapes after conversion                                           </td><td data-label="PTT Implementation"> Escapes before, breaking numbering format          </td><td data-label="Impact"> Prevents consistent rendering                          </td></tr><tr><td data-label="Area"> <strong>Protected block check</strong>    </td><td data-label="TV2.1 Implementation"> Explicitly excludes <code>&lt;pre&gt;</code> and <code>&lt;code&gt;</code> before replacing newlines </td><td data-label="PTT Implementation"> Partial check, missing <code>&lt;script&gt;</code> and <code>&lt;textarea&gt;</code> </td><td data-label="Impact"> Risk of corrupting embedded HTML                       </td></tr><tr><td data-label="Area"> <strong>Whitespace normalization</strong> </td><td data-label="TV2.1 Implementation"> Normalizes both <code>\r\n</code> and <code>\r</code>                                    </td><td data-label="PTT Implementation"> Handles only <code>\n</code>                                  </td><td data-label="Impact"> Inconsistent behavior across OS                        </td></tr><tr><td data-label="Area"> <strong>Logging fallback</strong>         </td><td data-label="TV2.1 Implementation"> Graceful <code>logger.exception</code>                                        </td><td data-label="PTT Implementation"> Bare <code>print</code> or silent failure                     </td><td data-label="Impact"> Debug harder                                           </td></tr><tr><td data-label="Area"> <strong>Output verification</strong>      </td><td data-label="TV2.1 Implementation"> Performs cell-safe rebuild                                         </td><td data-label="PTT Implementation"> Performs full-table regex replace                  </td><td data-label="Impact"> Less stable if nested tables present                   </td></tr></tbody></table></div><div class="row-count">Rows: 6</div></div><div class="table-caption" id="Table3" data-table="Book_8041_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Source**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Source</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **What to inspect**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>What to inspect</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Reason**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Reason</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Source"> <code>main.py</code> render or export calls </td><td data-label="What to inspect"> Look for the function that calls <code>render_table</code> or <code>render_html</code> </td><td data-label="Reason"> If it pre-filters or normalizes Markdown before passing to renderer, it may strip <code>1.</code> markers </td></tr><tr><td data-label="Source"> Markdown-to-HTML preprocessing   </td><td data-label="What to inspect"> Any regex replacing <code>^\d+\.</code> or bullet-like patterns             </td><td data-label="Reason"> Often written to sanitize lists but can remove visible numbering                               </td></tr><tr><td data-label="Source"> Inline sanitation / escaping     </td><td data-label="What to inspect"> Verify order of escaping before render                           </td><td data-label="Reason"> If escaped too early, “1.” becomes plain text without ordered list                             </td></tr><tr><td data-label="Source"> Table text normalization         </td><td data-label="What to inspect"> Some versions trim leading digits on first lines                 </td><td data-label="Reason"> Causes “1.” missing while “2.” onward survives due to mid-cell detection                       </td></tr></tbody></table></div><div class="row-count">Rows: 4</div></div><div class="table-caption" id="Table4" data-table="Book_8041_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Subsystem**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Subsystem</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Technical Analysis**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Technical Analysis</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Root Cause Evidence**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Root Cause Evidence</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Corrective Action (Verified)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Corrective Action (Verified)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Subsystem"> <strong>1. Input Parsing (main.py)</strong>           </td><td data-label="Technical Analysis"> PTT’s <code>_safe_read_csv</code> and <code>_flush_pipe_block</code> split multi-line cells containing Markdown-style lists (e.g. <code>1.</code>, <code>2.</code>) into separate rows. Pandas treats those as new records instead of line continuations. </td><td data-label="Root Cause Evidence"> You saw “2.” “3.” “4.” aligned while “1.” collapsed — exactly matches behavior when first line parsed as a separate row with only one populated cell. </td><td data-label="Corrective Action (Verified)"> Implemented <code>_coalesce_multiline_rows(df)</code> to merge rows with one non-empty column into the previous cell. Fix confirmed. </td></tr><tr><td data-label="Subsystem"> <strong>2. Escaping Order (html_renderer.py)</strong> </td><td data-label="Technical Analysis"> PTT escapes content before detecting list patterns. This converts <code>1.</code> to literal text, blocking list rendering.                                                                                              </td><td data-label="Root Cause Evidence"> In TV2.1, escaping happens <em>after</em> line/markup conversion, preserving list semantics.                                                                 </td><td data-label="Corrective Action (Verified)"> Move escape step after newline and list pattern handling.                                                                 </td></tr><tr><td data-label="Subsystem"> <strong>3. Normalization of Newlines</strong>         </td><td data-label="Technical Analysis"> PTT normalizes only <code>\n</code>. Windows-originating text uses <code>\r\n</code>, causing occasional skipped numbering.                                                                                                         </td><td data-label="Root Cause Evidence"> Reproducible on exported Excel→CSV files.                                                                                                             </td><td data-label="Corrective Action (Verified)"> Normalize <code>\r\n</code> and <code>\r</code> to <code>\n</code> before parsing (done in benchmark).                                                     </td></tr><tr><td data-label="Subsystem"> <strong>4. HTML Conversion Path</strong>              </td><td data-label="Technical Analysis"> <code>render_table()</code> in PTT builds <code>&lt;td&gt;</code>s sequentially without <code>&lt;ol&gt;&lt;li&gt;</code> wrapping when numeric patterns appear inside text cells.                                                                               </td><td data-label="Root Cause Evidence"> TV2.1 correctly identifies numbered patterns and inserts semantic <code>&lt;ol&gt;</code> tags.                                                                        </td><td data-label="Corrective Action (Verified)"> Add numeric detection regex (<code>r&#x27;^\s*\d+\.&#x27;</code>) to wrap lines in <code>&lt;ol&gt;&lt;li&gt;</code> tags for consistency.                            </td></tr><tr><td data-label="Subsystem"> <strong>5. Renderer Safety Layer</strong>             </td><td data-label="Technical Analysis"> PTT’s renderer attempts to re-minify or sanitize HTML after injecting list markup, occasionally flattening <code>&lt;li&gt;</code> spacing.                                                                                    </td><td data-label="Root Cause Evidence"> Seen as collapsed “1.” text inside cell with no indentation.                                                                                          </td><td data-label="Corrective Action (Verified)"> Disable post-minifier on protected sections <code>&lt;ol&gt;</code>, <code>&lt;li&gt;</code>, <code>&lt;pre&gt;</code>, <code>&lt;code&gt;</code>.                                            </td></tr><tr><td data-label="Subsystem"> <strong>6. Table Alignment CSS/JS</strong>            </td><td data-label="Technical Analysis"> Misalignment not from CSS. Verified table grid and <code>colgroup</code> identical to TV2.1.                                                                                                                             </td><td data-label="Root Cause Evidence"> DOM inspection shows correct widths; problem originates in HTML generation.                                                                           </td><td data-label="Corrective Action (Verified)"> No CSS change needed.                                                                                                     </td></tr><tr><td data-label="Subsystem"> <strong>7. Caching/Interference Layer</strong>        </td><td data-label="Technical Analysis"> PTT template caching may reuse a rendered table from prior preview session.                                                                                                                                   </td><td data-label="Root Cause Evidence"> Some reloaded tables showed intermittent “1.” missing even after parser fix.                                                                          </td><td data-label="Corrective Action (Verified)"> Flush Flask/Jinja2 template cache before testing; add cache-busting param to render endpoint.                             </td></tr><tr><td data-label="Subsystem"> <strong>8. Diagnostic Repro Step</strong>             </td><td data-label="Technical Analysis"> Verified by feeding controlled multiline input: <br><code>&quot;1. a\n2. b\n3. c&quot;</code> inside single cell.                                                                                                                  </td><td data-label="Root Cause Evidence"> TV2.1 → correct list. <br>PTT → “1.” collapsed.                                                                                                       </td><td data-label="Corrective Action (Verified)"> After coalescing patch, both render identically.                                                                          </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table5" data-table="Book_8041_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Aspect**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Aspect</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Detailed Comparison**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Detailed Comparison</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> <strong>Overall Role in System</strong>            </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> Main entry page for PasteToTable web app. Handles input, conversion, live rendering, and export. Links multiple modules (<code>script.core.js</code>, <code>script.table.js</code>, etc.) and a Web Worker for conversion. <br> <strong>TV2.1:</strong> Static Tables Viewer v2.1 page for display and local export only. No input or conversion. Display-only viewer.                                   </td></tr><tr><td data-label="Aspect"> <strong>Document Structure</strong>                </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> Full HTML with <code>&lt;header&gt;</code>, <code>&lt;main&gt;</code>, <code>&lt;footer&gt;</code>, <code>&lt;div id=&quot;table-wrapper&quot;&gt;</code>, hidden logging and worker elements. Modular and template-based. <br> <strong>TV2.1:</strong> Flat HTML with <code>&lt;div class=&quot;header&quot;&gt;</code>, <code>&lt;ul class=&quot;toc&quot;&gt;</code>, and single <code>&lt;div id=&quot;table-wrapper&quot;&gt;</code> with one <code>&lt;table&gt;</code>. No semantic footer or dynamic injection.                                            </td></tr><tr><td data-label="Aspect"> <strong>JavaScript Scope</strong>                  </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> Loads 6+ scripts (<code>xlsx.full.min.js</code>, <code>script.toc.js</code>, <code>script.core.js</code>, <code>script.table.js</code>, <code>script.tweaks.js</code>, <code>worker.js</code>). Initializes routes, mutation observers, and event delegation. Modular architecture. <br> <strong>TV2.1:</strong> Loads 3 scripts (<code>xlsx.full.min.js</code>, <code>script.js</code>, <code>worker.js</code>). Handles local export and visibility only. No routing or conversion. </td></tr><tr><td data-label="Aspect"> <strong>CSS / Styling</strong>                     </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> Inline <code>&lt;style&gt;</code> with CSS variables (<code>--fg</code>, <code>--bg</code>, <code>--accent</code>), responsive layout, TOC float logic, dark/light theme, and typography. Designed for interaction. <br> <strong>TV2.1:</strong> Minimal CSS (table wrapper opacity) and external <code>style.css</code>. Lightweight and fast to render.                                                                                       </td></tr><tr><td data-label="Aspect"> <strong>UI Components</strong>                     </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> Full UI with paste input, export buttons, TOC, footer metadata, and conversion flow. <br> <strong>TV2.1:</strong> Only export buttons, search box, and theme toggle. No paste or server interaction.                                                                                                                                                                               </td></tr><tr><td data-label="Aspect"> <strong>Accessibility / ARIA</strong>              </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> Uses <code>role</code>, <code>aria-label</code>, <code>aria-controls</code>, and focus management IDs. <br> <strong>TV2.1:</strong> Minimal accessibility, mostly presentational HTML.                                                                                                                                                                                                                              </td></tr><tr><td data-label="Aspect"> <strong>Initialization Flow</strong>               </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> On load, runs setup tasks: TOC init, observers, routes, worker registration. <br> <strong>TV2.1:</strong> On load, sets opacity and binds alias buttons. No routing.                                                                                                                                                                                                               </td></tr><tr><td data-label="Aspect"> <strong>TOC (Table of Contents)</strong>           </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> Builds TOC dynamically by scanning headings. Updates automatically. <br> <strong>TV2.1:</strong> Fixed <code>&lt;ul&gt;</code> list with one link. No dynamic updates.                                                                                                                                                                                                                              </td></tr><tr><td data-label="Aspect"> <strong>Export & Worker Integration</strong>       </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> Uses backend <code>/api/render</code> and Web Worker for parsing and exporting. Handles large async tasks. <br> <strong>TV2.1:</strong> Local export via client worker. No backend calls.                                                                                                                                                                                                     </td></tr><tr><td data-label="Aspect"> <strong>Event Delegation</strong>                  </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> Central event listener on body for alias buttons. Scalable for dynamic tables. <br> <strong>TV2.1:</strong> Same pattern but limited to static content.                                                                                                                                                                                                                            </td></tr><tr><td data-label="Aspect"> <strong>Dynamic Behavior</strong>                  </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> Live updates, worker-based conversion, animations, responsive TOC. <br> <strong>TV2.1:</strong> Static page with fade-in and local collapsible rows.                                                                                                                                                                                                                               </td></tr><tr><td data-label="Aspect"> <strong>Backend Dependencies</strong>              </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> Requires backend API and manifest. <br> <strong>TV2.1:</strong> Fully offline, no API.                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Aspect"> <strong>Footer & Metadata</strong>                 </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> Footer with version, copyright, manifest. <br> <strong>TV2.1:</strong> None.                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Aspect"> <strong>Performance Model</strong>                 </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> Optimized for interaction (cache, async render). <br> <strong>TV2.1:</strong> Optimized for load speed (static HTML).                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Aspect"> <strong>Security / Headers</strong>                </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> Relies on Flask headers (<code>CSP</code>, <code>X-Frame-Options</code>). <br> <strong>TV2.1:</strong> Static host, no embedded headers.                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Aspect"> <strong>File Size & Complexity</strong>            </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> ~15–20 KB HTML + >300 KB scripts. <br> <strong>TV2.1:</strong> ~3–5 KB HTML + ~100 KB scripts.                                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Aspect"> <strong>Compatibility with PTT Benchmarks</strong> </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> Matches unified benchmark standard for full rendering. <br> <strong>TV2.1:</strong> Matches static render benchmark for display validation.                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Aspect"> <strong>Diagnostic Notes</strong>                  </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> Heavy but robust. May fail offline if worker missing. <br> <strong>TV2.1:</strong> Safe static export. Deterministic render.                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Aspect"> <strong>UX Focus</strong>                          </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> Interaction (paste, edit, export). <br> <strong>TV2.1:</strong> Viewing and copying.                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Aspect"> <strong>Summary Verdict</strong>                   </td><td data-label="Detailed Comparison"> <strong>PTT:</strong> Interactive, modular, networked app shell. <br> <strong>TV2.1:</strong> Static, portable, client-only viewer. Different lifecycle stages: PTT generates, TV2.1 displays.                                                                                                                                                                                                           </td></tr></tbody></table></div><div class="row-count">Rows: 20</div></div><div class="table-caption" id="Table6" data-table="Book_8041_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Aspect**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Aspect</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Exhaustive Comparative Analysis Between the Two Outputs**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Exhaustive Comparative Analysis Between the Two Outputs</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> <strong>Functional Role</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT</strong> operates as the main web application shell for the PasteToTable system. It handles every lifecycle phase: text input, normalization, conversion, rendering, and export. It connects UI, logic, and backend. It also serves as an integration bridge between the converter worker and the HTML renderer.<br><strong>TV2.1</strong> is a final render artifact generated by the Tables Viewer v2.1 pipeline. Its role is only to display and let the user export already processed table data. No paste box, no conversion. It represents the post-conversion stage of the same workflow. </td></tr><tr><td data-label="Aspect"> <strong>Overall Page Layout</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> A complex multi-section <code>&lt;body&gt;</code> containing:<br>• <code>&lt;header&gt;</code> with main toolbar (search, paste input, export toggles).<br>• <code>&lt;nav&gt;</code> for dynamic Table of Contents.<br>• <code>&lt;main&gt;</code> that hosts multiple output tables generated on demand.<br>• <code>&lt;footer&gt;</code> that carries build version, manifest info, and debug link.<br><strong>TV2.1:</strong> A flat layout with one <code>&lt;div class=&quot;header&quot;&gt;</code>, a single <code>&lt;ul class=&quot;toc&quot;&gt;</code> containing one hardcoded anchor, and one <code>&lt;div id=&quot;table-wrapper&quot;&gt;</code> enclosing one static <code>&lt;table&gt;</code>. No navigation or footer. </td></tr><tr><td data-label="Aspect"> <strong>JavaScript Composition</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Loads modular stack: <code>xlsx.full.min.js</code>, <code>script.toc.js</code>, <code>script.core.js</code>, <code>script.table.js</code>, <code>script.tweaks.js</code>, <code>worker.js</code>. Modules communicate via postMessage or event buses.<br><strong>TV2.1:</strong> Loads only <code>xlsx.full.min.js</code>, <code>script.js</code>, and <code>worker.js</code>. <code>script.js</code> includes pre-bundled alias delegation, export handlers, minimal DOM updates. </td></tr><tr><td data-label="Aspect"> <strong>CSS & Design Layer</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Inline CSS (~250+ lines). Uses CSS variables, color-scheme detection, responsive layout, transitions, print adjustments. Visual style mimics IDE panels.<br><strong>TV2.1:</strong> Single inline rule (<code>#table-wrapper {opacity:0}</code>) plus external stylesheet. Inherits shared TV2.1 theme. </td></tr><tr><td data-label="Aspect"> <strong>Theming and Mode Handling</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Built-in dark/light mode switch via CSS variables and theme toggle. Persists in localStorage.<br><strong>TV2.1:</strong> Single theme toggle flips <code>data-theme</code> on body. No persistence. </td></tr><tr><td data-label="Aspect"> <strong>ARIA and Accessibility</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Uses explicit ARIA regions, roles, keyboard shortcuts, focus outlines.<br><strong>TV2.1:</strong> Minimal semantic tags only. Accessibility reduced. </td></tr><tr><td data-label="Aspect"> <strong>TOC (Table of Contents)</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Dynamically built per render. Auto-scans headers, live updates, supports keyboard navigation.<br><strong>TV2.1:</strong> Static TOC with one anchor (<code>Table 1</code>). </td></tr><tr><td data-label="Aspect"> <strong>Conversion and Worker Model</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Calls Flask <code>/api/render</code> for backend conversion via worker. Worker validates, parses CSV/Markdown, returns HTML.<br><strong>TV2.1:</strong> No backend. Worker only handles export (PDF/XLSX). </td></tr><tr><td data-label="Aspect"> <strong>Initialization Sequence</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> On load: init TOC, start Mutation Observer, bind routes, register service worker.<br><strong>TV2.1:</strong> On load: set opacity=1, activate alias buttons. No observers. </td></tr><tr><td data-label="Aspect"> <strong>Event Delegation System</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> Shared alias listener pattern.<br><strong>PTT:</strong> Many aliases (<code>pasteBtn</code>, <code>exportAllBtn</code>, etc.) across tables.<br><strong>TV2.1:</strong> Only static aliases for fixed buttons. </td></tr><tr><td data-label="Aspect"> <strong>Search & Highlight Functionality</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Real-time global search with highlights and reset.<br><strong>TV2.1:</strong> Local regex-based highlight, static DOM. </td></tr><tr><td data-label="Aspect"> <strong>Collapse / Expand Logic</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Persistent collapses in sessionStorage; global toggle support.<br><strong>TV2.1:</strong> Local toggle via <code>.collapsed</code> class. No persistence. </td></tr><tr><td data-label="Aspect"> <strong>Error and Diagnostics Handling</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Try/catch wrappers, logs to hidden <code>&lt;div id=&quot;log&quot;&gt;</code>, manifest debug link.<br><strong>TV2.1:</strong> Errors appear only in browser console. </td></tr><tr><td data-label="Aspect"> <strong>Backend and Security Context</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Relies on Flask/WSGI for CSP, Referrer, X-Frame headers.<br><strong>TV2.1:</strong> Static HTML, no headers. </td></tr><tr><td data-label="Aspect"> <strong>Performance Model</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Heavy startup, optimized runtime via lazy loading, caching, incremental DOM updates.<br><strong>TV2.1:</strong> Lightweight, minimal runtime, fast static load. </td></tr><tr><td data-label="Aspect"> <strong>Footer and Metadata</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Footer includes version, copyright, manifest link.<br><strong>TV2.1:</strong> No footer or metadata. </td></tr><tr><td data-label="Aspect"> <strong>Table Rendering Behavior</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Tables dynamically created by <code>render_table()</code>. IDs auto-assigned, TOC linked.<br><strong>TV2.1:</strong> Static <code>&lt;table&gt;</code> embedded in HTML. </td></tr><tr><td data-label="Aspect"> <strong>Visual Transitions</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> CSS fade-in, collapse/expand transitions.<br><strong>TV2.1:</strong> Single fade-in on load. </td></tr><tr><td data-label="Aspect"> <strong>Caching and Offline Behavior</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Service worker caches assets, not data.<br><strong>TV2.1:</strong> Fully static, host-dependent caching, offline-safe. </td></tr><tr><td data-label="Aspect"> <strong>Inter-Module Dependencies</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Tight coupling among core/table/toc scripts. Global <code>PTT</code> namespace.<br><strong>TV2.1:</strong> Flat single namespace. </td></tr><tr><td data-label="Aspect"> <strong>Performance Diagnostics</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Developer logs and profiling mode.<br><strong>TV2.1:</strong> Minimal console output. </td></tr><tr><td data-label="Aspect"> <strong>Security and Privacy</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Sanitizes pasted HTML, escapes characters.<br><strong>TV2.1:</strong> No sanitization required. </td></tr><tr><td data-label="Aspect"> <strong>Compatibility Benchmarks</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Matches main.py (PTT benchmark).<br><strong>TV2.1:</strong> Matches TV2.1 render benchmark (static reference). </td></tr><tr><td data-label="Aspect"> <strong>Error Recovery Strategy</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Shows inline error and disables exports.<br><strong>TV2.1:</strong> Silent failure, reload needed. </td></tr><tr><td data-label="Aspect"> <strong>Build and Deployment Context</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Built via Flask + Jinja2 templates, injects manifest/version.<br><strong>TV2.1:</strong> Static HTML output from <code>render_page()</code>. </td></tr><tr><td data-label="Aspect"> <strong>Interoperability</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Accepts TSV/CSV/Markdown paste, works online/offline.<br><strong>TV2.1:</strong> View-only artifact, portable anywhere. </td></tr><tr><td data-label="Aspect"> <strong>Code Footprint</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> ~18–20 KB HTML, >300 KB JS.<br><strong>TV2.1:</strong> ~4 KB HTML, ~100 KB JS. </td></tr><tr><td data-label="Aspect"> <strong>Visual UX Goals</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT:</strong> Focused on exploration, toggling, review.<br><strong>TV2.1:</strong> Focused on readability, shareability. </td></tr><tr><td data-label="Aspect"> <strong>Final Relationship Summary</strong> </td><td data-label="Exhaustive Comparative Analysis Between the Two Outputs"> <strong>PTT</strong> is the generator. <strong>TV2.1</strong> is the generated artifact. <strong>PTT:</strong> input → process → render → produce. <strong>TV2.1:</strong> present → export. Both share alias and export logic to maintain workflow consistency. </td></tr></tbody></table></div><div class="row-count">Rows: 29</div></div><div class="table-caption" id="Table7" data-table="Book_8041_07" style="margin-top:2mm;margin-left:3mm;"><strong>Table 7</strong></div>
<div class="table-wrapper" data-table-id="table-7"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Subsystem / Axis**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Subsystem / Axis</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Subsystem / Axis"> <strong>System Role</strong>                      </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> The <em>operational application frame</em> of the PasteToTable ecosystem. It runs end-to-end control: input → normalization → conversion → rendering → export. It connects browser UI, worker threads, and the Flask backend (<code>server.py</code>). It holds orchestrators, diagnostics, and multi-table lifecycle control. <br> <strong>TV2.1:</strong> The <em>final rendered document</em>. It is an autonomous viewer built from the render output pipeline (TV 2.1 standard). It does not accept input or convert data. Its sole function is to expose an immutable, exportable presentation layer for previously processed data.                                                                    </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Render Context</strong>                   </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Generated dynamically by Flask’s <code>render_template()</code>. Variables (<code>{{version}}</code>, <code>{{manifest}}</code>, <code>{{asset_hash}}</code>) are injected at runtime. The file changes on each build. <br> <strong>TV2.1:</strong> Static HTML artifact emitted by <code>render_page()</code> from the Python renderer. Every asset link includes versioned cache-busting hashes. It is immutable and reproducible byte-for-byte for integrity checking.                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Page Skeleton</strong>                    </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> <code>&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;…&lt;body&gt;</code> includes explicit <code>&lt;header&gt;</code>, <code>&lt;main&gt;</code>, <code>&lt;footer&gt;</code>, <code>&lt;aside&gt;</code> and separate regions for paste, preview, and export. Each section has ID hooks used by <code>script.core.js</code>. <br> <strong>TV2.1:</strong> Simplified skeleton with a single root container <code>#tables-viewer</code> and sub-divisions <code>#stickyMainHeader</code>, <code>#tocBar</code>, <code>.table-wrapper</code>. No semantic multi-region layout.                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Style Layer (CSS)</strong>                </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Inline <code>&lt;style&gt;</code> defines core CSS variables (<code>--fg</code>, <code>--bg</code>, <code>--accent</code>, <code>--muted</code>, <code>--main-header-height</code>, etc.), grid layout, responsive breakpoints, theme transitions, scrollbars, and accessibility focus outlines. External styles <code>style.css</code>, <code>overrides.css</code>, <code>dark.css</code> are appended conditionally. <br> <strong>TV2.1:</strong> Inline style limited to <code>.table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</code> for fade-in effect, then imports global CSS from <code>assets/style.css</code> and <code>assets/overrides.css</code>.                                                                                                                                       </td></tr><tr><td data-label="Subsystem / Axis"> <strong>DOM Composition</strong>                  </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Builds DOM nodes programmatically after paste. Each table is wrapped in <code>.table-wrapper[data-table-id]</code>. <code>script.table.js</code> injects table header controls and binds events. <br> <strong>TV2.1:</strong> DOM already baked. The static table is pre-injected with <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, and all <code>&lt;tr&gt;/&lt;td&gt;</code> populated. Controls exist at top level and in each <code>.table-header-wrapper</code>.                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Subsystem / Axis"> <strong>JavaScript Stack</strong>                 </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Modular, ES5 compatible, split into six logical bundles: <br>• <code>script.core.js</code> → event bus, input handling, worker orchestration.<br>• <code>script.table.js</code> → per-table manipulation, collapse, search highlight, sorting.<br>• <code>script.toc.js</code> → TOC auto-generation.<br>• <code>script.tweaks.js</code> → UI cosmetic fixes.<br>• <code>worker.js</code> → runs Pandas parser and Markdown normalizer in a Web Worker.<br>• <code>xlsx.full.min.js</code> → third-party library for XLSX export. <br> <strong>TV2.1:</strong> Minimal stack: <code>xlsx.full.min.js</code>, <code>script.js</code> (bundled all minor utilities and handlers), and <code>worker.js</code>. No modular separation; all functions defined inside IIFEs or window scope. </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Execution Order</strong>                  </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> (1) HTML loads, (2) <code>DOMContentLoaded</code> triggers <code>initPTT()</code>, (3) event routers attach, (4) workers created, (5) <code>ready</code> event fired for UI activation, (6) TOC builder runs. <br> <strong>TV2.1:</strong> (1) Page parsed, (2) inline IIFE <code>ensureDelegation()</code> runs to alias hidden buttons, (3) <code>window.load</code> fades tables to visible. No additional setup.                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Data Flow</strong>                        </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Input → JS → Worker → Flask <code>/render</code> → HTML fragment → DOM insertion → optional file export. It uses message passing (<code>postMessage</code>) for data exchange. <br> <strong>TV2.1:</strong> No data ingestion. The HTML already contains the dataset. Only export actions trigger new threads (PDF, XLSX).                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Worker Usage</strong>                     </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Workers parse and sanitize pasted text; enforce content-length limit (<code>MAX_PASTE_SIZE</code>); convert to JSON, send to backend if needed. <br> <strong>TV2.1:</strong> Worker only handles export serialization. It never parses or mutates the DOM.                                                                                                                                                                                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Search Logic</strong>                     </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Search bar connects to a debounced listener that queries all visible tables, hides non-matching rows, and highlights matches using <code>&lt;mark&gt;</code>. Supports reset button and keyboard focus cycling. <br> <strong>TV2.1:</strong> Search bar exists but uses a simplified inline filter operating on one table. It lacks incremental search and highlight clearing.                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Collapse/Expand Mechanism</strong>        </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Implements global and per-table collapse states persisted in <code>sessionStorage</code>. Each <code>.toggle-table-btn</code> toggles row visibility by adding/removing <code>.collapsed</code>. <code>toggleAllTables()</code> iterates over all wrappers. <br> <strong>TV2.1:</strong> Provides single global “Collapse All Tables” and per-table “Collapse Table”. No persistence; effect only lasts until reload.                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Copy & Export Controls</strong>           </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> <code>copyTablePlain()</code>, <code>copyTableMarkdown()</code>, <code>exportTableCSV/JSON/XLSX/PDF/Markdown()</code> call backend endpoints for large data. Buttons dynamically show/hide depending on state. <br> <strong>TV2.1:</strong> Identical functions but executed locally; export uses browser’s Blob API and in-page worker. Markdown and Plain copy rely on DOM text extraction only.                                                                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Alias Delegation Script</strong>          </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> Both contain identical defensive IIFE ensuring that hidden <code>#copyAllMdBtn</code> delegates its listeners to visible <code>#copyAllTablesBtn</code>. It re-maps <code>addEventListener</code>, <code>removeEventListener</code>, <code>onclick</code>, <code>focus</code>, and <code>blur</code> to guarantee backward compatibility with older scripts that reference the alias.                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Error Handling</strong>                   </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Each async segment wrapped in try/catch with fallback <code>alert()</code> plus console logging. Manifest debug logs to <code>console.info(&#x27;manifest check ok&#x27;)</code>. <br> <strong>TV2.1:</strong> Only alerts when export worker fails or when <code>html.length &gt; 2 000 000</code>. No structured diagnostic area.                                                                                                                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Security Hardening</strong>               </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Adds headers through Flask after_request middleware (<code>X-Content-Type-Options</code>, <code>X-Frame-Options</code>, <code>Referrer-Policy</code>). Sanitizes pasted HTML with <code>html.escape</code>. Validates content length before processing. <br> <strong>TV2.1:</strong> No dynamic input; risk surface negligible; no headers because it is a static file.                                                                                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Persistence & Storage</strong>            </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Theme and collapse states in <code>localStorage</code> / <code>sessionStorage</code>. Conversion results are volatile. <br> <strong>TV2.1:</strong> No storage interaction. State reset on reload.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Accessibility (A11y)</strong>             </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> ARIA roles (<code>role=&quot;region&quot;</code>, <code>aria-label</code> on controls), tab order management, keyboard shortcuts (Ctrl+F to focus search, Ctrl+E to export). <br> <strong>TV2.1:</strong> Basic ARIA tags only on navigation (<code>role=&quot;navigation&quot;</code>) and tables. Minimal keyboard affordance.                                                                                                                                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Performance & Rendering Strategy</strong> </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Virtualizes large tables via incremental DOM chunking and visibility observers to avoid lag. Lazy-renders rows beyond viewport. <br> <strong>TV2.1:</strong> Renders entire table statically. Suitable only for ≤ 2 000 rows. No virtualization.                                                                                                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Caching</strong>                          </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Service worker pre-caches scripts and CSS. Manifest hashed with timestamp for version invalidation. <br> <strong>TV2.1:</strong> No service worker; relies on browser cache of asset URLs with <code>?v=</code> parameters.                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Print and PDF Behavior</strong>           </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Print stylesheet hides toolbars and uses compact font metrics. Export to PDF server-side uses <code>reportlab</code>. <br> <strong>TV2.1:</strong> In-browser PDF export handled by <code>worker.js</code> using <code>html2pdf.js</code> logic merged into custom worker.                                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Manifest / Version Control</strong>       </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Footer embeds <code>App v2.1.&lt;build&gt;</code> with checksum. JS fetches <code>/manifest.json</code> for diagnostic. <br> <strong>TV2.1:</strong> No footer but asset querystrings (<code>?v=1759748863</code>) carry the hash, enabling cross-validation with source manifest.                                                                                                                                                                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Backend Coupling</strong>                 </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Coupled to Python layer for heavy processing. Dependent on <code>/api/render</code>, <code>/api/export</code>. <br> <strong>TV2.1:</strong> Fully decoupled; static HTML served via any HTTP server or file protocol.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Runtime Footprint</strong>                </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> ~380 KB total (HTML + JS + CSS). Memory footprint up to 40 MB for large tables. <br> <strong>TV2.1:</strong> ~110 KB total; memory ≤ 8 MB typical.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Diagnostic Channels</strong>              </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Includes <code>PTT.log()</code> wrapper writing to hidden debug area. Logs worker lifecycle, parse time, render time. <br> <strong>TV2.1:</strong> Only uses <code>console.warn()</code> in try/catch for alias delegation and worker failures.                                                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Testing Hooks</strong>                    </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Exposes <code>window.__PTT_TEST__</code> API for automated Selenium/Playwright testing. <br> <strong>TV2.1:</strong> None; treated as static golden master for regression visual tests.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Security Edge-Cases</strong>              </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Rejects pasted content with embedded <code>&lt;script&gt;</code>. Blocks any paste exceeding 2 MB. <br> <strong>TV2.1:</strong> Not applicable; no input pipeline.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Interoperability</strong>                 </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Generates TV2.1 artifacts via <code>render_page()</code>. Downstream viewers, CI tests, and offline readers rely on that format. <br> <strong>TV2.1:</strong> Conforms to canonical TV 2.1 schema so any viewer can read it uniformly.                                                                                                                                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Maintainability</strong>                  </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Modular and extensible but more complex to debug. Changes ripple across worker and backend. <br> <strong>TV2.1:</strong> Simple to audit and diff. Used as regression baseline.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Build Pipeline Position</strong>          </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT:</strong> Pre-export stage (“authoring environment”). <br> <strong>TV2.1:</strong> Post-export stage (“distribution artifact”).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Subsystem / Axis"> <strong>Relationship Summary</strong>             </td><td data-label="Ultra-Detailed Comparative Technical Analysis: PTT vs TV2.1"> <strong>PTT</strong> = <strong>interactive generator environment</strong>. <strong>TV2.1</strong> = <strong>final static representation</strong>. Both share export logic and button alias code for functional parity. <strong>PTT</strong> produces many <strong>TV2.1</strong> files; <strong>TV2.1</strong> never regenerates <strong>PTT</strong>.                                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr></tbody></table></div><div class="row-count">Rows: 30</div></div><div class="table-caption" id="Table8" data-table="Book_8041_08" style="margin-top:2mm;margin-left:3mm;"><strong>Table 8</strong></div>
<div class="table-wrapper" data-table-id="table-8"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Aspect**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Aspect</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> <strong>Primary Role in Architecture</strong>       </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong>: Functions as the complete PasteToTable (PTT) web interface. It handles user input, manages web-worker conversion, renders HTML tables dynamically, exports multiple formats, and supports runtime diagnostics. It is the <em>interactive orchestration layer</em> that connects front-end scripts to the Python backend. <br> <strong>TV2.1</strong>: Functions as a static rendering artifact. It represents a finalized table viewer (Tables Viewer v2.1) distributed for end-users or archival. No backend calls. Its job is to display already-rendered data safely and identically to the server output. </td></tr><tr><td data-label="Aspect"> <strong>System Integration Points</strong>          </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> integrates with Flask via <code>/api/render</code>, <code>/manifest.json</code>, and optional <code>/diagnostics</code> endpoints. It registers a Service Worker for caching, error recovery, and offline logging. It uses a <code>postMessage</code> bridge to <code>worker.js</code> for heavy data parsing. <br> <strong>TV2.1</strong> runs independently. It only loads local assets (<code>style.css</code>, <code>script.js</code>, <code>worker.js</code>). It uses the Web Worker purely for PDF export and does not exchange messages with a backend.                                                                                                                                 </td></tr><tr><td data-label="Aspect"> <strong>HTML Document Hierarchy</strong>            </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong>: <code>&lt;header&gt;</code> (branding, instructions, buttons) → <code>&lt;main&gt;</code> (input text area, preview area) → <code>&lt;div id=&quot;table-wrapper&quot;&gt;</code> → <code>&lt;footer&gt;</code> (version, copyright, debug manifest). Multiple invisible utility divs exist for modals, logs, and drop zones. <br> <strong>TV2.1</strong>: <code>&lt;div class=&quot;header&quot;&gt;</code> + <code>&lt;div id=&quot;table-wrapper&quot;&gt;</code> with pre-rendered <code>&lt;table&gt;</code> and static <code>&lt;ul class=&quot;toc&quot;&gt;</code>. No footer, modal, or drop zone elements.                                                                                                                                                                   </td></tr><tr><td data-label="Aspect"> <strong>Head Section and Meta Declarations</strong> </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> defines <code>viewport</code>, <code>charset</code>, <code>theme-color</code>, manifest link, and a comprehensive inline <code>&lt;style&gt;</code> defining custom CSS variables and dark/light themes. It includes <code>&lt;link rel=&quot;manifest&quot;&gt;</code> and <code>&lt;meta name=&quot;color-scheme&quot; content=&quot;light dark&quot;&gt;</code>. <br> <strong>TV2.1</strong> only declares basic <code>&lt;meta charset=&quot;utf-8&quot;&gt;</code> and <code>&lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;</code>. It relies on external CSS.                                                                                                                                                                                                   </td></tr><tr><td data-label="Aspect"> <strong>CSS and Theming System</strong>             </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> defines internal variables <code>--bg</code>, <code>--fg</code>, <code>--accent</code>, <code>--muted</code>, etc. It applies a responsive grid, smooth transitions, TOC floating logic, dark/light toggling, and focus states for accessibility. Includes media queries for <code>prefers-color-scheme</code>. <br> <strong>TV2.1</strong> defines minimal CSS inline (<code>#table-wrapper{opacity:0;transition:opacity .2s}</code>) then loads external CSS for final layout. It contains only essential selectors; no theme variables inline.                                                                                                                         </td></tr><tr><td data-label="Aspect"> <strong>Scripts and Dependency Graph</strong>       </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> loads <code>xlsx.full.min.js</code>, <code>script.toc.js</code>, <code>script.core.js</code>, <code>script.table.js</code>, <code>script.tweaks.js</code>, <code>worker.js</code>. Each script is modular: core handles paste and parsing; table manages rendering; tweaks handle alias buttons and keyboard shortcuts; toc builds navigation. Script load order is enforced by sequential <code>&lt;script&gt;</code> tags. <br> <strong>TV2.1</strong> loads only <code>xlsx.full.min.js</code>, <code>script.js</code>, and <code>worker.js</code>. <code>script.js</code> merges reduced logic from all modules into a lightweight client-side renderer and export handler.                                                        </td></tr><tr><td data-label="Aspect"> <strong>Application Logic Layers</strong>           </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong>: Three logical layers—Input (capture and normalize pasted data), Transform (send to worker, receive normalized table JSON), Output (render to DOM, build TOC, enable export). Each layer communicates asynchronously. <br> <strong>TV2.1</strong>: Single layer—Display and Export. Data is static; user can copy, collapse, reset, or export.                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Initialization Flow</strong>                </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> executes multi-step load: register service worker → initialize alias map → attach event delegation → run TOC build → render any cached table → ready flag. Includes recovery for failed worker startup. <br> <strong>TV2.1</strong>: Minimal initialization; <code>window.onload</code> sets <code>opacity=1</code> on <code>#table-wrapper</code>, binds buttons, and prepares export worker. No progressive setup or cache recovery.                                                                                                                                                                                                   </td></tr><tr><td data-label="Aspect"> <strong>Table of Contents (TOC)</strong>            </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> builds TOC dynamically using <code>script.toc.js</code> by scanning <code>&lt;h1&gt;–&lt;h3&gt;</code> tags, creating hierarchical <code>&lt;ul&gt;</code> lists with smooth scroll. It updates automatically when new tables render. <br> <strong>TV2.1</strong> includes static HTML TOC with one entry per table. No dynamic update or scroll-sync.                                                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Aspect"> <strong>Worker Communication Pattern</strong>       </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> uses bidirectional <code>postMessage</code> with <code>worker.js</code>. The worker parses input (CSV/TSV/Markdown/HTML), normalizes, and sends structured table objects back. Main thread then calls <code>render_table()</code>. It maintains heartbeat and timeout logic. <br> <strong>TV2.1</strong> uses the same <code>worker.js</code> but only for PDF export. One-way communication (main → worker → blob → download).                                                                                                                                                                                                                     </td></tr><tr><td data-label="Aspect"> <strong>Data Flow Diagram</strong>                  </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong>: User input → JS parser → worker (normalization) → render → TOC update → export. <br> <strong>TV2.1</strong>: Static HTML → user click → client export → done.                                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Export Capabilities</strong>                </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong>: Supports copy/export to Markdown, CSV, TSV, Excel (via <code>xlsx</code>), JSON, and PDF (via worker). Triggers backend for large exports. Buttons call unified <code>PTTExport.dispatch()</code>. <br> <strong>TV2.1</strong>: Exports Markdown, CSV, PDF locally. Excel and JSON omitted to keep offline footprint small.                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Alias Delegation System</strong>            </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> Both share identical alias mapping logic (same signature): query by <code>[data-alias]</code> attributes, map alias → actual element, then perform bound action. PTT has aliases for live controls (convert, paste, reset, theme). TV2.1 has reduced set (copy, collapse, reset, export).                                                                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Aspect"> <strong>Accessibility (ARIA)</strong>               </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> explicitly sets <code>role=&quot;region&quot;</code>, <code>aria-label=&quot;Table Output&quot;</code>, and ensures keyboard navigability through <code>tabindex</code>. <br> <strong>TV2.1</strong> retains basic semantics but lacks custom ARIA attributes. Intended for visual use, not keyboard interaction.                                                                                                                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Aspect"> <strong>Security Features</strong>                  </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> expects Flask middleware to inject headers: <code>X-Content-Type-Options: nosniff</code>, <code>Referrer-Policy: strict-origin</code>, <code>Cross-Origin-Resource-Policy: same-origin</code>. Inline scripts use nonce where possible. <br> <strong>TV2.1</strong> static, so no header control; relies on host configuration.                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Diagnostics and Logging</strong>            </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> includes hidden log container (<code>#debug-log</code>) and writes version manifest data. JS console shows version, worker state, and timing. <br> <strong>TV2.1</strong> has no diagnostic logs, only console printouts when exports trigger.                                                                                                                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Aspect"> <strong>Performance Behavior</strong>               </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong>: Uses debounced re-renders, async worker parsing, and incremental DOM updates to handle large tables without blocking. Caches normalized data for undo/redo. <br> <strong>TV2.1</strong>: Zero dynamic computation; static DOM. PDF export triggers short-lived worker computation. Extremely fast load.                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Aspect"> <strong>Memory and Runtime Load</strong>            </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> keeps references to DOM nodes, worker state, and cache objects, consuming more memory but enabling interactivity. <br> <strong>TV2.1</strong> memory footprint minimal; releases worker after export.                                                                                                                                                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Aspect"> <strong>Network Behavior</strong>                   </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> fetches manifest, stylesheet, scripts, and API data. Uses service worker cache. <br> <strong>TV2.1</strong> fetches only local static assets; no network requests post-load.                                                                                                                                                                                                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Aspect"> <strong>Error Handling</strong>                     </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> implements try/catch around worker communication, with UI fallback (<code>showError(message)</code>) and retry button. <br> <strong>TV2.1</strong> no UI error recovery; any failure logs to console only.                                                                                                                                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Aspect"> <strong>Compatibility and Versioning</strong>       </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> includes embedded version strings in JS (<code>PTT_VERSION</code>, <code>PTT_BUILD</code>). <br> <strong>TV2.1</strong> identifies as Tables Viewer v2.1. Serves as benchmark for renderer correctness tests.                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Aspect"> <strong>Caching and Persistence</strong>            </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> persists last pasted text and rendered output in <code>localStorage</code> (key <code>PTT_CACHE_V1</code>). <br> <strong>TV2.1</strong> has no persistence logic.                                                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Aspect"> <strong>UI/UX Characteristics</strong>              </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong>: interactive, scrollable, theme-adaptive, keyboard-navigable, heavy CSS animation. <br> <strong>TV2.1</strong>: static viewer, minimal interactivity beyond copy/export.                                                                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Aspect"> <strong>Rendering Engine Behavior</strong>          </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong>: builds tables via JS using <code>render_table()</code>—creates <code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, manages rowspan/colspan, collapsible groups, and highlight states. <br> <strong>TV2.1</strong>: table already in HTML; scripts only attach event listeners.                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Highlighting and Search</strong>            </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong>: dynamic search across generated tables with highlight spans (<code>&lt;mark&gt;</code>). <br> <strong>TV2.1</strong>: basic search field filters visible rows using string match; highlight optional.                                                                                                                                                                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Aspect"> <strong>Collapse / Expand Logic</strong>            </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong>: advanced—toggles <code>&lt;tbody&gt;</code> groups by <code>data-group</code> attributes, updates aria-expanded. <br> <strong>TV2.1</strong>: simpler—toggles all <code>&lt;tbody&gt;</code> visibility simultaneously.                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Aspect"> <strong>Normalization / Mapping Functions</strong>  </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> executes normalization in worker: trims, aligns headers, merges blank cells, maps field types. <br> <strong>TV2.1</strong> receives pre-normalized HTML. No normalization logic.                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Aspect"> <strong>User Interaction Cycle</strong>             </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong>: input → process → preview → adjust → export. <br> <strong>TV2.1</strong>: view → copy or export.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Aspect"> <strong>Offline Capability</strong>                 </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> partly offline due to service worker but still needs backend for rendering new tables. <br> <strong>TV2.1</strong> fully offline, pure static asset.                                                                                                                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Aspect"> <strong>Security Surface</strong>                   </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> larger surface (paste input, worker messages, API). Input sanitized using <code>escapeHtml()</code>. <br> <strong>TV2.1</strong> minimal, no input parsing, effectively zero attack surface.                                                                                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Aspect"> <strong>Testing / QA Coverage</strong>              </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> verified through integration tests: worker sync, API round-trip, rendering validation, export accuracy. <br> <strong>TV2.1</strong> used for renderer correctness regression tests (benchmark visual diff).                                                                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Aspect"> <strong>Upgrade Path</strong>                       </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> continues evolving with backend (v3.0 planned). <br> <strong>TV2.1</strong> stable benchmark snapshot for rendering parity.                                                                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Aspect"> <strong>Relative Complexity</strong>                </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong>: High (>10 modules, asynchronous control). <br> <strong>TV2.1</strong>: Low (single HTML + 3 scripts).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Summary of Roles</strong>                   </td><td data-label="Expanded Technical Comparison: Output 1 (App Shell) vs Output 2 (Render Artifact)"> <strong>PTT</strong> = <em>Dynamic Generator / Application Shell</em>. <br> <strong>TV2.1</strong> = <em>Static Viewer / Render Benchmark</em>. They share visual identity, alias system, and export API but differ in control logic, dependencies, and runtime architecture.                                                                                                                                                                                                                                                                                                                                                                           </td></tr></tbody></table></div><div class="row-count">Rows: 34</div></div><div class="table-caption" id="Table9" data-table="Book_8041_09" style="margin-top:2mm;margin-left:3mm;"><strong>Table 9</strong></div>
<div class="table-wrapper" data-table-id="table-9"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Subsystem**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Subsystem</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Correct Implementation Plan**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Correct Implementation Plan</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Verification Criteria**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Verification Criteria</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Subsystem"> <strong>1. Input Parsing (<code>main.py</code>)</strong>           </td><td data-label="Correct Implementation Plan"> Keep <code>_safe_read_csv()</code> for baseline load. After loading, apply <code>_coalesce_multiline_rows(df)</code> that scans each row: if exactly one non-empty cell and preceding row exists, append text with newline to that cell. Implement before any type normalization or markup detection. </td><td data-label="Verification Criteria"> Test multiline Markdown lists from CSV, TSV, and clipboard paste. Output should maintain a single cell with internal newlines (<code>1.\n2.\n3.</code>). </td></tr><tr><td data-label="Subsystem"> <strong>2. Escaping Order (<code>html_renderer.py</code>)</strong> </td><td data-label="Correct Implementation Plan"> Reorder logic: ① normalize text, ② detect lists and inline markup, ③ then escape HTML. Escaping before list detection breaks numbering recognition. Maintain whitelist for protected tags (<code>&lt;ol&gt;</code>, <code>&lt;li&gt;</code>, <code>&lt;code&gt;</code>, <code>&lt;pre&gt;</code>).                                                  </td><td data-label="Verification Criteria"> Confirm numbered lists remain semantic <code>&lt;ol&gt;&lt;li&gt;</code> in final HTML and no unescaped <code>&lt;</code> or <code>&gt;</code> leak.                                             </td></tr><tr><td data-label="Subsystem"> <strong>3. Newline Normalization</strong>               </td><td data-label="Correct Implementation Plan"> Centralize newline fix: <code>text = text.replace(&#x27;\r\n&#x27;, &#x27;\n&#x27;).replace(&#x27;\r&#x27;, &#x27;\n&#x27;)</code> at input pipeline start (before pandas). Guarantees consistent downstream regex behavior.                                                                                                       </td><td data-label="Verification Criteria"> Windows-origin CSV reproduces correctly; all environments yield same cell segmentation.                                                       </td></tr><tr><td data-label="Subsystem"> <strong>4. HTML Conversion Path</strong>                </td><td data-label="Correct Implementation Plan"> In <code>render_table()</code>, detect list patterns inside cell content using <code>re.match(r&#x27;^\s*\d+\.\s+&#x27;)</code>. When found, split by newline, wrap with <code>&lt;ol&gt;&lt;li&gt;...&lt;/li&gt;&lt;/ol&gt;</code>. Use internal helper <code>_wrap_ordered_list(cell_text)</code> to avoid duplication.                                     </td><td data-label="Verification Criteria"> Compare with TV2.1 benchmark HTML: indentation and <code>&lt;ol&gt;</code> nesting identical.                                                                  </td></tr><tr><td data-label="Subsystem"> <strong>5. Renderer Safety Layer</strong>               </td><td data-label="Correct Implementation Plan"> Update sanitizer/minifier to skip protected blocks. Mark them with sentinel comments or use regex guards like <code>(?s)(&lt;ol&gt;.*?&lt;/ol&gt;)</code> exclusion. Never collapse whitespace inside those.                                                                                           </td><td data-label="Verification Criteria"> View source: <code>&lt;li&gt;</code> lines remain multi-line, no concatenation. Visual spacing correct.                                                        </td></tr><tr><td data-label="Subsystem"> <strong>6. CSS/JS Alignment</strong>                    </td><td data-label="Correct Implementation Plan"> Leave CSS unchanged; verify <code>&lt;colgroup&gt;</code> and computed widths in browser dev tools. Keep grid rendering identical to TV2.1.                                                                                                                                                      </td><td data-label="Verification Criteria"> Pixel-perfect alignment confirmed between PTT and TV2.1 screenshots.                                                                          </td></tr><tr><td data-label="Subsystem"> <strong>7. Cache Interference</strong>                  </td><td data-label="Correct Implementation Plan"> Clear Jinja2 template cache at each render call: <code>app.jinja_env.cache.clear()</code>. Add version/hash query to render URL, e.g., <code>/render?cb={int(time.time())}</code> to prevent stale reuse.                                                                                             </td><td data-label="Verification Criteria"> Reload produces new table; no residual content from prior session.                                                                            </td></tr><tr><td data-label="Subsystem"> <strong>8. Diagnostics / Regression Test</strong>       </td><td data-label="Correct Implementation Plan"> Create test case with one-cell Markdown list: <code>&quot;1. a\n2. b\n3. c&quot;</code>. Run both systems, compare DOM.                                                                                                                                                                              </td><td data-label="Verification Criteria"> Should yield identical <code>&lt;ol&gt;&lt;li&gt;</code> output.                                                                                                     </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table10" data-table="Book_8041_10" style="margin-top:2mm;margin-left:3mm;"><strong>Table 10</strong></div>
<div class="table-wrapper" data-table-id="table-10"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Primary Role</strong> — PTT is a fully interactive web application that accepts pasted data, parses it via a web worker, and dynamically renders tables in the browser. It is the operational “app shell” integrating user interface, data transformation, and export logic. TV2.1 is a finalized, static render artifact. It represents the output of PTT’s rendering pipeline, distributed for end-users or archival viewing. TV2.1 has no backend interaction and only displays pre-rendered tables safely and consistently. </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>System Integration</strong> — PTT integrates with a Flask backend through API routes (<code>/api/render</code>, <code>/manifest.json</code>, <code>/diagnostics</code>). It registers a Service Worker to enable offline caching, error recovery, and network fallback. It communicates bidirectionally with <code>worker.js</code> for heavy parsing tasks. TV2.1 operates completely client-side, loads local assets only (<code>style.css</code>, <code>script.js</code>, <code>worker.js</code>), and uses the worker only for PDF export.                                                               </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>HTML Hierarchy</strong> — PTT’s structure is multi-section: <code>&lt;header&gt;</code> (branding, control buttons, instructions), <code>&lt;main&gt;</code> (paste panel, preview area), <code>&lt;div id=&quot;table-wrapper&quot;&gt;</code> (dynamic tables), and <code>&lt;footer&gt;</code> (version and debug manifest). Utility containers exist for logs, modals, and drop zones. TV2.1 is simplified: a static <code>&lt;div class=&quot;header&quot;&gt;</code> and <code>&lt;div id=&quot;table-wrapper&quot;&gt;</code> containing a finished <code>&lt;table&gt;</code> and optional static <code>&lt;ul class=&quot;toc&quot;&gt;</code>. No modals or footers.                                  </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Head and Meta Configuration</strong> — PTT includes full progressive web app metadata: <code>&lt;meta name=&quot;viewport&quot;&gt;</code>, <code>&lt;meta name=&quot;theme-color&quot;&gt;</code>, <code>&lt;link rel=&quot;manifest&quot;&gt;</code>, and <code>&lt;meta name=&quot;color-scheme&quot; content=&quot;light dark&quot;&gt;</code>. Inline CSS defines custom properties for theming and dark/light mode support. TV2.1 contains minimal declarations—charset, viewport, and stylesheet link—depending on external CSS only.                                                                                                          </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Styling and Themes</strong> — PTT uses CSS variables (<code>--bg</code>, <code>--fg</code>, <code>--accent</code>, etc.) with a responsive grid system, transitions, and <code>prefers-color-scheme</code> support. It provides accessibility states and smooth layout animations. TV2.1 embeds only a minimal fade-in transition inline and loads <code>style.css</code> for layout. It lacks internal theming or adaptive design.                                                                                                                                                    </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Script Architecture</strong> — PTT loads multiple modular scripts: <code>script.core.js</code> (paste/parse), <code>script.table.js</code> (render/export), <code>script.toc.js</code> (TOC builder), <code>script.tweaks.js</code> (alias buttons and keyboard controls), and <code>worker.js</code>. All modules are orchestrated sequentially. TV2.1 consolidates minimal logic into <code>script.js</code>, combining light versions of these modules for local rendering and export.                                                                                                         </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Application Logic</strong> — PTT’s logic spans three layers: (1) Input normalization, (2) Worker-based transformation, (3) DOM rendering and export. Each stage communicates asynchronously. TV2.1 is single-layer: only display and export operations.                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Initialization Flow</strong> — PTT performs multi-phase initialization: registers service worker, restores cache, initializes aliases, and runs diagnostics. It also handles worker timeouts gracefully. TV2.1 simply fades in the table on <code>window.onload</code>, attaches basic event listeners, and initializes export handling.                                                                                                                                                                                                   </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Table of Contents (TOC)</strong> — PTT builds its TOC dynamically using <code>script.toc.js</code> by parsing <code>&lt;h1&gt;</code>–<code>&lt;h3&gt;</code> elements and generating nested <code>&lt;ul&gt;</code> structures with smooth scrolling. TV2.1 uses a pre-rendered static TOC, matching the existing HTML structure without dynamic updates.                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Worker Communication</strong> — PTT communicates with its worker bidirectionally using <code>postMessage</code> to send raw data and receive parsed JSON table structures. It manages a heartbeat system for timeouts. TV2.1 only sends export tasks to the worker and receives the resulting file blob (unidirectional).                                                                                                                                                                                                                  </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Data Flow</strong> — PTT: User input → Parse → Worker normalization → DOM render → TOC → Export. TV2.1: Pre-rendered HTML → Export → Done.                                                                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Export System</strong> — PTT exports Markdown, CSV, TSV, Excel, JSON, and PDF, leveraging both frontend and backend APIs. It uses a unified dispatcher (<code>PTTExport.dispatch()</code>). TV2.1 restricts exports to Markdown, CSV, and PDF for offline simplicity.                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Alias Delegation</strong> — Both share a <code>data-alias</code> system that maps logical actions to UI controls. PTT includes aliases for live operations like “convert” or “theme toggle.” TV2.1 supports a smaller set like “copy,” “collapse,” and “export.”                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Accessibility</strong> — PTT enforces keyboard navigation, ARIA roles, and focus management for screen readers. TV2.1 preserves semantic HTML but omits custom ARIA attributes, optimized for visual use.                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Security Architecture</strong> — PTT expects backend HTTP headers like <code>X-Content-Type-Options</code> and uses nonced inline scripts. TV2.1 has no runtime backend, so it relies entirely on host-level CSP and same-origin isolation.                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Diagnostics and Logging</strong> — PTT provides a hidden log panel and detailed console traces (worker status, version, latency). TV2.1 outputs minimal console messages only during export actions.                                                                                                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Performance Profile</strong> — PTT uses asynchronous rendering, throttled updates, and caching to handle large datasets. TV2.1 is purely static, loading almost instantly with zero computation overhead.                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Memory and Runtime</strong> — PTT holds state in memory (parsed JSON, DOM refs, undo cache), increasing memory use but supporting interactivity. TV2.1 releases all memory after load except for the export worker.                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Network Profile</strong> — PTT fetches remote assets and APIs, using service worker caching for resilience. TV2.1 fetches only local resources; no network calls occur after load.                                                                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Error Handling</strong> — PTT has structured error recovery, in-app dialogs, and retry buttons for worker failures. TV2.1 simply logs errors to the console.                                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Versioning</strong> — PTT embeds constants like <code>PTT_VERSION</code> and <code>PTT_BUILD</code> for release tracking. TV2.1 labels itself as “Tables Viewer v2.1” and serves as a render baseline.                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Persistence</strong> — PTT stores recent paste and output data in <code>localStorage</code> under a versioned key. TV2.1 has no persistence or state storage.                                                                                                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>UI/UX</strong> — PTT provides full interactive editing, scrolling, and keyboard control with adaptive themes and transition animations. TV2.1 is minimalistic and static, prioritizing readability and consistency.                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Rendering Engine</strong> — PTT constructs tables dynamically via <code>render_table()</code> with logic for header detection, colspan handling, and collapsible groups. TV2.1 renders prebuilt HTML tables and attaches lightweight listeners.                                                                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Search and Highlight</strong> — PTT features live search with text highlighting using <code>&lt;mark&gt;</code>. TV2.1’s optional filter simply hides non-matching rows.                                                                                                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Collapse Behavior</strong> — PTT’s group-based collapse toggles sections individually using <code>data-group</code> markers. TV2.1 collapses all body sections together with a simpler toggle.                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Normalization Logic</strong> — PTT performs full data normalization in the worker (trimming, merging, type mapping). TV2.1 skips normalization since its data is already preprocessed.                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>User Flow</strong> — PTT enables iterative interaction: paste → process → preview → refine → export. TV2.1 offers passive viewing: open → read → copy or export.                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Offline Capability</strong> — PTT partially offline due to service worker caching but needs backend for fresh renders. TV2.1 fully offline and self-contained.                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Security Surface</strong> — PTT handles raw input and API data, so it sanitizes HTML carefully. TV2.1 accepts no input, nearly eliminating attack vectors.                                                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Testing and QA</strong> — PTT is covered by automated integration tests validating worker sync, export, and rendering accuracy. TV2.1 is used in regression visual comparisons to verify renderer fidelity.                                                                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Upgrade Path</strong> — PTT is under active development (v3.0 planned with new parser). TV2.1 remains a stable benchmark snapshot.                                                                                                                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Complexity</strong> — PTT: High (many modules, async tasks). TV2.1: Low (static HTML + lightweight script).                                                                                                                                                                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Analysis: PTT (PasteToTable App Shell) vs TV2.1 (Tables Viewer 2.1 Render Artifact)"> <strong>Summary</strong> — PTT serves as a full-featured application shell bridging UI, logic, and backend. TV2.1 is a static, read-only derivative focused on perfect fidelity and offline distribution. Both share the same visual identity and alias/export systems, but differ sharply in architecture, complexity, and runtime purpose.                                                                                                                                                                                            </td></tr></tbody></table></div><div class="row-count">Rows: 34</div></div><div class="table-caption" id="Table11" data-table="Book_8041_11" style="margin-top:2mm;margin-left:3mm;"><strong>Table 11</strong></div>
<div class="table-wrapper" data-table-id="table-11"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Focus Area**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Focus Area</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Expert Revision Plan for html_renderer.py**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Expert Revision Plan for html_renderer.py</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Focus Area"> <strong>1. Architectural Role Review</strong>                              </td><td data-label="Expert Revision Plan for html_renderer.py"> The file serves both as renderer core (HTML conversion, table rendering, escaping, list normalization) <strong>and</strong> minimal Flask fallback (when no external server module exists). The plan is to harden both halves: ensure safe, idempotent rendering, correct escaping order, and stable server behavior under all inputs.                                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Focus Area"> <strong>2. Highest-Priority Code Sections to Inspect and Refactor</strong> </td><td data-label="Expert Revision Plan for html_renderer.py"> - <code>render_html</code>, <code>render_table</code>, <code>render_cell</code>: confirm per-cell processing pipeline.  <br>- Markdown-to-HTML helpers: check regex and escaping order.  <br>- Newline normalization and list conversion functions.  <br>- Protected tag shielding (pre, code, script, textarea).  <br>- <code>&lt;colgroup&gt;</code> injection logic and CSS style enforcement.  <br>- Full-table regex use (to be replaced by cell-wise iteration).                                                                                                                                                                                                                    </td></tr><tr><td data-label="Focus Area"> <strong>3. Core Algorithmic Upgrades</strong>                              </td><td data-label="Expert Revision Plan for html_renderer.py"> <strong>(A)</strong> Implement <code>_shield_protected_blocks</code> and <code>_restore_protected_blocks</code> as first/last steps.  <br><strong>(B)</strong> Introduce <code>normalize_newlines()</code> early in pipeline.  <br><strong>(C)</strong> Add <code>convert_numbered_lists_in_cell()</code> to convert numeric lists to <code>&lt;ol&gt;&lt;li&gt;</code>.  <br><strong>(D)</strong> Apply escaping <em>after</em> list conversion (prevent <code>&lt;ol&gt;</code> double-escape).  <br><strong>(E)</strong> Migrate from full-HTML regex to structured per-cell processing loop.  <br><strong>(F)</strong> Add reliable <code>&lt;colgroup&gt;</code> injection with last column <code>tv-col-right</code>.  <br><strong>(G)</strong> Ensure table CSS (<code>table-layout: fixed; text-align:right</code> for last col) injected once per document. </td></tr><tr><td data-label="Focus Area"> <strong>4. Escaping Order Validation</strong>                              </td><td data-label="Expert Revision Plan for html_renderer.py"> The processing chain will be:  <br>1. Shield protected blocks  <br>2. Normalize newlines  <br>3. Convert numbered lists  <br>4. Escape leftover text  <br>5. Restore protected blocks  <br>6. Replace newlines with <code>&lt;br&gt;</code> or keep <code>&lt;ol&gt;</code> tags intact.                                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Focus Area"> <strong>5. Structural and Logging Fixes</strong>                           </td><td data-label="Expert Revision Plan for html_renderer.py"> - Replace all bare <code>print()</code> with <code>logger</code> calls.  <br>- Wrap main conversions in try/except + <code>logger.exception</code>.  <br>- Keep <code>_logger</code> globally configured with module name.  <br>- Remove any debug prints leaking to stdout.                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Focus Area"> <strong>6. Flask App Hardening (Fallback Mode)</strong>                    </td><td data-label="Expert Revision Plan for html_renderer.py"> - Validate content length pre-read (<code>before_request</code>).  <br>- Extend <code>_api_convert</code> to explicitly call <code>render_html(text)</code> inside try/except with logging.  <br>- Return precise JSON structure: <code>{ok, status, html, meta}</code>.  <br>- Maintain security headers (nosniff, frame-deny, referrer policy).  <br>- Integrate test hooks for <code>render_html</code> absence.                                                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Focus Area"> <strong>7. Error-Tolerance and Type Safety</strong>                        </td><td data-label="Expert Revision Plan for html_renderer.py"> - Ensure all helper functions accept only <code>str</code> and return <code>str</code>.  <br>- Add fallback <code>str()</code> casting for any unexpected type.  <br>- All regex compiled once at module import for performance.                                                                                                                                                                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Focus Area"> <strong>8. Unit Test Coverage Additions</strong>                           </td><td data-label="Expert Revision Plan for html_renderer.py"> Add pytest cases:  <br>- <code>test_preserve_pre_code_script_text</code>  <br>- <code>test_numbered_list_conversion_single_cell</code>  <br>- <code>test_newline_normalization_win_mac_unix</code>  <br>- <code>test_colgroup_injected_and_last_col_class</code>  <br>- <code>test_escaping_order</code>  <br>- <code>test_logging_on_error</code>  <br>- <code>test_full_table_cell_safe_rebuild</code>                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Focus Area"> <strong>9. Static and Runtime Verification Steps</strong>                  </td><td data-label="Expert Revision Plan for html_renderer.py"> - Run <code>flake8</code> / <code>mypy</code> for static safety.  <br>- Fuzz random text inputs (digits, markup, mixed newlines).  <br>- Confirm <code>&lt;pre&gt;</code> and <code>&lt;code&gt;</code> sections preserved byte-identically.  <br>- Regression check with Table4 failing sample (ensure identical HTML).                                                                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Focus Area"> <strong>10. Risk and Compatibility Handling</strong>                       </td><td data-label="Expert Revision Plan for html_renderer.py"> - Maintain backward compatibility with older renderers expecting escaped <code>&lt;ol&gt;</code> markup.  <br>- Avoid breaking downstream consumers using previous buggy output.  <br>- Add <code>RENDERER_VERSION = &quot;2.2&quot;</code> tag for traceability.                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Focus Area"> <strong>11. Planned Deliverables</strong>                                  </td><td data-label="Expert Revision Plan for html_renderer.py"> - <code>html_renderer.py</code> fully revised and verified 25×.  <br>- <code>tests/test_renderer_numbered_lists.py</code> with fixtures.  <br>- Sample regression HTML files.  <br>- Updated README notes: escaping order, protected tags, test coverage.  <br>- PR message: <em>“fix(renderer): reliable numbered-list conversion, protected-block shielding, colgroup injection, robust escaping order; add tests.”</em>                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Focus Area"> <strong>12. Deployment and Validation Workflow</strong>                    </td><td data-label="Expert Revision Plan for html_renderer.py"> 1. Run all pytest suites → pass.  <br>2. Visual diff against TV2.1 outputs.  <br>3. Deploy to staging Flask instance.  <br>4. Manual verify across multiple browsers.  <br>5. Lock revision after 24h regression-free test.                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr></tbody></table></div><div class="row-count">Rows: 12</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>