<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1761537670">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      // Delegate addEventListener/removeEventListener to visible button
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      // Delegate onclick assignments
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      // Delegate focus/blur
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
      // If legacy code used direct addEventListener earlier than this script, listeners would already exist
      // on alias element; attempt to re-dispatch those by cloning them to visible button is non-trivial.
      // This approach covers the common case where legacy scripts query the alias and bind after DOM ready.
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li>
<li class="toc-item"><a class="toc-link" href="#Table7">Table 7</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Book_8029_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Table"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Table</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Focus"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Focus</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Issues described"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Issues described</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Expected fixes in this file"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Expected fixes in this file</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Table"> <strong>Table 1 — Loader Errors and Index Attributes</strong> </td><td data-label="Focus"> Base path, asset resolution, loader fallback                          </td><td data-label="Issues described"> <em>Extra.js</em> fails if body not ready, <code>data-index-url</code> or <code>data-worker-url</code> missing or invalid, multiple base path confusion. </td><td data-label="Expected fixes in this file"> Strengthen <code>ensureIndexAndWorkerAttrs()</code> and <code>startExtraLoader()</code> so repeated load attempts and empty attributes never persist. Add explicit validation and single info log. </td></tr><tr><td data-label="Table"> <strong>Table 2 — Export and Clipboard Errors</strong>        </td><td data-label="Focus"> Copy modal, Markdown export                                           </td><td data-label="Issues described"> Silent export errors, clipboard failure on secure contexts, broken filename sanitizer on unicode, empty blob download.      </td><td data-label="Expected fixes in this file"> Harden <code>copyToClipboard</code>, <code>sanitizeFileName</code>, and <code>downloadBlob</code>; ensure async clipboard fallback messages consistent; guarantee non-empty download.                         </td></tr><tr><td data-label="Table"> <strong>Table 3 — Toast System Repeats</strong>               </td><td data-label="Focus"> Duplicate or hanging toasts at bottom of screen                       </td><td data-label="Issues described"> <code>_processToastQueue</code> sometimes stalls if <code>_activeToast</code> lost reference, leading to repeated identical messages.             </td><td data-label="Expected fixes in this file"> Introduce state cleanup guard and timeout watchdog to reset <code>_activeToast</code> if detached.                                                                                      </td></tr><tr><td data-label="Table"> <strong>Table 4 — Convert Delegation and Export Race</strong> </td><td data-label="Focus"> Multiple convert events firing, export buttons disabled after failure </td><td data-label="Issues described"> Double event registration, unhandled fetch rejection, inconsistent button re-enable.                                        </td><td data-label="Expected fixes in this file"> Wrap convert logic with mutex flag, guarantee <code>finally</code> restores button state, and de-duplicate event listener setup.                                                        </td></tr></tbody></table></div><div class="row-count">Rows: 4</div></div><div class="table-caption" id="Table2" data-table="Book_8029_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Category**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Category</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Loader, Base-Path, Index &amp; Worker — Expanded Diagnostic Summary"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Loader, Base-Path, Index & Worker — Expanded Diagnostic Summary</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Category"> <strong>Issue</strong>            </td><td data-label="Loader, Base-Path, Index &amp; Worker — Expanded Diagnostic Summary"> extra.js never loads or loads repeatedly                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Category"> <strong>Symptom</strong>          </td><td data-label="Loader, Base-Path, Index &amp; Worker — Expanded Diagnostic Summary"> no tvExtra features; console shows repeated attempts or silent fail                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Category"> <strong>Likely causes</strong>    </td><td data-label="Loader, Base-Path, Index &amp; Worker — Expanded Diagnostic Summary"> document.body missing at init; <code>_tv_extra_loader_attached</code> set even after error; bad candidate order; CORS or 404                                                                                                                                                                                                                  </td></tr><tr><td data-label="Category"> <strong>Code locations</strong>   </td><td data-label="Loader, Base-Path, Index &amp; Worker — Expanded Diagnostic Summary"> <code>startExtraLoader()</code>, <code>loadExtraSequentially()</code>, <code>ensureIndexAndWorkerAttrs()</code>                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Category"> <strong>Checks (console)</strong> </td><td data-label="Loader, Base-Path, Index &amp; Worker — Expanded Diagnostic Summary"> 1. <code>console.log(window._tv_extra_loader_attached, !!document.querySelector(&#x27;script[src*=&quot;extra.js&quot;]&#x27;))</code><br>2. <code>fetch(window.tvIndexUrl).then(r=&gt;console.log(r.status)).catch(e=&gt;console.error(e))</code>                                                                                                                                 </td></tr><tr><td data-label="Category"> <strong>Fix</strong>              </td><td data-label="Loader, Base-Path, Index &amp; Worker — Expanded Diagnostic Summary"> 1. Only set <code>_tv_extra_loader_attached = true</code> after first successful append attempt.<br>2. Record attempts counter and abort after >3.<br>3. Use retry backoff instead of tight loop.<br>4. Validate candidate path with <code>tryFetchCandidate(path)</code> (HEAD) before append when CORS allows.<br>5. Always log candidate paths tried. </td></tr><tr><td data-label="Category"> <strong>Tests</strong>            </td><td data-label="Loader, Base-Path, Index &amp; Worker — Expanded Diagnostic Summary"> Simulate missing <code>extra.js</code> (rename). Confirm loader stops after 3 attempts and shows a single warning toast.                                                                                                                                                                                                                      </td></tr><tr><td data-label="Category"> <strong>Issue</strong>            </td><td data-label="Loader, Base-Path, Index &amp; Worker — Expanded Diagnostic Summary"> data-index-url / data-worker-url wrong or empty                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Category"> <strong>Symptom</strong>          </td><td data-label="Loader, Base-Path, Index &amp; Worker — Expanded Diagnostic Summary"> <code>tables_index.json</code> or <code>worker.js</code> 404                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Category"> <strong>Likely causes</strong>    </td><td data-label="Loader, Base-Path, Index &amp; Worker — Expanded Diagnostic Summary"> Base detection wrong when script bundled or <code>currentScript</code> absent                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Category"> <strong>Code locations</strong>   </td><td data-label="Loader, Base-Path, Index &amp; Worker — Expanded Diagnostic Summary"> <code>detectScriptBase()</code>, <code>ensureIndexAndWorkerAttrs()</code>                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Category"> <strong>Checks</strong>           </td><td data-label="Loader, Base-Path, Index &amp; Worker — Expanded Diagnostic Summary"> <code>window.__tv_base</code>, <code>document.body.dataset.indexUrl</code>                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Category"> <strong>Fix</strong>              </td><td data-label="Loader, Base-Path, Index &amp; Worker — Expanded Diagnostic Summary"> 1. If <code>document.currentScript</code> absent, use last <code>&lt;script&gt;</code> heuristic, then fallback to <code>location.origin + &#x27;/&#x27;</code>.<br>2. Normalize and write final URLs to <code>window.tvIndexUrl</code> and <code>window.tvWorkerUrl</code>.<br>3. Expose <code>window.__tv_base</code> override and document via <code>console.info</code>.                                                    </td></tr><tr><td data-label="Category"> <strong>Tests</strong>            </td><td data-label="Loader, Base-Path, Index &amp; Worker — Expanded Diagnostic Summary"> Load from root, subpath, and bundler (inline script). Confirm <code>tvIndexUrl</code> is valid.                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Category"> <strong>Issue</strong>            </td><td data-label="Loader, Base-Path, Index &amp; Worker — Expanded Diagnostic Summary"> Loader flags block retry after transient failure                                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Category"> <strong>Symptom</strong>          </td><td data-label="Loader, Base-Path, Index &amp; Worker — Expanded Diagnostic Summary"> <code>_tv_extra_loader_attached</code> prevents retry even after network recovers                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Category"> <strong>Fix</strong>              </td><td data-label="Loader, Base-Path, Index &amp; Worker — Expanded Diagnostic Summary"> Store <code>window._tv_extra_loader_state = { attached: bool, attempts: n, lastError: msg }</code>. Prevent reattach only while <code>attempts &lt; max</code> or when <code>attached === true</code>.                                                                                                                                                                 </td></tr></tbody></table></div><div class="row-count">Rows: 17</div></div><div class="table-caption" id="Table3" data-table="Book_8029_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Category**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Category</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Category"> <strong>Issue</strong>            </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> Clipboard fails silently on insecure origin                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Category"> <strong>Symptom</strong>          </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> "Copy" button does nothing or legacy fallback fails                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Category"> <strong>Likely causes</strong>    </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> <code>navigator.clipboard</code> restricted; <code>execCommand</code> blocked                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Category"> <strong>Code</strong>             </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> <code>copyToClipboard()</code>, <code>tryLegacyCopy()</code>                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Category"> <strong>Checks (console)</strong> </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> <code>console.log(navigator.clipboard, location.protocol)</code>                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Category"> <strong>Fix</strong>              </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> 1. Detect secure context: if not <code>location.protocol === &#x27;https:&#x27;</code> and <code>navigator.clipboard</code> exists, use <code>showCopyModal()</code> with prefilled text and focus.<br>2. In legacy path, ensure textarea selection uses <code>ta.setSelectionRange(0, ta.value.length)</code> for some browsers.<br>3. Add clear user-facing toasts on fallback. </td></tr><tr><td data-label="Category"> <strong>Tests</strong>            </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> Run on <code>http:</code> and <code>https:</code>. Confirm modal appears on insecure origin.                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Category"> <strong>Issue</strong>            </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> Downloads arrive empty or blocked by popup blocker                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Category"> <strong>Symptom</strong>          </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> 0-byte file or no download triggered                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Category"> <strong>Likely causes</strong>    </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> <code>URL.revokeObjectURL</code> called too early; download invoked outside user gesture; anchor removed before click                                                                                                                                                                                                                  </td></tr><tr><td data-label="Category"> <strong>Code</strong>             </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> <code>downloadBlob()</code> and related calls (e.g. <code>downloadBtn</code>)                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Category"> <strong>Fix</strong>              </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> 1. Create link, append, call <code>a.click()</code> synchronously within click handler.<br>2. Schedule <code>URL.revokeObjectURL(url)</code> with <code>setTimeout(..., 4000)</code>.<br>3. Return boolean success; on failure, fall back to <code>showCopyModal()</code> with content.                                                                                 </td></tr><tr><td data-label="Category"> <strong>Tests</strong>            </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> Export via button click and programmatic call. Verify saved file size and content.                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Category"> <strong>Issue</strong>            </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> <code>sanitizeFileName</code> mangles Unicode or produces blank                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Category"> <strong>Symptom</strong>          </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> Download fallback name <code>&#x27;download&#x27;</code> or empty after sanitization                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Category"> <strong>Fix</strong>              </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> Normalize Unicode to NFC. If blank after filtering, fallback to timestamp slug.                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Category"> <strong>Issue</strong>            </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> CSV/XLSX exports garbled (HTML in cells, quote errors)                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Category"> <strong>Symptom</strong>          </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> Cells contain <code>&lt;br&gt;</code>, <code>&amp;nbsp;</code>, or inconsistent quoting                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Category"> <strong>Fix</strong>              </td><td data-label="Clipboard, Download, Filename, Export Sanitization — Expanded Diagnostic Summary"> 1. In export helpers, trim and replace <code>\u00A0</code> with space.<br>2. Convert <code>&lt;br&gt;</code> to <code>\n</code> when reading <code>innerHTML</code> fallback.<br>3. Escape CSV by doubling quotes.<br>4. Strip HTML tags when exporting CSV unless user selects markdown or HTML mode.                                                                        </td></tr></tbody></table></div><div class="row-count">Rows: 19</div></div><div class="table-caption" id="Table4" data-table="Book_8029_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Category**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Category</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Toast System Repetition and Watchdog — Expanded Diagnostic Summary"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Toast System Repetition and Watchdog — Expanded Diagnostic Summary</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Category"> <strong>Issue</strong>             </td><td data-label="Toast System Repetition and Watchdog — Expanded Diagnostic Summary"> Repeated identical toasts accumulate and persist at bottom                                                                                                                                                                                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Category"> <strong>Symptom</strong>           </td><td data-label="Toast System Repetition and Watchdog — Expanded Diagnostic Summary"> Identical messages appear multiple times; <code>_processToastQueue</code> stalls or <code>_activeToast</code> lost                                                                                                                                                                                                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Category"> <strong>Likely causes</strong>     </td><td data-label="Toast System Repetition and Watchdog — Expanded Diagnostic Summary"> <code>_activeToast</code> mutated or removed externally; container element removed by page code; <code>_toastQueue</code> re-populated by retry loops                                                                                                                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Category"> <strong>Code</strong>              </td><td data-label="Toast System Repetition and Watchdog — Expanded Diagnostic Summary"> <code>_processToastQueue()</code>, <code>showToast()</code>, <code>_hideActiveToast()</code>                                                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Category"> <strong>Fixes implemented</strong> </td><td data-label="Toast System Repetition and Watchdog — Expanded Diagnostic Summary"> 1. Add toast dedupe cache <code>__tv_toast_history</code> keyed by <code>message+type</code> with TTL 60 s.<br>2. Default <code>showToast</code> uses <code>showToastOnce</code> logic for network and error messages.<br>3. Add <code>_toastWatchdog</code> that runs every 3 s when queue non-empty and verifies <code>_activeToast.el</code> still in DOM; if missing, reset <code>_activeToast = null</code> and call <code>_processToastQueue()</code>.<br>4. Recreate container if missing.<br>5. Ensure <code>_processToastQueue</code> always schedules a safety <code>setTimeout</code> re-check to prevent permanent stall. </td></tr><tr><td data-label="Category"> <strong>Tests</strong>             </td><td data-label="Toast System Repetition and Watchdog — Expanded Diagnostic Summary"> Run <code>for(let i=0;i&lt;100;i++)showToast(&#x27;x&#x27;)</code> in console. Confirm deduplication and no DOM bloat.                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Category"> <strong>Issue</strong>             </td><td data-label="Toast System Repetition and Watchdog — Expanded Diagnostic Summary"> Toast styles unreadable due to missing CSS variables                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Category"> <strong>Fix</strong>               </td><td data-label="Toast System Repetition and Watchdog — Expanded Diagnostic Summary"> Provide hard-coded fallback colors when computed styles empty. Use <code>getComputedStyle(document.documentElement).getPropertyValue(...)                                                                                                                                                                                                                                                                                                                                                                                    |   | &#x27;#fff&#x27;</code>, ensure trimming and fallback for both background and text colors. </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table5" data-table="Book_8029_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Category**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Category</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Convert Delegation, Double Registration, Fetch Robustness — Expanded Diagnostic Summary"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Convert Delegation, Double Registration, Fetch Robustness — Expanded Diagnostic Summary</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Category"> <strong>Issue</strong>         </td><td data-label="Convert Delegation, Double Registration, Fetch Robustness — Expanded Diagnostic Summary"> Double convert runs or UI stays disabled after error                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Category"> <strong>Symptom</strong>       </td><td data-label="Convert Delegation, Double Registration, Fetch Robustness — Expanded Diagnostic Summary"> Multiple fetch calls or <code>convertBtn</code> remains disabled                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Category"> <strong>Likely causes</strong> </td><td data-label="Convert Delegation, Double Registration, Fetch Robustness — Expanded Diagnostic Summary"> Both delegated document click and direct handler attached; convert logic not idempotent; <code>finally</code> re-enables but skipped on alternate code paths                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Category"> <strong>Code</strong>          </td><td data-label="Convert Delegation, Double Registration, Fetch Robustness — Expanded Diagnostic Summary"> <code>convertButtonHandler()</code>, <code>__tv_convert_click_ev()</code>, attach logic block                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Category"> <strong>Fix</strong>           </td><td data-label="Convert Delegation, Double Registration, Fetch Robustness — Expanded Diagnostic Summary"> 1. Add global mutex <code>window.__tv_convert_lock = false</code>. Wrap entry:<br><code>if (window.__tv_convert_lock) { showToast(&#x27;Convert already in progress&#x27;, { type:&#x27;warn&#x27; }); return; }</code><br><code>window.__tv_convert_lock = true;</code> and finally set <code>false</code>.<br>2. Both delegated and direct attach paths must check <code>dataset.__tv_convert_attached</code> before attach.<br>3. Consolidate convert logic: <code>__tv_convert_click_ev</code> calls <code>await window.convertButtonHandler(ev)</code> only if handler exists and is distinct; else run fallback using same mutex.<br>4. Ensure <code>btn.disabled = false</code> in all error paths via <code>unlockConvert(btn)</code> utility called in all <code>catch</code> and <code>finally</code> blocks. </td></tr><tr><td data-label="Category"> <strong>Tests</strong>         </td><td data-label="Convert Delegation, Double Registration, Fetch Robustness — Expanded Diagnostic Summary"> Click convert rapidly; simulate server error; confirm single toast and button re-enables.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Category"> <strong>Issue</strong>         </td><td data-label="Convert Delegation, Double Registration, Fetch Robustness — Expanded Diagnostic Summary"> Fetch parsing fails for non-JSON and causes injection error                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Category"> <strong>Fix</strong>           </td><td data-label="Convert Delegation, Double Registration, Fetch Robustness — Expanded Diagnostic Summary"> Implement robust parse: try <code>resp.clone().json()</code>; if fails, fallback to <code>resp.text()</code>. If text appears JSON, attempt <code>JSON.parse</code>; if HTML, wrap as <code>{ html: text }</code>. Use timeout wrapper <code>fetchWithTimeout(url, opts, 15000)</code>.                                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Category"> <strong>Issue</strong>         </td><td data-label="Convert Delegation, Double Registration, Fetch Robustness — Expanded Diagnostic Summary"> Injection to <code>routeHtmlToAreas</code> fails when <code>PasteToTable</code> not ready or overridden                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Category"> <strong>Fix</strong>           </td><td data-label="Convert Delegation, Double Registration, Fetch Robustness — Expanded Diagnostic Summary"> Check <code>typeof window.PasteToTable === &#x27;object&#x27; &amp;&amp; typeof window.PasteToTable.routeHtmlToAreas === &#x27;function&#x27;</code>. If false, fallback insert into <code>#tables-viewer</code>. After insertion, call <code>PasteToTable.initRenderedContent()</code> if present. Always log informative <code>console.info</code> on fallback.                                                                                                                                                                                                                                                                                                                                                                                  </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table6" data-table="Book_8029_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Category**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Category</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Cross-Cutting Hardening and Diagnostics — Expanded Summary"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Cross-Cutting Hardening and Diagnostics — Expanded Summary</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Category"> <strong>Diagnostics</strong>                   </td><td data-label="Cross-Cutting Hardening and Diagnostics — Expanded Summary"> Extend <code>window.__tv_diag()</code> to include <code>extraLoaderState</code>, <code>toastQueueLen</code>, and <code>__tv_convert_lock</code> for unified runtime inspection.                                                                                                                                                                                          </td></tr><tr><td data-label="Category"> <strong>Logging</strong>                       </td><td data-label="Cross-Cutting Hardening and Diagnostics — Expanded Summary"> Use <code>console.info(&#x27;tv:core loaded&#x27;, {...})</code> for key load events. Reserve <code>console.debug</code> only for handler or attachment events. Avoid repetitive or verbose logging.                                                                                                                                                         </td></tr><tr><td data-label="Category"> <strong>Graceful degradation</strong>          </td><td data-label="Cross-Cutting Hardening and Diagnostics — Expanded Summary"> When critical features missing, display one user-visible toast per session only. Prevent duplicate alerts.                                                                                                                                                                                                                   </td></tr><tr><td data-label="Category"> <strong>Idempotent handler attachment</strong> </td><td data-label="Cross-Cutting Hardening and Diagnostics — Expanded Summary"> Before attaching any event handler, check <code>dataset.__tv_*_attached</code>. Clear stale flags if an element was replaced. Ensures no double-binding or memory leaks.                                                                                                                                                                </td></tr><tr><td data-label="Category"> <strong>Safe DOM removal</strong>              </td><td data-label="Cross-Cutting Hardening and Diagnostics — Expanded Summary"> When removing core-generated elements (toasts, modals), guard with:<br><code>if (el &amp;&amp; el.parentNode) el.parentNode.removeChild(el)</code>.<br>Prevents DOM exceptions when elements already detached.                                                                                                                                  </td></tr><tr><td data-label="Category"> <strong>Timeouts</strong>                      </td><td data-label="Cross-Cutting Hardening and Diagnostics — Expanded Summary"> Standardize network operation timeouts to 12–18 seconds for consistent behavior and retry logic.                                                                                                                                                                                                                             </td></tr><tr><td data-label="Category"> <strong>Security</strong>                      </td><td data-label="Cross-Cutting Hardening and Diagnostics — Expanded Summary"> Avoid logging large raw payloads in <code>console.warn</code>. Instead, log payload size and type for diagnostic context.                                                                                                                                                                                                               </td></tr><tr><td data-label="Category"> <strong>Tests</strong>                         </td><td data-label="Cross-Cutting Hardening and Diagnostics — Expanded Summary"> 1. Rapid convert click ×10.<br>2. Export XLSX, CSV, and MD on table with HTML and long cell content.<br>3. Test copy on <code>http:</code> and <code>https:</code>.<br>4. Simulate <code>extra.js</code> failure and restoration to confirm safe retry behavior.<br>5. Remove <code>tv-toast-container</code>, then trigger <code>showToast</code> to confirm container recreation. </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table7" data-table="Book_8029_07" style="margin-top:2mm;margin-left:3mm;"><strong>Table 7</strong></div>
<div class="table-wrapper" data-table-id="table-7"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Category**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Category</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Precise Code Edits —  CODE0  (approx. line references)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Precise Code Edits —  CODE0  (approx. line references)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Category"> <strong><code>startExtraLoader()</code></strong>                                   </td><td data-label="Precise Code Edits —  CODE0  (approx. line references)"> Convert single flag to state object: <code>window._tv_extra_loader_state = { attached: false, attempts: 0, maxAttempts: 3 }</code>. Set <code>attached = true</code> only when attempt starts. Increment <code>attempts</code> on each try. Log all candidate paths in <code>onAllFailed</code>.                     </td></tr><tr><td data-label="Category"> <strong><code>loadExtraSequentially()</code></strong>                              </td><td data-label="Precise Code Edits —  CODE0  (approx. line references)"> Add progressive backoff before each retry: <code>setTimeout(tryNext, 150 + idx * 100)</code> to prevent tight looping.                                                                                                                                                              </td></tr><tr><td data-label="Category"> <strong><code>copyToClipboard()</code></strong>                                    </td><td data-label="Precise Code Edits —  CODE0  (approx. line references)"> Update legacy fallback: use <code>ta.setSelectionRange(0, ta.value.length)</code>. If <code>document.execCommand(&#x27;copy&#x27;)</code> returns <code>false</code>, trigger <code>showCopyModal()</code> with prefilled text and focus.                                                                                      </td></tr><tr><td data-label="Category"> <strong><code>downloadBlob()</code></strong>                                       </td><td data-label="Precise Code Edits —  CODE0  (approx. line references)"> Delay <code>URL.revokeObjectURL(url)</code> by 4000 ms. Wrap body in <code>try/catch</code>; return <code>true</code> on success, <code>false</code> on failure. On failure, invoke <code>showCopyModal()</code> with content fallback.                                                                                         </td></tr><tr><td data-label="Category"> <strong><code>showToast()</code></strong>                                          </td><td data-label="Precise Code Edits —  CODE0  (approx. line references)"> Add <code>window.__tv_toast_history = new Set()</code>. Before showing toast of type <em>error/warn/info</em>, skip if identical message seen in last 60 s. Start <code>_toastWatchdog</code> interval while queue or active toast exists to restore stalled toasts.                                  </td></tr><tr><td data-label="Category"> <strong><code>convertButtonHandler()</code> and <code>__tv_convert_click_ev()</code></strong> </td><td data-label="Precise Code Edits —  CODE0  (approx. line references)"> Introduce <code>window.__tv_convert_lock</code> guard. On entry: <code>if (window.__tv_convert_lock) { showToast(&#x27;Convert already in progress&#x27;, {type:&#x27;warn&#x27;}); return; }</code>. Set lock true during process. Add shared <code>unlockConvert(btn)</code> utility called in every <code>catch</code> and <code>finally</code>. </td></tr><tr><td data-label="Category"> <strong><code>tryParseResponse(resp)</code> helper</strong>                        </td><td data-label="Precise Code Edits —  CODE0  (approx. line references)"> Replace <code>resp.json().catch(()=&gt;null)</code> logic. Implementation:<br>1. Attempt <code>resp.clone().json()</code>.<br>2. If fails, read <code>resp.text()</code>.<br>3. If text resembles JSON, <code>JSON.parse</code>; else return <code>{ html: text }</code>. Used across all fetch paths.                             </td></tr><tr><td data-label="Category"> <strong><code>window.__tv_diag</code></strong>                                     </td><td data-label="Precise Code Edits —  CODE0  (approx. line references)"> Extend diagnostics to expose <code>extraLoaderState</code>, <code>toastLength</code>, and <code>convertLock</code> values for live debugging via console.                                                                                                                                                 </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>