/* style.css — Tables Viewer (complete) */
/* Corrected for accessibility, sticky TOC consolidation, zebra rows, and floating controls. */

/* -------------------------
   Theme variables
   ------------------------- */
:root{
  --bg: #ffffff;
  --fg: #111111;
  --muted: #6b7280;
  --accent: #0b74de;
  --surface: #f8fafc;
  --surface-2: #f1f5f9;
  --border: #e6edf3;
  --shadow: 0 4px 10px rgba(16,24,40,0.06);
  --topbar-height: 56px;
  --toc-width: 280px;
  --radius: 8px;
  --focus-ring: 3px solid rgba(11,116,222,0.25);
  --toast-bg: rgba(0,0,0,0.88);
  --toast-fg: #fff;
  --btn-padding: 8px 12px;
  --font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
}

[data-theme="dark"]{
  --bg: #0b0f13;
  --fg: #e6eef6;
  --muted: #98a4b3;
  --accent: #3aa0ff;
  --surface: #071019;
  --surface-2: #08131a;
  --border: rgba(255,255,255,0.06);
  --shadow: 0 6px 18px rgba(2,6,23,0.6);
  --toast-bg: rgba(255,255,255,0.06);
  --toast-fg: #e6eef6;
}

/* Respect user preference */
@media (prefers-color-scheme: dark) {
  :root:not([data-theme]) { color-scheme: dark; }
}

/* -------------------------
   Base reset
   ------------------------- */
*,
*::before,
*::after { box-sizing: border-box; }
html,body{ height:100%; margin:0; padding:0; background:var(--bg); color:var(--fg); font-family:var(--font-family); -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; line-height:1.45; }
a{ color:var(--accent); text-decoration:none; }

/* Accessible focus handling */
:focus:not(:focus-visible) { outline: none; }
:focus-visible { outline: var(--focus-ring); border-radius: 6px; }

/* -------------------------
   Layout
   ------------------------- */
.header, .topbar, header {
  height: var(--topbar-height);
  display:flex;
  align-items:center;
  gap:12px;
  padding:8px 12px;
  background:transparent;
  border-bottom:1px solid var(--border);
  position:relative;
  z-index:50;
}

.container {
  display:flex;
  gap:16px;
  padding:16px;
  width:100%;
}

/* TOC column (consolidated) */
nav.toc, .toc {
  width: var(--toc-width);
  flex: 0 0 var(--toc-width);
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:8px;
  box-shadow:var(--shadow);
  max-height: calc(100vh - var(--topbar-height) - 32px);
  overflow:auto;
  position: sticky;
  top: calc(var(--topbar-height) + 12px);
  -webkit-overflow-scrolling: touch;
  z-index: 60;
}

/* TOC list and items */
.toc ul, nav.toc ul { list-style:none; margin:0; padding:0; }
.toc li { margin:0 0 6px 0; }
.toc a {
  display:block;
  padding:12px 14px;              /* larger hit area for touch */
  line-height:1.25;
  border-radius:6px;
  color:var(--fg);
  background:transparent;
  transition: background .12s ease;
  text-decoration:none;
  font-size:15px;
}
.toc a:hover, .toc a:focus-visible {
  background:var(--surface-2);
  box-shadow:none;
}
.toc a.active {
  background: linear-gradient(90deg, rgba(11,116,222,0.06), transparent);
  box-shadow: inset 3px 0 0 var(--accent);
  padding-left:14px; /* keep spacing consistent */
}

/* Expand/collapse controls inside TOC */
.toc .toc-toggle { display:inline-flex; align-items:center; gap:6px; cursor:pointer; }

/* -------------------------
   Main content and tables
   ------------------------- */
.main {
  flex:1 1 auto;
  min-width:0;
}

/* Table container responsive */
.table-container {
  width:100%;
  overflow:auto;
  margin-bottom:20px;
  border-radius:6px;
  background:transparent;
  border:1px solid var(--border);
}

/* Table base styles */
table {
  width:100%;
  border-collapse:collapse;
  font-size:13px;
  background:transparent;
}
thead th {
  text-align:left;
  font-weight:600;
  padding:8px 10px;
  border-bottom:1px solid var(--border);
  background: linear-gradient(180deg, rgba(0,0,0,0.02), transparent);
}
tbody td {
  padding:8px 10px;
  border-bottom:1px dashed var(--border);
  vertical-align:top;
}
/* Allow overrides to control zebra coloring */
tbody tr:nth-child(even) td { background: inherit; }

/* small screens: allow horizontal scroll */
@media (max-width: 900px){
  .container { padding:10px; gap:10px; flex-direction:column; }
  nav.toc, .toc { width:100%; max-height:none; top:calc(var(--topbar-height) + 8px); border-radius:6px; }
  .table-container { overflow:auto; }
}

/* -------------------------
   Buttons and controls
   ------------------------- */
.btn {
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding: var(--btn-padding);
  background:var(--accent);
  color:#fff;
  border:none;
  border-radius:6px;
  cursor:pointer;
  font-size:13px;
  transition: transform .08s ease, box-shadow .12s ease, opacity .12s ease;
}
.btn[disabled]{ opacity: .5; cursor: not-allowed; transform:none; }
.btn.inline { display:inline-block; background:transparent; color:var(--fg); border:1px solid var(--border); padding:6px 8px; }

/* copy buttons */
.copy-btn, .copy-button, .btn.copy {
  display:inline-flex;
  gap:8px;
  align-items:center;
  padding:6px 10px;
  background:transparent;
  border:1px solid var(--border);
  color:var(--fg);
  border-radius:6px;
  cursor:pointer;
}
.copy-btn:focus-visible, .copy-button:focus-visible { box-shadow:var(--focus-ring); outline:none; }

/* floating controls (legacy support) */
.floating, .floating-btn {
  position:fixed;
  right:16px;
  bottom:16px;
  z-index:80;
}

/* back-to-top (placed above floating-buttons to avoid overlap) */
.back-to-top, #backToTop, .backToTop {
  position:fixed;
  right:20px;
  bottom:88px; /* raised above floating buttons */
  width:44px;
  height:44px;
  border-radius:999px;
  display:flex;
  align-items:center;
  justify-content:center;
  background:var(--surface);
  border:1px solid var(--border);
  box-shadow:var(--shadow);
  cursor:pointer;
  z-index:90;
}
.back-to-top:focus-visible { box-shadow:var(--focus-ring); outline:none; }

/* search */
.search, .search-bar { display:flex; gap:8px; align-items:center; }
.search input[type="search"], .search input[type="text"], #searchInput {
  padding:8px 10px;
  border:1px solid var(--border);
  border-radius:8px;
  min-width:220px;
  font-size:14px;
  background:var(--surface-2);
  color:var(--fg);
}
#searchInput:focus-visible { box-shadow:var(--focus-ring); outline:none; }

/* small inline spinner for search */
#searchLoading {
  display:inline-block;
  width:16px;
  height:16px;
  border-radius:50%;
  border:2px solid rgba(0,0,0,0.12);
  border-top-color:var(--accent);
  animation:spin 800ms linear infinite;
  vertical-align:middle;
  margin-left:6px;
}
#searchLoading[hidden] { display:none; }

/* table chunk/load controls */
.table-load-controls {
  display:flex;
  gap:8px;
  align-items:center;
  margin:8px 0;
}
.table-load-controls button {
  padding:6px 10px;
  border-radius:6px;
  border:1px solid var(--border);
  background:var(--surface);
  cursor:pointer;
}

/* -------------------------
   Toast / non-blocking notification
   ------------------------- */
.toast, #toast {
  position:fixed;
  left:50%;
  bottom:22px;
  transform:translateX(-50%) translateY(12px);
  background:var(--toast-bg);
  color:var(--toast-fg);
  padding:10px 14px;
  border-radius:8px;
  box-shadow:0 8px 24px rgba(2,6,23,0.4);
  opacity:0;
  visibility:hidden;
  transition: all .22s cubic-bezier(.2,.9,.2,1);
  z-index:120;
  max-width:92%;
  font-size:13px;
}
.toast.show, #toast.show {
  opacity:1;
  visibility:visible;
  transform:translateX(-50%) translateY(0);
}

/* -------------------------
   Details / collapsible
   ------------------------- */
details[open] > summary::after { content: "▲"; float:right; }
details > summary::after { content: "▼"; float:right; }
details summary { list-style:none; cursor:pointer; padding:8px; border-radius:6px; }
.collapsed, .collapse, .is-collapsed { display:none; }

/* -------------------------
   Accessibility / focus (global)
   ------------------------- */
button:focus-visible, a:focus-visible, input:focus-visible, select:focus-visible, textarea:focus-visible { box-shadow:var(--focus-ring); border-radius:6px; }

/* reduce motion */
@media (prefers-reduced-motion: reduce){
  * { animation-duration: 0.001ms !important; animation-iteration-count: 1 !important; transition-duration: 0.001ms !important; scroll-behavior: auto !important; }
}

/* -------------------------
   Dark mode helper classes (explicit)
   ------------------------- */
.theme-toggle, .theme-control { cursor:pointer; display:inline-flex; align-items:center; gap:8px; padding:6px 8px; border-radius:6px; border:1px solid var(--border); background:var(--surface); }

/* -------------------------
   Utilities
   ------------------------- */
.hidden { display:none !important; }
.no-print { display:none !important; }
.center { display:flex; align-items:center; justify-content:center; }

/* -------------------------
   Print optimizations (careful rules)
   ------------------------- */
@media print {
  :root { color-scheme: light; }
  html, body {
    background: #fff !important;
    color: #000 !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }
  * {
    background: transparent !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }

  nav.toc, .toc, .toc-controls, .toc-toggle,
  .search, .search-bar, #searchInput, .search-input, input[type="search"],
  .controls, .header, .topbar, .toast, #toast,
  .theme-toggle, .theme-control, .copy-btn, .copy-button, .btn.copy, .table-load-controls,
  .floating, .floating-btn, .back-to-top, #backToTop, .backToTop,
  .pagination-controls, .filter-controls, .sticky-controls {
    display: none !important;
    visibility: hidden !important;
    height: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
  }

  header, footer { position: static !important; display:block !important; }

  .collapsed, .collapse, .is-collapsed, .hidden, .no-collapse, [aria-hidden="true"] {
    display: block !important;
    visibility: visible !important;
    height: auto !important;
    overflow: visible !important;
  }
  details { display: block !important; }
  details > summary { display: none !important; }

  table {
    width: 100% !important;
    border-collapse: collapse !important;
    font-size: 12pt !important;
    background: transparent !important;
  }
  thead { display: table-header-group; }
  tfoot { display: table-footer-group; }
  tr, th, td {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }
  th, td {
    border: 1px solid #ccc !important;
    padding: 4px 6px !important;
    color: #000 !important;
    background: transparent !important;
  }
  .table-container, table, tbody {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }
  .table-separator, .table-container + .table-container, h1, h2, h3 {
    page-break-before: always;
    page-break-after: avoid;
  }
  img, svg { max-width:100% !important; height:auto !important; }
  a[href]:after { content: " (" attr(href) ")"; font-size:90%; color:#000; }
  body { line-height:1.25 !important; font-size:12pt !important; -webkit-print-color-adjust: exact !important; }
  .sticky, .fixed, .is-fixed, [style*="position:fixed"], [style*="position: sticky"] { position: static !important; }
  .no-print, .no-print * { display: none !important; }

  @page { margin: 12mm; size: auto; }
}

/* -------------------------
   Animations
   ------------------------- */
@keyframes spin { from { transform: rotate(0deg);} to { transform: rotate(360deg);} }

/* -------------------------
   End of file
   ------------------------- */

/* --- Integrated floating Print + Top buttons (append only) --- */
.floating-buttons {
  position: fixed;
  bottom: 20px;
  right: 20px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  z-index: 9999;
  pointer-events: auto;
}

/* Button visuals follow existing tokens (non-destructive) */
.floating-buttons button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  min-width: 44px;
  height: 44px;
  padding: 8px 12px;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: var(--surface);
  color: var(--fg);
  box-shadow: var(--shadow);
  cursor: pointer;
  font-size: 14px;
  transition: transform .08s ease, box-shadow .12s ease, opacity .12s ease;
}

/* Match focus / accessibility styles used elsewhere */
.floating-buttons button:focus-visible {
  outline: none;
  box-shadow: var(--focus-ring);
  border-radius: 10px;
}

/* Subtle hover/active micro-interactions */
.floating-buttons button:hover { transform: translateY(-2px); }
.floating-buttons button:active { transform: translateY(0); }

/* Specific helper classes (use in HTML): */
.print-btn { /* print button */
  background: var(--surface);
  color: var(--fg);
  border: 1px solid var(--border);
}
.top-btn { /* top button if you want a named hook */
  background: var(--surface);
  color: var(--fg);
  border: 1px solid var(--border);
}

/* Hide floating controls when printing */
@media print {
  .floating-buttons { display: none !important; }
}
