/* style.css — Tables Viewer v2.1
   Revised: 2025-09-21 (fix: sticky first-column <th> styling, dark-shadow, media-query cleanup)
   Purpose: consistent list markers inside table cells, plus general UI polish
*/

/* --------------------------
   Theme variables (light)
   -------------------------- */
:root{
  --bg:#ffffff;
  --text:#111827;
  --panel:#f8fafc;
  --border:#e5e7eb;
  --row-hover:#d0ebff;
  --highlight:#fff3a2;
  --current-row:#ffeaa2;
  --button-bg:#f3f4f6;
  --button-text:#111827;
  --muted:rgba(17,24,39,0.45);
  --toc-link:#2563eb;
  --toc-link-hover-bg:#e0f2fe;
  --toc-link-hover-color:#1e40af;
  --tv-header-min-height:48px;
  --firstcol-shadow-light: 2px 0 5px -2px rgba(0,0,0,0.08);
  --firstcol-shadow-dark: 2px 0 5px -2px rgba(255,255,255,0.06);
}

/* --------------------------
   Dark theme overrides
   -------------------------- */
[data-theme="dark"]{
  --bg:#1e1e2f;
  --text:#e0e0e0;
  --panel:#2a2a3e;
  --border:#3c3c4f;
  --row-hover:#38384c;
  --highlight:#fffa8c;
  --current-row:#ffd86c;
  --button-bg:#44445a;
  --button-text:#e0e0e0;
  --muted:rgba(224,224,224,0.35);
  --toc-link:#93c5fd;
  --toc-link-hover-bg:#1e3a8a;
  --toc-link-hover-color:#ffffff;
}

/* --------------------------
   Base layout + typography
   -------------------------- */
html,body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial;
  font-size:15px;
  line-height:1.45;
}
a{color:inherit;text-decoration:none}

/* Buttons */
button{
  background:var(--button-bg);
  color:var(--button-text);
  border:1px solid var(--border);
  padding:6px 12px;
  border-radius:6px;
  cursor:pointer;
  font-size:14px;
  display:inline-flex;
  align-items:center;
  justify-content:center;
}

/* --------------------------
   Table container and responsive behavior
   -------------------------- */
.table-container{
  width:100%;
  overflow-x:auto;
  -webkit-overflow-scrolling:touch;
  border-radius:8px;
}
table{
  width:100%;
  border-collapse:collapse;
  table-layout:fixed;
  word-wrap:break-word;
  margin-bottom:18px;
  background:transparent;
  font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
  font-size:15px;
  min-width:420px;
}

/* Headers and cells
   - use top value from header-min-height variable
*/
thead th, th{
  padding:12px 14px;
  text-align:left;
  vertical-align:middle;
  border:1px solid var(--border);
  background:var(--panel);
  font-weight:700;
  font-size:1.03rem;
  position:sticky;
  top:var(--tv-header-min-height);
  z-index:3;
  cursor:default;
  transition: background-color 120ms ease, color 120ms ease;
}
tbody td, td{
  padding:12px 14px;
  border:1px solid var(--border);
  vertical-align:top;
  font-weight:400;
  word-break:break-word;
  white-space:normal;
}
table strong, table b{
  font-weight:600;
  color:var(--text);
  letter-spacing:-0.01em;
}

/* Row striping & hover (apply to both td and th in tbody) */
tbody tr:nth-child(even) td,
tbody tr:nth-child(even) th { background: var(--bg); }
tbody tr:nth-child(odd) td,
tbody tr:nth-child(odd) th { background: transparent; }

tbody tr:hover td,
tbody tr:hover th { background: var(--row-hover) !important; transition: background-color 120ms ease; }

.highlight{background:var(--highlight)!important;transition:background .45s ease}
.current-row td{background:var(--current-row)!important}

/* --------------------------
   Sticky first column (covers td + th)
   -------------------------- */
/* Base sticky first-column (applies to both header and body first-child) */
td:first-child, th:first-child{
  background:var(--panel);
  font-weight:600;
  position:sticky;
  left:0;
  z-index:2;
  min-width:140px;
  box-shadow: var(--firstcol-shadow-light);
}

/* Make sure body row-headers (<tbody> th:first-child) also get sticky and copy zebra/hover */
.table-container table tbody th:first-child,
.table-container table tbody td:first-child {
  /* reinforce sticky behavior specifically for body first-column */
  position: sticky;
  left: 0;
  z-index: 4;
  box-shadow: var(--firstcol-shadow-light);
  background-color: inherit !important;
  color: inherit !important;
}

/* Explicit zebra colors for first-column <th> in tbody (to avoid stacking issues) */
.table-container table tbody tr:nth-child(odd) th:first-child {
  background-color: inherit !important;
}
.table-container table tbody tr:nth-child(even) th:first-child {
  background-color: inherit !important;
}
/* Hover sync for first-column <th> in tbody */
.table-container table tbody tr:hover th:first-child {
  background-color: var(--row-hover) !important;
}

/* Dark-mode adaptive shadow for the sticky first column */
[data-theme="dark"] .table-container table tbody th:first-child,
[data-theme="dark"] .table-container table tbody td:first-child {
  box-shadow: var(--firstcol-shadow-dark);
}

/* Subtle border color override (keeps borders light) */
table td, table th{border-color:rgba(0,0,0,0.06)}

/* --------------------------
   Sort button and header interactions
   -------------------------- */
.sort-btn{
  display:flex;
  align-items:center;
  gap:6px;
  background:transparent;
  border:0;
  padding:6px 8px;
  cursor:pointer;
  border-radius:8px;
  font-size:12px;
  color:var(--muted);
}
.th-with-sort, thead th[role="button"], .sort-btn{cursor:pointer}
thead th[role="button"]:hover{background:#eef6ff}

/* --------------------------
   Sticky header area - header + TOC
   -------------------------- */
#stickyMainHeader{
  position:sticky;
  top:0;
  background:var(--bg);
  z-index:1001;
  padding:10px 14px;
  border-bottom:1px solid var(--border);
  display:flex;
  flex-direction:column;
  gap:6px;
  align-items:stretch;
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
  box-shadow: 0 1px 0 rgba(0,0,0,0.03);
}

/* tv-header layout */
#tv-header{
  display:flex;
  gap:6px;
  align-items:center;
  justify-content:space-between;
  flex-wrap:wrap;
  width:100%;
  min-height:var(--tv-header-min-height);
}
#tv-header > div:first-child{
  flex: 0 0 auto;
  display:flex;
  align-items:center;
  gap:8px;
}
#tv-header > div:last-child{
  display:flex;
  gap:6px;
  align-items:center;
  justify-content:flex-end;
  flex: 1 1 auto;
  flex-wrap:wrap;
  overflow:visible;
}

/* Compact top buttons (header only) */
#tv-header button,
#tv-header .btn,
#stickyMainHeader button {
  flex: 0 0 auto;
  padding: 4px 8px;
  font-size: 13px;
  border-radius: 5px;
  line-height: 1.1;
  min-height: 40px;     /* preserves touch target */
  min-width: 36px;
  white-space:nowrap;
  gap:6px;
}
#tv-header button.icon-only,
#tv-header .btn.icon-only {
  padding: 6px;
  width: 36px;
  height: 36px;
  min-width: 36px;
  min-height: 36px;
  font-size: 0; /* icon fonts or SVG only */
}

/* Compact header search inputs */
#tv-header input[type="search"],
#tv-header input[type="text"],
#stickyMainHeader input[type="search"],
#stickyMainHeader input[type="text"]{
  flex: 1 1 220px !important;
  min-width: 110px !important;
  width: auto !important;
  max-width: 100% !important;
  box-sizing: border-box;
  padding: 6px 8px;
  font-size: 13px;
  border-radius: 6px;
  height: 34px;
}

/* TOC bar */
#tocBar{
  display:flex;
  align-items:center;
  gap:12px;
  width:100%;
  overflow-x:auto;
  padding:6px 4px;
  background:transparent;
  -webkit-overflow-scrolling:touch;
}
#tocBar ul{
  display:flex;
  gap:8px;
  list-style:none;
  margin:0;
  padding:0;
  align-items:center;
}
#tocBar a{
  white-space:nowrap;
  display:inline-block;
  padding:6px 10px;
  color:var(--toc-link);
  border-radius:6px;
  transition:background .18s ease,color .18s ease;
}

/* Page layout */
#mainContent{padding:20px}
.th-with-sort{display:flex;align-items:center;gap:8px}
.sort-icon{width:12px;height:12px;display:inline-block;vertical-align:middle}
.sort-state-0{opacity:.45}
.sort-state-1,.sort-state-2{color:var(--text);opacity:1}

/* --------------------------
   Responsive tweaks
   -------------------------- */
@media (max-width:900px){
  #tv-header input[type="search"]{ width:180px !important; min-width:120px !important; }
  #tocBar{gap:8px;padding:4px}
  #mainContent{padding:12px}
}

/* Small-screen adjustments */
@media (max-width:600px){
  table{font-size:15px}
  td,th{padding:10px 12px}
  thead th{position:sticky;top:var(--tv-header-min-height);z-index:4}
  .table-container{border-radius:6px}

  /* Make the tv-header stack on very small screens */
  #tv-header{
    flex-direction:column;
    align-items:stretch;
  }
  #tv-header > div:last-child{
    justify-content:flex-start;
  }

  /* Force search full width on mobile and place above controls if wrapping */
  #tv-header input[type="search"],
  #tv-header input[type="text"],
  #stickyMainHeader input[type="search"],
  #stickyMainHeader input[type="text"] {
    flex-basis: 100% !important;
    width: 100% !important;
    order: 1;
    margin-bottom:6px;
    height:32px;
    font-size:12px;
    padding:4px 7px;
  }

  /* Slightly tighter header buttons on very small screens */
  #tv-header button,
  #tv-header .btn,
  #stickyMainHeader button {
    padding: 3px 7px;
    font-size: 12px;
    min-height:36px;
  }

  /* Ensure toc has good touch area */
  #tocBar{
    padding:8px 6px;
  }
}

/* Narrow-screen: hide less-essential header buttons to save space */
@media (max-width:420px){
  #tv-header > div:last-child{
    overflow-x:auto;
    -webkit-overflow-scrolling:touch;
  }
  #tv-header > div:last-child button:not(#modeBtn):not(#toggleAllBtn) {
    display:none !important;
  }
}

/* Table header area, collapse controls */
.table-wrapper .table-header-wrapper{gap:8px}
.toggle-table-btn{margin-left:10px;font-size:12px;padding:6px 10px}
.table-wrapper.table-collapsed .table-container table tbody{display:none}
.table-wrapper.table-collapsed .copy-buttons button{opacity:.65}

/* Back-to-top */
#backToTop{
  display:none;
  position:fixed;
  bottom:24px;
  right:24px;
  z-index:1100;
  padding:10px 14px;
  font-size:14px;
  border-radius:8px;
  background:var(--button-bg);
  color:var(--button-text);
  border:1px solid var(--border);
  cursor:pointer;
  box-shadow:0 2px 6px rgba(0,0,0,.15);
  transition:opacity .3s ease;
}
#backToTop:hover{opacity:.85}
.row-count{font-size:13px;color:var(--muted);margin-top:6px;margin-left:6px}

/* --------------------------
   Lists inside table cells: force consistent markers
   -------------------------- */
td ul, td ol {
  margin: .45rem 0;
  padding-left: 1.25rem;
  list-style: none;
}
td ul li, td ol li {
  margin-bottom: .3rem;
  line-height:1.36;
}
td > ul > li::before {
  content: "– ";
  color: var(--text);
  display: inline-block;
  width: 1.1ch;
  margin-left: -1.1ch;
}
td ul ul, td ul ol, td ol ul {
  margin-top:.2rem;
  margin-bottom:.35rem;
  padding-left:1rem;
}
td ul ul > li::before {
  content: "• ";
  display:inline-block;
  width:1.1ch;
  margin-left:-1.1ch;
  color:var(--muted);
  font-size:0.9em;
}
td ol {
  counter-reset: table-ol;
  padding-left: 1.6rem;
}
td ol > li {
  counter-increment: table-ol;
}
td ol > li::before {
  content: counter(table-ol) ". ";
  color: var(--text);
  display: inline-block;
  width: 2.2ch;
  margin-left: -2.2ch;
}

/* Keep inline code readable */
td code{
  background:#f3f4f6;
  padding:2px 6px;
  border-radius:6px;
  font-family:ui-monospace,SFMono-Regular,Menlo,monospace;
  font-size:.92em;
}

/* Ensure nested lists inside <td> inherit color in dark mode too */
[data-theme="dark"] td > ul > li::before,
[data-theme="dark"] td ol > li::before {
  color: var(--text);
}

/* Accessibility: increase focus outline visibility */
a:focus, button:focus, input:focus, select:focus, textarea:focus {
  outline: 3px solid rgba(37,99,235,0.18);
  outline-offset: 2px;
}

/* Prevent ancestor overflow from disabling sticky positioning */
#tables-viewer, #mainContent {
  overflow: visible;
}

/* small visual polish for toc links */
#tocBar a:hover{ background:var(--toc-link-hover-bg); color:var(--toc-link-hover-color) }

/* End of file */
