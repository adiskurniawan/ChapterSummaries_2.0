/* assets/style.css — Tables Viewer v2.1
   Revised: enforce clean line breaks inside cells (pre-line).
   Checked carefully.
*/

/* -----------------------
   Design tokens
   ----------------------- */
:root{
  --bg: #ffffff;
  --panel: #ffffff;
  --text: #111827;
  --muted: #6b7280;
  --accent: #2563eb;
  --accent-600: #1e40af;
  --border: #e6e9ee;
  --row-hover: rgba(0,0,0,0.04);
  --highlight: #fff9d9;
  --current-row: #fff4c2;
  --shadow-sm: 0 6px 18px rgba(16,24,40,0.06);

  --space-xs: 6px;
  --space-sm: 10px;
  --space-md: 16px;
  --space-lg: 24px;
  --radius: 10px;

  --sticky-header-offset: 72px;
  --left-col-width: 28.5714%;
  --right-col-width: 71.4286%;
  --max-width: 1100px;

  --font-sans: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  --transition-fast: 150ms cubic-bezier(.2,.9,.2,1);
}

/* -----------------------
   Base / layout
   ----------------------- */
*,:before,:after{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:var(--font-sans);font-size:15px;line-height:1.45;-webkit-font-smoothing:antialiased}
a{color:inherit;text-decoration:none}
[hidden]{display:none!important}
.visually-hidden{position:absolute!important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0 0 0 0);white-space:nowrap;border:0}

/* Page container */
#mainContent{padding:var(--space-lg)}
.container{max-width:var(--max-width);margin:0 auto}

/* -----------------------
   Header / TOC / Controls
   ----------------------- */
.header-main{
  position:sticky;
  top:0;
  z-index:1400;
  background:rgba(255,255,255,0.95);
  border-bottom:1px solid var(--border);
  backdrop-filter: blur(4px);
  padding:10px 16px;
}
.header-top{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
.app-title{margin:0;font-size:18px;font-weight:700}
.header-actions{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.header-search{display:flex;gap:8px;align-items:center;margin-top:8px;max-width:760px;width:100%}

/* TOC */
.toc-bar{display:flex;align-items:center;gap:12px;width:100%;overflow-x:auto;padding:8px 4px}
.toc-list{display:flex;gap:8px;list-style:none;margin:0;padding:0}
.toc-list a{display:inline-block;padding:6px 10px;border-radius:10px;color:var(--accent);transition:background var(--transition-fast),color var(--transition-fast)}
.toc-list a:hover{background:var(--accent);color:#fff}

/* Buttons */
.btn{
  display:inline-flex;align-items:center;gap:8px;
  background:linear-gradient(180deg,#fff,#fafafa);
  color:var(--text);
  border:1px solid var(--border);
  padding:8px 12px;border-radius:8px;cursor:pointer;
  font-size:13px;transition:transform var(--transition-fast),box-shadow var(--transition-fast);
}
.btn:hover{transform:translateY(-1px);box-shadow:var(--shadow-sm)}
.btn:active{transform:none}
.btn:focus{outline:3px solid rgba(37,99,235,0.14);outline-offset:2px}
.search-input{
  padding:8px 10px;border-radius:8px;border:1px solid var(--border);background:var(--panel);color:var(--text);min-width:220px
}

/* -----------------------
   Table wrapper / header
   ----------------------- */
.table-wrapper{margin:20px 0;padding:12px;border-radius:var(--radius);background:transparent}
.table-title{margin:0 0 8px 0;font-size:15px;font-weight:600}
.table-header-wrapper{display:flex;justify-content:space-between;align-items:center;gap:10px;margin-bottom:8px}
.table-controls{display:flex;align-items:center;gap:8px}

/* toggle button */
.toggle-table-btn{background:transparent;border:1px solid var(--border);padding:6px 10px;border-radius:8px;cursor:pointer}
.toggle-table-btn:hover{background:rgba(37,99,235,0.03);}

/* collapsed behavior */
.table-wrapper.table-collapsed .table-container{max-height:0;overflow:hidden;transition:max-height 220ms ease}
.table-wrapper.table-collapsed .toggle-table-btn{opacity:.9}
.table-wrapper.table-collapsed .data-table tbody{display:none}

/* -----------------------
   Table visuals (polished)
   ----------------------- */
.table-container{width:100%;overflow:auto;border-radius:8px}
.data-table, table.chat-table{
  width:100%;border-collapse:separate;border-spacing:0;table-layout:fixed;min-width:420px;
  background:var(--panel);border-radius:8px;overflow:hidden;
  box-shadow:0 6px 18px rgba(2,6,23,0.04);
}

/* header row */
.data-table thead th, table.chat-table thead th{
  padding:12px 14px;text-align:left;vertical-align:middle;background:#f7f7f9;
  border-bottom:1px solid var(--border);font-weight:700;font-size:1rem;position:sticky;top:var(--sticky-header-offset);z-index:1050;
  cursor:pointer; /* clickable header */
}

/* sticky first column */
.data-table thead th:first-child, table.chat-table thead th:first-child{left:0;z-index:1060;width:var(--left-col-width);min-width:140px}
.data-table th:first-child,.data-table td:first-child, table.chat-table th:first-child, table.chat-table td:first-child{
  position:sticky;left:0;z-index:1040;background:linear-gradient(90deg, rgba(255,255,255,0.9), var(--panel));
  font-weight:700;min-width:140px;box-shadow:2px 0 10px -6px rgba(0,0,0,0.06);
}

/* -----------------------
   Preserve line breaks in cells (pre-line)
   -----------------------
   pre-line converts \n into line breaks while collapsing other whitespace.
*/
.data-table tbody td,
table.chat-table td,
.data-table thead th,
table.chat-table thead th {
  white-space: pre-line;     /* enforce line-breaks from \n */
  vertical-align: top;
  padding:12px 14px;
  line-height:1.48;
  word-break:break-word;
}

/* lists inside cells should use normal whitespace */
.data-table td ul, .data-table td ol, table.chat-table td ul, table.chat-table td ol {
  white-space: normal;
  margin:.45rem 0;
  padding-left:1.25rem;
  list-style:none;
}

/* list marker styling */
.data-table td > ul > li::before, table.chat-table td > ul > li::before {
  content: "— ";
  color:var(--muted);
  display:inline-block;
  width:1.1ch;
  margin-left:-1.1ch;
}

/* stripe & hover */
.data-table tbody tr:nth-child(odd) td{background:transparent}
.data-table tbody tr:hover td{background:var(--row-hover);transition:background var(--transition-fast)}
.highlight{background:var(--highlight)!important;transition:background var(--transition-fast)}
.current-row td{background:var(--current-row)!important}

/* th sort area */
.th-with-sort{display:flex;align-items:center;gap:10px}
.th-label{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.sort-btn{display:inline-flex;align-items:center;gap:6px;background:transparent;border:0;padding:6px;border-radius:8px;cursor:pointer;color:var(--muted)}
.sort-icon{width:14px;height:14px;display:inline-block;vertical-align:middle}
.sort-state-0{opacity:.45}
.sort-state-1,.sort-state-2{opacity:1;color:var(--accent-600)}

/* small caption / row count */
.row-count{font-size:13px;color:var(--muted);margin-top:8px;margin-left:4px}

/* inline code */
.data-table td code, table.chat-table td code{background:rgba(2,6,23,0.03);padding:2px 6px;border-radius:6px;font-family:ui-monospace,monospace;font-size:.92em}

/* back to top */
.back-to-top{
  position:fixed;right:20px;bottom:20px;padding:10px 14px;border-radius:12px;background:var(--panel);border:1px solid var(--border);
  box-shadow:var(--shadow-sm);cursor:pointer;transition:transform var(--transition-fast),opacity var(--transition-fast)
}
.back-to-top[hidden]{opacity:0;pointer-events:none;transform:scale(.96)}

/* accessibility focus */
a:focus,button:focus,input:focus,select:focus,textarea:focus{outline:3px solid rgba(37,99,235,0.14);outline-offset:3px}

/* responsive */
@media (max-width:900px){
  #mainContent{padding:14px}
  .search-input{min-width:160px}
  .table-title{font-size:1rem}
  .table-container{border-radius:10px}
  .data-table{min-width:360px}
}
@media (max-width:600px){
  .data-table td,.data-table th{padding:10px}
  .data-table td:first-child,.data-table th:first-child{min-width:110px}
  .header-top{gap:8px}
  .toc-bar{padding:6px 2px}
}

/* print */
@media print{
  .header-main,.toc-bar,.back-to-top,.btn{display:none!important}
  body{background:#fff;color:#000}
  .data-table{box-shadow:none;border:1px solid #ddd}
  .data-table thead th{position:static}
}

/* small helpers */
.kbd{display:inline-block;padding:2px 6px;border-radius:6px;border:1px solid var(--border);background:#f7f7f9;font-family:ui-monospace,monospace;font-size:.85em}
.note{font-size:13px;color:var(--muted)}
