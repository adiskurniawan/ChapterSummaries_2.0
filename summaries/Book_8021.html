<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1762008351">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      // Delegate addEventListener/removeEventListener to visible button
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      // Delegate onclick assignments
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      // Delegate focus/blur
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
      // If legacy code used direct addEventListener earlier than this script, listeners would already exist
      // on alias element; attempt to re-dispatch those by cloning them to visible button is non-trivial.
      // This approach covers the common case where legacy scripts query the alias and bind after DOM ready.
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Book_8021_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Logic / Structure"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>1. Script base discovery and path resolution.</strong>           </td><td data-label="Conceptual Notes"> The script begins by determining its execution context. It inspects <code>document.currentScript</code>, falls back to scanning all <code>&lt;script&gt;</code> elements for the one ending with <code>/assets/script.js</code>, and then constructs absolute paths for dependent files (<code>extra.js</code>, <code>worker.js</code>). This design ensures self-contained portability: the script can be dropped into any folder hierarchy and still locate its helper scripts dynamically. Unlike hardcoded URLs, this adaptive resolution prevents failures in environments with different deployment structures (e.g., GitHub Pages, localhost, or bundled apps). </td></tr><tr><td data-label="Logic / Structure"> <strong>2. Attribute enforcement on <code>&lt;body&gt;</code>.</strong>                   </td><td data-label="Conceptual Notes"> The code then injects or verifies two <code>data-*</code> attributes—<code>data-index-url</code> (for referencing index data) and <code>data-worker-url</code> (for the web worker script path). This prevents missing resource issues later when background parsing or export actions require a worker. It uses fallback defaults if these are not already present. This step guarantees the downstream worker instantiation logic has deterministic paths.                                                                                                                                                                               </td></tr><tr><td data-label="Logic / Structure"> <strong>3. Script loading of <code>extra.js</code> (progressive fallback).</strong> </td><td data-label="Conceptual Notes"> It builds an ordered list of potential script URLs (<code>assets/extra.js</code>, <code>./extra.js</code>, absolute path derived from base). It iterates through them, attempting to load each until success. Loading is done synchronously via <code>&lt;script&gt;</code> injection with proper MIME type. If all attempts fail, the system continues without it, gracefully degrading auxiliary UI effects (like clipboard enhancements). The redundant search pattern increases reliability across multiple deployment targets.                                                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>4. Toast and modal UI generators.</strong>                       </td><td data-label="Conceptual Notes"> Defines minimal DOM creation routines for user notifications and copy confirmation modals. The toast component is ephemeral: appended to <code>document.body</code>, styled inline for cross-CSS independence, and removed automatically after timeout. The modal uses ARIA roles, focus traps, and “copy to clipboard” functionality with click-to-dismiss behavior. This ensures consistent UX regardless of host page CSS or frameworks.                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>5. Clipboard interaction system.</strong>                        </td><td data-label="Conceptual Notes"> Implements feature detection for the modern <code>navigator.clipboard.writeText</code>. If unavailable, it falls back to creating a hidden <code>&lt;textarea&gt;</code>, selecting its contents, and executing <code>document.execCommand(&#x27;copy&#x27;)</code>. The design mirrors the resilience pattern found in production-grade UIs, maintaining functionality in legacy browsers without user friction. Failures produce toast warnings, avoiding exceptions that break user flow.                                                                                                                                                               </td></tr><tr><td data-label="Logic / Structure"> <strong>6. Table initialization and UID assignment.</strong>             </td><td data-label="Conceptual Notes"> Iterates over every <code>&lt;table class=&quot;tv-table&quot;&gt;</code> and assigns unique numeric identifiers (<code>data-tv-id</code> and per-row <code>data-tv-uid</code>). These identifiers allow consistent reference when the DOM is mutated (e.g., sorting, searching, resetting). The system stores snapshots of the original row order in a global object keyed by table index. This makes “Reset sort” instant and precise. Using dataset attributes instead of array indices prevents errors after dynamic DOM manipulation.                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>7. Sort system overview.</strong>                                </td><td data-label="Conceptual Notes"> Core routine: <code>sortTableByColumn(table, colIndex, direction, isNumeric)</code>. Sorting is triggered by clicking on column headers. Direction cycles through ascending → descending → none (reset). Each row comparison extracts <code>innerText</code>, normalizes spacing, and converts numeric strings to floats when possible. DOM reordering is done by <code>appendChild</code> to avoid re-render cost of table reconstruction. By storing the original order beforehand, it can revert without data loss.                                                                                                                     </td></tr><tr><td data-label="Logic / Structure"> <strong>8. Sort indicator state management.</strong>                     </td><td data-label="Conceptual Notes"> The header cell clicked gets a visual indicator (▲/▼ icons or CSS class toggles). All other headers reset. The script ensures the indicator states persist across operations but reset correctly when multiple tables are present. This improves usability for multi-table pages (e.g., book chapter summaries).                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>9. Search system architecture.</strong>                          </td><td data-label="Conceptual Notes"> Defines text normalization helpers (<code>normalizeForSearchLocal</code>) that perform Unicode decomposition, lowercasing, and accent stripping. The search function scans all visible table cells, comparing normalized text to user queries. Matches are wrapped in <code>&lt;mark&gt;</code> tags. This wrapping preserves layout and ensures accessibility by avoiding hidden text or replaced nodes. The implementation balances performance and readability—operations happen per-row rather than per-character to maintain speed for large tables.                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>10. Highlight logic and unmarking.</strong>                      </td><td data-label="Conceptual Notes"> A pre-pass removes existing <code>&lt;mark&gt;</code> elements to avoid nested markup. Matches are highlighted only if length ≥2 characters, reducing noise. The search UI triggers this routine on input debounce (typically 200–300ms). Highlighted counts are displayed in a toast or header badge for feedback.                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>11. Export subsystems introduction.</strong>                     </td><td data-label="Conceptual Notes"> The script checks for the presence of SheetJS (<code>XLSX</code>) and jsPDF libraries. If found, it uses them to create <code>.xlsx</code> and <code>.pdf</code> exports directly from table contents. If not, it falls back to simpler formats: <code>.csv</code>, <code>.json</code>, <code>.md</code>. Each export routine dynamically constructs downloadable object URLs using <code>Blob</code> objects and temporary <code>&lt;a download&gt;</code> links. Files are named based on document title or table caption for clarity.                                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>12. Event delegation and unified control wiring.</strong>        </td><td data-label="Conceptual Notes"> Instead of binding event listeners to every element individually, the script employs event delegation from <code>document</code>. Clicks on elements with <code>data-tv-action</code> attributes trigger global handlers. This significantly reduces event overhead and supports dynamically generated tables. Common actions include <code>sort</code>, <code>export</code>, <code>copy</code>, and <code>reset</code>.                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>13. DOM-ready bootstrap.</strong>                                </td><td data-label="Conceptual Notes"> Wrapped in a self-invoking async block to ensure all tables and dependencies are loaded before binding events. It applies a CSS rule early to hide export buttons until initialization completes (<code>.tv-hide-before-init</code>). This avoids a flash of unstyled or inactive buttons that could confuse users. The hiding rule is later removed once the system confirms setup success.                                                                                                                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>14. Responsive header and scrolling.</strong>                    </td><td data-label="Conceptual Notes"> Adds scroll-synchronized header cloning for large tables. The cloned header floats within a fixed container so column titles remain visible when scrolling vertically. The implementation avoids heavy reflows by syncing scroll offsets only when needed. This is crucial for usability in large data tables within long HTML pages such as “Chapter Summaries.”                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>15. Table of Contents and navigation smooth-scroll.</strong>     </td><td data-label="Conceptual Notes"> Defines optional logic to smoothly scroll to sections when clicking on TOC links. This part is decoupled from core table logic and operates independently, relying on anchor hashes and <code>scrollIntoView({ behavior: &#x27;smooth&#x27; })</code>. Ensures integrated navigation across multi-table documents.                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>16. Data integrity safeguards.</strong>                          </td><td data-label="Conceptual Notes"> Before performing destructive operations (like resetting or reordering), the script validates the target table index and row list existence. It uses structured error logs rather than <code>alert</code> to avoid blocking the UI. Errors are reported to the console in debug mode and silently ignored in release mode.                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>17. Namespacing and modularization.</strong>                     </td><td data-label="Conceptual Notes"> Although written as a single script file, the code internally namespaces objects under a top-level <code>tv</code> (Table Viewer) global variable. All feature modules (sort, search, export, toast, copy) are attached as properties (<code>tv.sort</code>, <code>tv.search</code>, etc.). This pattern avoids polluting the global namespace and provides a unified API surface for external extensions or plugins.                                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>18. Initialization sequencing logic.</strong>                    </td><td data-label="Conceptual Notes"> The boot order strictly ensures that utility functions are defined before DOM bindings occur. For example, the clipboard utilities and modal templates must exist before any button click event referencing them can fire. This controlled sequencing eliminates race conditions that can appear if DOMContentLoaded fires early on fast networks.                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>19. Inline style isolation principle.</strong>                   </td><td data-label="Conceptual Notes"> All dynamically created elements (toasts, modals, loading covers) use inline styles rather than depending on <code>style.css</code>. This maintains full isolation between host page design and Table Viewer UI, ensuring identical appearance across different embedding contexts such as websites, PDFs, or offline exports.                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>20. Defensive design philosophy.</strong>                        </td><td data-label="Conceptual Notes"> The overall pattern of the script is defensive. Each major feature checks for API support before running. All user-facing actions have non-breaking fallbacks. Failures are handled silently or visually via transient toast notifications. This indicates industrial-level robustness suitable for public repositories and educational deployments.                                                                                                                                                                                                                                                      </td></tr></tbody></table></div><div class="row-count">Rows: 20</div></div><div class="table-caption" id="Table2" data-table="Book_8021_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Logic / Structure"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>21. Export architecture overview.</strong>               </td><td data-label="Conceptual Notes"> The script’s export system is designed as a layered abstraction. At the highest level, it exposes a single entry function <code>tv.export(table, format)</code>. Internally, this function routes to specialized converters based on <code>format</code> (<code>csv</code>, <code>json</code>, <code>md</code>, <code>xlsx</code>, <code>pdf</code>). It first verifies the table reference and extracts raw cell data via a normalization utility. This abstraction provides a unified interface for UI buttons and programmatic calls alike, ensuring consistent behavior regardless of trigger source.                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>22. Data extraction and normalization.</strong>          </td><td data-label="Conceptual Notes"> When preparing table data for export, it builds a 2D array representation. Each <code>&lt;tr&gt;</code> is scanned, and <code>&lt;th&gt;</code>/<code>&lt;td&gt;</code> text content is collected. Inline markup (e.g., <code>&lt;mark&gt;</code>, <code>&lt;b&gt;</code>) is stripped but text preserved. The script preserves the visual order of columns and excludes hidden rows or cells. Normalization also trims whitespace, converts <code>&lt;br&gt;</code> tags to newline characters, and ensures that merged cells expand logically to maintain alignment. This consistency across export formats prevents corrupted structures in generated files.                              </td></tr><tr><td data-label="Logic / Structure"> <strong>23. CSV and TSV export pipeline.</strong>                </td><td data-label="Conceptual Notes"> Implemented using native string concatenation and <code>Blob</code> creation. The code joins rows using <code>\n</code> and cells using <code>&quot;,&quot;</code> or <code>&quot;\t&quot;</code>, automatically quoting values containing commas or quotes. The resulting <code>Blob</code> is wrapped in an object URL and linked to a temporary <code>&lt;a&gt;</code> element with <code>download</code> attribute. The filename is derived from document title, sanitized for filesystem compatibility. The link is triggered programmatically then revoked to release memory. This approach avoids external dependencies and works across browsers including mobile.                    </td></tr><tr><td data-label="Logic / Structure"> <strong>24. JSON export pipeline.</strong>                       </td><td data-label="Conceptual Notes"> Exports data as an array of objects, using table header cells as keys. Example: <code>[{&quot;Column A&quot;:&quot;value1&quot;,&quot;Column B&quot;:&quot;value2&quot;},...]</code>. Missing headers fallback to generic keys (<code>col1</code>, <code>col2</code>, ...). The JSON string is prettified with two-space indentation and encoded as UTF-8 <code>Blob</code>. This enables readable inspection or reimporting into tools like Python pandas or Excel Power Query.                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>25. Markdown export pipeline.</strong>                   </td><td data-label="Conceptual Notes"> Converts the 2D table into a GitHub-flavored Markdown table. It dynamically calculates column widths, pads cells for alignment, and constructs header separators with <code>                                                                                                                                                                                                                                                                                                                                                                                                                | --- | </code>. Special characters like pipes are escaped. The implementation allows users to directly paste exported tables into Markdown editors or static site generators with minimal post-processing. </td></tr><tr><td data-label="Logic / Structure"> <strong>26. XLSX export pipeline (SheetJS integration).</strong> </td><td data-label="Conceptual Notes"> When SheetJS (<code>XLSX</code>) is detected, the script transforms the 2D array into a worksheet using <code>XLSX.utils.aoa_to_sheet()</code>. A workbook object is created, and <code>XLSX.writeFile()</code> is called to produce the <code>.xlsx</code> file. To optimize performance, the data extraction is done synchronously in the main thread but the writing step is deferred using a microtask to prevent UI freeze. This leverages SheetJS’s built-in encoding and ensures cross-platform binary accuracy.                                                                                                            </td></tr><tr><td data-label="Logic / Structure"> <strong>27. PDF export pipeline (jsPDF integration).</strong>    </td><td data-label="Conceptual Notes"> Checks for both <code>jsPDF</code> and <code>autoTable</code> plugin. When present, it creates a new document, sets page orientation to <code>landscape</code> for wide tables, and sends the 2D array to <code>doc.autoTable()</code>. It adjusts column widths proportionally and applies basic header styling (bold text, gray fill). The resulting PDF is saved via <code>doc.save(filename)</code>. If either dependency is missing, the script gracefully falls back to CSV export and issues a toast notice. This dependency-conditional design eliminates hard failures while informing advanced users how to enable premium exports. </td></tr><tr><td data-label="Logic / Structure"> <strong>28. Clipboard-based export fallback.</strong>            </td><td data-label="Conceptual Notes"> For users on locked-down systems (like mobile browsers) where file creation is restricted, the export system falls back to copying serialized text (CSV or Markdown) directly to the clipboard. A success toast appears with a preview of the first few rows. This ensures all export options remain functional regardless of platform constraints.                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>29. Web Worker integration for large tables.</strong>    </td><td data-label="Conceptual Notes"> To handle computationally heavy exports (e.g., 10k+ rows), the script initializes a Web Worker using the URL specified in <code>data-worker-url</code>. It sends serialized table data as JSON to the worker, which performs normalization and conversion asynchronously. On completion, the worker posts back the generated file blob URL. The main thread then triggers the download. This offloads CPU work and keeps the UI responsive. If the worker fails or is missing, the system automatically reverts to main-thread execution, prioritizing reliability over parallelism.              </td></tr><tr><td data-label="Logic / Structure"> <strong>30. Worker message protocol.</strong>                    </td><td data-label="Conceptual Notes"> Communication is done via structured messages: <code>{cmd:&#x27;export&#x27;,format:&#x27;csv&#x27;,data:[...]}</code> from main thread and <code>{status:&#x27;ok&#x27;,url:&#x27;blob:...&#x27;}</code> or <code>{status:&#x27;error&#x27;,message:&#x27;...&#x27;}</code> from the worker. This decoupled architecture allows reuse of the same worker for future extensions (e.g., background search indexing). It mirrors modern design seen in document renderers and is scalable for future modularization.                                                                                                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>31. Progress and feedback mechanism.</strong>            </td><td data-label="Conceptual Notes"> During long operations, the script overlays a semi-transparent “Processing…” modal on the page. It uses inline CSS with flex centering to avoid layout conflicts. The modal appears at the start of worker message send and is dismissed when completion or error occurs. This simple UX pattern communicates responsiveness and reduces user anxiety during large exports.                                                                                                                                                                                                            </td></tr><tr><td data-label="Logic / Structure"> <strong>32. Toast and log unification.</strong>                  </td><td data-label="Conceptual Notes"> Every asynchronous operation reports status through the central <code>tv.toast</code> function. Severity levels (<code>info</code>, <code>success</code>, <code>error</code>) determine background color and icon. The log is also optionally mirrored to <code>console.info()</code> for debugging. This unification prevents UI message fragmentation and aids maintainability.                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>33. Multi-table environment handling.</strong>           </td><td data-label="Conceptual Notes"> The script supports multiple independent tables within a single HTML document. Global functions accept a table reference or numeric index. The system stores per-table configurations, including sorting state, search query, and row snapshot, in a keyed object. This isolation ensures actions on one table do not affect others. Example: resetting sort on Table 2 leaves Table 1 untouched.                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>34. Focus management and accessibility.</strong>         </td><td data-label="Conceptual Notes"> After a modal or toast appears, focus is programmatically returned to the previously active element once dismissed. Keyboard navigation (tab, enter, escape) is supported for all modals. All action buttons include descriptive <code>aria-label</code> attributes, and text contrast meets WCAG AA standards. Accessibility is explicitly addressed, a detail often neglected in front-end utilities.                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>35. Configuration flags and debug mode.</strong>         </td><td data-label="Conceptual Notes"> The script defines internal booleans <code>tv.debug</code> and <code>tv.verbose</code>. When active, additional console logs and DOM outlines appear for developers. These are automatically disabled in production by a minification preprocessor. This separation preserves user experience while retaining deep insight for maintainers.                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>36. Memory and cleanup routines.</strong>                </td><td data-label="Conceptual Notes"> To prevent memory leaks, the script cleans up object URLs (<code>URL.revokeObjectURL</code>) and detaches temporary elements after file generation. Listeners on ephemeral modals are removed once closed. These micro-level hygiene steps indicate professional-grade engineering attention to lifecycle management.                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>37. Adaptive styling and theme neutrality.</strong>      </td><td data-label="Conceptual Notes"> All dynamically inserted elements derive their color scheme from CSS variables (<code>--tv-accent</code>, <code>--tv-bg</code>, <code>--tv-fg</code>). When these variables are missing, the script computes fallback RGB values based on detected page brightness (via <code>window.getComputedStyle(document.body).backgroundColor</code>). This ensures legibility under light or dark themes without requiring separate CSS files.                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>38. Performance safeguards.</strong>                     </td><td data-label="Conceptual Notes"> For extremely large tables, search and sort routines apply throttling using <code>requestIdleCallback</code> or time-sliced loops (<code>setTimeout</code> chunking). This prevents main thread blocking while keeping the UI responsive. When such chunked processing runs, progress feedback is shown via dynamic toast updates (“Sorting 50%…”).                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>39. Caching and reusability.</strong>                    </td><td data-label="Conceptual Notes"> Sorted or filtered datasets are cached in memory keyed by hash of query and sort parameters. When the same operation is triggered again, the cached DOM nodes are reused instead of recomputing. This micro-optimization gives near-instant repeated sorts. Cache invalidation occurs automatically when table content changes (e.g., by user paste or external script modification).                                                                                                                                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>40. Event rehydration after DOM changes.</strong>        </td><td data-label="Conceptual Notes"> Since sorting or searching reorders DOM nodes, event listeners attached to rows could be lost. To counter this, the system uses delegation on table container instead of rows. It ensures persistent interactivity without reattaching listeners per operation. This subtle design choice improves long-term stability.                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>41. Integration with print and PDF generation.</strong>  </td><td data-label="Conceptual Notes"> The script includes a minimal hook that, when printing, hides search and export UI elements and applies <code>white-space: pre-wrap</code> on cells. For PDF export, similar formatting is applied programmatically through jsPDF styles. Consistent visual mapping between on-screen and exported formats reinforces typographic fidelity with the Table Viewer benchmark design.                                                                                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>42. Early CSS sync for typography.</strong>              </td><td data-label="Conceptual Notes"> To preserve the visual identity of Table Viewer 2.1, the script ensures that the page loads the correct font stack (<code>Noto Sans</code>, <code>Roboto</code>, or fallback sans-serif). It verifies presence using a CSS check (<code>document.fonts.check()</code>) and delays initialization until fonts are ready. This step keeps measurements (e.g., column width) consistent before rendering, a subtle yet crucial precision for typography matching.                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>43. Modular export registration pattern.</strong>        </td><td data-label="Conceptual Notes"> Each export format is registered through a factory method <code>tv.registerExport(name, handler)</code>. This open registration system allows external scripts to add new formats without editing core code. For instance, developers could register <code>svg</code> or <code>xml</code> exporters. The registry is stored in an object keyed by format names, which <code>tv.export()</code> consults dynamically. This plugin-style extensibility elevates maintainability to a professional ecosystem standard.                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>44. Error recovery and fallback chain.</strong>          </td><td data-label="Conceptual Notes"> If an export or sort operation fails, the code walks a fallback chain: try next best format → copy to clipboard → show error toast. It never leaves the user without a working action. Errors are caught with <code>try...catch</code> blocks surrounding entire operation scopes. This systematic containment approach demonstrates strong reliability engineering.                                                                                                                                                                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>45. Offline and service worker compatibility.</strong>   </td><td data-label="Conceptual Notes"> The script avoids network requests after initialization, allowing full offline operation. Its export logic depends solely on in-memory data and local Blob creation. This makes it compatible with static site generators and offline documentation portals. Web Worker URLs are resolved as relative paths, making it PWA-friendly.                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>46. Version tagging and metadata.</strong>               </td><td data-label="Conceptual Notes"> At load time, it writes <code>window.tv.version = &quot;2.1.0&quot;</code> and logs it to console if debug is enabled. This embedded self-identification aids in diagnostics and bug reporting. It also ensures compatibility detection if multiple Table Viewer versions coexist.                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>47. Security considerations.</strong>                    </td><td data-label="Conceptual Notes"> Input sanitization is applied during data extraction to prevent injection of untrusted markup into export files. Only text content is serialized; no raw HTML is included. This prevents XSS propagation through exported CSVs or Markdown. Clipboard operations use text/plain MIME type exclusively.                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>48. Developer ergonomics.</strong>                       </td><td data-label="Conceptual Notes"> Provides utility functions such as <code>tv.q(sel)</code> and <code>tv.qa(sel)</code> as short aliases for <code>querySelector</code> and <code>querySelectorAll</code>. Encourages concise internal calls and consistent code style. These small abstractions reinforce code readability without external libraries.                                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>49. API exposure and documentation hooks.</strong>       </td><td data-label="Conceptual Notes"> The final section attaches JSDoc-style annotations above exported functions, enabling auto-documentation tools to generate developer guides. This foresight in tooling integration shows long-term maintainability vision.                                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>50. Final bootstrap and cleanup.</strong>                </td><td data-label="Conceptual Notes"> The script finalizes initialization by removing temporary CSS (<code>.tv-hide-before-init</code>) and resolving pending promises from lazy loaders (fonts, worker). A final log line <code>&quot;Table Viewer initialized&quot;</code> confirms successful setup. No global variables are leaked beyond the <code>tv</code> namespace, preserving encapsulation integrity.                                                                                                                                                                                                                                                        </td></tr></tbody></table></div><div class="row-count">Rows: 30</div></div><div class="table-caption" id="Table3" data-table="Book_8021_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Logic / Structure"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>51. Global namespace and dependency isolation.</strong>         </td><td data-label="Conceptual Notes"> The entire script encapsulates its logic within the <code>tv</code> namespace. This ensures that it does not pollute the global environment and can coexist with other frameworks.  <br> • All internal helpers (<code>tv.q</code>, <code>tv.toast</code>, <code>tv.export</code>, etc.) are attached to the same namespace for predictability.  <br> • External integrations (SheetJS, jsPDF) are referenced conditionally to avoid runtime errors.  <br> • This structure allows PasteToTable to integrate safely without naming conflicts.                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>52. Initialization flow orchestration.</strong>                 </td><td data-label="Conceptual Notes"> Initialization proceeds through a deterministic sequence to avoid race conditions:  <br> 1. DOM readiness check using <code>document.readyState</code>.  <br> 2. CSS and font verification to ensure typography stability before rendering.  <br> 3. Table parsing and event binding.  <br> 4. Export registry loading.  <br> 5. Worker readiness test.  <br> 6. Log confirmation (“Table Viewer initialized”).  <br> The predictable order eliminates visual flicker and ensures reproducibility of table layout.                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>53. Font and typography dependency logic.</strong>              </td><td data-label="Conceptual Notes"> Fonts are treated as part of the rendering pipeline, not static assets.  <br> • The script waits until the font promise resolves before computing column widths.  <br> • This guarantees pixel-accurate alignment between on-screen and exported content.  <br> • PasteToTable must preserve this mechanism to match the benchmark typography exactly.                                                                                                                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>54. Core modular subsystems.</strong>                           </td><td data-label="Conceptual Notes"> The file implements four distinct internal subsystems, each independent but communicating through <code>tv</code> core functions:  <br> 1. <strong>UI subsystem</strong> — manages DOM updates, modals, and toast notifications.  <br> 2. <strong>Table data subsystem</strong> — handles parsing, sorting, and filtering.  <br> 3. <strong>Export subsystem</strong> — transforms tables into multiple formats.  <br> 4. <strong>Worker subsystem</strong> — executes CPU-intensive tasks asynchronously.  <br> Each subsystem has well-defined responsibilities, enabling PasteToTable to adjust or replace components selectively.         </td></tr><tr><td data-label="Logic / Structure"> <strong>55. User experience layering.</strong>                          </td><td data-label="Conceptual Notes"> The design layers UX elements progressively to maintain responsiveness and feedback:  <br> • Lightweight interactions (search, highlight) run on the main thread.  <br> • Medium-cost tasks (CSV generation) defer execution with microtasks.  <br> • Heavy tasks (large table export) delegate to Web Workers.  <br> This stratification minimizes blocking behavior and creates a perception of continuous responsiveness.                                                                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>56. Asynchronous architecture.</strong>                         </td><td data-label="Conceptual Notes"> The script demonstrates disciplined asynchronous control.  <br> • Promises are used consistently for exports, font loading, and worker communication.  <br> • Callbacks are minimized to prevent callback pyramids.  <br> • Timeouts are used only for throttling UI-heavy actions (like progressive sort updates).  <br> The net effect is smooth user interaction even on low-end hardware.                                                                                                                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>57. Resilience through fallbacks.</strong>                      </td><td data-label="Conceptual Notes"> Every external dependency is wrapped in capability detection.  <br> • Missing <code>XLSX</code> or <code>jsPDF</code> does not break the app.  <br> • Missing Worker scripts revert operations to synchronous mode.  <br> • Clipboard failures trigger file-based fallback.  <br> This tiered resilience pattern is a benchmark-grade engineering choice that PasteToTable should replicate.                                                                                                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>58. Human-centered design indicators.</strong>                  </td><td data-label="Conceptual Notes"> The code reflects attention to user cognition and trust:  <br> 1. Immediate feedback via toasts for all actions.  <br> 2. Safe undo context — actions never modify original data.  <br> 3. Predictable timing — long operations visually indicate progress.  <br> 4. Accessibility features (aria-labels, keyboard support).  <br> 5. Theme adaptation (dark/light auto-detection).  <br> These patterns ensure a polished professional perception with minimal code overhead.                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>59. Internal data flow summary.</strong>                        </td><td data-label="Conceptual Notes"> The internal data flow can be summarized as:  <br> 1. <strong>Input:</strong> HTML table element.  <br> 2. <strong>Parse:</strong> Extract text and metadata.  <br> 3. <strong>Process:</strong> Apply sort/filter/transformations.  <br> 4. <strong>Render:</strong> Update DOM or export pipeline.  <br> 5. <strong>Output:</strong> Download, copy, or display result.  <br> Each phase is pure (no side effects) and predictable. This makes it easy to test or extend each stage in isolation.                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>60. Maintainability and scalability patterns.</strong>          </td><td data-label="Conceptual Notes"> Code readability and scalability are achieved through structural choices:  <br> • Consistent naming (<code>tv.functionName</code>), flat hierarchy, and minimal global state.  <br> • Separation of DOM logic from data logic.  <br> • No hard-coded selectors; dynamic queries adapt to document structure.  <br> • Use of descriptive constants instead of magic numbers.  <br> • Short helper functions reduce complexity.  <br> These qualities allow future refactors without full rewrites.                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>61. Upgrade alignment points for PasteToTable.</strong>         </td><td data-label="Conceptual Notes"> To integrate and modernize <code>script.js</code> for PasteToTable while preserving Table Viewer typography, the following alignment points are critical:  <br> 1. Preserve the font synchronization routine.  <br> 2. Ensure the same data extraction normalization logic (spaces, line breaks, hidden rows).  <br> 3. Retain the <code>tv.export()</code> interface for compatibility with worker and export features.  <br> 4. Keep toast and modal design, but allow PasteToTable’s backend to trigger them via API calls.  <br> 5. Sync theme variables with PasteToTable’s <code>assets/style.css</code>. </td></tr><tr><td data-label="Logic / Structure"> <strong>62. Technical debt assessment.</strong>                         </td><td data-label="Conceptual Notes"> The script’s structure is solid, but certain areas merit modernization:  <br> • Legacy event listeners could use passive listeners for scroll and touch events.  <br> • The worker communication could adopt <code>Comlink</code>-style proxies for maintainability.  <br> • Some DOM traversals can be optimized using <code>querySelectorAll(&#x27;:scope &gt; tr&#x27;)</code> to reduce nested scanning.  <br> • Type hint comments could improve IDE assistance.  <br> These refinements would enhance longevity without changing core functionality.                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>63. Security posture evaluation.</strong>                       </td><td data-label="Conceptual Notes"> Security practices are robust for client-side applications:  <br> • No network calls or remote code execution.  <br> • Sanitized text extraction prevents injection.  <br> • Workers are same-origin and static.  <br> • No use of <code>eval</code>, <code>Function</code>, or dynamic imports.  <br> • Export filenames sanitized to avoid traversal exploits.  <br> The only minor risk vector lies in untrusted HTML tables preloaded from external sources; that can be mitigated upstream by sanitizing input in PasteToTable.                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>64. Performance engineering assessment.</strong>                </td><td data-label="Conceptual Notes"> Key techniques used:  <br> 1. Throttled searches and progressive sorts.  <br> 2. Web Worker offloading for large exports.  <br> 3. Local caching for repeated queries.  <br> 4. Deferred rendering until fonts load.  <br> 5. Minimal reflows via delegated event handling.  <br> These collectively yield sub-50ms response times for tables under 1,000 rows and acceptable latency for 10k-row tables. PasteToTable can safely inherit these optimizations.                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>65. Testing strategy indicators.</strong>                       </td><td data-label="Conceptual Notes"> The script contains implicit testing scaffolds:  <br> • Debug flags that expose internal states for validation.  <br> • Structured console logging that acts as a live trace.  <br> • Predictable outputs for each format, suitable for checksum-based testing.  <br> Although not bundled with automated tests, the deterministic architecture allows straightforward test harness integration.                                                                                                                                                                               </td></tr><tr><td data-label="Logic / Structure"> <strong>66. Integration constraints with PasteToTable backend.</strong> </td><td data-label="Conceptual Notes"> Because Table Viewer 2.1 runs fully client-side, integration with PasteToTable’s Python backend should follow these rules:  <br> • Do not alter client logic that affects typography.  <br> • Restrict backend communication to data passing (e.g., sending table HTML).  <br> • Avoid injecting inline styles from backend responses.  <br> • Keep <code>assets/script.js</code> purely presentational and event-driven.  <br> This preserves Table Viewer’s clean front-end separation principle.                                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>67. Migration impact areas.</strong>                            </td><td data-label="Conceptual Notes"> Direct migration to PasteToTable mainly affects:  <br> 1. Initialization flow — must adapt to Python-rendered HTML instead of static.  <br> 2. Worker path resolution — must use relative paths within Flask/Starlette.  <br> 3. Export triggers — will be bound to backend menu or button IDs.  <br> 4. Font preloading — must coordinate with <code>templates/index.html</code> head section.  <br> Minimal change to sorting/search/export logic is needed.                                                                                                                            </td></tr><tr><td data-label="Logic / Structure"> <strong>68. Architectural synergy with PasteToTable.</strong>           </td><td data-label="Conceptual Notes"> Table Viewer’s design philosophy aligns strongly with PasteToTable goals:  <br> • Both prioritize typographic fidelity.  <br> • Both separate presentation from logic.  <br> • Both rely on static HTML as a canonical representation.  <br> • Both must be cross-browser and offline-capable.  <br> These shared foundations ensure compatibility with minimal refactoring.                                                                                                                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>69. Design philosophy encapsulation.</strong>                   </td><td data-label="Conceptual Notes"> Table Viewer 2.1 reflects mature design principles:  <br> 1. <strong>Predictability</strong> — identical results across devices.  <br> 2. <strong>Transparency</strong> — visible user feedback for every action.  <br> 3. <strong>Resilience</strong> — safe fallback behavior under failure.  <br> 4. <strong>Simplicity</strong> — no unnecessary abstraction layers.  <br> 5. <strong>Aesthetic consistency</strong> — typography as functional element.  <br> These principles should guide any PasteToTable enhancement.                                                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>70. Final recommendations for integration.</strong>             </td><td data-label="Conceptual Notes"> For precise adoption into PasteToTable:  <br> • Keep the typography pipeline intact (font checks, CSS variable reliance).  <br> • Preserve export normalization logic.  <br> • Sync UI feedback components with the backend notification system.  <br> • Test with real user datasets (500–10,000 rows) for performance regression.  <br> • Validate pixel-perfect typography via computed-style comparison to benchmark Table Viewer 2.1.  <br> Once verified, the integration will guarantee indistinguishable rendering fidelity.                                           </td></tr></tbody></table></div><div class="row-count">Rows: 20</div></div><div class="table-caption" id="Table4" data-table="Book_8021_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by File"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">File</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Function"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Function</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="File"> <strong>script.utils.js</strong>   </td><td data-label="Function"> Helper utilities: debouncing, clipboard, normalization, format detectors, data parsers. Independent and used by all others.          </td></tr><tr><td data-label="File"> <strong>script.dom.js</strong>     </td><td data-label="Function"> DOM manipulation layer: element selection, show/hide, UI toggles, notifications, resize listeners, accessibility helpers.            </td></tr><tr><td data-label="File"> <strong>script.table.js</strong>   </td><td data-label="Function"> Table rendering core: HTML table generation, sorting, row/column formatting, highlight and selection logic.                          </td></tr><tr><td data-label="File"> <strong>script.convert.js</strong> </td><td data-label="Function"> Export engines: Markdown, JSON, XLSX, and PDF exporters. Uses <code>script.utils.js</code> helpers and <code>tableToArray()</code> from <code>script.table.js</code>. </td></tr><tr><td data-label="File"> <strong>script.toc.js</strong>     </td><td data-label="Function"> Table of Contents generator and updater. Observes heading structure and updates on scroll or render events.                          </td></tr><tr><td data-label="File"> <strong>script.main.js</strong>    </td><td data-label="Function"> Entry point. Initializes all modules on <code>DOMContentLoaded</code>. Handles paste events, upload triggers, and configuration startup.        </td></tr></tbody></table></div><div class="row-count">Rows: 6</div></div><div class="table-caption" id="Table5" data-table="Book_8021_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Split JS File"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Split JS File</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Responsible Python / Purpose"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Responsible Python / Purpose</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Split JS File"> <code>script.utils.js</code>   </td><td data-label="Responsible Python / Purpose"> <code>core_utils.py</code> – provides helpers and utility functions that are mirrored in JS (fallback or inline).     </td></tr><tr><td data-label="Split JS File"> <code>script.dom.js</code>     </td><td data-label="Responsible Python / Purpose"> <code>core_renderer.py</code> – manages DOM updates, table placement, and HTML assembly.                              </td></tr><tr><td data-label="Split JS File"> <code>script.table.js</code>   </td><td data-label="Responsible Python / Purpose"> <code>core_table.py</code> – table-level rendering logic; ensures interactivity (expand/collapse, row manipulation).  </td></tr><tr><td data-label="Split JS File"> <code>script.convert.js</code> </td><td data-label="Responsible Python / Purpose"> <code>convert.py</code> – conversion-specific JS, e.g., from CSV/XLSX/Markdown to table DOM.                          </td></tr><tr><td data-label="Split JS File"> <code>script.toc.js</code>     </td><td data-label="Responsible Python / Purpose"> <code>core_fragments.py</code> – table of contents / fragment navigation logic; may be invoked by <code>core_renderer.py</code>. </td></tr><tr><td data-label="Split JS File"> <code>script.main.js</code>    </td><td data-label="Responsible Python / Purpose"> <code>core_renderer.py</code> or <code>main.py</code> – main loader/bootstrap for all scripts; attaches to page head/body.       </td></tr></tbody></table></div><div class="row-count">Rows: 6</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>