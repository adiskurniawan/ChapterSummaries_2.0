<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1760835299">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      // Delegate addEventListener/removeEventListener to visible button
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      // Delegate onclick assignments
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      // Delegate focus/blur
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
      // If legacy code used direct addEventListener earlier than this script, listeners would already exist
      // on alias element; attempt to re-dispatch those by cloning them to visible button is non-trivial.
      // This approach covers the common case where legacy scripts query the alias and bind after DOM ready.
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li>
<li class="toc-item"><a class="toc-link" href="#Table7">Table 7</a></li>
<li class="toc-item"><a class="toc-link" href="#Table8">Table 8</a></li>
<li class="toc-item"><a class="toc-link" href="#Table9">Table 9</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Book_8030_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Area"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Area</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Benchmark Behavior"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Benchmark Behavior</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Required Implementation"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Required Implementation</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Area"> <strong>Table Wrapping</strong> </td><td data-label="Benchmark Behavior"> <code>&lt;div class=&quot;table-wrapper&quot;&gt;</code> </td><td data-label="Required Implementation"> Must be produced server-side in <code>core_table.render_table</code>. </td></tr><tr><td data-label="Area"> <strong>Heading Level</strong> </td><td data-label="Benchmark Behavior"> <code>&lt;h3&gt;</code> used for table titles </td><td data-label="Required Implementation"> Inserted immediately before each <code>&lt;table&gt;</code>. </td></tr><tr><td data-label="Area"> <strong>Captions</strong> </td><td data-label="Benchmark Behavior"> <code>&lt;div class=&quot;table-caption&quot;&gt;</code> following the table </td><td data-label="Required Implementation"> Must exist even if caption empty (for CSS spacing consistency). </td></tr><tr><td data-label="Area"> <strong>Anchors / IDs</strong> </td><td data-label="Benchmark Behavior"> Each <code>&lt;h3&gt;</code> includes unique id (<code>id=&quot;table-001&quot;</code>) </td><td data-label="Required Implementation"> Deterministic ID generation from table index in document. </td></tr><tr><td data-label="Area"> <strong>TOC Scanning</strong> </td><td data-label="Benchmark Behavior"> <code>PTToc.scan()</code> looks for <code>.table-wrapper h3</code> </td><td data-label="Required Implementation"> Ensure markup exactly matches expected DOM tree. </td></tr><tr><td data-label="Area"> <strong>Typography</strong> </td><td data-label="Benchmark Behavior"> Serif body text, consistent h3 margin/padding </td><td data-label="Required Implementation"> Controlled entirely by <code>assets/style.css</code>. No inline style. </td></tr><tr><td data-label="Area"> <strong>Asset Loading</strong> </td><td data-label="Benchmark Behavior"> CSS and JS linked via <code>/assets/</code> paths </td><td data-label="Required Implementation"> <code>core_assets.py</code> handles manifest, SRI, embedding. </td></tr><tr><td data-label="Area"> <strong>Safety</strong> </td><td data-label="Benchmark Behavior"> Atomic writes, no broken temp files </td><td data-label="Required Implementation"> <code>core_io.py</code> + <code>io_utils.py</code> enforce atomic operations. </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table2" data-table="Book_8030_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Layer"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Layer</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Mechanism"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Mechanism</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Responsible Module"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Responsible Module</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Layer"> Atomic file writes </td><td data-label="Mechanism"> Write to tmp + rename </td><td data-label="Responsible Module"> <code>core_io.py</code>, <code>io_utils.py</code> </td></tr><tr><td data-label="Layer"> Manifest + SRI </td><td data-label="Mechanism"> Hash CSS/JS for integrity </td><td data-label="Responsible Module"> <code>core_assets.py</code> </td></tr><tr><td data-label="Layer"> Input sanitization </td><td data-label="Mechanism"> Strip scripts, event handlers </td><td data-label="Responsible Module"> <code>sanitize.py</code> </td></tr><tr><td data-label="Layer"> Metadata tracking </td><td data-label="Mechanism"> JSON sidecar with checksum </td><td data-label="Responsible Module"> <code>io_utils.py</code> </td></tr><tr><td data-label="Layer"> Logging </td><td data-label="Mechanism"> Structured with timestamps </td><td data-label="Responsible Module"> <code>utils.make_logger</code> </td></tr><tr><td data-label="Layer"> Unit tests </td><td data-label="Mechanism"> Table render tests </td><td data-label="Responsible Module"> <code>tests/render/test_table.py</code> (to be added) </td></tr></tbody></table></div><div class="row-count">Rows: 6</div></div><div class="table-caption" id="Table3" data-table="Book_8030_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Test ID"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Test ID</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Input Type"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Input Type</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Expected Output"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Expected Output</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Validation"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Validation</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Test ID"> T01 </td><td data-label="Input Type"> Simple 1-table Markdown </td><td data-label="Expected Output"> One <code>.table-wrapper</code> with <code>h3</code> and caption </td><td data-label="Validation"> DOM match </td></tr><tr><td data-label="Test ID"> T02 </td><td data-label="Input Type"> Multiple tables </td><td data-label="Expected Output"> Sequential wrappers with incremental IDs </td><td data-label="Validation"> DOM + TOC count </td></tr><tr><td data-label="Test ID"> T03 </td><td data-label="Input Type"> Missing caption </td><td data-label="Expected Output"> Empty <code>.table-caption</code> retained </td><td data-label="Validation"> CSS spacing preserved </td></tr><tr><td data-label="Test ID"> T04 </td><td data-label="Input Type"> Long caption text </td><td data-label="Expected Output"> Wrapped text, no overflow </td><td data-label="Validation"> Visual </td></tr><tr><td data-label="Test ID"> T05 </td><td data-label="Input Type"> HTML paste </td><td data-label="Expected Output"> Safe sanitization </td><td data-label="Validation"> No script tags </td></tr><tr><td data-label="Test ID"> T06 </td><td data-label="Input Type"> JSON metadata </td><td data-label="Expected Output"> Correct table count </td><td data-label="Validation"> API </td></tr><tr><td data-label="Test ID"> T07 </td><td data-label="Input Type"> Concurrent render requests </td><td data-label="Expected Output"> No file collision </td><td data-label="Validation"> Atomic ops </td></tr><tr><td data-label="Test ID"> T08 </td><td data-label="Input Type"> Reload benchmark style </td><td data-label="Expected Output"> Typography identical </td><td data-label="Validation"> Screenshot diff </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table4" data-table="Book_8030_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Element"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Element</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Font"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Font</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Size"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Size</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Weight"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Weight</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Margin"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Margin</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Element"> Body </td><td data-label="Font"> Georgia, "Times New Roman", serif </td><td data-label="Size"> 16px </td><td data-label="Weight"> 400 </td><td data-label="Margin"> line-height 1.6 </td></tr><tr><td data-label="Element"> h3 </td><td data-label="Font"> Inherits serif </td><td data-label="Size"> 1.1em </td><td data-label="Weight"> 600 </td><td data-label="Margin"> margin-top ~1.6em </td></tr><tr><td data-label="Element"> Table caption </td><td data-label="Font"> Smaller italic </td><td data-label="Size"> 0.9em </td><td data-label="Weight"> normal </td><td data-label="Margin"> top margin 0.4em </td></tr><tr><td data-label="Element"> Wrapper </td><td data-label="Font"> block </td><td data-label="Size"> auto width </td><td data-label="Weight"> — </td><td data-label="Margin"> bottom margin 1.2em </td></tr></tbody></table></div><div class="row-count">Rows: 4</div></div><div class="table-caption" id="Table5" data-table="Book_8030_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Risk"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Risk</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Cause"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Cause</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Mitigation"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Mitigation</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Risk"> Broken DOM structure </td><td data-label="Cause"> Incorrect wrapper nesting </td><td data-label="Mitigation"> Use template fragments from benchmark </td></tr><tr><td data-label="Risk"> Overwriting user data </td><td data-label="Cause"> Incomplete atomic write </td><td data-label="Mitigation"> Always use temp + rename </td></tr><tr><td data-label="Risk"> CSS mismatch </td><td data-label="Cause"> Inline style contamination </td><td data-label="Mitigation"> Strip all inline attributes </td></tr><tr><td data-label="Risk"> TOC failure </td><td data-label="Cause"> Missing h3 or wrong selector </td><td data-label="Mitigation"> Add unit tests to validate TOC scan output </td></tr><tr><td data-label="Risk"> Race conditions </td><td data-label="Cause"> Concurrent writes </td><td data-label="Mitigation"> Lock via per-user temp dirs </td></tr><tr><td data-label="Risk"> SRI validation fails </td><td data-label="Cause"> Asset hash mismatch </td><td data-label="Mitigation"> Rebuild manifest on deploy </td></tr></tbody></table></div><div class="row-count">Rows: 6</div></div><div class="table-caption" id="Table6" data-table="Book_8030_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Section**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Section</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Analysis Summary**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Analysis Summary</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Section"> <strong>Objective</strong>                </td><td data-label="Analysis Summary"> Unify SSR (Python) and CSR (JS) table rendering under a deterministic DOM schema matching Book 9001 typography.                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Section"> <strong>Problem Diagnosis</strong>        </td><td data-label="Analysis Summary"> Client JS relies on <code>.table-wrapper</code>, <code>.table-title</code>, <code>.table-caption</code>, <code>.table-core</code>. SSR inconsistencies caused ToC desync, duplicate titles, broken anchors, and typography drift.                                                                                                                                                                                                     </td></tr><tr><td data-label="Section"> <strong>Strategic Importance</strong>     </td><td data-label="Analysis Summary"> Ensures functional parity between SSR and CSR, enforces a verifiable DOM contract, prevents runtime DOM repairs, locks typography to CSS benchmark, enables CI regression testing.                                                                                                                                                                                                        </td></tr><tr><td data-label="Section"> <strong>Core Deliverables</strong>        </td><td data-label="Analysis Summary"> Canonical wrapper structure (<code>&lt;div class=&quot;table-wrapper&quot; data-title=&quot;...&quot;&gt;</code> etc.), functions: <code>normalize_table_output()</code>, <code>make_table_wrapper()</code>, <code>validate_table_structure()</code>, <code>inject_wrapped_tables_into_page()</code>. File responsibilities: core_table.py (wrapping), convert.py (normalization), html_renderer.py (injection), core_io.py (atomic write), script.table.js (enhancement). </td></tr><tr><td data-label="Section"> <strong>SSR ↔ CSR Contract</strong>       </td><td data-label="Analysis Summary"> <strong>Server Guarantees:</strong> each table wrapped with metadata, escaped title/caption, all nodes present. <strong>Client Assumptions:</strong> DOM conforms; client enhances but does not reconstruct.                                                                                                                                                                                                        </td></tr><tr><td data-label="Section"> <strong>Validation & Diagnostics</strong> </td><td data-label="Analysis Summary"> <code>validate_table_structure()</code> ensures 1:1 table-wrapper ratio. <code>diagnostic_mode</code> logs per-table metrics. Atomic write prevents corruption. Benchmark loop: render → compare with Book 9001 → adjust Python modules → approve snapshot.                                                                                                                                                     </td></tr><tr><td data-label="Section"> <strong>Accessibility & Security</strong> </td><td data-label="Analysis Summary"> Adds <code>aria-labelledby</code> and <code>aria-describedby</code>. Sanitizes HTML, escapes metadata, blocks inline scripts and events.                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Section"> <strong>Testing Framework</strong>        </td><td data-label="Analysis Summary"> <strong>Structural:</strong> wrapper count = table count, no nested wrappers. <strong>Functional:</strong> ToC enumerates all titles, anchors scroll correctly, no JS errors. <strong>Visual:</strong> margins and hierarchy match benchmark ±1 px.                                                                                                                                                                              </td></tr><tr><td data-label="Section"> <strong>Benefits & Impact</strong>        </td><td data-label="Analysis Summary"> Reliable ToC and anchors, consistent visual rhythm, robust CI regression protection, built-in accessibility, low maintenance, scalable to thousands of tables per page.                                                                                                                                                                                                                   </td></tr><tr><td data-label="Section"> <strong>Governance & Maintenance</strong> </td><td data-label="Analysis Summary"> Ownership: SSR → backend, CSS → design, JS → frontend. Schema versioning: <code>WRAPPER_SCHEMA_VERSION = 2.0</code>. Changes documented in user_guide.md.                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Section"> <strong>Acceptance Criteria</strong>      </td><td data-label="Analysis Summary"> ✅ 100% wrapper coverage<br>✅ ToC and anchors verified<br>✅ Typography ≤1 px deviation<br>✅ Atomic write integrity<br>✅ Zero console errors<br>✅ SSR and CSR synchronized                                                                                                                                                                                                                  </td></tr><tr><td data-label="Section"> <strong>Conclusion</strong>               </td><td data-label="Analysis Summary"> Establishes DOM contract as single source of truth. Server emits structure, client enhances only, CSS defines rhythm, Book 9001 validates output. Ensures deterministic typography and resilient table navigation for PasteToTable outputs.                                                                                                                                               </td></tr></tbody></table></div><div class="row-count">Rows: 12</div></div><div class="table-caption" id="Table7" data-table="Book_8030_07" style="margin-top:2mm;margin-left:3mm;"><strong>Table 7</strong></div>
<div class="table-wrapper" data-table-id="table-7"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Aspect**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Aspect</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Summary**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Summary</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> <strong>Goal</strong>                          </td><td data-label="Conceptual Summary"> Achieve consistent, benchmark-grade typography and structural semantics for all rendered tables in both <strong>SSR</strong> (server-side rendering via Python modules) and <strong>CSR</strong> (client-side enhancement via <code>assets/script.table.js</code>). The aim is visual, structural, and behavioral parity with the Book 9001 typographic baseline.                                                                                                                                       </td></tr><tr><td data-label="Aspect"> <strong>Primary Pain Point</strong>            </td><td data-label="Conceptual Summary"> Client code relies on structural markers (<code>.table-wrapper</code>, <code>h3.table-title</code>, <code>.table-caption</code>, <code>.table-core</code>) to build the ToC and manage anchors. Current SSR output occasionally omits or nests these inconsistently, causing missing anchors, uneven margins, duplicated titles, and breakage in scroll-to-section logic.                                                                                                                                      </td></tr><tr><td data-label="Aspect"> <strong>Strategic Principle</strong>           </td><td data-label="Conceptual Summary"> The server must always emit <em>fully-formed wrapper structures</em> with predictable tags and attributes. The client layer enhances behavior but never performs reconstruction or healing. Server and client communicate through a strict DOM schema. Any missing node constitutes a bug in SSR, not a tolerated omission.                                                                                                                                               </td></tr><tr><td data-label="Aspect"> <strong>Reference Baseline</strong>            </td><td data-label="Conceptual Summary"> Benchmark typography: <strong>[Book 9001](https://github.com/adiskurniawan/ChapterSummaries_2.0/raw/refs/heads/main/summaries/Book_9001.html)</strong>. It defines vertical rhythm, heading scale, caption offset, and table grid alignment. All typographic validation is relative to this baseline. CSS remains locked; structural correction happens only in Python.                                                                                                         </td></tr><tr><td data-label="Aspect"> <strong>Affected Files (SSR Layer)</strong>    </td><td data-label="Conceptual Summary"> • <code>html_renderer.py</code> — inserts tables into HTML templates, governs wrapping and placeholder injection.<br>• <code>render/core_table.py</code> — assembles per-table HTML fragments and associated metadata.<br>• <code>render/convert.py</code> — ensures converters output canonical tuple <code>(html, title, caption)</code> and normalizes missing metadata.<br>• <code>server.py</code> — coordinates multi-table page composition and ensures uniform wrapping.                                          </td></tr><tr><td data-label="Aspect"> <strong>Affected Files (CSR Layer)</strong>    </td><td data-label="Conceptual Summary"> • <code>assets/script.table.js</code> — reads <code>.table-wrapper</code> blocks, extracts <code>h3.table-title</code> and <code>.table-caption</code>, constructs the Table of Contents, and attaches anchors.<br>• <code>assets/style.css</code> — defines visual rhythm, margins, and typographic hierarchy. Locked file; changes occur only when the typography benchmark itself changes.                                                                                                                             </td></tr><tr><td data-label="Aspect"> <strong>SSR ↔ CSR Contract</strong>            </td><td data-label="Conceptual Summary"> <strong>Server Guarantees:</strong><br>• Every rendered table is enclosed in <code>&lt;div class=&quot;table-wrapper&quot; data-title=&quot;...&quot;&gt;</code>.<br>• Inside: <code>&lt;h3 class=&quot;table-title&quot;&gt;&lt;/h3&gt;</code>, <code>&lt;div class=&quot;table-caption&quot;&gt;&lt;/div&gt;</code>, <code>&lt;div class=&quot;table-core&quot;&gt;&lt;table&gt;…&lt;/table&gt;&lt;/div&gt;</code>.<br>• Escaping rules: title/caption escaped, table body trusted.<br><strong>Client Assumptions:</strong> DOM already matches this schema; client adds anchors, numbering, and ToC entries but never reconstructs structure. </td></tr><tr><td data-label="Aspect"> <strong>Wrapper Construction</strong>          </td><td data-label="Conceptual Summary"> Implement <code>make_table_wrapper(html, title, caption)</code> in <code>core_table.py</code>. It escapes metadata, assigns <code>data-title</code>, and returns a complete wrapper block. If title is missing, <code>data-title</code> = "Untitled Table N". Each table gets unique <code>id</code> for anchor mapping.                                                                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Normalization Layer</strong>           </td><td data-label="Conceptual Summary"> <code>normalize_table_output(obj)</code> accepts raw HTML, dict, or tuple. Returns canonical <code>(html, title, caption)</code>. This ensures all upstream converters yield uniform outputs regardless of source format (Markdown, CSV, HTML fragment).                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Aspect"> <strong>Conversion Pipeline Model</strong>     </td><td data-label="Conceptual Summary"> ① Source (Markdown/CSV/HTML) → ② Converter → <code>(html, title, caption)</code> → ③ <code>render/convert.py</code> wraps output → ④ <code>html_renderer.py</code> injects wrappers into template placeholders → ⑤ Client JS reads wrappers and updates ToC. This chain is deterministic and reversible for debugging.                                                                                                                                                                              </td></tr><tr><td data-label="Aspect"> <strong>Atomic Write & Validation</strong>     </td><td data-label="Conceptual Summary"> Writing handled by <code>render/core_io.py</code>: render to temp file, verify structure (count wrappers = tables, no unclosed tags), then atomically rename to destination. Prevents corrupted HTML on crash or I/O interruption.                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Aspect"> <strong>Diagnostics Mode</strong>              </td><td data-label="Conceptual Summary"> Add optional flag <code>diagnostic_mode=True</code>. When active, log structured summary: index, title, caption length, wrapper validity, total table count. Enables regression tracking during build. Output to console and <code>diagnostics.log</code>.                                                                                                                                                                                                                               </td></tr><tr><td data-label="Aspect"> <strong>Typography Preservation Layer</strong> </td><td data-label="Conceptual Summary"> Structural markup stays semantic: <code>&lt;h3&gt;</code> for title, <code>&lt;div&gt;</code> for caption/core, <code>&lt;table&gt;</code> for data. No inline styles or hardcoded spacing. All visual rhythm derives from CSS. HTML merely expresses hierarchy and meaning.                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Structural Validation Routine</strong> </td><td data-label="Conceptual Summary"> Function <code>validate_table_structure(html)</code> ensures each <code>&lt;table&gt;</code> is inside one <code>.table-wrapper</code>, each wrapper contains exactly one <code>.table-core</code>, <code>.table-title</code>, <code>.table-caption</code>. Throws error if mismatch. Called pre-commit.                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Aspect"> <strong>Accessibility Compliance</strong>      </td><td data-label="Conceptual Summary"> Add <code>aria-labelledby</code> and <code>aria-describedby</code> attributes linking <code>.table-core</code> to title/caption. Enables screen readers to announce context properly. Use deterministic ID generation (<code>table-n</code>) to avoid duplicates.                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Aspect"> <strong>SSR Post-Processing Hook</strong>      </td><td data-label="Conceptual Summary"> After <code>html_renderer.py</code> builds the document, call <code>postprocess_wrappers()</code> to re-scan and confirm wrapper completeness before writing to disk. Provides a single checkpoint for future metadata extensions.                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Aspect"> <strong>Benchmark Validation Loop</strong>     </td><td data-label="Conceptual Summary"> <strong>Step 1:</strong> Render representative pages.<br><strong>Step 2:</strong> Compare rendered output with Book 9001 baseline for typography, spacing, and structural consistency.<br><strong>Step 3:</strong> Adjust only <code>core_table.py</code> or <code>html_renderer.py</code> to fix structure; CSS remains locked.<br><strong>Step 4:</strong> Approve snapshot when parity achieved.                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Testing Matrix (Structural)</strong>   </td><td data-label="Conceptual Summary"> • <code>.table-wrapper</code> count = table count.<br>• Each wrapper contains <code>.table-title</code>, <code>.table-core</code>, <code>.table-caption</code>.<br>• No nested wrappers.<br>• <code>data-title</code> reflects <code>.table-title</code> text.<br>• Output passes HTML5 validation.                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Testing Matrix (Functional)</strong>   </td><td data-label="Conceptual Summary"> • ToC correctly enumerates all titles.<br>• Clicking ToC items scrolls to wrappers.<br>• No JS errors or duplicate anchors.<br>• Dynamic updates via MutationObserver do not alter base HTML.                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Aspect"> <strong>Testing Matrix (Visual)</strong>       </td><td data-label="Conceptual Summary"> • Title margin-top and caption margin-bottom match Book 9001 scale (verify via computed style).<br>• Table alignment with paragraph grid consistent within ±1 px.<br>• Typography hierarchy identical (h3 ≈ 1.25 em baseline).                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Aspect"> <strong>Performance Considerations</strong>    </td><td data-label="Conceptual Summary"> Wrapping logic O(1) per table. Bench test with > 1000 tables per page to ensure negligible overhead. Client scanning uses querySelectorAll once; avoid per-node mutation loops.                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Aspect"> <strong>Error Handling Strategy</strong>       </td><td data-label="Conceptual Summary"> Missing metadata → auto-fill defaults, log warning.<br>I/O errors → safe abort before file rename.<br>Structural errors → fail build explicitly. No silent repairs.                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Aspect"> <strong>Backward Compatibility</strong>        </td><td data-label="Conceptual Summary"> Legacy pages without wrappers handled by one-time <code>legacy_wrap()</code> adapter that detects <code>&lt;table&gt;</code> outside <code>.table-wrapper</code>, wraps dynamically, then logs deprecation warning. Maintains support until migration complete.                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Aspect"> <strong>Security Policy</strong>               </td><td data-label="Conceptual Summary"> Sanitize HTML from external sources in converters before wrapping. Disallow inline event attributes and script tags. Escape metadata; whitelist allowed table tags (<code>&lt;thead&gt;</code>, <code>&lt;tbody&gt;</code>, <code>&lt;tr&gt;</code>, <code>&lt;td&gt;</code>, <code>&lt;th&gt;</code>).                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Aspect"> <strong>Minimal-Change Principle</strong>      </td><td data-label="Conceptual Summary"> Server never modifies inner table content. Wrapping adds hierarchy and metadata only. All visual or behavioral changes occur externally via style or JS modules.                                                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Aspect"> <strong>Extensibility Roadmap</strong>         </td><td data-label="Conceptual Summary"> Wrapper schema supports optional future elements:<br>• Per-table action bar (<code>.table-actions</code>) for copy/download/export.<br>• Numbered prefixes (“Table 1”).<br>• Alternate caption positioning (<code>data-caption-pos=&quot;bottom&quot;</code>).<br>• Localized strings for accessibility.                                                                                                                                                                                           </td></tr><tr><td data-label="Aspect"> <strong>Code Interfaces (Proposed)</strong>    </td><td data-label="Conceptual Summary"> <code>python\nnormalize_table_output(obj)-&gt;Tuple[str,str,str]\nmake_table_wrapper(html,title,caption)-&gt;str\nvalidate_table_structure(html)-&gt;bool\ninject_wrapped_tables_into_page(page_html)-&gt;str\n</code> These become public utilities within <code>render/core_table.py</code> or <code>html_renderer.py</code>.                                                                                                                                                                                 </td></tr><tr><td data-label="Aspect"> <strong>Integration Flow Summary</strong>      </td><td data-label="Conceptual Summary"> <code>core_table</code> → <code>convert.normalize</code> → <code>make_table_wrapper</code> → <code>html_renderer.inject</code> → <code>core_io.atomic_write</code>. Each link verified independently. Client picks up stable DOM and builds ToC.                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Logging & Telemetry</strong>           </td><td data-label="Conceptual Summary"> Add structured event logs: <code>{index,title,caption_len,valid,elapsed_ms}</code>. Store under <code>logs/render_tables.json</code> for performance analytics.                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Regression Protection</strong>         </td><td data-label="Conceptual Summary"> Keep HTML snapshots in <code>tests/snapshots/</code>. CI pipeline diffs new output against baseline. Fails on structural deviation or missing wrapper nodes.                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Failure Recovery</strong>              </td><td data-label="Conceptual Summary"> On exception, revert to last valid snapshot. Keep corrupted temp file renamed with <code>.broken</code> suffix for inspection. Prevents deployment of partial builds.                                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Aspect"> <strong>Documentation Requirement</strong>     </td><td data-label="Conceptual Summary"> Update <code>user_guide.md</code> section “Table Rendering Flow” with new wrapper contract and diagnostic options. Include code snippet demonstrating canonical wrapper markup.                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Aspect"> <strong>Operational Checkpoints</strong>       </td><td data-label="Conceptual Summary"> • Pre-commit hook runs structural validator.<br>• Post-deploy script fetches Book 9001 baseline, performs visual diff screenshots.<br>• Any mismatch > 2 px triggers rollback flag.                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Aspect"> <strong>Quality Assurance Targets</strong>     </td><td data-label="Conceptual Summary"> 100 % wrapper coverage, 0 JS console errors, ≤ 1 px typographic deviation, atomic file integrity verified on all builds.                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Aspect"> <strong>Long-Term Maintenance Plan</strong>    </td><td data-label="Conceptual Summary"> Gradually unify SSR/CSR wrappers into a single JSON schema describing table metadata. Allow client to lazy-load additional modules (e.g., filter, sort) without altering DOM contract.                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Aspect"> <strong>Governance / Ownership</strong>        </td><td data-label="Conceptual Summary"> Ownership of SSR structure: backend team. Ownership of visual design: CSS maintainer. Ownership of JS ToC: front-end maintainer. All must adhere to the DOM contract versioned in docs.                                                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Aspect"> <strong>Versioning Policy</strong>             </td><td data-label="Conceptual Summary"> Introduce <code>WRAPPER_SCHEMA_VERSION = 2.0</code> constant in <code>core_table.py</code>. Increment only on structural breaking changes. Client checks this via <code>data-schema-version</code>.                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Aspect"> <strong>Acceptance Criteria</strong>           </td><td data-label="Conceptual Summary"> ✅ All tables wrapped and validated.<br>✅ ToC functions and anchors correct.<br>✅ Typography matches benchmark.<br>✅ Build passes atomic write and regression tests.<br>✅ No structural divergence between SSR and CSR.                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Aspect"> <strong>Summary Directive</strong>             </td><td data-label="Conceptual Summary"> SSR produces the canonical structure. CSR enhances. CSS dictates rhythm. Book 9001 validates appearance. Once these four layers stay in sync, PasteToTable gains deterministic typography and resilient table navigation for every output mode.                                                                                                                                                                                                                    </td></tr></tbody></table></div><div class="row-count">Rows: 39</div></div><div class="table-caption" id="Table8" data-table="Book_8030_08" style="margin-top:2mm;margin-left:3mm;"><strong>Table 8</strong></div>
<div class="table-wrapper" data-table-id="table-8"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Aspect**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Aspect</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Summary**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Summary</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> <strong>Goal</strong>                        </td><td data-label="Conceptual Summary"> Ensure deterministic, benchmark-grade typography and structural uniformity for all tables in both <strong>SSR</strong> (Python-based server rendering) and <strong>CSR</strong> (client enhancement via <code>assets/script.table.js</code>). The output must match the Book 9001 typographic baseline in rhythm, hierarchy, and caption spacing.                                </td></tr><tr><td data-label="Aspect"> <strong>Primary Pain Point</strong>          </td><td data-label="Conceptual Summary"> The client relies on fixed structural markers (<code>.table-wrapper</code>, <code>h3.table-title</code>, <code>.table-caption</code>, <code>.table-core</code>) to assemble the ToC and anchor map. SSR inconsistencies—missing wrappers, double nesting, malformed headings—break scroll logic and typography rhythm.                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Strategic Principle</strong>         </td><td data-label="Conceptual Summary"> The server emits fully formed, semantically complete wrappers. The client only enhances. No DOM reconstruction is allowed client-side. Missing or malformed nodes constitute SSR defects.                                                                                                                                                   </td></tr><tr><td data-label="Aspect"> <strong>Reference Baseline</strong>          </td><td data-label="Conceptual Summary"> <strong>[Book 9001](https://github.com/adiskurniawan/ChapterSummaries_2.0/raw/refs/heads/main/summaries/Book_9001.html)</strong> defines the grid, type scale, and caption offset. CSS is locked; corrections occur in Python layers only.                                                                                                               </td></tr><tr><td data-label="Aspect"> <strong>Affected Files (SSR)</strong>        </td><td data-label="Conceptual Summary"> <code>html_renderer.py</code> — injects wrapped tables into templates.<br><code>render/core_table.py</code> — builds per-table HTML and metadata.<br><code>render/convert.py</code> — enforces tuple output <code>(html, title, caption)</code>.<br><code>server.py</code> — composes final page and coordinates wrapper generation.                                                               </td></tr><tr><td data-label="Aspect"> <strong>Affected Files (CSR)</strong>        </td><td data-label="Conceptual Summary"> <code>assets/script.table.js</code> — reads wrappers, builds ToC, assigns anchors.<br><code>assets/style.css</code> — holds typographic grid and rhythm (locked).                                                                                                                                                                                                 </td></tr><tr><td data-label="Aspect"> <strong>SSR ↔ CSR Contract</strong>          </td><td data-label="Conceptual Summary"> <strong>Server:</strong> emits <code>&lt;div class=&quot;table-wrapper&quot; data-title=&quot;...&quot;&gt;</code> with children <code>&lt;h3 class=&quot;table-title&quot;&gt;</code>, <code>&lt;div class=&quot;table-caption&quot;&gt;</code>, and <code>&lt;div class=&quot;table-core&quot;&gt;&lt;table&gt;…&lt;/table&gt;&lt;/div&gt;</code>. Title/caption escaped; table body trusted.<br><strong>Client:</strong> assumes schema validity; adds numbering and anchors but never rebuilds structure. </td></tr><tr><td data-label="Aspect"> <strong>Wrapper Construction</strong>        </td><td data-label="Conceptual Summary"> Implement <code>make_table_wrapper(html, title, caption)</code> in <code>core_table.py</code>. Escapes metadata, sets <code>data-title</code>, generates <code>id</code>, and returns a complete wrapper. If title missing → <code>&quot;Untitled Table N&quot;</code>.                                                                                                                                      </td></tr><tr><td data-label="Aspect"> <strong>Normalization Layer</strong>         </td><td data-label="Conceptual Summary"> <code>normalize_table_output(obj)</code> coerces raw HTML, tuple, or dict into <code>(html, title, caption)</code>. Standardizes converters (Markdown, CSV, HTML).                                                                                                                                                                                                </td></tr><tr><td data-label="Aspect"> <strong>Conversion Pipeline</strong>         </td><td data-label="Conceptual Summary"> 1️⃣ Source → 2️⃣ Converter → 3️⃣ <code>convert.normalize</code> → 4️⃣ <code>make_table_wrapper</code> → 5️⃣ <code>html_renderer.inject</code> → 6️⃣ Client ToC build. Deterministic and reversible.                                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Atomic Write & Validation</strong>   </td><td data-label="Conceptual Summary"> <code>core_io.py</code> writes to temp file, validates structure, then renames atomically. Prevents half-written HTML and race conditions.                                                                                                                                                                                                             </td></tr><tr><td data-label="Aspect"> <strong>Diagnostics Mode</strong>            </td><td data-label="Conceptual Summary"> Optional flag logs <code>{index, title, caption_len, valid}</code> to console + <code>diagnostics.log</code>. Enables regression tracking and render metrics.                                                                                                                                                                                                     </td></tr><tr><td data-label="Aspect"> <strong>Typography Preservation</strong>     </td><td data-label="Conceptual Summary"> Semantic tags only (<code>&lt;h3&gt;</code>, <code>&lt;div&gt;</code>, <code>&lt;table&gt;</code>). No inline styles. All visual rhythm resides in CSS. HTML defines hierarchy and meaning only.                                                                                                                                                                                               </td></tr><tr><td data-label="Aspect"> <strong>Structural Validation</strong>       </td><td data-label="Conceptual Summary"> <code>validate_table_structure(html)</code> checks one wrapper per table, proper child nodes, and balanced tags. Triggered pre-commit and CI.                                                                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Accessibility Compliance</strong>    </td><td data-label="Conceptual Summary"> Assign <code>aria-labelledby</code> (title) and <code>aria-describedby</code> (caption) to <code>.table-core</code>. Deterministic <code>id</code> (<code>table-n</code>) ensures unique anchors.                                                                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>SSR Post-Processing Hook</strong>    </td><td data-label="Conceptual Summary"> <code>postprocess_wrappers()</code> runs after render, confirming wrapper integrity and adding metadata for diagnostics or future extensions.                                                                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Benchmark Validation</strong>        </td><td data-label="Conceptual Summary"> Render sample set → visually/structurally compare with Book 9001 → adjust only Python emitters → approve snapshot once alignment ≤ 1 px deviation.                                                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Testing Matrix (Structural)</strong> </td><td data-label="Conceptual Summary"> • <code>.table-wrapper</code> count = <code>&lt;table&gt;</code> count<br>• Each wrapper has <code>.table-title</code>, <code>.table-core</code>, <code>.table-caption</code><br>• <code>data-title</code> matches title<br>• No nested wrappers<br>• HTML5 valid.                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Testing Matrix (Functional)</strong> </td><td data-label="Conceptual Summary"> • ToC enumerates all tables<br>• Anchors scroll correctly<br>• No JS errors<br>• MutationObserver leaves base DOM intact.                                                                                                                                                                                                                   </td></tr><tr><td data-label="Aspect"> <strong>Testing Matrix (Visual)</strong>     </td><td data-label="Conceptual Summary"> • Margins, caption offset, and line height follow Book 9001 grid<br>• <code>h3</code> ≈ 1.25 em baseline<br>• Alignment deviation ≤ 1 px.                                                                                                                                                                                                              </td></tr><tr><td data-label="Aspect"> <strong>Performance</strong>                 </td><td data-label="Conceptual Summary"> Wrapper creation O(1) per table. Benchmark with ≥ 1000 tables. Client uses single querySelectorAll; avoid per-node mutation loops.                                                                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Error Handling</strong>              </td><td data-label="Conceptual Summary"> Missing metadata → auto-fill + warning.<br>I/O failure → abort before rename.<br>Invalid structure → explicit build failure. No silent recovery.                                                                                                                                                                                            </td></tr><tr><td data-label="Aspect"> <strong>Backward Compatibility</strong>      </td><td data-label="Conceptual Summary"> <code>legacy_wrap()</code> detects bare <code>&lt;table&gt;</code> elements, wraps once, logs deprecation. Removed once all legacy pages migrated.                                                                                                                                                                                                                      </td></tr><tr><td data-label="Aspect"> <strong>Security</strong>                    </td><td data-label="Conceptual Summary"> Sanitize external HTML. Escape metadata. Disallow <code>&lt;script&gt;</code> and inline event attributes. Whitelist standard table tags only.                                                                                                                                                                                                               </td></tr><tr><td data-label="Aspect"> <strong>Minimal-Change Policy</strong>       </td><td data-label="Conceptual Summary"> Do not modify table body. Add wrappers and attributes only. Presentation handled by style and JS.                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Aspect"> <strong>Extensibility Roadmap</strong>       </td><td data-label="Conceptual Summary"> Future optional nodes:<br>• <code>.table-actions</code> toolbar (copy/export)<br>• Automatic numbering (“Table 1” etc.)<br>• <code>data-caption-pos</code> support<br>• Localized accessibility strings.                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Public APIs</strong>                 </td><td data-label="Conceptual Summary"> <code>python\nnormalize_table_output(obj) -&gt; Tuple[str,str,str]\nmake_table_wrapper(html,title,caption) -&gt; str\nvalidate_table_structure(html) -&gt; bool\ninject_wrapped_tables_into_page(page_html) -&gt; str\n</code> Located in <code>core_table.py</code> or <code>html_renderer.py</code>.                                                                                   </td></tr><tr><td data-label="Aspect"> <strong>Integration Flow</strong>            </td><td data-label="Conceptual Summary"> <code>core_table</code> → <code>convert.normalize</code> → <code>make_table_wrapper</code> → <code>html_renderer.inject</code> → <code>core_io.atomic_write</code> → Client ToC. Each layer verifiable.                                                                                                                                                                                            </td></tr><tr><td data-label="Aspect"> <strong>Logging & Telemetry</strong>         </td><td data-label="Conceptual Summary"> Emit structured logs <code>{index,title,caption_len,valid,elapsed_ms}</code> to <code>logs/render_tables.json</code>. Enables build-time metrics and anomaly detection.                                                                                                                                                                                           </td></tr><tr><td data-label="Aspect"> <strong>Regression Protection</strong>       </td><td data-label="Conceptual Summary"> Keep HTML snapshots under <code>tests/snapshots/</code>. CI diffs outputs. Build fails on missing wrappers or changed structure.                                                                                                                                                                                                                       </td></tr><tr><td data-label="Aspect"> <strong>Failure Recovery</strong>            </td><td data-label="Conceptual Summary"> On exception, revert to last valid snapshot. Rename incomplete file <code>.broken</code>. Prevent deployment of corrupt builds.                                                                                                                                                                                                                        </td></tr><tr><td data-label="Aspect"> <strong>Documentation</strong>               </td><td data-label="Conceptual Summary"> Update <code>user_guide.md → Table Rendering Flow</code> with wrapper schema, diagnostics flag, and canonical example markup.                                                                                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Operational Checkpoints</strong>     </td><td data-label="Conceptual Summary"> • Pre-commit: run structural validator.<br>• Post-deploy: visual diff vs Book 9001 (screenshot compare).<br>• Deviation > 2 px → auto rollback.                                                                                                                                                                                             </td></tr><tr><td data-label="Aspect"> <strong>Quality Targets</strong>             </td><td data-label="Conceptual Summary"> 100 % wrapper coverage, 0 JS errors, ≤ 1 px typographic drift, atomic I/O integrity verified.                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Aspect"> <strong>Long-Term Plan</strong>              </td><td data-label="Conceptual Summary"> Unify SSR and CSR via a JSON metadata schema describing tables. Client may lazy-load sort/filter modules without DOM changes.                                                                                                                                                                                                               </td></tr><tr><td data-label="Aspect"> <strong>Governance</strong>                  </td><td data-label="Conceptual Summary"> SSR structure → backend lead; CSS typography → design maintainer; ToC logic → frontend. All follow versioned DOM contract.                                                                                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Versioning Policy</strong>           </td><td data-label="Conceptual Summary"> <code>WRAPPER_SCHEMA_VERSION = 2.0</code> in <code>core_table.py</code>. Increment only for breaking DOM changes. Client checks via <code>data-schema-version</code>.                                                                                                                                                                                                        </td></tr><tr><td data-label="Aspect"> <strong>Acceptance Criteria</strong>         </td><td data-label="Conceptual Summary"> ✅ All tables wrapped<br>✅ Anchors + ToC valid<br>✅ Typography matches benchmark<br>✅ Atomic + CI tests pass<br>✅ SSR/CSR parity confirmed.                                                                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Summary Directive</strong>           </td><td data-label="Conceptual Summary"> SSR defines canonical DOM. CSR augments only. CSS enforces rhythm. Book 9001 is validation source. Alignment of these four layers guarantees stable, predictable table rendering across all modes.                                                                                                                                          </td></tr></tbody></table></div><div class="row-count">Rows: 39</div></div><div class="table-caption" id="Table9" data-table="Book_8030_09" style="margin-top:2mm;margin-left:3mm;"><strong>Table 9</strong></div>
<div class="table-wrapper" data-table-id="table-9"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Aspect**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Aspect</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Summary**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Summary</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> <strong>Goal</strong>                    </td><td data-label="Conceptual Summary"> Enforce benchmark-grade, deterministic typography and structural consistency for all rendered tables across <strong>SSR</strong> (Python modules) and <strong>CSR</strong> (client JS). The objective is full structural, behavioral, and visual parity with <strong>Book 9001</strong> typography.                                                         </td></tr><tr><td data-label="Aspect"> <strong>Core Problem</strong>            </td><td data-label="Conceptual Summary"> Client logic depends on <code>.table-wrapper</code>, <code>.table-title</code>, <code>.table-caption</code>, and <code>.table-core</code>. SSR inconsistencies break anchors, ToC generation, spacing rhythm, and navigation.                                                                                                                                    </td></tr><tr><td data-label="Aspect"> <strong>Design Doctrine</strong>         </td><td data-label="Conceptual Summary"> The DOM contract is sacred. SSR emits complete wrapper structures. CSR enhances but never reconstructs. Missing or malformed nodes are SSR defects.                                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Typography Benchmark</strong>    </td><td data-label="Conceptual Summary"> [Book 9001](https://github.com/adiskurniawan/ChapterSummaries_2.0/raw/refs/heads/main/summaries/Book_9001.html) defines the typographic grid: rhythm, header scale, and caption offset. CSS is immutable; structure correction occurs only in Python.                                                                </td></tr><tr><td data-label="Aspect"> <strong>SSR Components</strong>          </td><td data-label="Conceptual Summary"> <code>html_renderer.py</code> injects wrappers into templates.<br><code>render/core_table.py</code> assembles <code>(html, title, caption)</code> and constructs wrapper blocks.<br><code>render/convert.py</code> normalizes converter outputs.<br><code>server.py</code> ensures uniformity across composed pages.                                                        </td></tr><tr><td data-label="Aspect"> <strong>CSR Components</strong>          </td><td data-label="Conceptual Summary"> <code>assets/script.table.js</code> scans <code>.table-wrapper</code> elements to build ToC and anchors.<br><code>assets/style.css</code> defines margins and rhythm. Locked reference file; baseline validation only.                                                                                                                                </td></tr><tr><td data-label="Aspect"> <strong>SSR ↔ CSR Contract</strong>      </td><td data-label="Conceptual Summary"> <strong>Server Output:</strong> <code>&lt;div class=&quot;table-wrapper&quot; data-title=&quot;…&quot;&gt;</code> → child nodes: <code>&lt;h3 class=&quot;table-title&quot;&gt;</code>, <code>&lt;div class=&quot;table-caption&quot;&gt;</code>, <code>&lt;div class=&quot;table-core&quot;&gt;</code>. Escaped metadata, trusted table body.<br><strong>Client Expectation:</strong> DOM matches schema; CSR adds anchors, numbering, ToC. No DOM healing allowed. </td></tr><tr><td data-label="Aspect"> <strong>Wrapper Constructor</strong>     </td><td data-label="Conceptual Summary"> <code>make_table_wrapper(html, title, caption)</code> forms valid block with escaped metadata and deterministic <code>id</code>. Missing titles become <code>Untitled Table N</code>.                                                                                                                                                                 </td></tr><tr><td data-label="Aspect"> <strong>Normalization Layer</strong>     </td><td data-label="Conceptual Summary"> <code>normalize_table_output(obj)</code> guarantees canonical <code>(html, title, caption)</code> regardless of input type (Markdown, CSV, HTML).                                                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Processing Chain</strong>        </td><td data-label="Conceptual Summary"> ① Parse → ② Normalize → ③ Wrap → ④ Inject → ⑤ Write → ⑥ Enhance. Each stage isolated, reversible, and testable.                                                                                                                                                                                                      </td></tr><tr><td data-label="Aspect"> <strong>Atomic Write</strong>            </td><td data-label="Conceptual Summary"> <code>render/core_io.py</code> performs memory render → validation → atomic rename. Prevents partial or corrupted outputs.                                                                                                                                                                                                      </td></tr><tr><td data-label="Aspect"> <strong>Diagnostics Mode</strong>        </td><td data-label="Conceptual Summary"> Optional flag logs per-table index, title, caption length, validity, and render duration to console and <code>diagnostics.log</code>.                                                                                                                                                                                           </td></tr><tr><td data-label="Aspect"> <strong>Semantic HTML</strong>           </td><td data-label="Conceptual Summary"> Use only <code>&lt;h3&gt;</code>, <code>&lt;div&gt;</code>, and <code>&lt;table&gt;</code>. No inline CSS. All presentation governed by stylesheet.                                                                                                                                                                                                                     </td></tr><tr><td data-label="Aspect"> <strong>Validation Function</strong>     </td><td data-label="Conceptual Summary"> <code>validate_table_structure(html)</code> checks wrapper presence, tag counts, and node completeness. Errors abort build.                                                                                                                                                                                                     </td></tr><tr><td data-label="Aspect"> <strong>Accessibility Layer</strong>     </td><td data-label="Conceptual Summary"> Apply <code>aria-labelledby</code> and <code>aria-describedby</code> linking titles and captions to <code>.table-core</code>. Deterministic IDs prevent collisions.                                                                                                                                                                                   </td></tr><tr><td data-label="Aspect"> <strong>Post-Build Verification</strong> </td><td data-label="Conceptual Summary"> <code>postprocess_wrappers()</code> rescans document after SSR assembly to confirm schema integrity before commit.                                                                                                                                                                                                              </td></tr><tr><td data-label="Aspect"> <strong>Benchmark Loop</strong>          </td><td data-label="Conceptual Summary"> 1️⃣ Render test pages → 2️⃣ Compare with Book 9001 → 3️⃣ Adjust SSR files only → 4️⃣ Lock snapshot after parity.                                                                                                                                                                                                     </td></tr><tr><td data-label="Aspect"> <strong>Structural Tests</strong>        </td><td data-label="Conceptual Summary"> <code>.table-wrapper</code> count equals <code>&lt;table&gt;</code> count.<br>Each wrapper has title, caption, core.<br>No nested wrappers.<br>HTML5 valid.                                                                                                                                                                                      </td></tr><tr><td data-label="Aspect"> <strong>Functional Tests</strong>        </td><td data-label="Conceptual Summary"> ToC enumerates all titles.<br>Anchors scroll correctly.<br>No JS errors.<br>MutationObserver does not alter base HTML.                                                                                                                                                                                               </td></tr><tr><td data-label="Aspect"> <strong>Visual Tests</strong>            </td><td data-label="Conceptual Summary"> Title and caption spacing match benchmark (±1 px).<br>Alignment and line height consistent.<br>Header hierarchy preserved.                                                                                                                                                                                           </td></tr><tr><td data-label="Aspect"> <strong>Performance Rule</strong>        </td><td data-label="Conceptual Summary"> O(1) wrapping per table; client scans once via <code>querySelectorAll</code>. Large-page benchmark > 1000 tables shows negligible delay.                                                                                                                                                                                        </td></tr><tr><td data-label="Aspect"> <strong>Error Discipline</strong>        </td><td data-label="Conceptual Summary"> Missing metadata → default + warning.<br>I/O error → abort safely.<br>Structural error → fail fast. No silent repair.                                                                                                                                                                                                </td></tr><tr><td data-label="Aspect"> <strong>Legacy Handling</strong>         </td><td data-label="Conceptual Summary"> <code>legacy_wrap()</code> detects bare <code>&lt;table&gt;</code>, wraps once, logs deprecation. Transitional only.                                                                                                                                                                                                                             </td></tr><tr><td data-label="Aspect"> <strong>Security</strong>                </td><td data-label="Conceptual Summary"> Sanitize external HTML before wrapping. Escape attributes. Whitelist table-related tags only. Block inline scripts.                                                                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Minimal Change Rule</strong>     </td><td data-label="Conceptual Summary"> SSR never alters table data. It wraps and labels only. CSS and JS define all appearance and behavior.                                                                                                                                                                                                                </td></tr><tr><td data-label="Aspect"> <strong>Extensibility Hooks</strong>     </td><td data-label="Conceptual Summary"> Future: <code>.table-actions</code> (copy/download), numbered prefixes, alternate caption placement, localized strings.                                                                                                                                                                                                         </td></tr><tr><td data-label="Aspect"> <strong>Public APIs</strong>             </td><td data-label="Conceptual Summary"> <code>normalize_table_output(obj)→tuple</code><br><code>make_table_wrapper(html,title,caption)→str</code><br><code>validate_table_structure(html)→bool</code><br><code>inject_wrapped_tables_into_page(page_html)→str</code>.                                                                                                                                    </td></tr><tr><td data-label="Aspect"> <strong>Integration Flow</strong>        </td><td data-label="Conceptual Summary"> <code>core_table</code> → <code>convert</code> → <code>make_table_wrapper</code> → <code>html_renderer</code> → <code>core_io</code>. Verified per stage.                                                                                                                                                                                                                   </td></tr><tr><td data-label="Aspect"> <strong>Logging Schema</strong>          </td><td data-label="Conceptual Summary"> Structured JSON logs <code>{index, title, caption_len, valid, elapsed_ms}</code> in <code>logs/render_tables.json</code>.                                                                                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Regression Control</strong>      </td><td data-label="Conceptual Summary"> Snapshot diffs in <code>tests/snapshots/</code>. CI fails on wrapper count or tag deviation.                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Aspect"> <strong>Recovery Path</strong>           </td><td data-label="Conceptual Summary"> On failure, revert to last good snapshot; rename bad file <code>.broken</code> for audit.                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Aspect"> <strong>Documentation Update</strong>    </td><td data-label="Conceptual Summary"> Extend <code>user_guide.md</code> → “Table Rendering Flow” with schema diagram, diagnostics usage, and canonical HTML snippet.                                                                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Operational Gates</strong>       </td><td data-label="Conceptual Summary"> Pre-commit validator → post-deploy visual diff vs Book 9001. Δ > 2 px triggers rollback.                                                                                                                                                                                                                             </td></tr><tr><td data-label="Aspect"> <strong>QA Targets</strong>              </td><td data-label="Conceptual Summary"> 100 % wrapper compliance, 0 JS errors, ≤ 1 px deviation, atomic writes verified each build.                                                                                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Maintenance Strategy</strong>    </td><td data-label="Conceptual Summary"> Evolve toward shared JSON metadata schema. Enable client modules (filter, sort) without DOM change.                                                                                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Governance</strong>              </td><td data-label="Conceptual Summary"> SSR: backend owner.<br>CSS: design owner.<br>JS ToC: front-end owner. Contract versioning enforced.                                                                                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Version Control</strong>         </td><td data-label="Conceptual Summary"> <code>WRAPPER_SCHEMA_VERSION = 2.0</code> in <code>core_table.py</code>; client reads <code>data-schema-version</code> to ensure sync.                                                                                                                                                                                                                </td></tr><tr><td data-label="Aspect"> <strong>Acceptance Tests</strong>        </td><td data-label="Conceptual Summary"> ✅ Complete wrappers<br>✅ ToC and anchors valid<br>✅ Typography aligned<br>✅ Atomic file writes<br>✅ No schema drift.                                                                                                                                                                                                 </td></tr><tr><td data-label="Aspect"> <strong>Directive Summary</strong>       </td><td data-label="Conceptual Summary"> SSR defines structure, CSR enhances, CSS fixes rhythm, Book 9001 certifies result. Alignment of these four ensures deterministic typography and robust navigation for all PasteToTable outputs.                                                                                                                      </td></tr></tbody></table></div><div class="row-count">Rows: 39</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>