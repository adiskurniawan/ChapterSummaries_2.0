<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1767518032">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Docu_0166_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **User Guide Depreciation**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>User Guide Depreciation</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="User Guide Depreciation"> <strong>Overview / Purpose</strong><br>Comprehensive technical manual for the Ortax Depreciation Calculator Excel workbook (reproduction of kalkulator.ortax.org/penyusutan). Purpose: provide a single authoritative reference documenting every input field, unit conventions, required sheets, calculation flow (monthly ↔ fiscal-year aggregation), validation rules, rounding & precision rules, disposal/revaluation handling, treatment of SL vs DB methods, example QA cases, integration mapping (CSV/JSON), macro vs formula design decisions, performance guidance, security & PII controls, changelog/versioning, and handover deliverables for accountants, tax engineers, and system integrators. Reference regulatory basis: PMK and Income Tax rules applicable to fiscal depreciation (document effective versions in <code>metadata</code>). </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Canonical data model & sheet names</strong><br>Define canonical sheets and purpose: <code>tbl_assets</code> (asset master), <code>tbl_rates</code> (asset group → life years → SL/DB rates and effective dates), <code>inputs</code> (workbook-level inputs: fiscal year end, default acquisition policy), <code>schedule</code> (fiscal-year schedule per asset), <code>journal_entries</code> (recommended journal lines), <code>reporting</code> (printable summaries), <code>qa</code> (testcases), <code>metadata</code> (definitions, versions, owner), <code>changelog</code>, <code>instructions</code>. Requirement: each data sheet must include a header row and be converted to an Excel Table with <code>tbl_</code> prefix (e.g., <code>tbl_assets</code>) to enable structured references and reduce formula errors. Document sheet purpose and required columns in <code>metadata</code>. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Primary key & identity rules</strong><br><code>asset_id</code> is the canonical primary key used to join across sheets (text type to preserve leading zeros). <code>asset_id</code> must be unique; duplicate detection required on import. Secondary identifiers: <code>serial_no</code> (optional), <code>invoice_ref</code>. Use text type for <code>asset_id</code> in CSV exports to avoid numeric coercion. When assets are imported from multiple systems, provide <code>source_system</code> and <code>source_id</code> columns to retain provenance. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Monetary conventions & units</strong><br>Currency: Indonesian Rupiah (IDR). Unit: integer rupiah (no cents). Store all monetary fields as numeric values (Excel number) and format with Accounting/IDR for display. Label every header with unit annotation and periodicity (e.g., <code>(cost, IDR)</code>, <code>(annual, IDR)</code>, <code>(monthly, IDR)</code>). For internal intermediate calculations allow unrounded floating values but round final reported monetary fields (annual depreciation, carrying value) to nearest rupiah using round-half-up. Document rounding points in <code>metadata</code>. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>tbl_assets (sheet) - purpose & required columns</strong><br>Sheet name: <code>tbl_assets</code>.<br>Required columns: <code>asset_id</code> (PK), <code>description</code>, <code>asset_type</code> (tangible/intangible/building), <code>asset_group</code> (FK → tbl_rates.group_id), <code>acquisition_date</code> (YYYY-MM-DD), <code>acquisition_cost</code> (IDR), <code>initial_accum_depr</code> (IDR; optional, for legacy assets), <code>useful_life_years</code> (optional override), <code>residual_value</code> (IDR, optional), <code>service_start_month</code> (1–12, optional override), <code>disposed_flag</code> (TRUE/FALSE), <code>disposal_date</code> (if disposed), <code>disposal_proceeds</code> (IDR).<br>Optional: <code>location</code>, <code>department</code>, <code>vendor</code>, <code>invoice_ref</code>, <code>source_system</code>, <code>source_id</code>. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>tbl_assets - field rules & validation</strong><br><code>asset_id</code> required and unique.<br><code>acquisition_date</code> required and must be a valid ISO date ≤ workbook run date (or flagged if future). <code>acquisition_cost</code> must be >= 0 and integer. <code>asset_group</code> must map to a valid row in <code>tbl_rates</code>. <code>service_start_month</code> if omitted defaults to acquisition month. <code>residual_value</code> default = 0 unless policy permits salvage; if >0 document rationale. <code>disposed_flag = TRUE</code> must have <code>disposal_date</code> and <code>disposal_proceeds</code> present. Use data validation lists, and conditional formatting to highlight missing or invalid entries; record a <code>validation_flag</code> column with machine-readable codes. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>tbl_rates (sheet) - purpose & structure</strong><br>Sheet: <code>tbl_rates</code> holds asset classification and depreciation parameters (source: PMK or local policy). Required columns: <code>group_id</code>, <code>group_name</code>, <code>life_years</code>, <code>sl_rate_pct</code>, <code>db_rate_pct</code>, <code>method_allowed</code> (<code>SL</code>, <code>DB</code>, or <code>Both</code>), <code>effective_from</code>, <code>effective_to</code>, <code>notes</code>. Do not hardcode rates in formulas—always lookup from <code>tbl_rates</code> with <code>XLOOKUP</code>/<code>INDEX-MATCH</code> or structured references so rates can be versioned. Maintain effective dates to compute historical schedules. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Assumptions & regulatory basis</strong><br>Document the tax/regulatory rules implemented (e.g., PMK-72/2023 groups, month counting rule that acquisition month counts as month 1 for depreciation, DB as double-declining where applicable). Include a <code>regulation_reference</code> field in <code>metadata</code> with citation and effective date; keep copies in <code>changelog</code> when guidance changes. State explicit assumptions: e.g., no market revaluations applied, salvage value tax treatment (typically ignored unless specified), whether installations/commissioning months count. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Service start & month counting rules</strong><br>Default rule implemented: depreciation begins in the month of acquisition (the acquisition month counts as the first month in service). Total months = <code>life_years * 12</code>. For partial months use whole-month counting—i.e., an asset acquired any day in month M is considered in service for month M. Allow a <code>prorate_by_days</code> mode as alternate policy, but make it configurable and documented in <code>metadata</code>. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Calculation flow (monthly → fiscal-year aggregation)</strong><br>1) Enumerate each month of the asset's useful life starting from <code>service_start_month</code>. <br>2) Assign each month to a fiscal year determined by <code>fiscal_year_end_month</code> in <code>inputs</code> (e.g., FY label = year in which fiscal year ends). <br>3) Aggregate months per fiscal year to compute months_in_fy for that asset-FY pair. <br>4) Compute SL monthly = <code>acquisition_cost / (life_years * 12)</code>. FY SL = monthly * months_in_fy. <br>5) Compute DB on fiscal-year basis using DB annual rate prorated by months: FY DB = <code>carrying_value_start_of_FY * db_rate * (months_in_fy/12)</code>. <br>6) Ensure depreciation does not reduce carrying value below residual value or negative; cap FY depreciation accordingly. <br>7) Update carrying values and accumulated depreciation at FY end. Persist per-FY rows in <code>schedule</code>. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>schedule (sheet) - layout & essential columns</strong><br>Sheet: <code>schedule</code> (table <code>tbl_schedule</code>) should include one row per <code>asset_id</code> × <code>fiscal_year</code> with: <code>asset_id</code>, <code>FY_end_year</code> (label), <code>months_in_fy</code>, <code>depr_method_used</code> (SL/DB), <code>depr_amount_fy</code> (IDR), <code>accum_depr_beg</code> (IDR), <code>accum_depr_end</code> (IDR), <code>carrying_value_beg</code> (IDR), <code>carrying_value_end</code> (IDR), <code>residual_value_applied</code> (IDR), <code>notes</code> (e.g., proration or disposal). Include hidden debug columns for month-level schedule if needed (<code>month_list</code>, <code>month_counts</code>). Provide <code>tbl_schedule</code> filters to extract assets by FY, department, or status. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>SL vs DB specifics & formula snippets</strong><br>SL annual rate = <code>100 / life_years</code> (%) and monthly = <code>cost / (life_years*12)</code>. DB annual rate typically = <code>2 * SL_rate</code> (double declining) or as specified in <code>tbl_rates</code>. For prorated FY, apply DB as: <code>DB_FY = carrying_beg * db_rate * (months_in_fy / 12)</code>. On final year ensure <code>accum_depr_end = cost - residual_value</code> (do not over-depreciate). For Excel formula-only implementations, compute month counts per FY with <code>SUMPRODUCT</code> on a month-index array or use Power Query to expand months then pivot. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Disposal & revaluation handling</strong><br>If <code>disposed_flag = TRUE</code>, schedule ceases at month of disposal. Compute disposal gain/loss = <code>disposal_proceeds - carrying_value_at_disposal</code>. Record disposal FY row with <code>disposal_proceeds</code>, <code>gain_loss</code>, and set <code>carrying_value_end = 0</code>. If revaluation or impairment is required, record manual override columns (<code>manual_accum_depr_adjustment</code>) and require approver sign-off recorded in <code>tbl_assets</code> audit columns. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Residual / salvage policy</strong><br>If policy uses residual value, store <code>residual_value</code> in <code>tbl_assets</code>. Cap depreciation such that <code>carrying_value_end &gt;= residual_value</code>. If the tax regulation disallows residual value, set <code>residual_value = 0</code> and document in <code>metadata</code>. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Rounding & precision policy</strong><br>Round monetary values to the nearest rupiah at agreed aggregation points. Recommended policy: keep unrounded intermediate computations (hidden) but round FY depreciation and carrying values reported in <code>schedule</code> to nearest IDR using round-half-up. Store both <code>depr_amount_fy_unrounded</code> (hidden) and <code>depr_amount_fy</code> (rounded) for audit. Document rounding policy (when and where rounding occurs) in <code>metadata</code>. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Validation & data-quality rules</strong><br>Automated validations: required fields present, <code>acquisition_cost &gt;= 0</code>, <code>life_years &gt; 0</code>, <code>asset_group</code> maps to <code>tbl_rates</code>, <code>acquisition_date</code> valid, <code>service_start_month</code> 1–12, <code>disposed_flag</code> consistent with disposal fields. Flag negative carrying values, months_in_fy > 12 errors, and mismatched rates. Implement a <code>validation_flag</code> and <code>validation_message</code> column on <code>tbl_assets</code> and a summary <code>validation_report</code> that lists all failure types. Use Excel Data Validation lists and conditional formatting for quick visual checks. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>QA test suite & expected cases</strong><br>Create <code>qa</code> sheet with unit tests (rows): Case ID, description, inputs (acq date, cost, group, method, fiscal_end_month), expected schedule (per FY depreciation, accum, carry end), actual result, difference, pass/fail (tolerance 1 IDR). Include test cases: full-year acquisition (Jan 1), mid-year acquisition (e.g., Jun 15), end-of-life truncation, disposal mid-year, zero cost, DB vs SL comparison, life override, residual non-zero. Capture expected formulas and sample calculations to demonstrate parity with Ortax online calculator. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Import / Export rules (CSV & XLSX)</strong><br>CSV encoding: UTF-8 (BOM optional for Excel). Required header row and exact column names matching canonical <code>tbl_</code> columns. Preserve <code>asset_id</code> as quoted text. Date format ISO 8601 (YYYY-MM-DD). Monetary fields must be plain digits (no currency symbols). Provide export modes: <code>value-only</code> (no formulas) and <code>formula-enabled</code>. Include a companion <code>metadata.json</code> or <code>metadata</code> sheet detailing units, fiscal year settings, and version of <code>tbl_rates</code>. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>API / DB mapping guidance</strong><br>Recommended JSON payload schema aligns with <code>tbl_assets</code> fields: e.g., <code>{ &quot;asset_id&quot;: &quot;...&quot;, &quot;description&quot;: &quot;...&quot;, &quot;acquisition_date&quot;: &quot;YYYY-MM-DD&quot;, &quot;acquisition_cost&quot;: 123456, &quot;asset_group&quot;: &quot;2&quot;, ... }</code>. Use ISO 8601 for dates. Provide an ingestion checklist: validate mapping, coerce <code>asset_id</code> to text, parse and validate <code>acquisition_date</code>, coerce month fields to numeric 1–12, and confirm <code>asset_group</code> exists. Document sample request/response examples in <code>metadata</code>. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Macro vs Formula design & performance guidance</strong><br>For large datasets (>5000 assets) avoid heavy volatile formulas that recalculate on every edit. Implement month expansion, aggregation, and iteration-heavy logic (DB carrying updates) via a macro or server-side script (Python/Power Query or VBA) that writes values into <code>tbl_schedule</code>. Recommend workbook calculation = Manual during batch runs; provide a single <code>RecomputeAll</code> macro that: validates inputs, clears schedules, computes schedule in a single pass, writes results, and produces a <code>run_report</code>. For auditability, macros must log start/end time, rows processed, and errors to <code>metadata.execution_log</code>. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Iterations & convergence (if any)</strong><br>DB and SL do not require iterative convergence. If implementing alternate workflows (e.g., split cost allocations, gross-ups for tax-driven capitalisation) that do require iteration, document numeric method, bounds, iteration cap, and convergence flag. Persist iteration metadata (<code>iterations</code>, <code>converged</code>) in <code>tbl_schedule</code> or <code>metadata</code>. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Journal entries & accounting mapping</strong><br>Provide <code>journal_entries</code> sheet with template journal lines for posting: <code>journal_id</code>, <code>asset_id</code>, <code>date</code>, <code>account_debit</code>, <code>account_credit</code>, <code>amount</code>, <code>narrative</code>, <code>posting_status</code>. Typical entries: monthly/fiscal depreciation expense (debit) and accumulated depreciation (credit) on FY aggregation or periodic posting. Provide mapping examples for major GL systems (SAP/Oracle/QuickBooks) in <code>metadata</code>. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Reporting & printable deliverables</strong><br><code>reporting</code> sheet should present per-asset and aggregated views: asset summary (asset_id, description, cost, life_years, accumulated_depr, carrying_value), FY summary (total depreciation by department or GL account), and disposal report. For submission/audit create <code>reporting_value_only</code> that is a copy-paste of values to avoid recomputation. Include a printable layout with company header, run date, and version tag. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Changelog & version control</strong><br><code>changelog</code> sheet must capture <code>date</code>, <code>author</code>, <code>change_summary</code>, <code>affected_sheets</code>, <code>version_tag</code>, and <code>regulatory_reference</code>. Update whenever <code>tbl_rates</code>, <code>metadata</code> policy, or calculation formulas change. Archive prior workbook versions (zip) and retain per-change QA snapshots. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Error handling & human messages</strong><br>Standardize error codes/messages in <code>metadata</code> (e.g., <code>E01: MISSING_COST</code>, <code>E02: INVALID_DATE</code>, <code>W01: PRORATE_ASSUMPTION_USED</code>). Populate <code>notes</code> columns in <code>tbl_schedule</code> and <code>tbl_assets</code> with human-readable reasons and suggested fixes. Provide a <code>validation_report</code> that aggregates errors and recommended remediations. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Security, privacy & PII handling</strong><br>Asset data may be sensitive (e.g., vendor invoices). Protect files with encryption and restrict edit permissions. Mask vendor bank or invoice details in exports unless required. Maintain <code>metadata.execution_log</code> with run user and timestamp. Digitally sign macros and document required macro security settings. Ensure backups are retained per corporate retention policy. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>QA acceptance criteria</strong><br>Before handover require: all <code>qa</code> cases pass (tolerance 1 IDR), no unresolved <code>validation_flag</code> records, <code>tbl_rates</code> populated with effective dates, <code>metadata</code> contains owner and version, and <code>changelog</code> entry created for this release. Run parallel comparison with Ortax online calculator for representative assets (include sample assets in <code>qa</code> sheet and attach comparison outputs). </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Troubleshooting checklist</strong><br>If numbers differ from Ortax site: verify <code>tbl_rates</code> matches regulatory rates and effective dates; confirm month counting (acquisition month counted); check fiscal year end setting in <code>inputs</code>; verify whether residual values or manual adjustments exist; ensure rounded vs unrounded values and aggregation order match Ortax method; re-run <code>qa</code> cases to localize differences. For disposal discrepancies, confirm disposal date inclusion rule (month counted or excluded). </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Automation & scheduled processing</strong><br>For recurring processing implement a server batch that: imports validated CSV/JSON, runs the calculation engine (Python/VBA/Power Query), writes <code>tbl_schedule</code>, exports reports (value-only XLSX/CSV), and archives inputs/outputs. Record schedule details (cron, owner, contacts) in <code>metadata</code>. Prefer server engine for scale and deterministic logs; use Excel only for small/interactive runs. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Delivery & handover checklist</strong><br>Deliverables: workbook with named tables and protected calculation regions, <code>tbl_rates</code> filled and versioned, <code>metadata</code> with owner and run instructions, <code>qa</code> sheet with passing cases, <code>instructions</code> sheet with runbook and formula descriptions, <code>reporting</code> templates, macro code (if .xlsm) documented and signed, sample import/export JSON schema, and an acceptance test run output. Provide README with step-by-step run instructions and a short acceptance run demonstrating outputs for representative sample assets. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Governance & change approval</strong><br>Designate owners for <code>tbl_rates</code> updates and rounding policy changes. Require approval and a <code>changelog</code> entry before applying new rate tables or policy changes. Preserve pre- and post-change outputs and QA snapshots for audit. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Auditability & traceability</strong><br>Persist per-asset computation metadata: <code>input_snapshot</code> (copy of original asset row), <code>depr_algorithm_version</code> (tag), <code>tbl_rates_version</code>, <code>run_id</code>, and <code>execution_log</code>. Keep hidden columns for unrounded intermediate values and month-level details to enable independent recalculation. Provide an audit export that contains all intermediate fields. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>User guidance & help text</strong><br>Populate header-row help strings or a <code>README</code>/<code>instructions</code> sheet explaining each column, data type, expected ranges, and examples. Add cell comments/tooltips on critical fields (e.g., <code>asset_group</code>, <code>acquisition_date</code>, <code>residual_value</code>). Direct users to <code>qa</code> examples and the troubleshooting checklist before filing support requests. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Appendix: recommended workbook hygiene</strong><br>Protect calculation sheets, leave input sheets editable. Use named ranges for critical parameters (<code>fiscal_end_month</code>, <code>default_residual_policy</code>, <code>rates_version</code>). Keep a read-only distribution copy and a master editable copy. Sign macros and maintain macro documentation. Back up and archive versions on each update. Include a maintenance window and change approval workflow in <code>metadata</code>. </td></tr><tr><td data-label="User Guide Depreciation"> <strong>Contact & ownership</strong><br>Record the calculator owner in <code>metadata</code> with name, role, and contact email. Include escalation paths for regulatory clarifications and a designated approver for <code>tbl_rates</code> and <code>metadata</code> changes. Provide an operational contact for scheduled batch runs and a support SLA. </td></tr></tbody></table></div><div class="row-count">Rows: 35</div></div><div class="table-caption" id="Table2" data-table="Docu_0166_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **User Guide — Fixed Asset Depreciation**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>User Guide — Fixed Asset Depreciation</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="User Guide — Fixed Asset Depreciation"> <strong>1. What this thing does — simple</strong><br>This workbook turns a list of your assets (computers, machines, buildings) into a year-by-year depreciation table. It works on a fiscal-year basis (you pick which month your fiscal year ends). There are two pieces: a full calculator (VBA macro <code>RecomputeAll</code>) and a safe preview (Power Query) that only does straight-line. </td></tr><tr><td data-label="User Guide — Fixed Asset Depreciation"> <strong>2. The sheets (what you must have)</strong><br>Think of each sheet as a form you must fill: <br>• <code>tbl_assets</code> — one row per asset. Must include <code>asset_id</code>, <code>acquisition_date</code>, <code>acquisition_cost</code>, and <code>asset_group</code>. Other columns are optional but recommended. <br>• <code>tbl_rates</code> — rules by asset group (life in years, allowed methods, effective dates). <br>• <code>tbl_inputs</code> — one row with workbook settings (e.g., fiscal year end month). <br>Optional helpful sheets: <code>tbl_schedule</code> (output), <code>validation_report</code> (errors), <code>tbl_changelog</code> (run log). </td></tr><tr><td data-label="User Guide — Fixed Asset Depreciation"> <strong>3. How to fill <code>tbl_assets</code> — plain rules</strong><br>For each asset row: <br>• <code>asset_id</code> — required and unique (text). <br>• <code>acquisition_date</code> — required (use YYYY-MM-DD). <br>• <code>acquisition_cost</code> — required (number, >= 0). <br>• <code>asset_group</code> — required (must match <code>tbl_rates.group_id</code>). <br>• <code>useful_life_years</code> — optional (if blank, system uses <code>tbl_rates</code>). <br>• If you mark <code>disposed_flag = TRUE</code>, you must fill <code>disposal_date</code> and <code>disposal_proceeds</code>. </td></tr><tr><td data-label="User Guide — Fixed Asset Depreciation"> <strong>4. What <code>tbl_rates</code> must contain — plain</strong><br><code>tbl_rates</code> tells the system how long assets live and which method to use. Each row should have: <code>group_id</code>, <code>effective_from</code>, <code>effective_to</code>, <code>life_years</code>, <code>method_allowed</code> (<code>SL</code>, <code>DB</code>, or <code>BOTH</code>). If you don’t supply life there, add it per asset. Keep date ranges correct so acquisitions pick the right rule. </td></tr><tr><td data-label="User Guide — Fixed Asset Depreciation"> <strong>5. The simple math — SL (Straight-Line) explained</strong><br>Steps: <br>1) Find cost and life in years. <br>2) Monthly depreciation = cost ÷ (life_years × 12). <br>3) For each fiscal year, count how many months of service fall in that FY (months_in_fy). <br>4) FY depreciation = monthly × months_in_fy. <br>5) Round only after the FY total. Do not let carrying value fall below residual value. </td></tr><tr><td data-label="User Guide — Fixed Asset Depreciation"> <strong>6. The simple math — DB (Declining Balance) explained</strong><br>Steps: <br>1) Find carrying value at the start of the fiscal year (cost minus accumulated depreciation). <br>2) Annual DB rate = <code>db_rate_pct / 100</code> or <code>2 / life_years</code> if not provided. <br>3) FY depreciation = carrying_start × annual_rate × (months_in_fy / 12). <br>4) Cap so carrying value never goes below residual. DB is calculated per fiscal year (we do not do monthly DB here). </td></tr><tr><td data-label="User Guide — Fixed Asset Depreciation"> <strong>7. Fiscal year assignment — how months map to FY</strong><br>Pick <code>fiscal_year_end_month</code> in <code>tbl_inputs</code> (1 = Jan, 12 = Dec typical). Example: If fiscal year ends March (3): January and February count in FY of that same calendar year; April counts in the next FY. The code uses the month to group months into FY labels. </td></tr><tr><td data-label="User Guide — Fixed Asset Depreciation"> <strong>8. Disposal — what happens when an asset is sold</strong><br>If <code>disposed_flag = TRUE</code> and <code>disposal_date</code> is set: <br>• Depreciation is included up to the disposal month. <br>• The system computes carrying value before disposal. <br>• Gain/loss = disposal_proceeds − carrying_before_disposal. <br>• After disposal the asset is removed (carrying = 0, accum_depr = cost). No more rows are created after disposal. </td></tr><tr><td data-label="User Guide — Fixed Asset Depreciation"> <strong>9. Validation — what the system checks and what to fix</strong><br>Before it runs the calculator checks for common mistakes: missing <code>asset_id</code>, invalid dates, negative cost, missing life info, disposal missing date/proceeds, duplicate IDs. If there are errors the macro stops and writes problems into <code>validation_report</code>. Fix the flagged rows, then run again. </td></tr><tr><td data-label="User Guide — Fixed Asset Depreciation"> <strong>10. Outputs — what you will see in <code>tbl_schedule</code></strong><br>Each row = one asset for one fiscal year. Key columns you’ll get: <code>asset_id</code>, <code>FY_end_year</code>, <code>months_in_fy</code>, <code>depr_method_used</code>, <code>depr_amount_fy</code> (rounded), <code>depr_amount_fy_unrounded</code> (audit), <code>accum_depr_beg</code>, <code>accum_depr_end</code>, <code>carrying_value_beg</code>, <code>carrying_value_end</code>, plus disposal columns if needed. Use filters to look up one asset or one FY. </td></tr><tr><td data-label="User Guide — Fixed Asset Depreciation"> <strong>11. Power Query (PQ) — what it is and when to use it</strong><br>Power Query provides a safe preview. It: always uses Straight-Line; does not compute disposal gain/loss; will not change your workbook data; is good for quick reporting and checks. Use PQ when you just want to see results without running the macro. </td></tr><tr><td data-label="User Guide — Fixed Asset Depreciation"> <strong>12. How to run the macro — exact steps</strong><br>1) Save your workbook (always). <br>2) Make sure <code>tbl_assets</code>, <code>tbl_rates</code>, <code>tbl_inputs</code> exist and are filled. <br>3) Press <strong>Alt+F8</strong>, choose <code>RecomputeAll</code>, then click <strong>Run</strong>. OR use Developer → Macros → select <code>RecomputeAll</code> → Run. <br>4) After it finishes, open <code>tbl_schedule</code> to review and <code>validation_report</code> if there were issues. If it errors, fix validation issues and run again. </td></tr><tr><td data-label="User Guide — Fixed Asset Depreciation"> <strong>13. Simple examples — two quick worked numbers</strong><br>Example A (SL): Cost = 12,000; life = 2 years → monthly = 12,000 ÷ 24 = 500. If 6 months fall in FY, FY depreciation = 500 × 6 = 3,000. <br>Example B (DB): Cost = 12,000; life = 2 years → default annual rate = 2/2 = 1.0 (100%). If carrying at FY start is 12,000 and months_in_fy = 6 → FY DB = 12,000 × 1.0 × (6/12) = 6,000. (DB reduces carrying faster; system enforces residual floor.) </td></tr><tr><td data-label="User Guide — Fixed Asset Depreciation"> <strong>14. Common mistakes and fixes (quick)</strong><br>• Blank <code>asset_id</code> → add a unique ID. <br>• <code>acquisition_date</code> not a date → enter as YYYY-MM-DD. <br>• Negative <code>acquisition_cost</code> → correct to >= 0. <br>• Missing life years → add to asset row or <code>tbl_rates</code>. <br>• Disposal flagged but no date or proceeds → fill those fields. After fixes, run macro again. </td></tr><tr><td data-label="User Guide — Fixed Asset Depreciation"> <strong>15. If numbers don’t match another tool</strong><br>Check these in order: <code>tbl_rates</code> life and effective dates; <code>fiscal_year_end_month</code> in <code>tbl_inputs</code>; whether calculation used SL vs DB; residual values; rounding differences (system rounds after FY aggregation). Fix settings and re-run. </td></tr><tr><td data-label="User Guide — Fixed Asset Depreciation"> <strong>16. If you want only a printable report</strong><br>Refresh Power Query for a quick view, or run the macro then copy <code>tbl_schedule</code> and paste-values into a new sheet for a printable snapshot. That snapshot will not change when you refresh. </td></tr><tr><td data-label="User Guide — Fixed Asset Depreciation"> <strong>17. Final, plain advice</strong><br>Always save before running macros. Fix validation errors first. Use Power Query to preview. Use filters to inspect a single asset row in <code>tbl_schedule</code>. If you don’t understand a flagged validation message, copy the problematic row into a support ticket or to the person who gave you the workbook. </td></tr></tbody></table></div><div class="row-count">Rows: 17</div></div><div class="table-caption" id="Table3" data-table="Docu_0166_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **What this workbook contains**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>What this workbook contains</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="What this workbook contains"> <strong>Overview</strong><br>This file restructures the entire <em>User Guide Depreciation</em> into a per-function technical breakdown aligned to the actual calculation engine (macro-driven or server-side equivalent). It is designed for accountants, tax engineers, and system integrators. </td></tr><tr><td data-label="What this workbook contains"> <strong>Sheet & Table Structure (Excel Tables / ListObjects)</strong> </td></tr><tr><td data-label="What this workbook contains"> <strong>1. tbl_function_index</strong><br>Purpose: Canonical registry of all calculation and control functions.<br><br>Key columns:<br>• function_id<br>• function_name<br>• layer (Input / Validation / Calculation / Aggregation / Posting / Reporting / Control)<br>• invocation_order<br>• implemented_in (VBA / Formula / Power Query / Server)<br>• description </td></tr><tr><td data-label="What this workbook contains"> <strong>2. tbl_function_inputs</strong><br>Purpose: Formal contract of inputs per function.<br><br>Key columns:<br>• function_id<br>• input_name<br>• source_table<br>• data_type<br>• unit<br>• required_flag<br>• default_rule<br>• validation_rule </td></tr><tr><td data-label="What this workbook contains"> <strong>3. tbl_function_outputs</strong><br>Purpose: Deterministic outputs produced by each function.<br><br>Key columns:<br>• function_id<br>• output_field<br>• target_table<br>• data_type<br>• unit<br>• rounding_rule<br>• persistence (value-only / formula / transient) </td></tr><tr><td data-label="What this workbook contains"> <strong>4. tbl_function_logic</strong><br>Purpose: Step-by-step technical logic (core decomposition).<br><br>Key columns:<br>• function_id<br>• step_no<br>• operation_type (lookup / loop / aggregation / cap / post)<br>• formula_or_rule<br>• regulatory_reference<br>• notes<br><br>This table decomposes:<br>• Monthly enumeration<br>• FY assignment<br>• SL vs DB computation<br>• Residual value capping<br>• Disposal truncation </td></tr><tr><td data-label="What this workbook contains"> <strong>5. tbl_function_validations</strong><br>Purpose: Machine-readable validation and error semantics.<br><br>Key columns:<br>• function_id<br>• error_code<br>• severity (ERROR / WARNING)<br>• condition<br>• message<br>• affected_table<br><br>Mapped to validation_report and validation_flag. </td></tr><tr><td data-label="What this workbook contains"> <strong>6. tbl_function_dependencies</strong><br>Purpose: Execution graph and ordering.<br><br>Key columns:<br>• function_id<br>• depends_on_function_id<br>• dependency_type (hard / soft)<br>• failure_behavior (stop / warn / skip)<br><br>Used by RecomputeAll. </td></tr><tr><td data-label="What this workbook contains"> <strong>7. tbl_function_examples</strong><br>Purpose: QA-oriented examples per function.<br><br>Key columns:<br>• function_id<br>• case_id<br>• input_snapshot<br>• expected_output<br>• tolerance_idr<br>• source (Ortax / Manual calc) </td></tr><tr><td data-label="What this workbook contains"> <strong>8. metadata</strong><br>Documents:<br>• Regulatory basis (PMK references)<br>• Month-counting rule<br>• Rounding policy<br>• Function version tag<br>• Workbook purpose and owner </td></tr><tr><td data-label="What this workbook contains"> <strong>How this maps to RecomputeAll</strong><br>RecomputeAll acts as an orchestrator, not a monolith.<br><br>Phases and example functions:<br>• Validation – ValidateAssets(), ValidateRates()<br>• Expansion – EnumerateServiceMonths()<br>• Aggregation – AssignFiscalYears()<br>• Calculation – ComputeSL(), ComputeDB()<br>• Safeguards – ApplyResidualCap()<br>• Lifecycle – ApplyDisposalRules()<br>• Persistence – WriteSchedule()<br>• Audit – LogRun()<br><br>Each phase is fully specified row-by-row in the tables above. </td></tr><tr><td data-label="What this workbook contains"> <strong>Why this format is audit-safe</strong><br>• Function-level determinism<br>• Explicit input/output contracts<br>• Regulatory traceability per step<br>• One-to-one mapping to VBA, Python, or SQL implementations<br>• Suitable for SOX / tax audit handover </td></tr></tbody></table></div><div class="row-count">Rows: 12</div></div><div class="table-caption" id="Table4" data-table="Docu_0166_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **What this workbook contains**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>What this workbook contains</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="What this workbook contains"> <strong>Overview (plain language)</strong><br>This workbook is not just a calculator. It is a <em>map of how the calculator works</em>. Every calculation is broken into small, named functions so anyone (accountant, auditor, IT, or tax reviewer) can see <strong>what happens, in what order, and why</strong>. Nothing is hidden inside one big macro. </td></tr><tr><td data-label="What this workbook contains"> <strong>Big idea (important)</strong><br>Instead of “trust the macro”, this workbook says: <em>here is every step, every input, every output</em>. Each step is written down in tables so it can be reviewed, tested, audited, or rebuilt in another system (Python, SQL, server app). </td></tr><tr><td data-label="What this workbook contains"> <strong>Sheet & Table Structure — what each table is for</strong> </td></tr><tr><td data-label="What this workbook contains"> <strong>1. tbl_function_index — list of all functions</strong><br>This is the master index. Think of it as a table of contents for the entire calculation engine.<br><br>For each function it answers:<br>• What is the function called?<br>• What layer does it belong to (input, validation, calculation, etc.)?<br>• When does it run (early or late)?<br>• Where is it implemented (VBA, Power Query, server)?<br>• What does it do in one sentence?<br><br>If you want to know <em>“what exists in the system”</em>, start here. </td></tr><tr><td data-label="What this workbook contains"> <strong>2. tbl_function_inputs — what each function needs</strong><br>This table answers a very simple question: <em>What data does this function need to work?</em><br><br>For every function, it lists:<br>• Input name (example: acquisition_cost)<br>• Where it comes from (which table)<br>• What type it is (date, number, text)<br>• Unit (IDR, years, months)<br>• Whether it is required or optional<br>• What default is used if missing<br>• What rule checks if it is valid<br><br>This prevents “magic values” or guessing. Every input is documented. </td></tr><tr><td data-label="What this workbook contains"> <strong>3. tbl_function_outputs — what each function produces</strong><br>This table answers: <em>After the function runs, what new values exist?</em><br><br>For each function output it shows:<br>• Output field name<br>• Which table it is written to (e.g., tbl_schedule)<br>• Data type and unit<br>• Rounding rule (when rounding happens)<br>• Whether the value is stored permanently or just used temporarily<br><br>This makes it clear where numbers come from and where they end up. </td></tr><tr><td data-label="What this workbook contains"> <strong>4. tbl_function_logic — how the function works (step by step)</strong><br>This is the heart of the system. It breaks each function into small steps a human can read.<br><br>Each row represents one step, such as:<br>• Look up useful life from tbl_rates<br>• Loop through service months<br>• Assign each month to a fiscal year<br>• Calculate SL or DB depreciation<br>• Apply residual value cap<br>• Stop at disposal month<br><br>No code reading required. Logic is written as rules and formulas. </td></tr><tr><td data-label="What this workbook contains"> <strong>5. tbl_function_validations — error rules, clearly stated</strong><br>This table defines <em>what can go wrong</em> and <em>what the system should do</em>.<br><br>For each validation rule it shows:<br>• Error code (machine-readable)<br>• Severity (ERROR stops the run, WARNING does not)<br>• Condition (what causes the issue)<br>• Human-readable message<br>• Which table is affected<br><br>This feeds directly into <code>validation_report</code> so users see clear reasons, not cryptic errors. </td></tr><tr><td data-label="What this workbook contains"> <strong>6. tbl_function_dependencies — execution order</strong><br>This table explains <em>which function must run before another</em>.<br><br>For each dependency it says:<br>• Function A depends on Function B<br>• Whether the dependency is hard (must succeed) or soft (can warn)<br>• What happens if it fails (stop, warn, skip)<br><br>This prevents out-of-order calculations and explains how <code>RecomputeAll</code> decides what to run next. </td></tr><tr><td data-label="What this workbook contains"> <strong>7. tbl_function_examples — test cases you can verify</strong><br>This table contains simple, concrete examples to prove each function works.<br><br>Each example includes:<br>• Input snapshot (small, readable case)<br>• Expected output<br>• Allowed tolerance (usually 1 IDR)<br>• Source of truth (manual math or Ortax calculator)<br><br>This is what auditors and testers use to confirm correctness. </td></tr><tr><td data-label="What this workbook contains"> <strong>8. metadata — rules, policies, and ownership</strong><br>This table explains the <em>rules behind the numbers</em>.<br><br>It records:<br>• Regulatory references (PMK numbers)<br>• Month-counting rules (when depreciation starts)<br>• Rounding policy (when numbers are rounded)<br>• Version of the calculation logic<br>• Workbook owner and purpose<br><br>If someone asks “why is it done this way?”, the answer is here. </td></tr><tr><td data-label="What this workbook contains"> <strong>How this maps to RecomputeAll — in simple words</strong><br><code>RecomputeAll</code> is not a giant calculator. It is a coordinator.<br><br>It simply says:<br>1) Run validations<br>2) Expand months<br>3) Group months into fiscal years<br>4) Calculate depreciation (SL or DB)<br>5) Apply caps and disposal rules<br>6) Write results to tables<br>7) Log what happened<br><br>Each of these steps is a function described in the tables above. </td></tr><tr><td data-label="What this workbook contains"> <strong>Why this design is audit-safe (very important)</strong><br>• Every calculation step is named and documented<br>• Inputs and outputs are explicit<br>• Rules reference regulations, not assumptions<br>• Logic can be reimplemented in VBA, Python, or SQL with the same result<br>• Auditors can review tables without reading code<br><br>This is why the system is suitable for tax review, SOX controls, and long-term maintenance. </td></tr></tbody></table></div><div class="row-count">Rows: 13</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>