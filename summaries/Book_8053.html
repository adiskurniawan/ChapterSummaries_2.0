<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1761541233">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      // Delegate addEventListener/removeEventListener to visible button
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      // Delegate onclick assignments
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      // Delegate focus/blur
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
      // If legacy code used direct addEventListener earlier than this script, listeners would already exist
      // on alias element; attempt to re-dispatch those by cloning them to visible button is non-trivial.
      // This approach covers the common case where legacy scripts query the alias and bind after DOM ready.
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Book_8053_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Project Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Project Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Project Structure"> PasteToTable<br>├─ main.py<br>├─ server.py<br>├─ html_renderer.py<br>├─ utils.py<br>├─ render<br>│  ├─ <strong>init</strong>.py<br>│  ├─ core_compat.py<br>│  ├─ core_table.py — table-level helpers, render_table wrapper<br>│  ├─ core_assets.py — asset discovery, embedding, copy logic<br>│  ├─ core_io.py — atomic write, tmp dirs, path checks<br>│  ├─ core_utils.py — misc helpers (sanitize, streaming, sri_attr)<br>│  ├─ core_renderer.py<br>│  ├─ core_fragments.py<br>│  ├─ convert.py<br>│  ├─ markdown.py<br>│  ├─ sanitize.py<br>│  ├─ io_utils.py<br>│  ├─ assets.py<br>│  ├─ cli.py<br>│  └─ types.py<br>├─ assets<br>│  ├─ script.core.js<br>│  ├─ script.table.js<br>│  ├─ script.toc.js<br>│  ├─ overrides.css<br>│  ├─ style.css<br>│  ├─ extra.js<br>│  └─ worker.js — optional: future client-side features<br>├─ templates<br>│  └─ index.html<br>└─ saved_tables<br><br>Project structure for PasteToTable:<br><code>render/</code> — core rendering modules for tables, HTML assembly, sanitization, and conversion.<br><code>assets/</code> — CSS, JS, and worker scripts for styling and interactivity.<br><code>templates/</code> — contains the main HTML template for rendering outputs.<br><code>saved_tables/</code> — stores generated tables.<br>Root scripts (<code>main.py</code>, <code>server.py</code>, <code>html_renderer.py</code>, <code>utils.py</code>) coordinate the conversion workflow and backend operations. </td></tr></tbody></table></div><div class="row-count">Rows: 1</div></div><div class="table-caption" id="Table2" data-table="Book_8053_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Plan / Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Plan / Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Plan / Notes"> You want to save Markdown (.md) files from the UI. Current state: server.py already has /convert and /save (HTML), enforcing MAX_PASTE_SIZE with helpers _safe_filename, storage path, and atomic flush. index.html has a visible Save button dispatching ptt:save-request. utils.py, render/core_io.py, main.py, extra.js, and batch logic exist and are suitable.                                                                       </td></tr><tr><td data-label="Plan / Notes"> Approach: edit one file at a time in this order and test after each change. Files to revise (single-file rule): server.py, assets/script.save.js, index.html (minor include), optional utils.py (likely unchanged).                                                                                                                                                                                                                       </td></tr><tr><td data-label="Plan / Notes"> <strong>server.py</strong>: Add POST /save-md endpoint. Accept JSON {markdown, filename} or form data. Enforce MAX_PASTE_SIZE, check len(markdown). Coerce filename with _safe_filename, append .md. Save atomically under STORAGE_PATH. Return JSON {ok, status, path, id} with 200/201. Reuse existing logging and error handling. Keep /save (HTML) unchanged.                                                                                      </td></tr><tr><td data-label="Plan / Notes"> <strong>assets/script.save.js</strong>: Client-side script. On load, register listener for ptt:save-request and #saveBtn click. Read markdown from #paste, fallback to page-area if empty. Prompt for filename if missing, append .md. Optional client-side size check against MAX_PASTE_SIZE. Send POST /save-md via fetch(JSON). Handle response, update #status, optionally download/open saved file. Dispatch ptt:save-response for other scripts. </td></tr><tr><td data-label="Plan / Notes"> <strong>index.html</strong>: Include <script src="assets/script.save.js" defer></script> if not already included. Existing inline save dispatcher works with new script.                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Plan / Notes"> <strong>Implementation details (server)</strong>: Only POST allowed. Enforce content-length and markdown size. Sanitize filename to avoid path traversal. Atomic write. Return proper JSON on success or error (400/413/500). Security headers preserved. Optionally sanitize content but store raw markdown.                                                                                                                                          </td></tr><tr><td data-label="Plan / Notes"> <strong>Implementation details (client)</strong>: Register listener, read markdown, prompt filename, size check, fetch POST JSON, handle server response, update UI, trigger download/open, dispatch event. Graceful fallback and accessibility. Works on Chrome/Firefox/Edge and mobile.                                                                                                                                                              </td></tr><tr><td data-label="Plan / Notes"> <strong>Tests / Verification (Server, 13)</strong>: POST /save-md accepts JSON; >MAX_PASTE_SIZE returns 413; empty markdown 400; filename sanitized and appended with .md; path inside STORAGE_PATH; atomic write; file readable; STORAGE_PATH created if missing; concurrent saves handled; response JSON contains ok, path, id; logging contains actions and errors; GET /saved/<id> works for HTML only; security headers present.                  </td></tr><tr><td data-label="Plan / Notes"> <strong>Tests / Verification (Client, 12)</strong>: Save triggers ptt:save-request; filename prompt appears; prevents >MAX_PASTE_SIZE; #status shows messages; errors displayed; saved path opens/downloads; fallback works; works on all browsers and mobile; accessible; cancelable events honored; no JS console exceptions; works with existing site save scripts.                                                                                 </td></tr><tr><td data-label="Plan / Notes"> <strong>Quick cURL tests</strong>: JSON POST: <code>curl -v -X POST http://127.0.0.1:5000/save-md -H &quot;Content-Type: application/json&quot; -d &#x27;{&quot;markdown&quot;:&quot;# Hello\nThis is a note.&quot;,&quot;filename&quot;:&quot;my-note.md&quot;}&#x27;</code>. Form POST: <code>curl -v -X POST http://127.0.0.1:5000/save-md -F &quot;markdown=@./notes.txt;type=text/plain&quot; -F &quot;filename=my-note.md&quot;</code>.                                                                                                                </td></tr><tr><td data-label="Plan / Notes"> <strong>Acceptance criteria</strong>: Server and client code implemented; Save button triggers new script; saved .md files appear in STORAGE_PATH and retrievable; security and size checks pass; all 25 verification checks succeed.                                                                                                                                                                                                                  </td></tr></tbody></table></div><div class="row-count">Rows: 11</div></div><div class="table-caption" id="Table3" data-table="Book_8053_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Change Area"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Change Area</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Details"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Details</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Change Area"> <strong>Content-Length Enforcement</strong>            </td><td data-label="Details"> Added <code>_enforce_content_length</code> in <code>before_request</code> to limit body-bearing requests (POST/PUT/PATCH) to <code>MAX_PASTE_SIZE</code>. Returns <code>413</code> if exceeded.                                                      </td></tr><tr><td data-label="Change Area"> <strong>Security Headers</strong>                      </td><td data-label="Details"> Added <code>_set_minimal_security_headers</code> in <code>after_request</code> with <code>X-Content-Type-Options</code>, <code>X-Frame-Options</code>, <code>Referrer-Policy</code>, <code>Permissions-Policy</code>. Non-invasive; uses <code>setdefault</code>.                     </td></tr><tr><td data-label="Change Area"> <strong>Template Cache Flush / Cache Busting</strong>  </td><td data-label="Details"> Added <code>_clear_jinja_template_cache</code> helper. <code>/convert</code> endpoint respects <code>v</code> query param or <code>FLUSH_TEMPLATES_ON_RENDER</code> config to flush Jinja cache.                                                     </td></tr><tr><td data-label="Change Area"> <strong>Reference-Style Footnote Stripping</strong>    </td><td data-label="Details"> <code>_strip_ref_footnotes</code> now removes <code>([ref][n])</code>, <code>[ref][n]</code>, <code>[n]</code> early in preprocessing to prevent them reaching renderers.                                                                            </td></tr><tr><td data-label="Change Area"> <strong>Escape Leading List Markers in Tables</strong> </td><td data-label="Details"> <code>_escape_leading_list_markers_in_table_cells</code> escapes numeric or <code>-/*/+</code> at start of pipe-table cells, preventing Markdown from interpreting them as lists.                                              </td></tr><tr><td data-label="Change Area"> <strong>Renderer Fallback Logic</strong>               </td><td data-label="Details"> <code>_render_text_with_fallbacks</code> consolidated multiple fallbacks: <code>render_from_text</code> preferred, candidate modules/functions tried, finally <code>&lt;pre&gt;</code> escape. Adds <code>meta[&quot;converted&quot;]=False</code> if fallback used. </td></tr><tr><td data-label="Change Area"> <strong>Convert Endpoint</strong>                      </td><td data-label="Details"> <code>/convert</code> now: strips footnotes, escapes leading list markers, enforces max size, optionally flushes cache, adds post-render guard if <code>&lt;table&gt;</code> missing.                                                </td></tr><tr><td data-label="Change Area"> <strong>Save Endpoint</strong>                         </td><td data-label="Details"> <code>/save</code> uses <code>_safe_filename</code>, tries <code>save_html_atomic</code>, falls back to atomic tempfile write. Returns consistent JSON with <code>path</code> and <code>id</code>.                                                              </td></tr><tr><td data-label="Change Area"> <strong>Get Saved Endpoint</strong>                    </td><td data-label="Details"> <code>/saved/&lt;file_id&gt;</code> uses <code>read_saved</code> helper or falls back to storage path. Validates <code>commonpath</code> to prevent directory traversal.                                                                        </td></tr><tr><td data-label="Change Area"> <strong>Compatibility API Routes</strong>              </td><td data-label="Details"> Added <code>/api/convert</code>, <code>/api/render</code>, <code>/api/health</code> as aliases.                                                                                                                                           </td></tr><tr><td data-label="Change Area"> <strong>Logging Improvements</strong>                  </td><td data-label="Details"> More info logs: feature flags, cache-bust flush, CORS enabled. Debug logs on manifest 404, preprocessing failure, save/read failures.                                                                    </td></tr><tr><td data-label="Change Area"> <strong>Minor Fixes</strong>                           </td><td data-label="Details"> Coerces integers safely (<code>_coerce_int</code>), safe filenames, robust exception handling everywhere.                                                                                                           </td></tr></tbody></table></div><div class="row-count">Rows: 12</div></div><div class="table-caption" id="Table4" data-table="Book_8053_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Aspect"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Aspect</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Status / Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Status / Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> <strong>Form / Convert endpoint</strong>  </td><td data-label="Status / Notes"> <code>#render-form</code> posts to <code>/api/render</code>. Matches updated <code>/convert</code> route. ✅                                                                                                                                                                                                                      </td></tr><tr><td data-label="Aspect"> <strong>Paste textarea</strong>           </td><td data-label="Status / Notes"> Fixed width 8 cm, non-resizable. Compatible with <code>_escape_leading_list_markers_in_table_cells</code>. ✅                                                                                                                                                                                               </td></tr><tr><td data-label="Aspect"> <strong>Cache-busting</strong>            </td><td data-label="Status / Notes"> <code>&lt;link&gt;</code> tags include <code>v=%%ASSET_HASH%%</code>. Good for CSS/JS; consider adding <code>v</code> support for <code>/convert</code> fetch if client-side uses query param. ✅                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Saved tables</strong>             </td><td data-label="Status / Notes"> <code>&lt;section id=&quot;saved&quot;&gt;</code> present but hidden. Server now stores in configurable path. JS to fetch list not included. ⚠️ Need client-side fetch to populate saved tables.                                                                                                                           </td></tr><tr><td data-label="Aspect"> <strong>TOC / Header</strong>             </td><td data-label="Status / Notes"> <code>#toc</code> and <code>#tocBar</code> exist. JS <code>PTToc.init</code> handles TOC population. Compatible. ✅                                                                                                                                                                                                               </td></tr><tr><td data-label="Aspect"> <strong>Tables placeholder</strong>       </td><td data-label="Status / Notes"> <code>#tables-placeholder</code> ready for dynamic injection. ✅                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Aspect"> <strong>Route HTML to areas</strong>      </td><td data-label="Status / Notes"> <code>PasteToTable.routeHtmlToAreas</code> correctly handles full-page vs fragment responses. ✅                                                                                                                                                                                                            </td></tr><tr><td data-label="Aspect"> <strong>MutationObserver</strong>         </td><td data-label="Status / Notes"> Watches <code>#tables-viewer</code> to reveal <code>.table-wrapper</code>. Compatible with dynamically injected tables. ✅                                                                                                                                                                                             </td></tr><tr><td data-label="Aspect"> <strong>Modal / Copy</strong>             </td><td data-label="Status / Notes"> <code>#tv-copy-modal-template</code> exists. Matches <code>script.table.js</code> expectations. ✅                                                                                                                                                                                                                     </td></tr><tr><td data-label="Aspect"> <strong>Legacy alias</strong>             </td><td data-label="Status / Notes"> <code>copyAllMdBtn</code> delegated to <code>copyAllTablesBtn</code>. ✅                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Aspect"> <strong>JS load order</strong>            </td><td data-label="Status / Notes"> XLSX → TOC → Core → Table → Tweaks → Worker. Correct. ✅                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Aspect"> <strong>Accessibility / ARIA</strong>     </td><td data-label="Status / Notes"> Roles, labels, <code>aria-live</code> present. ✅                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Aspect"> <strong>Security / headers</strong>       </td><td data-label="Status / Notes"> No inline JS/CSP violations; compatible with minimal headers from server. ✅                                                                                                                                                                                                                     </td></tr><tr><td data-label="Aspect"> <strong>Outstanding improvements</strong> </td><td data-label="Status / Notes"> 1. Add client-side fetch logic to populate <code>#saved</code> section from <code>/saved/&lt;file_id&gt;</code> or list endpoint.<br>2. Ensure <code>/convert</code> fetch uses cache-busting query <code>v</code>. <br>3. Optional: enhance table copy/export buttons to respect new save path (<code>tables</code>). </td></tr></tbody></table></div><div class="row-count">Rows: 14</div></div><div class="table-caption" id="Table5" data-table="Book_8053_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Aspect"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Aspect</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Enhancement"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Enhancement</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> Web UI              </td><td data-label="Enhancement"> Add a <strong>Save Table</strong> button to allow users to save one or multiple tables directly from the web interface.                                                                                                 </td></tr><tr><td data-label="Aspect"> Batch mode          </td><td data-label="Enhancement"> Already parses Markdown/CSV files into tables, sanitizes Dropbox paths, and optionally generates HTML via renderer or fallback.                                                                            </td></tr><tr><td data-label="Aspect"> Table rendering     </td><td data-label="Enhancement"> Preserve inline <code>code</code>, avoid auto <code>&lt;br&gt;</code>, sanitize sensitive paths.                                                                                                                                       </td></tr><tr><td data-label="Aspect"> Config              </td><td data-label="Enhancement"> Uses <code>load_env()</code> for paths, batch flags, port, host, storage.                                                                                                                                             </td></tr><tr><td data-label="Aspect"> JS/HTML integration </td><td data-label="Enhancement"> Current <code>index.html</code> is minimal; it lacks interactive buttons. Enhancement requires adding buttons (e.g., Save), linking them to client-side JS (likely <code>script.table.js</code> or <code>extra.js</code>) for table export. </td></tr><tr><td data-label="Aspect"> Goal                </td><td data-label="Enhancement"> Provide a <strong>user-friendly way to load saved tables, save them under new names, and integrate seamlessly with the existing PTT workflow</strong>, without breaking batch or web mode.                              </td></tr></tbody></table></div><div class="row-count">Rows: 6</div></div><div class="table-caption" id="Table6" data-table="Book_8053_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by File"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">File</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Purpose of Revision"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Purpose of Revision</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Notes / Verification Points"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Notes / Verification Points</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="File"> <code>server.py</code>                                        </td><td data-label="Purpose of Revision"> Add endpoints to list saved tables (<code>GET /api/saved_tables</code>) and load one (<code>GET /api/saved_tables/&lt;name&gt;</code>). </td><td data-label="Notes / Verification Points"> Check import correctness, path safety, JSON formatting, atomic reads, error handling.                                    </td></tr><tr><td data-label="File"> <code>templates/index.html</code>                             </td><td data-label="Purpose of Revision"> Add toolbar button for “Load saved table(s)” and modal container for list UI.                               </td><td data-label="Notes / Verification Points"> Ensure IDs unique, inline styles minimal, DOM placement correct.                                                         </td></tr><tr><td data-label="File"> <code>assets/extra.js</code> (or append to <code>script.table.js</code>) </td><td data-label="Purpose of Revision"> Client-side logic to fetch saved table list, load content into paste input, and handle modal show/hide.     </td><td data-label="Notes / Verification Points"> Validate fetch URLs, JSON parsing, error handling, interaction with existing paste input function (<code>handlePastedInput</code>). </td></tr><tr><td data-label="File"> <code>render/core_io.py</code> (optional / check-if-needed)   </td><td data-label="Purpose of Revision"> Confirm atomic write function exists and could be reused for future POST/save endpoint.                     </td><td data-label="Notes / Verification Points"> Verify signature, safe fallback if missing, avoid overwriting existing saved tables.                                     </td></tr><tr><td data-label="File"> <code>utils.py</code> (optional)                              </td><td data-label="Purpose of Revision"> If needed, minor helpers for safe path normalization or modal utility.                                      </td><td data-label="Notes / Verification Points"> Keep lightweight, do not interfere with existing helpers.                                                                </td></tr><tr><td data-label="File"> <code>main.py</code>                                          </td><td data-label="Purpose of Revision"> Confirm Flask app or server startup recognizes new endpoints.                                               </td><td data-label="Notes / Verification Points"> Check blueprint registration or direct app inclusion.                                                                    </td></tr><tr><td data-label="File"> <code>assets/style.css</code>                                 </td><td data-label="Purpose of Revision"> Optional minor CSS for modal display, basic responsiveness.                                                 </td><td data-label="Notes / Verification Points"> Keep minimal, ensure no clash with overrides.css.                                                                        </td></tr></tbody></table></div><div class="row-count">Rows: 7</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>