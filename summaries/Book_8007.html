<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;}</style>
<link rel="stylesheet" href="assets/style.css?v=1758615668">
<link rel="stylesheet" href="assets/overrides.css?v=1758615668">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header"><div><h1>Tables Viewer v2.1</h1></div><div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" type="search" placeholder="Search" aria-label="Search tables" style="min-width:420px; width:44ch;"/>
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllMdBtn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy all tables as markdown">Copy All Tables (Markdown)</button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset all tables">Reset All Tables</button>
</div></div>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#table-1">Table 1</a></li></ul></div></div>
<div class="table-wrapper" data-table-id="table-1"><h3 id="table-1">Table 1</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr>
        <th style="width:28.57%;" onclick="sortTableByColumn(0,0)" role="button" aria-label="Sort by File">
          <div class="th-with-sort">
            <div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">File</div>
            <button class="sort-btn sort-state-0" onclick="event.stopPropagation(); headerSortButtonClicked(0,0, this)" title="Toggle sort" aria-label="Toggle sort">
              <span class="sort-icon" aria-hidden="true"></span>
            </button>
          </div>
        </th>
        <th style="width:71.43%;" onclick="sortTableByColumn(0,1)" role="button" aria-label="Sort by Conceptual improvements">
          <div class="th-with-sort">
            <div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual improvements</div>
            <button class="sort-btn sort-state-0" onclick="event.stopPropagation(); headerSortButtonClicked(0,1, this)" title="Toggle sort" aria-label="Toggle sort">
              <span class="sort-icon" aria-hidden="true"></span>
            </button>
          </div>
        </th></tr></thead><tbody><tr><td data-label="File"><p><strong>`render/core&#95;assets.py`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Add `find<em>project</em>assets()` that returns ordered candidate dirs (`pkg`, `repo<em>root`, `cwd`) and a selection policy.<br></li> <li>Expose `atomic</em>copy<em>assets(src</em>dir, dst<em>dir, overwrite=False, whitelist=None)` that uses `core</em>io.atomic<em>copy</em>file` and returns `{copied, skipped, errors}`.<br></li> <li>Default to a safe whitelist: `['style.css','script.js','worker.js','overrides.css']` and provide `copy<em>all=True` opt-in.<br></li> <li>Implement `dry</em>run=True` option to simulate changes for CI checks and return a detailed report.<br></li> <li>Make embedded fallbacks configurable via `cfg` keys `'<em>EMBED</em>STYLE'` and `'<em>EMBED</em>SCRIPT'` and validate their types.<br></li> <li>Add optional `sri` (subresource integrity) generator for CDN fallback and expose `get<em>asset</em>info()` for callers.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`render/core&#95;fragments.py`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Use a single `atomic<em>write</em>best()` from `core<em>io` and remove local `</em>atomic<em>write</em>text` duplication.<br></li> <li>Choose `render<em>func = </em>render<em>table</em>helper or <em>simple</em>render<em>table` once up front to avoid per-fragment try/except overhead.<br></li> <li>Record per-fragment timing and include `duration</em>ms` in returned fragment metadata for perf analysis.<br></li> <li>Support optional `stream<em>writer` interface on `renderer`. If present, call it to write partial HTML rows to disk (enables streaming for very large tables).<br></li> <li>Replace fragile regex HTML parsing with `html.parser` extraction, fall back to regex only if parser fails. Add defensive unit tests for parsing edge cases.<br></li> <li>Return a typed `RenderResult` dataclass (fields: `fragments</em>map`, `frag<em>row</em>counts`, `total<em>rows`, `warnings`, `duration</em>ms`) rather than a raw tuple.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`render/core&#95;io.py`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Export `atomic<em>write</em>text(path, text)`, `atomic<em>write</em>bytes(path, b)`, and `atomic<em>write</em>callable(path, writer<em>callable)` as the canonical atomic API.<br></li> <li>Provide `atomic</em>copy<em>file(src, dst, preserve</em>mode=True)` that uses atomic temp-write for small files and streaming copy for large files.<br></li> <li>Implement capability negotiation: prefer project `<em>atomic</em>write<em>impl` or `</em>atomic<em>stream</em>write<em>impl` if present, else use defaults. Expose `atomic</em>write<em>best(path, data)` convenience wrapper.<br></li> <li>Add optional `fsync` parameter to ensure durability on POSIX where required.<br></li> <li>Provide `tmp</em>frag<em>dir</em>for(out<em>dir, prefix='.frags</em>')` that uses `tempfile.mkdtemp` or `uuid4()` to avoid collisions.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`render/core&#95;renderer.py`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Represent `cfg` as a typed dataclass with validated defaults (embed<em>assets, max</em>workers, assets<em>dir, embed</em>fallbacks).<br></li> <li>Factor head/tail construction into helpers: `build<em>head</em>parts(cfg, assets)` and `build<em>tail</em>parts(cfg, assets)` to improve readability and testability.<br></li> <li>Compute asset version query param once then reuse to avoid inconsistent timestamps across links.<br></li> <li>Use `RenderResult` from `core<em>fragments` to assemble final page and propagate structured warnings with codes and categories.<br></li> <li>Expose a `render</em>policy` option to select `inline`, `link<em>assets`, or `cdn` behavior and make `export</em>template` insertion robust by JSON-encoding values for JS.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`render/core&#95;table.py`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Accept `markdown<em>to</em>html` strictly as a callable with the contract: `str -> safe<em>html</em>str`. Validate early and fallback deterministically.<br></li> <li>Add `allow<em>tables` flag to `sanitize</em>html` call and document risk tradeoffs.<br></li> <li>Improve nested list and block handling by delegating to `render/markdown.py` `markdown<em>to</em>html` when available; keep a safe fallback for no-deps environments.<br></li> <li>Add optional metadata output from table renderer: return `(html, schema)` where `schema` lists column names, detected types, and sample values to support UI virtualization and type-aware sorting.<br></li> <li>Add `cell<em>raw</em>marker` option (e.g., prefix `!raw:`) to permit trusted HTML passthrough where safe and documented.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`render/core&#95;utils.py`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Centralize small helpers: `safe<em>id(s)`, `maybe</em>path`, `sri<em>attr(href, cdn</em>integrity)`, and a `timer()` context manager that returns elapsed ms.<br></li> <li>Provide structured logger setup helper `get<em>logger(name, level)` and a `log</em>fragment` helper to standardize fragment logs.<br></li> <li>Offer `stream&#95;lines(iterable, writer)` helper for streaming large outputs in other modules.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`render/core&#95;compat.py`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>On import, inspect `convert.render&#95;table` signature and auto-wrap or adapt older signatures to maintain compatibility.<br></li> <li>Provide a clear deprecation warning if an old signature is detected and document the expected signature in module docstring.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`render/convert.py`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>If heavy conversions exist here, expose both `render<em>table` and a streaming `render</em>table<em>stream` that yields chunks or writes to a provided writer. <br></li> <li>Keep small public API surface and mark private helpers `</em>`-prefixed.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`render/markdown.py`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Prefer `python-markdown` when available with extensions `['extra','sane<em>lists','smarty','codehilite']` and `output</em>format='html5'` for best fidelity.<br></li> <li>Move `<em>is</em>safe<em>url` into `render/sanitize.py` to centralize safety logic.<br></li> <li>Strengthen fallback parser: use `html.parser.HTMLParser` tokenizer and incremental parsing rather than fragile line-based regexes. Add tests for nested lists, tables inside cells, code fences, and images with data URIs.<br></li> <li>Expose `markdown</em>to<em>html(..., extensions=None, safe</em>mode=True)` to let callers opt in to additional extensions.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`render/io&#95;utils.py`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Document expected signatures for `<em>atomic</em>write`, `<em>atomic</em>stream<em>write`, and `</em>ensure<em>dir` so project-provided overrides are consistent.<br></li> <li>Provide `atomic</em>write<em>adapter()` that wraps different vendor implementations into the canonical callable used by `core</em>io`.<br></li> <li>Offer a small `safe<em>open</em>for&#95;write(path, encoding='utf-8')` helper that ensures parent dirs exist and opens in atomic-mode when possible.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`render/sanitize.py`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Consolidate all HTML/URL sanitization here. Export `sanitize<em>html(html, allow</em>tables=False, allow<em>images=False)` and `is</em>safe<em>url(url)`.<br></li> <li>Use `bleach` when available with a well-documented whitelist, and fallback to `HTMLParser` cleaner with proper attribute filtering.<br></li> <li>Provide a `sanitize</em>policy` dataclass to control allowed tags and attributes per context and make the sanitizer pluggable.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`render/types.py`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Add dataclasses: `RenderWarning(level: str, msg: str, table: Optional[int])`, `FragmentMeta(path: Path, title<em>id: str, title</em>text: str, sections: List[Tuple[str,str]], rows: int, duration<em>ms: int)`, and `RenderResult(fragments</em>map: Dict[int, FragmentMeta], frag<em>row</em>counts: Dict[int,int], total<em>rows:int, warnings: List[RenderWarning], runtime</em>ms: int)`.<br></li> <li>Use these consistently across modules instead of raw dicts/tuples for clearer typing and introspection.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`render/init.py`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Keep minimal public exports. Validate and re-export `render<em>html` and `render</em>table` from `core&#95;compat` but catch import errors and provide human-friendly messages at import time.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`assets/style.css`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Keep default CSS small. Provide documented hooks (CSS custom properties) like `--tv-left-width` and `--tv-right-width` so `write<em>overrides</em>css` can rely on variables.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`assets/script.js`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Keep lightweight; expose a small API surface used by generated pages (`sortTableByColumn`, `toggleTable`, `copyTableMarkdown`). Document expected DOM structure so changes in HTML remain compatible.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`assets/worker.js`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Provide a minimal placeholder but document expected worker API (postMessage in/out) so replacement implementations can be swapped without changing main code.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`assets/overrides.css`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Keep as generated file only. Do not expect users to edit it manually; instead provide a `cfg` option to supply custom overrides content.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`output&#95;combined/assets`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>When copying assets, compute a manifest (checksum, size, last-modified) and write `assets/manifest.json` to support caching and integrity checks.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`html&#95;renderer.py`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Keep as a thin wrapper that builds a validated `cfg` dataclass and forwards to `core<em>renderer.render</em>html`.<br></li> <li>Add CLI-friendly sanity checks such as: validate `output` path, confirm asset dir writable, and summary of tables to render.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`utils.py`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Centralize misc helpers used by the CLI or tests (path normalization, small formatting helpers). Avoid overlap with `core&#95;utils.py` by concentrating pure helpers here.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`helpers.py`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>If helpers are domain-specific, rename to `render<em>helpers.py` or `file</em>helpers.py` for clarity. Keep pure functions and add unit tests.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>`main.py`</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>CLI entrypoint: parse args into the `cfg` dataclass, run `html&#95;renderer`, and print a concise machine-readable summary (JSON) to stdout on success. Return non-zero exit codes on fatal errors.<br></li> <li>Add `--dry-run` option for asset copy simulation.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>Cross-cutting: `cfg` design</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Define a single `Config` dataclass used across modules with documented fields: `embed<em>assets`, `assets</em>dir`, `max<em>workers`, `embed</em>fallbacks`, `concurrency<em>policy`, `log</em>level`, `dry<em>run`.<br></li> <li>Provide `from</em>args()` and `from&#95;env()` helpers to construct from CLI or environment.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>Cross-cutting: logging & observability</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Offer standardized structured logging (timestamps, module, fragment idx, duration<em>ms). Expose a `debug` mode that logs stack traces, and a `quiet` mode that reduces noise.<br></li> <li>Record per-fragment `duration</em>ms` and total `runtime&#95;ms` in `RenderResult`.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>Cross-cutting: testing and CI</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Add unit tests for each module focusing on edge cases: sanitizer XSS, markdown edge cases, atomic writes under simulated failures, fragment parsing, and fallback behavior.<br></li> <li>Add integration tests: render a representative Markdown table set and assert fragment counts, row counts, and presence of assets.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>Cross-cutting: performance & streaming</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Provide streaming APIs where possible: `render<em>table</em>stream(writer)` for chunked output and `atomic<em>write</em>stream` in `core<em>io` to support large outputs without building full HTML in memory.<br></li> <li>Expose a `performance</em>report` summary in `RenderResult` listing slow fragments.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>Cross-cutting: security</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Ensure `sanitize&#95;html` is always applied to generated fragments unless caller explicitly marks content as trusted. Document the trusted mode clearly.<br></li> <li>Make URL/asset checks strict by default; allow relaxed mode via `cfg`.</li> </ul></p></td></tr>
<tr><td data-label="File"><p><strong>Cross-cutting: developer ergonomics</strong></p></td><td data-label="Conceptual improvements"><p><ul> <li>Provide a `debug` config that raises on first exception. Provide `--inspect` mode to dump intermediate fragment HTML for debugging.<br></li> <li>Provide clear README sections for: plugin points, how to override assets, and how to plug a custom `render&#95;table` implementation.</li> </ul></p></td></tr>
</tbody></table></div>
  <div class='row-count'></div>
</div>
<script src="assets/xlsx.full.min.js?v=1758615668" defer></script>
<script src="assets/script.js?v=1758615668" defer></script>
<script src="assets/worker.js?v=1758615668" defer></script>

<script>
(function(){
  const template = "{table}_{date}";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', '');
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) {
          alert('Export refused: html too large');
          return;
        }
        if(window.Worker) {
          const worker = new Worker((function(){
            try{ return 'assets/worker.js'; }catch(e){ return null; }
          })());
          if(worker){
            worker.postMessage({html:html, format:'pdf'});
            worker.onmessage = function(e){ console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
          } else {
            alert('Worker not available');
          }
        } else {
          alert('Export worker not supported in this environment.');
        }
      } catch(err) {
        console.warn('Export failed', err);
        alert('Export worker not available. See console for details.');
      }
    });
  }
})();
</script>

</div>
</body>
</html>