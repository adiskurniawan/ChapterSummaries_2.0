<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1760034609">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header"><div><h1>Tables Viewer v2.1</h1></div><div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" type="search" placeholder="Search" aria-label="Search tables" style="min-width:420px; width:44ch;"/>
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllMdBtn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset all tables">Reset All Tables</button>
</div></div>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li>
<li class="toc-item"><a class="toc-link" href="#Table7">Table 7</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Book_8009_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Feature"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Feature</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Module"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Module</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Present?"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Present?</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Feature"> Row normalization / padding       </td><td data-label="Module"> <code>convert.py</code>         </td><td data-label="Present?"> TBD      </td><td data-label="Notes"> Handle uneven rows, fill missing cells            </td></tr><tr><td data-label="Feature"> Whitespace cleanup                </td><td data-label="Module"> <code>convert.py</code>         </td><td data-label="Present?"> TBD      </td><td data-label="Notes"> Trim spaces, convert None → ""                    </td></tr><tr><td data-label="Feature"> Column type detection             </td><td data-label="Module"> <code>convert.py</code>         </td><td data-label="Present?"> TBD      </td><td data-label="Notes"> Numeric, text, code, date, mixed                  </td></tr><tr><td data-label="Feature"> Markdown parsing / normalization  </td><td data-label="Module"> <code>markdown.py</code>        </td><td data-label="Present?"> TBD      </td><td data-label="Notes"> Handle malformed Markdown tables                  </td></tr><tr><td data-label="Feature"> Placeholder for missing cells     </td><td data-label="Module"> <code>core_table.py</code>      </td><td data-label="Present?"> TBD      </td><td data-label="Notes"> Render <code>–</code> or custom placeholder                  </td></tr><tr><td data-label="Feature"> Column-type CSS styling           </td><td data-label="Module"> <code>core_table.py</code>      </td><td data-label="Present?"> TBD      </td><td data-label="Notes"> Right-align numeric, monospace code               </td></tr><tr><td data-label="Feature"> Export-ready CSV/JSON/XLSX        </td><td data-label="Module"> <code>core_table.py</code>      </td><td data-label="Present?"> TBD      </td><td data-label="Notes"> Ensure consistent column count                    </td></tr><tr><td data-label="Feature"> Collapsible / lazy-loaded rows    </td><td data-label="Module"> <code>core_table.py</code> / JS </td><td data-label="Present?"> TBD      </td><td data-label="Notes"> Efficient rendering for large tables              </td></tr><tr><td data-label="Feature"> Fail-safe rendering               </td><td data-label="Module"> <code>core_renderer.py</code>   </td><td data-label="Present?"> TBD      </td><td data-label="Notes"> Render error placeholder instead of crashing      </td></tr><tr><td data-label="Feature"> Diagnostics panel                 </td><td data-label="Module"> <code>core_renderer.py</code>   </td><td data-label="Present?"> TBD      </td><td data-label="Notes"> Show row/column counts, padded cells, mixed types </td></tr><tr><td data-label="Feature"> Deduplicated assets               </td><td data-label="Module"> <code>core_assets.py</code>     </td><td data-label="Present?"> TBD      </td><td data-label="Notes"> Avoid duplicate JS/CSS injection                  </td></tr><tr><td data-label="Feature"> Configurable fragment concurrency </td><td data-label="Module"> <code>core_fragments.py</code>  </td><td data-label="Present?"> TBD      </td><td data-label="Notes"> Stream large tables safely                        </td></tr><tr><td data-label="Feature"> Batch CLI handling                </td><td data-label="Module"> <code>cli.py</code>             </td><td data-label="Present?"> TBD      </td><td data-label="Notes"> Process multiple files, optional diagnostics      </td></tr></tbody></table></div><div class="row-count">Rows: 13</div></div><div class="table-caption" id="Table2" data-table="Book_8009_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Stage"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Stage</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by File"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">File</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Purpose"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Purpose</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Risk"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Risk</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Status"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Status</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Stage">1</td><td data-label="File"> <code>convert.py</code>        </td><td data-label="Purpose"> Add robust CSV parser & detection           </td><td data-label="Risk"> Low      </td><td data-label="Status"> Partially done        </td></tr><tr><td data-label="Stage">2</td><td data-label="File"> <code>core_fragments.py</code> </td><td data-label="Purpose"> Recognize and normalize CSV fragments       </td><td data-label="Risk"> Medium   </td><td data-label="Status"> Next step             </td></tr><tr><td data-label="Stage">3</td><td data-label="File"> <code>core_table.py</code>     </td><td data-label="Purpose"> Ensure table renderer supports CSV row data </td><td data-label="Risk"> Low      </td><td data-label="Status"> Review after Stage 2  </td></tr><tr><td data-label="Stage">4</td><td data-label="File"> <code>core_renderer.py</code>  </td><td data-label="Purpose"> Ensure orchestrator includes CSV tables     </td><td data-label="Risk"> Very low </td><td data-label="Status"> Adjust fallback logic </td></tr><tr><td data-label="Stage">5</td><td data-label="File"> —                   </td><td data-label="Purpose"> Validate with fenced and external CSVs      </td><td data-label="Risk"> —        </td><td data-label="Status"> Pending               </td></tr><tr><td data-label="Stage">6</td><td data-label="File"> All                 </td><td data-label="Purpose"> Backward compatibility guardrails           </td><td data-label="Risk"> —        </td><td data-label="Status"> Always enforced       </td></tr></tbody></table></div><div class="row-count">Rows: 6</div></div><div class="table-caption" id="Table3" data-table="Book_8009_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Aspect**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Aspect</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Details**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Details</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> <strong>Purpose / Goal</strong>      </td><td data-label="Details"> Ensure string cells are consistently formatted: strip leading/trailing spaces, normalize internal runs of whitespace as configured, standardize newlines, and convert <code>None</code> (optionally) to empty string <code>&quot;&quot;</code>. Remove invisible characters like non-breaking spaces and zero-width spaces that can cause parsing or display bugs.                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Aspect"> <strong>Context in Pipeline</strong> </td><td data-label="Details"> Runs immediately <strong>after</strong> row normalization and <strong>before</strong> column type detection. At this point the table matrix is rectangular, so the cleanup can safely iterate every cell by index. Clean input improves type detection and normalized Markdown rendering.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Aspect"> <strong>Input / Output</strong>      </td><td data-label="Details"> <strong>Input:</strong> <code>Table</code> with <code>.headers</code>, <code>.rows</code>, <code>.meta</code>. Cells may be strings, <code>None</code>, numbers, dicts, etc.  <strong>Output:</strong> same <code>Table</code> mutated in-place: textual cells are normalized; <code>None</code> converted to <code>&quot;&quot;</code> unless <code>preserve_none=True</code>; <code>meta</code> gains <code>whitespace_stats</code>. Non-string cells left untouched (but logged if unexpected).                                                                                                                                                                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Aspect"> <strong>Normalization Rules</strong> </td><td data-label="Details"> 1. <strong>Leading/trailing trim:</strong> Remove leading and trailing Unicode whitespace from the string.  <br>2. <strong>Internal compression (optional):</strong> Replace repeated internal whitespace (spaces/tabs) with a single space, unless the cell is marked as code or <code>compress_internal=False</code>.  <br>3. <strong>Newline standardization:</strong> Convert <code>\r\n</code> and <code>\r</code> to <code>\n</code>.  <br>4. <strong>Non-breaking space normalization:</strong> Convert <code>\u00A0</code> → regular space.  <br>5. <strong>Zero-width characters (optional):</strong> Remove zero-width spaces and similar if <code>remove_zero_width=True</code>.  <br>6. <strong>None coercion:</strong> If <code>preserve_none=False</code>, convert <code>None</code> → <code>&quot;&quot;</code>.  <br>7. <strong>Code/preformatted cells skip:</strong> If <code>skip_code_cells=True</code>, skip trimming/compression for cells marked as code (by parser metadata). </td></tr><tr><td data-label="Aspect"> <strong>Header Treatment</strong> </td><td data-label="Details"> Headers get identical normalization (trim, newline normalization). This prevents visual misalignment and ensures exported CSV/JSON keys are clean. </td></tr><tr><td data-label="Aspect"> <strong>Interaction with Type Detection</strong> </td><td data-label="Details"> Removing stray whitespace makes numeric/date detection more reliable (e.g., <code>&quot; 42 &quot;</code> → <code>&quot;42&quot;</code>). Document that whitespace normalization runs <strong>before</strong> type detection. If a user wants to treat padded spaces as semantic, they must pass options to preserve them. </td></tr><tr><td data-label="Aspect"> <strong>Edge Cases & Special Handling</strong> </td><td data-label="Details"> • <strong>Code / fenced cells:</strong> preserve internal whitespace and indentation if <code>skip_code_cells=True</code>.  <br>• <strong>Multiline cells:</strong> by default, normalize newline endings but do not collapse <code>\n</code> unless explicitly requested.  <br>• <strong>Cells beginning with <code>=</code> (formulas):</strong> option to skip to avoid altering spreadsheet formulas.  <br>• <strong>Non-string objects:</strong> if a cell holds a list/dict, emit a warning and leave unchanged. </td></tr><tr><td data-label="Aspect"> <strong>Testing Matrix</strong> </td><td data-label="Details"> Tests should cover:  <br>1. Leading/trailing whitespace removal.  <br>2. Internal whitespace collapse on repeated spaces/tabs.  <br>3. Tab expansion behavior.  <br>4. <code>None</code> → <code>&quot;&quot;</code> conversion and <code>preserve_none</code> toggling.  <br>5. Skipping code cells.  <br>6. <code>dry_run</code> returns correct counts and makes no changes.  <br>7. Re-running is idempotent (no extra changes). </td></tr><tr><td data-label="Aspect"> <strong>Performance</strong> </td><td data-label="Details"> Complexity O(total_cells). Use compiled regex and in-place string ops. For very large tables, support chunked/fragmented processing in <code>core_fragments.py</code> to avoid long single-threaded runs. Keep <code>whitespace_stats</code> aggregated per fragment. </td></tr><tr><td data-label="Aspect"> <strong>CLI Flags & UX</strong> </td><td data-label="Details"> Suggested flags:  <br><code>--preserve-none</code>  <br><code>--no-compress-whitespace</code>  <br><code>--no-newline-normalize</code>  <br><code>--tabsize &lt;n&gt;</code>  <br><code>--remove-zero-width</code>  <br>CLI summary prints <code>table.meta[&quot;whitespace_stats&quot;]</code>. </td></tr><tr><td data-label="Aspect"> <strong>Renderer / UI Implications</strong> </td><td data-label="Details"> Clean data reduces layout jitter and inconsistent wrapping in HTML. Optionally provide a debug overlay that highlights cells changed by cleanup (useful during QA). </td></tr><tr><td data-label="Aspect"> <strong>Export Behavior</strong> </td><td data-label="Details"> Post-cleanup exports are cleaner:  <br>- CSV: no trailing spaces in fields.  <br>- JSON: strings free of invisibles.  <br>- XLSX: Excel cells receive cleaned text (no stray <code>\r</code>/<code>\r\n</code>).  <br>Exporter mapping for <code>None</code> should respect <code>preserve_none</code>. </td></tr><tr><td data-label="Aspect"> <strong>Error Handling & Fail-safe</strong> </td><td data-label="Details"> On encoding errors or unexpected types, add <code>table.meta[&quot;cleanup_failed&quot;]=True</code> and append diagnostics; return the table unmodified if critical failure. Prefer graceful degradation over raising in batch mode. </td></tr><tr><td data-label="Aspect"> <strong>Security Considerations</strong> </td><td data-label="Details"> Detect and remove invisible characters that can be used in phishing or tricking viewers (e.g., zero-width joiner). Optionally sanitize characters that could cause CSV injection (cells starting with <code>=</code>, <code>+</code>, <code>-</code>, <code>@</code>), controlled by a separate <code>sanitize_csv</code> option. </td></tr><tr><td data-label="Aspect"> <strong>Extensibility</strong> </td><td data-label="Details"> Future options:  <br>- Unicode normalization (<code>NFC</code>/<code>NFKC</code>)  <br>- Column-level policies (skip cleanup for address column)  <br>- Locale-aware whitespace handling (CJK full-width space preservation)  </td></tr><tr><td data-label="Aspect"> <strong>Integration with Fragments</strong> </td><td data-label="Details"> When processing fragments, each fragment emits <code>whitespace_stats</code>; merge them in <code>table.meta</code>. This allows streaming large datasets and still getting accurate totals. </td></tr><tr><td data-label="Aspect"> <strong>Docstring / Documentation</strong> </td><td data-label="Details"> Include examples of before/after, and a clear note: <em>“Whitespace cleanup is structural and deterministic — use <code>preserve_none=True</code> to retain <code>None</code> as semantic <code>null</code>.”</em> </td></tr><tr><td data-label="Aspect"> <strong>Dry-run Mode</strong> </td><td data-label="Details"> <code>dry_run=True</code> returns stats only and does not mutate table. Useful for previewing changes in CLI or web UI. </td></tr><tr><td data-label="Aspect"> <strong>Idempotency</strong> </td><td data-label="Details"> Re-running cleanup should result in zero further changes and <code>whitespace_stats</code> reflecting no additional modifications. This determinism supports caching and repeated pipelines. </td></tr><tr><td data-label="Aspect"> <strong>Summary</strong> </td><td data-label="Details"> Deterministic, configurable sanitation of textual cells that removes invisible/errant whitespace, standardizes newline behavior, and converts <code>None</code> to empty strings by default — improving reliability of type detection, rendering, and exports. </td></tr></tbody></table></div><div class="row-count">Rows: 20</div></div><div class="table-caption" id="Table4" data-table="Book_8009_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Aspect**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Aspect</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Details**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Details</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> <strong>Purpose / Goal</strong>           </td><td data-label="Details"> Determine the semantic type of each column to improve rendering, CSS styling, validation, and export behavior. Supported types include:  <br>1. <strong>Numeric</strong> — integers or floats  <br>2. <strong>Text</strong> — general string content  <br>3. <strong>Code</strong> — fenced or inline code blocks  <br>4. <strong>Date/Time</strong> — ISO-like or human-readable formats  <br>5. <strong>Mixed</strong> — heterogeneous content detected in the same column.                                                                                                                                                                                      </td></tr><tr><td data-label="Aspect"> <strong>Context in Pipeline</strong>      </td><td data-label="Details"> Runs <strong>after row normalization</strong> and <strong>whitespace cleanup</strong>, ensuring consistent cell lengths and clean text. Accurate type detection is crucial for alignment (numbers right-aligned, code monospace) and for downstream exporters that rely on type metadata.                                                                                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Aspect"> <strong>Input / Output</strong>           </td><td data-label="Details"> <strong>Input:</strong> normalized <code>Table</code> with clean <code>.rows</code>, <code>.headers</code>, <code>.meta</code>.  <br><strong>Output:</strong> <code>.meta[&quot;column_types&quot;]</code> list matching number of columns, e.g., <code>[&quot;text&quot;,&quot;numeric&quot;,&quot;date&quot;,&quot;code&quot;,&quot;mixed&quot;]</code>. Optional per-column metadata includes confidence score, detected sample values, and inferred format.                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Aspect"> <strong>Detection Rules</strong>          </td><td data-label="Details"> 1. <strong>Numeric:</strong> Detect integer/float patterns, optionally stripping thousands separators and currency symbols.  <br>2. <strong>Date/Time:</strong> Use regex heuristics and <code>dateutil.parser</code> to detect ISO-8601, common US/EU formats, and datetime strings.  <br>3. <strong>Code:</strong> Identify fenced Markdown blocks, backtick spans, or language hints.  <br>4. <strong>Text:</strong> Default fallback when other types do not match.  <br>5. <strong>Mixed:</strong> Flag column if >5% of cells differ in type from majority.  <br>6. <strong>Null cells (<code>None</code> or empty):</strong> Ignored in type majority calculation but counted for diagnostics. </td></tr><tr><td data-label="Aspect"> <strong>Header Treatment</strong> </td><td data-label="Details"> Column headers are not analyzed for type detection but are stored in metadata. Optional: infer type from first row if headers are not reliable. </td></tr><tr><td data-label="Aspect"> <strong>Edge Cases & Special Handling</strong> </td><td data-label="Details"> • <strong>Empty column:</strong> Type defaults to <code>text</code>.  <br>• <strong>Mixed numeric/date formats:</strong> Prefer numeric if parsing succeeds, fallback to date if majority parses.  <br>• <strong>Code embedded in text:</strong> Identify fenced/backtick spans and classify as code only if consistent.  <br>• <strong>Large tables:</strong> Sample subset for speed; report estimated confidence. </td></tr><tr><td data-label="Aspect"> <strong>Testing Strategy</strong> </td><td data-label="Details"> 1. Columns of integers/floats → numeric.  <br>2. ISO/US/EU date strings → date.  <br>3. Mixed types below threshold → majority type.  <br>4. Mixed types above threshold → <code>mixed</code>.  <br>5. Code blocks with backticks/fenced → code.  <br>6. Empty columns → text.  <br>7. <code>type_hints</code> override works.  <br>8. Idempotency: repeated detection yields same metadata. </td></tr><tr><td data-label="Aspect"> <strong>Performance Considerations</strong> </td><td data-label="Details"> Complexity O(R·C) for full scan. Sampling reduces this to O(S·C), where S ≤ R. Parsing libraries optimized with try/except blocks. Parallelization possible per column for very large tables. </td></tr><tr><td data-label="Aspect"> <strong>Renderer / UI Implications</strong> </td><td data-label="Details"> Column types drive CSS: numeric → right-align, code → monospace, dates → formatted as needed. <code>mixed</code> columns may receive warning badges in diagnostics panel. </td></tr><tr><td data-label="Aspect"> <strong>Export Behavior</strong> </td><td data-label="Details"> Accurate types improve export:  <br>- CSV: numeric cells remain numeric literals.  <br>- JSON: numbers vs strings preserved.  <br>- XLSX: Excel cell types set correctly.  <br>Fallback for <code>mixed</code> columns: export as text. </td></tr><tr><td data-label="Aspect"> <strong>Error Handling & Fail-safe</strong> </td><td data-label="Details"> Parsing errors (invalid numeric/date) are logged to <code>table.diagnostics</code> with cell coordinates. Column type defaults to <code>text</code> if detection fails. </td></tr><tr><td data-label="Aspect"> <strong>CLI Flags</strong> </td><td data-label="Details"> Suggested:  <br><code>--force-type &lt;col_index&gt;=&lt;type&gt;</code>  <br><code>--max-sample &lt;N&gt;</code>  <br><code>--mixed-threshold &lt;fraction&gt;</code>  <br>CLI output: summary table of column types and confidence scores. </td></tr><tr><td data-label="Aspect"> <strong>Integration Hooks</strong> </td><td data-label="Details"> Optional callbacks:  <br><code>on_column_type_detected(col_index, detected_type, confidence)</code> for UI/analytics dashboards. </td></tr><tr><td data-label="Aspect"> <strong>Dry-run Mode</strong> </td><td data-label="Details"> <code>dry_run=True</code> computes types and diagnostics only, without modifying metadata in-place. Useful for previewing type assignments. </td></tr><tr><td data-label="Aspect"> <strong>Idempotency</strong> </td><td data-label="Details"> Re-running on same cleaned table yields identical types. Deterministic: order of rows does not affect type if <code>max_sample_rows=None</code>. </td></tr><tr><td data-label="Aspect"> <strong>Extensibility</strong> </td><td data-label="Details"> Support for:  <br>1. Custom type parsers (e.g., currency, percentages).  <br>2. Multi-locale numeric/date parsing.  <br>3. Column-specific thresholds for mixed detection. </td></tr><tr><td data-label="Aspect"> <strong>Versioning / Compatibility</strong> </td><td data-label="Details"> Metadata stored in <code>table.meta[&quot;column_types_version&quot;]=&quot;1.0&quot;</code>. Ensures backward-compatible interpretation across pipelines. </td></tr><tr><td data-label="Aspect"> <strong>Summary</strong> </td><td data-label="Details"> Reliable, configurable column type detection based on cell content analysis. Supports numeric, date, code, text, and mixed types. Provides diagnostic metadata, configurable sampling, and deterministic output to ensure downstream rendering, CSS styling, and exports function correctly. </td></tr></tbody></table></div><div class="row-count">Rows: 18</div></div><div class="table-caption" id="Table5" data-table="Book_8009_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Aspect**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Aspect</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Details**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Details</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by .1"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">.1</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> <strong>Purpose / Goal</strong>                     </td><td data-label="Details"> Transform Markdown tables, including malformed ones, into a structured, rectangular Table object suitable for downstream processing. Handle inconsistent pipes, missing delimiters, misaligned columns, empty rows, or broken fences. Ensure the internal representation is consistent and predictable.                                                </td><td data-label=".1">     </td></tr><tr><td data-label="Aspect"> <strong>Context in Pipeline</strong>                </td><td data-label="Details"> First parsing step for Markdown input. Occurs before row normalization, whitespace cleanup, and column type detection. Outputs a Table object with raw cell content, preserving Markdown syntax for code fences or inline formatting.                                                                                                                  </td><td data-label=".1">     </td></tr><tr><td data-label="Aspect"> <strong>Input / Output</strong>                     </td><td data-label="Details"> <strong>Input:</strong> Raw Markdown string (possibly malformed).  <br><strong>Output:</strong> Table object with <code>.headers</code>, <code>.rows</code>, and preliminary <code>.meta</code>. Includes flags marking cells as code, inline Markdown, or escaped content.                                                                                                                                       </td><td data-label=".1">     </td></tr><tr><td data-label="Aspect"> <strong>Parsing Rules</strong>                      </td><td data-label="Details"> 1. Detect table boundaries (fences `                                                                                                                                                                                                                                                                                                                   </td><td data-label=".1"> --- </td></tr><tr><td data-label="Aspect"> <strong>Error Handling / Tolerance</strong>         </td><td data-label="Details"> Malformed rows (too many or too few cells) are allowed; padding occurs in later stages. Diagnostics record inconsistencies: missing pipes, uneven columns, empty rows. Strict mode may reject tables with unbalanced fences.                                                                                                                           </td><td data-label=".1">     </td></tr><tr><td data-label="Aspect"> <strong>Integration with Row Normalization</strong> </td><td data-label="Details"> Output rows may be irregular; row normalization ensures a consistent, rectangular table. Metadata from parsing flags code cells and special inline syntax for downstream stages.                                                                                                                                                                       </td><td data-label=".1">     </td></tr><tr><td data-label="Aspect"> <strong>Header Treatment</strong>                   </td><td data-label="Details"> Detect header row if first row contains non-empty cells and is followed by a pipe/separator row. Mark header length and content for alignment with body rows.                                                                                                                                                                                          </td><td data-label=".1">     </td></tr><tr><td data-label="Aspect"> <strong>Diagnostics / Metadata</strong>             </td><td data-label="Details"> 1. <code>meta[&quot;rows_parsed&quot;]</code> – total number of rows detected.  <br>2. <code>meta[&quot;columns_detected&quot;]</code> – preliminary column count.  <br>3. <code>meta[&quot;malformed_rows&quot;]</code> – indices of rows with inconsistent cell counts.  <br>4. <code>meta[&quot;code_cells&quot;]</code> – coordinates of fenced or inline code.  <br>Diagnostics allow reporting malformed structures without failing. </td><td data-label=".1">     </td></tr><tr><td data-label="Aspect"> <strong>Edge Cases</strong>                         </td><td data-label="Details"> • Missing header separator row.  <br>• Inconsistent number of pipes per row.  <br>• Embedded newlines in a single Markdown cell.  <br>• Code fences spanning multiple rows.  <br>• Leading/trailing whitespace affecting split.                                                                                                                        </td><td data-label=".1">     </td></tr><tr><td data-label="Aspect"> <strong>Testing Strategy</strong>                   </td><td data-label="Details"> 1. Tables with missing leading/trailing pipes.  <br>2. Uneven rows.  <br>3. Multi-line cells.  <br>4. Inline and fenced code blocks.  <br>5. Tables embedded within other Markdown elements (lists, blockquotes).                                                                                                                                      </td><td data-label=".1">     </td></tr><tr><td data-label="Aspect"> <strong>Performance Considerations</strong>         </td><td data-label="Details"> Linear scan over lines. Handles large Markdown documents by processing line-by-line, with early detection of code blocks to prevent excessive parsing.                                                                                                                                                                                                 </td><td data-label=".1">     </td></tr><tr><td data-label="Aspect"> <strong>Renderer / UI Implications</strong>         </td><td data-label="Details"> Output Table object allows renderer to accurately display Markdown tables with correct alignment and code styling. Inline formatting preserved for later HTML/CSS rendering.                                                                                                                                                                           </td><td data-label=".1">     </td></tr><tr><td data-label="Aspect"> <strong>Export Behavior</strong>                    </td><td data-label="Details"> Once normalized, tables can be exported to CSV, JSON, or Excel with consistent column alignment. Malformed cells are padded or flagged without loss of data.                                                                                                                                                                                           </td><td data-label=".1">     </td></tr><tr><td data-label="Aspect"> <strong>CLI / Configuration</strong>                </td><td data-label="Details"> Options for strict parsing (abort on malformed tables) vs tolerant mode (auto-fix row lengths). Summary output shows number of rows, columns, malformed entries, and code cells detected.                                                                                                                                                              </td><td data-label=".1">     </td></tr><tr><td data-label="Aspect"> <strong>Extensibility</strong>                      </td><td data-label="Details"> Future support for GitHub-flavored Markdown, pipe-escaped tables, multi-line content within cells, and embedded HTML tags.                                                                                                                                                                                                                             </td><td data-label=".1">     </td></tr><tr><td data-label="Aspect"> <strong>Dry-run / Preview Mode</strong>             </td><td data-label="Details"> Generate diagnostics without altering raw input, useful for previewing potential parsing issues in CLI or UI.                                                                                                                                                                                                                                          </td><td data-label=".1">     </td></tr><tr><td data-label="Aspect"> <strong>Idempotency</strong>                        </td><td data-label="Details"> Re-parsing the same Markdown input produces identical Table object and metadata, supporting deterministic pipelines.                                                                                                                                                                                                                                   </td><td data-label=".1">     </td></tr><tr><td data-label="Aspect"> <strong>Design Philosophy</strong>                  </td><td data-label="Details"> Be forgiving: parse what is present, mark inconsistencies for diagnostics, and defer structural fixes to later stages (normalization, cleanup). Preserve original Markdown semantics for accurate rendering and export.                                                                                                                                </td><td data-label=".1">     </td></tr><tr><td data-label="Aspect"> <strong>Summary</strong>                            </td><td data-label="Details"> Converts potentially malformed Markdown tables into consistent, structured Table objects. Captures code spans, inline formatting, and cell boundaries while providing rich diagnostics for later normalization, type detection, and rendering. Enables resilient pipelines even with messy Markdown input.                                             </td><td data-label=".1">     </td></tr></tbody></table></div><div class="row-count">Rows: 19</div></div><div class="table-caption" id="Table6" data-table="Book_8009_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Aspect**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Aspect</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Details**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Details</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> <strong>Purpose / Goal</strong>                  </td><td data-label="Details"> Provide a visual or semantic marker for missing data, whether originally <code>None</code> or introduced via row padding. Enhances clarity in table renderings and prevents empty cells from being misinterpreted as valid data.                                                                                                                                                                                </td></tr><tr><td data-label="Aspect"> <strong>Context in Pipeline</strong>             </td><td data-label="Details"> Runs <strong>after row normalization</strong> and <strong>before rendering</strong>. Ensures that every cell in the Table object has a defined value for display and export, even if the value is a placeholder. Works hand-in-hand with whitespace cleanup and column type detection to maintain consistent appearance.                                                                                                       </td></tr><tr><td data-label="Aspect"> <strong>Input / Output</strong>                  </td><td data-label="Details"> <strong>Input:</strong> Table object with potentially missing or padded cells.  <br><strong>Output:</strong> Table object where missing cells are replaced with configured placeholder (e.g., <code>None</code>, <code>&quot;&quot;</code>, <code>&quot;-&quot;</code>, or <code>&quot;N/A&quot;</code>), and metadata tracks which cells were placeholders.                                                                                                                                             </td></tr><tr><td data-label="Aspect"> <strong>Placeholder Rules</strong>               </td><td data-label="Details"> 1. Default placeholder is <code>None</code> unless overridden.  <br>2. Placeholder is configurable per table or per column.  <br>3. Distinguish between <strong>originally missing</strong> vs <strong>padded</strong> cells in metadata.  <br>4. Placeholder should be visually subtle but semantically clear.  <br>5. Code or numeric cells may receive type-consistent placeholders if desired (e.g., <code>0</code> for numeric, <code>&quot;&quot;</code> for text). </td></tr><tr><td data-label="Aspect"> <strong>Metadata & Diagnostics</strong>          </td><td data-label="Details"> 1. <code>table.meta[&quot;placeholders&quot;]</code> – list of <code>(row_index, col_index)</code> where placeholder applied.  <br>2. <code>table.diagnostics</code> logs: e.g., <code>&quot;Cell (3,4) replaced with placeholder &#x27;-&#x27;.&quot;</code>  <br>3. Track counts per placeholder type and column for reports.                                                                                                                                                </td></tr><tr><td data-label="Aspect"> <strong>Header Treatment</strong>                </td><td data-label="Details"> Headers are not assigned placeholders; placeholders only apply to body cells. Ensures alignment with header-defined columns.                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Aspect"> <strong>Renderer / UI Implications</strong>      </td><td data-label="Details"> 1. Placeholder cells may be visually styled differently (e.g., grayed background, italic, dashed border).  <br>2. Tooltip or hover info can indicate <code>&quot;Auto-filled placeholder&quot;</code>.  <br>3. Consistent alignment with column types: numeric placeholders right-aligned, code placeholders monospace.                                                                                                   </td></tr><tr><td data-label="Aspect"> <strong>Export Behavior</strong>                 </td><td data-label="Details"> 1. CSV: placeholder written as-is.  <br>2. JSON: placeholder can be <code>null</code> or literal string.  <br>3. XLSX: placeholder appears in cell; optional style formatting applied.  <br>4. Users can configure whether placeholder should round-trip (retain) or revert to <code>None</code> in export.                                                                                                                </td></tr><tr><td data-label="Aspect"> <strong>Edge Cases</strong>                      </td><td data-label="Details"> • Multi-type columns: placeholder must match column type for rendering consistency.  <br>• Sparse data: ensure placeholder does not overwrite valid entries.  <br>• Lazy-loaded or collapsible rows: placeholder must be present in DOM for accurate incremental rendering.                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Integration with Other Features</strong> </td><td data-label="Details"> • Works with row normalization to mark padded cells.  <br>• Whitespace cleanup may still modify placeholder strings if they are textual.  <br>• Column type detection uses placeholders to infer correct type without being misled by missing data.                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Configuration / CLI</strong>             </td><td data-label="Details"> CLI flags:  <br>– <code>--placeholder &lt;value&gt;</code>  <br>– <code>--column-placeholders &lt;col_index&gt;=&lt;value&gt;</code>  <br>Summary output: number of placeholders applied per column.                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Aspect"> <strong>Idempotency</strong>                     </td><td data-label="Details"> Re-applying placeholder assignment should not modify already-filled cells. Deterministic placement ensures repeated rendering is identical.                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Extensibility</strong>                   </td><td data-label="Details"> Future support for:  <br>1. Conditional placeholders based on cell type.  <br>2. Dynamic placeholder functions (e.g., <code>&quot;Missing &quot; + column_name</code>).  <br>3. UI-driven override or per-row styling.                                                                                                                                                                                                    </td></tr><tr><td data-label="Aspect"> <strong>Testing Strategy</strong>                </td><td data-label="Details"> 1. Table with varying missing/padded cells → placeholder applied consistently.  <br>2. Column-specific placeholder overrides.  <br>3. Renderer displays placeholder correctly.  <br>4. Export produces expected placeholder in CSV/JSON/XLSX.  <br>5. Idempotency: repeated application has no effect.                                                                                               </td></tr><tr><td data-label="Aspect"> <strong>Design Philosophy</strong>               </td><td data-label="Details"> Aim for clarity and consistency. Placeholders signal absent data without confusing the user or corrupting export semantics. Metadata provides full traceability.                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Aspect"> <strong>Summary</strong>                         </td><td data-label="Details"> Ensures every missing or padded cell has a clearly defined representation, improving rendering consistency, export reliability, and diagnostic reporting. Works transparently with normalization, cleanup, and type detection for downstream operations.                                                                                                                                             </td></tr></tbody></table></div><div class="row-count">Rows: 16</div></div><div class="table-caption" id="Table7" data-table="Book_8009_07" style="margin-top:2mm;margin-left:3mm;"><strong>Table 7</strong></div>
<div class="table-wrapper" data-table-id="table-7"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Aspect**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Aspect</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Details**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Details</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> <strong>Purpose / Goal</strong>                  </td><td data-label="Details"> Ensure visual alignment and presentation of table columns according to their semantic type. Numeric columns are right-aligned, text columns left-aligned, code columns use monospace font, dates follow a consistent format, and mixed columns indicate ambiguity.                                                                                                                                                                                            </td></tr><tr><td data-label="Aspect"> <strong>Context in Pipeline</strong>             </td><td data-label="Details"> Runs <strong>after column type detection</strong>. Table rows are already normalized and cleaned. Styling is applied as part of rendering metadata, influencing HTML output, CSS class assignments, and optionally exporter formatting.                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Aspect"> <strong>Input / Output</strong>                  </td><td data-label="Details"> <strong>Input:</strong> Table object with <code>.rows</code> and <code>.meta[&quot;column_types&quot;]</code>.  <br><strong>Output:</strong> Table cells annotated with CSS classes or style hints. Renderers use these classes to produce correct alignment and font.                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Styling Rules</strong>                   </td><td data-label="Details"> 1. <strong>Numeric:</strong> right-aligned, optional thousand separators or decimal formatting.  <br>2. <strong>Text:</strong> left-aligned, wrap naturally.  <br>3. <strong>Code:</strong> monospace font, preserve whitespace.  <br>4. <strong>Date:</strong> right-aligned or center, formatted consistently (ISO or locale-aware).  <br>5. <strong>Mixed:</strong> may receive a neutral style or subtle warning highlight to indicate heterogeneous data.  <br>6. Custom class mapping is configurable per user or theme. </td></tr><tr><td data-label="Aspect"> <strong>Metadata / Diagnostics</strong>          </td><td data-label="Details"> <code>table.meta[&quot;column_styles&quot;]</code> stores class names per column, e.g., <code>[&quot;text-left&quot;, &quot;numeric-right&quot;, &quot;code-mono&quot;, &quot;date-center&quot;, &quot;mixed&quot;]</code>.  <br>Diagnostics can flag columns with unexpected types or inconsistent styling.                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Aspect"> <strong>Edge Cases</strong>                      </td><td data-label="Details"> • Columns detected as <code>mixed</code> may still contain numeric or date values; decide on alignment fallback.  <br>• Empty or placeholder cells adopt neutral alignment.  <br>• Multi-type code/text columns: monospace applied if code proportion exceeds threshold.                                                                                                                                                                                                 </td></tr><tr><td data-label="Aspect"> <strong>Renderer / UI Implications</strong>      </td><td data-label="Details"> 1. CSS classes ensure consistent display across browsers.  <br>2. Tooltips or hover effects may reveal type or diagnostic info.  <br>3. Responsive tables may collapse or scroll while preserving alignment.                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Aspect"> <strong>Export Behavior</strong>                 </td><td data-label="Details"> 1. CSV: alignment not applicable, but text can be padded if needed.  <br>2. JSON: no direct effect.  <br>3. XLSX/Excel: numeric/date/code alignment mapped to cell formatting.                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Aspect"> <strong>Testing Strategy</strong>                </td><td data-label="Details"> 1. Verify numeric columns right-aligned visually.  <br>2. Code columns preserve monospace font.  <br>3. Date columns display uniformly.  <br>4. Mixed columns show neutral or warning style.  <br>5. Empty/placeholder cells do not break alignment.                                                                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Configuration / Extensibility</strong>   </td><td data-label="Details"> 1. Custom CSS class mapping per type.  <br>2. Theme support (light/dark mode).  <br>3. Optional per-column overrides.                                                                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Aspect"> <strong>Integration with Other Features</strong> </td><td data-label="Details"> Works in tandem with:  <br>• Column type detection (source of truth).  <br>• Placeholder handling (ensures placeholder cells adopt consistent alignment).  <br>• Lazy-loading (styling metadata preserved in virtualized DOM).                                                                                                                                                                                                                                </td></tr><tr><td data-label="Aspect"> <strong>Idempotency</strong>                     </td><td data-label="Details"> Re-applying CSS styling does not alter existing class assignments unnecessarily. Deterministic mapping ensures reproducibility across render passes.                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Aspect"> <strong>Design Philosophy</strong>               </td><td data-label="Details"> Present data clearly without altering content. Alignment and font selection improve readability and highlight column semantics without interfering with exports or downstream data processing.                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Aspect"> <strong>Summary</strong>                         </td><td data-label="Details"> Maps semantic column types to CSS classes and styles, providing consistent visual alignment, readable code formatting, and diagnostic cues for mixed or irregular data. Supports downstream renderers and export pipelines.                                                                                                                                                                                                                                   </td></tr></tbody></table></div><div class="row-count">Rows: 14</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>