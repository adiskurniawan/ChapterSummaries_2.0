<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1763049428">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      // Delegate addEventListener/removeEventListener to visible button
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      // Delegate onclick assignments
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      // Delegate focus/blur
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
      // If legacy code used direct addEventListener earlier than this script, listeners would already exist
      // on alias element; attempt to re-dispatch those by cloning them to visible button is non-trivial.
      // This approach covers the common case where legacy scripts query the alias and bind after DOM ready.
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li>
<li class="toc-item"><a class="toc-link" href="#Table7">Table 7</a></li>
<li class="toc-item"><a class="toc-link" href="#Table8">Table 8</a></li>
<li class="toc-item"><a class="toc-link" href="#Table9">Table 9</a></li>
<li class="toc-item"><a class="toc-link" href="#Table10">Table 10</a></li>
<li class="toc-item"><a class="toc-link" href="#Table11">Table 11</a></li>
<li class="toc-item"><a class="toc-link" href="#Table12">Table 12</a></li>
<li class="toc-item"><a class="toc-link" href="#Table13">Table 13</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Docu_0114_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Logic / Structure"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Purpose / high-level</strong>: Provide helper utilities to post-process HTML (ensure page title attributes, inject UI assets, minify, wrap <code>&lt;table&gt;</code> elements with a JS-driven UI wrapper, convert cell newlines, produce bytes output).                                                                                                                                                                                                                                                                                                  </td><td data-label="Conceptual notes"> Targets rendering pipelines that output HTML fragments or pages and need consistent title attributes, table UI injection, and safe embedding of table HTML as JSON payloads or inline script. Designed as a drop-in helper module rather than a full renderer.                                                                                                                                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Public config API</strong>: <code>_DEFAULTS</code> → <code>_renderer_config</code>; <code>set_renderer_config(**kwargs)</code>, <code>get_renderer_config()</code>                                                                                                                                                                                                                                                                                                                                                                                                                    </td><td data-label="Conceptual notes"> Configuration is overridable at runtime and via environment variables. Uses booleans (ensure_title, minify_html, process_path_outputs) and asset paths (table_ui_css, table_ui_js) with a max JSON attribute length control.                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Import diagnostics / optional helpers</strong>: top-level placeholders <code>render_html</code>, <code>render_table</code>, <code>render_page</code>, and helpers (<code>convert_bullets_to_ul</code>, <code>_normalize_list_markers</code>, <code>_unescape_brackets_outside_code</code>, <code>prepare_assets</code>, <code>write_overrides_css</code>) set to <code>None</code>; <code>_try_msgs</code> deque captures import-attempt messages; <code>get_import_diagnostics()</code> reports availability.                                                                                                                                                     </td><td data-label="Conceptual notes"> Module intentionally detects and reports optional external helpers instead of hard-failing. Good for environments where some features live elsewhere. The <code>_try_msgs</code> deque is a lightweight import/diagnostic log for debugging.                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Logic / Structure"> <strong>Input / output types</strong>: functions accept <code>str</code> HTML or <code>bytes</code> (<code>_process_bytes</code>), return processed <code>str</code> or <code>bytes</code>. Several functions operate on HTML fragments (strings). Table wrapper constructs JSON strings then embeds them into HTML attributes or scripts.                                                                                                                                                                                                                                                               </td><td data-label="Conceptual notes"> Primary data flow: HTML string → sanitize/ensure-title/minify → find <code>&lt;table&gt;</code> blocks → wrap each table with a UI wrapper containing either a JSON data-attribute or an inline <code>&lt;script&gt;</code> with escaped JSON → return modified HTML (or bytes).                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Title handling</strong>: <code>_ensure_title_in_h1_fragment()</code> and <code>_ensure_title_attrs_in_str()</code> scan for first <code>&lt;h1..h6&gt;</code> fragment and ensure <code>class</code> and <code>id</code> attributes exist (adds <code>page-title</code> class and <code>pageTitle</code> id by default). Controlled by <code>ensure_title</code> config.                                                                                                                                                                                                                                                                </td><td data-label="Conceptual notes"> Defensive: adds missing attributes rather than replacing heading. Uses regex-based parsing — faster but fragile on malformed HTML or unconventional spacing/quotes. Respects <code>RENDER_TITLE_CLASS</code> / <code>RENDER_TITLE_ID</code> env overrides.                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>Minify logic</strong>: <code>_minify_html_str()</code> tokenizes and attempts to collapse whitespace outside tags. Controlled by <code>minify_html</code> config.                                                                                                                                                                                                                                                                                                                                                                                               </td><td data-label="Conceptual notes"> Lightweight minification (collapse runs of whitespace outside tags). Not a full HTML minifier — safe but can alter whitespace-sensitive content if misapplied.                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Asset normalization & injection</strong>: <code>_normalize_asset_basename()</code> extracts basename; <code>_inject_ui_assets()</code> checks for presence of configured CSS/JS in page <code>&lt;link&gt;</code>/<code>&lt;script&gt;</code> tags (via regex) and inserts missing <code>&lt;link&gt;</code> into <code>&lt;head&gt;</code> or <code>&lt;script&gt;</code> before <code>&lt;/body&gt;</code>/<code>&lt;/head&gt;</code> as fallback.                                                                                                                                                                                                                                   </td><td data-label="Conceptual notes"> Uses regex to find existing assets by basename; inserts tags when missing. Respects <code>table_ui_css</code> and <code>table_ui_js</code> config. Edge: relies on regex that may miss nonstandard tag ordering, multiple <code>&lt;head&gt;</code>/<code>&lt;body&gt;</code> variants, or pages that are partial fragments (no head/body).                                                                                                                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>Table detection & wrapping</strong>: <code>_TABLE_RE</code> locates <code>&lt;table ...&gt;...&lt;/table&gt;</code> spans; <code>_wrap_each_table_with_ui()</code> iterates matches, extracts preceding header (last heading or <code>.table-caption</code>) to create a title, computes a <code>table_id</code> (uses existing <code>id</code> or generates <code>TableN</code>), avoids wrapping if already inside <code>.table-wrapper</code> (heuristic on prev slice), then constructs wrapper HTML either with <code>data-attributes</code> (if JSON payload ≤ max_attr) or with escaped JSON inside a <code>&lt;script&gt;</code> block when payload is too large. </td><td data-label="Conceptual notes"> Produces wrapper markup containing an <code>&lt;h3&gt;</code> title (when no header), a <code>.table-ui</code> container with <code>data-</code> or script payload, and the original table HTML. Data flow enables client-side JS to hydrate UI. Edge: regex-based table finding can stumble on nested tables, malformed markup, or <code>&lt;table&gt;</code> tags inside scripts/styles. The "already wrapped" detection is heuristic (searching for last-opening <code>&lt;div&gt;</code> with <code>.table-wrapper</code>) and may produce false positives/negatives. </td></tr><tr><td data-label="Logic / Structure"> <strong>Cell newline handling</strong>: <code>_convert_newlines_in_table_cells()</code> finds cell tags and replaces <code>\n</code> with <code>&lt;br&gt;</code> (or preserves protected substrings) while respecting cases where existing <code>&lt;br&gt;</code> is present.                                                                                                                                                                                                                                                                                                                           </td><td data-label="Conceptual notes"> Helps preserve user-intended newlines inside <code>&lt;td&gt;</code>/<code>&lt;th&gt;</code>. Relies on <code>_CELL_TAG_RE</code> and <code>_BR_RE</code> — regex complexity may mis-handle nested tags or edge-case inline HTML.                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>JSON payload handling</strong>: wraps table HTML into <code>{&quot;html&quot;: ...}</code> and uses <code>json.dumps(..., ensure_ascii=False)</code>; when payload small, escapes JSON into a <code>data-</code> attribute; when large, inserts escaped JSON into a <code>&lt;script&gt;</code> block and references it.                                                                                                                                                                                                                                                                              </td><td data-label="Conceptual notes"> Careful to avoid oversized attributes (configurable <code>table_ui_max_attr_json_len</code>). Uses HTML escaping for attributes and script payload to reduce XSS risk—but escaping logic must be audited against malicious table content.                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Error handling & logging</strong>: many <code>try/except</code> blocks with <code>_logger.exception(...)</code> and fallbacks that return original content. <code>_record()</code> pushes debug messages to <code>_try_msgs</code>.                                                                                                                                                                                                                                                                                                                                                   </td><td data-label="Conceptual notes"> Defensive: module avoids raising on internal errors and instead logs and returns unmodified content. Good for not breaking rendering pipelines, but can silently hide failures if logs are not monitored.                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Optional helpers & extension points</strong>: placeholders at top indicate module expects external helpers to be injected/assigned (e.g., <code>render_html = ...</code>). <code>get_import_diagnostics()</code> exposes those presence checks.                                                                                                                                                                                                                                                                                                                 </td><td data-label="Conceptual notes"> This makes the module composable: another module can provide richer renderers or sanitizers. Document this when integrating.                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Concurrency / atomic I/O</strong>: no explicit concurrency constructs (no threads/async). No file write/atomic-write utilities in shown code.                                                                                                                                                                                                                                                                                                                                                                                             </td><td data-label="Conceptual notes"> Module is pure string/bytes processing — safe to call from concurrent contexts provided external helpers are thread-safe.                                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Potential risks / edge cases</strong>: heavy reliance on regex for HTML parsing (fragile on malformed HTML, CDATA, script blocks); heuristic checks (already-wrapped detection) may be brittle; JSON-in-attribute vs script branching must carefully escape/unescape; minify and newline conversions can alter whitespace-significant content; lack of explicit sanitization — module assumes upstream sanitized HTML or that optional sanitizers will be attached.                                                                       </td><td data-label="Conceptual notes"> Recommend review when using with untrusted HTML (XSS risk), nested tables, very large tables (JSON length / memory), or when the host page is a fragment without <code>&lt;head&gt;</code>/<code>&lt;body&gt;</code>. Consider replacing regex parsing with a parser (lxml/beautifulsoup) if higher robustness required.                                                                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Outputs / metadata</strong>: generates wrapper markup containing <code>table-wrapper-&lt;id&gt;</code>, optional <code>&lt;h3&gt;</code> title, and embedded payload; provides <code>get_import_diagnostics()</code> to introspect available helpers and config.                                                                                                                                                                                                                                                                                                                       </td><td data-label="Conceptual notes"> Useful for debugging and for automated tests to assert wrapper presence, data-attribute vs script usage, and that page assets are injected.                                                                                                                                                                                                                                                                                                                                           </td></tr></tbody></table></div><div class="row-count">Rows: 15</div></div><div class="table-caption" id="Table2" data-table="Docu_0114_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Logic / Structure"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Purpose / role in module family</strong>: Completes HTML post-processing pipeline — handles conversion to bytes, safe asset injection, content-type determination, and convenience wrappers that orchestrate lower-level helpers.                  </td><td data-label="Conceptual notes"> Builds on <code>html_renderer_01.py</code> core utilities to form a full HTML output system suitable for HTTP responses or file writes. Focused on safe finalization, encoding, and top-level orchestration.              </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary exports / entry points</strong>: <code>process_html_output(html_str, config=None)</code>, <code>process_bytes_output(data, config=None)</code>, <code>_finalize_html(html_str, cfg)</code>, <code>_write_with_assets(html_str, cfg)</code>.                                            </td><td data-label="Conceptual notes"> Defines standardized top-level call pattern: normalize → inject assets → ensure titles → wrap tables → minify → convert to bytes. <code>config</code> merges user overrides with module defaults.                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Configuration handling</strong>: Uses <code>_renderer_config</code> from previous segment as shared mutable dict. <code>config</code> argument is optional — merged with defaults on each call.                                                                          </td><td data-label="Conceptual notes"> Ensures consistent behavior across multi-module renderer system; supports runtime customization (e.g., skip minify or skip title injection). Prevents global-state mutation side effects by working on copies. </td></tr><tr><td data-label="Logic / Structure"> <strong>HTML processing pipeline</strong>: <code>_finalize_html()</code> → ensures <code>&lt;title&gt;</code> presence, injects assets, runs table-wrapping and newline conversion, optional minification. Returns final HTML string.                                                  </td><td data-label="Conceptual notes"> Conceptually a deterministic ordered pipeline. Emphasizes order: title handling before table wrapping (for heading detection), then newline conversion, then asset injection, finally minify.                  </td></tr><tr><td data-label="Logic / Structure"> <strong>Asset preparation / linking</strong>: <code>_write_with_assets()</code> adds CSS and JS references (configured paths or defaults), verifying insertion into <code>&lt;head&gt;</code> / <code>&lt;body&gt;</code> similar to first file’s <code>_inject_ui_assets()</code>.                                </td><td data-label="Conceptual notes"> Prevents duplicate asset insertion by searching existing tags. Fallback ensures <code>&lt;link&gt;</code> and <code>&lt;script&gt;</code> tags appear even if HTML fragment lacks head/body — prepends/appends as needed.                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Bytes output handling</strong>: <code>process_bytes_output()</code> wraps <code>_finalize_html()</code> then encodes as UTF-8 bytes, setting default content type (<code>text/html; charset=utf-8</code>).                                                                          </td><td data-label="Conceptual notes"> Allows safe passing to HTTP response writers or file writes. Defends against non-str inputs and double-encoding errors.                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Error resilience</strong>: try/except blocks around minify, injection, wrapping; on failure, logs error and returns original input (or UTF-8 fallback bytes).                                                                                      </td><td data-label="Conceptual notes"> Prioritizes continuity: even malformed HTML or partial fragments still produce usable output. Useful for batch renderers where one broken page must not halt the process.                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Inter-module calls</strong>: references to helper names defined in part 1 (<code>_ensure_title_attrs_in_str</code>, <code>_inject_ui_assets</code>, <code>_wrap_each_table_with_ui</code>, <code>_convert_newlines_in_table_cells</code>, <code>_minify_html_str</code>).                                 </td><td data-label="Conceptual notes"> Tight coupling: all helpers in <code>html_renderer_01.py</code> expected to be imported or present in same namespace. Exposes cohesive but monolithic renderer unit.                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>I/O boundaries</strong>: no direct file writing except potential <code>_write_with_assets()</code> (for embedding inline asset content); intended to be used by higher-level server module or static builder.                                                 </td><td data-label="Conceptual notes"> Decoupled from file system for safety. Output returned as bytes/str; actual writing done elsewhere (e.g., <code>server.py</code>).                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Optional dependencies</strong>: continues using placeholder functions (<code>render_html</code>, etc.) if assigned externally.                                                                                                                                </td><td data-label="Conceptual notes"> Supports modular overrides (custom renderers, external sanitizers).                                                                                                                                            </td></tr><tr><td data-label="Logic / Structure"> <strong>Edge cases & robustness</strong>: handles HTML fragments with missing <code>&lt;head&gt;</code> or <code>&lt;body&gt;</code> gracefully; preserves non-ASCII characters (<code>ensure_ascii=False</code>); minification and regex-based parsing remain potentially fragile on malformed markup. </td><td data-label="Conceptual notes"> Resilient against partial documents and mixed encodings; risk remains with irregular nested tags, commented tables, or script-embedded <code>&lt;table&gt;</code> markup.                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Concurrency & safety</strong>: no locks or shared-state writes except configuration dict access (copy protected). Thread-safe under read-only usage.                                                                                               </td><td data-label="Conceptual notes"> Safe for multithreaded render pipelines as long as <code>_renderer_config</code> is not mutated globally.                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Outputs / metadata</strong>: returns <code>{&quot;html&quot;: final_html, &quot;bytes&quot;: utf8_bytes, &quot;content_type&quot;: &quot;text/html; charset=utf-8&quot;}</code> or similar tuple; logs asset insertions and wrapping counts.                                                          </td><td data-label="Conceptual notes"> Provides clean, testable outputs for downstream modules to serve over HTTP or write to disk.                                                                                                                   </td></tr></tbody></table></div><div class="row-count">Rows: 13</div></div><div class="table-caption" id="Table3" data-table="Docu_0114_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Logic / Structure"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Purpose / overview</strong>: Core lightweight HTTP server that hosts rendered HTML fragments, assets, and project endpoints. Manages file serving, dynamic content generation, and optional auto-reload/watch behavior. </td><td data-label="Conceptual notes"> Acts as the project’s runtime execution and preview server — not a production-grade web framework, but a convenience tool for local development and testing of HTML-rendered outputs. </td></tr><tr><td data-label="Logic / Structure"> <strong>Architecture</strong>: built on top of Python’s <code>http.server</code> (BaseHTTPRequestHandler / ThreadingHTTPServer).                                                                                                           </td><td data-label="Conceptual notes"> Provides minimal but extendable structure; inherits built-ins for file-serving and GET/POST handling, enabling easy debugging and local rendering of project outputs.                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Initialization / entry points</strong>: main functions — <code>run_server()</code>, <code>_make_handler_class()</code>, and <code>_run_threaded_server()</code>.                                                                                         </td><td data-label="Conceptual notes"> Separation of concerns: handler class defines behavior for incoming requests, while runner functions manage configuration, threading, and startup messages.                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Configuration / environment handling</strong>: reads host, port, and asset paths from env variables or config; includes optional <code>--auto-open</code> to launch browser; optional <code>--watch</code> mode for live reload.              </td><td data-label="Conceptual notes"> Supports developer-friendly features for quick preview loops. Allows flexible port binding and user customization without modifying code.                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Routing behavior</strong>: request handler checks paths → serves HTML fragments, static assets, or directory listings; supports <code>/reload</code> endpoint for triggering page reloads.                                         </td><td data-label="Conceptual notes"> Emulates static file serving with additional logic for preprocessed outputs. Routes are minimalistic but sufficient for rendering demos and viewing generated HTML in context.        </td></tr><tr><td data-label="Logic / Structure"> <strong>HTML rendering pipeline integration</strong>: delegates to <code>html_renderer</code> (previous module) for rendering dynamic or generated pages. Calls <code>process_html_output()</code> or <code>process_bytes_output()</code> depending on context.  </td><td data-label="Conceptual notes"> Provides the runtime link between content generation and the HTML renderer. Server ensures consistent pipeline: source content → renderer → HTTP response.                            </td></tr><tr><td data-label="Logic / Structure"> <strong>Request handling details</strong>: uses <code>do_GET()</code> and <code>do_POST()</code> methods (or <code>_serve_file()</code>, <code>_serve_dynamic()</code>). Implements MIME type guessing via <code>mimetypes.guess_type()</code>.                                        </td><td data-label="Conceptual notes"> Designed to serve HTML, CSS, JS, JSON, and image assets. Returns correct Content-Type headers; includes gzip or chunked transfer for efficiency when enabled.                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Logging / diagnostics</strong>: custom logging functions override BaseHTTPRequestHandler’s <code>log_message()</code>; includes startup banners and colored console output.                                                        </td><td data-label="Conceptual notes"> Improves developer feedback; logs GET/POST and errors without excessive verbosity. Could be integrated with higher-level debug console in later phases.                               </td></tr><tr><td data-label="Logic / Structure"> <strong>Concurrency & threading</strong>: <code>_run_threaded_server()</code> spawns server in background thread; allows CLI to continue running. Optionally uses <code>ThreadingHTTPServer</code> for parallel requests.                             </td><td data-label="Conceptual notes"> Enables concurrent client handling; suitable for live preview or multiple browser tabs. Does not use async but thread-safe for lightweight concurrency.                               </td></tr><tr><td data-label="Logic / Structure"> <strong>File serving & safety</strong>: sanitizes requested paths to prevent directory traversal; joins with project root and validates existence before serving.                                                               </td><td data-label="Conceptual notes"> Security-conscious: protects local machine from arbitrary file access. Edge-case: no sandbox for symbolic links — relies on simple path normalization.                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Fallback and error responses</strong>: 404 and 500 templates rendered via <code>html_renderer</code> or inline HTML fallback. Returns plain text or simple error HTML if renderer unavailable.                                     </td><td data-label="Conceptual notes"> Graceful degradation when optional dependencies are missing; ensures developer receives readable output even on internal exceptions.                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>Auto-reload / watcher mode</strong>: optionally spawns file-watcher thread monitoring project directory; sends reload event to connected browsers via <code>/reload</code>.                                                        </td><td data-label="Conceptual notes"> Implements basic live-reload for rapid dev iteration. Uses polling or <code>watchdog</code> if available. Optional dependency detection at import time.                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Command-line interface</strong>: supports <code>python server.py --port 8080 --watch --open</code>.                                                                                                                                </td><td data-label="Conceptual notes"> CLI flexibility mirrors popular dev servers (Flask, Vite, etc.). Allows immediate start without editing source.                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Error handling</strong>: extensive try/except wrappers around file I/O and socket binding; falls back to next available port or prints descriptive error messages.                                                      </td><td data-label="Conceptual notes"> Prevents crashes from port conflicts or missing assets. Logs details for debugging.                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>Shutdown behavior</strong>: traps <code>KeyboardInterrupt</code> and closes server gracefully.                                                                                                                                     </td><td data-label="Conceptual notes"> Ensures proper thread termination and socket release.                                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Edge cases / limitations</strong>: no HTTPS or authentication; minimal caching; regex-based reload trigger detection; assumes UTF-8 text for all served documents.                                                      </td><td data-label="Conceptual notes"> Sufficient for dev use; unsuitable for production due to missing hardening, concurrency limits, and cache control.                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Inter-module dependencies</strong>: imports from <code>html_renderer</code> (core rendering), optional imports from <code>sanitize</code>, <code>convert</code>, or <code>core_table</code> when available.                                                         </td><td data-label="Conceptual notes"> Flexible: can operate even if some optional modules are missing (logs diagnostics). Uses same import-recording mechanism as html_renderer.                                            </td></tr></tbody></table></div><div class="row-count">Rows: 17</div></div><div class="table-caption" id="Table4" data-table="Docu_0114_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Logic / Structure"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Purpose / role</strong>: Final extension layer for the server module — adds utility endpoints, improved MIME type handling, template-based responses, and integration points for project-specific pipelines (Markdown, JSON, table fragments, etc.). </td><td data-label="Conceptual notes"> Acts as the orchestration and extension bridge connecting the lightweight HTTP server to higher-level render or data-export systems. Completes the runtime preview environment for the entire project. </td></tr><tr><td data-label="Logic / Structure"> <strong>Core additions</strong>: defines advanced route handlers (<code>/api/*</code>, <code>/data/*</code>, <code>/fragments/*</code>), modular content generation dispatchers, and middleware-like processing before returning HTML/JSON.                                                   </td><td data-label="Conceptual notes"> Expands server capability from static to semi-dynamic responses. Introduces minimal routing map and dispatch pattern without a full framework dependency.                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>Request dispatching logic</strong>: parses request path (<code>self.path</code>) → matches known patterns (HTML pages, data endpoints, assets). Uses lightweight regex or <code>startswith()</code> logic.                                                                 </td><td data-label="Conceptual notes"> Simple routing avoids framework overhead. Each route type delegates to specialized generator (fragment loader, renderer, data provider).                                                               </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration with renderers</strong>: calls <code>render_html()</code>, <code>render_table()</code>, or <code>render_page()</code> if assigned; otherwise uses fallback functions from <code>html_renderer</code>.                                                                                </td><td data-label="Conceptual notes"> Keeps the dependency graph modular. If custom renderers exist (Markdown to HTML converters, HTML sanitizers), they’re automatically used without code changes.                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Dynamic content handling</strong>: supports generating HTML fragments from Markdown or structured data on request; may call <code>convert()</code> or <code>sanitize()</code> when available.                                                                              </td><td data-label="Conceptual notes"> Enables real-time conversion pipeline for rapid testing — e.g., Markdown source → sanitized HTML → served response.                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>API/data endpoints</strong>: <code>/api/config</code>, <code>/api/ping</code>, <code>/api/diagnostics</code>, <code>/api/reload</code> implemented with JSON responses. Uses <code>json.dumps()</code> with safe serialization and UTF-8 encoding.                                                          </td><td data-label="Conceptual notes"> Provides introspection and testing tools for developers. <code>diagnostics</code> returns system state (loaded modules, config flags, environment info).                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Reload system enhancement</strong>: integrates with file watcher to send reload events to browser clients via Server-Sent Events (SSE) or JavaScript polling.                                                                                        </td><td data-label="Conceptual notes"> Allows real-time page refresh on file changes. Watcher logic (thread or timer) updates a global timestamp or pushes reload JSON; front-end script polls <code>/api/reload</code>.                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>MIME type improvements</strong>: wraps <code>mimetypes.guess_type()</code> with fallback dictionary for uncommon types (e.g., <code>.md</code>, <code>.json</code>, <code>.csv</code>, <code>.tsv</code>).                                                                                                  </td><td data-label="Conceptual notes"> Increases reliability of asset serving across project file types. Ensures browser receives correct <code>Content-Type</code>.                                                                                     </td></tr><tr><td data-label="Logic / Structure"> <strong>Response construction helpers</strong>: <code>_send_response(status, content, content_type)</code> centralizes header writing; adds <code>Cache-Control</code> and CORS headers for dev convenience.                                                                       </td><td data-label="Conceptual notes"> Simplifies handler code and supports cross-origin testing (important if JS assets fetch data from same server).                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Error & fallback responses</strong>: uniform error templates for 404/500; optionally uses <code>html_renderer</code> to prettify them; otherwise sends plain text fallback.                                                                                     </td><td data-label="Conceptual notes"> Ensures user sees readable error pages even if rendering pipeline partially broken.                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Concurrency & threads</strong>: continues to rely on <code>ThreadingHTTPServer</code>; watcher thread may interact with reload endpoints. Locks or atomic variables guard shared reload state.                                                                  </td><td data-label="Conceptual notes"> Safe for concurrent access; uses lock-protected timestamp or queue to synchronize reload signaling.                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Logging & diagnostics</strong>: richer <code>log_message()</code> and <code>log_error()</code> methods with timestamps and route type labeling; integrates <code>get_import_diagnostics()</code> from html_renderer to expose dependency status via <code>/api/diagnostics</code>.               </td><td data-label="Conceptual notes"> Provides complete transparency into which modules loaded, which optional helpers missing, and how routes behave.                                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>CLI integration / entrypoint</strong>: main guard (<code>if __name__ == &quot;__main__&quot;</code>) calls <code>run_server()</code> with extended flags (<code>--watch</code>, <code>--port</code>, <code>--no-browser</code>, <code>--debug</code>).                                                                           </td><td data-label="Conceptual notes"> Makes file self-executable for quick testing; debug mode increases verbosity and disables caching.                                                                                                     </td></tr><tr><td data-label="Logic / Structure"> <strong>Edge cases & resilience</strong>: Handles binary files, JSON arrays, UTF-8 BOM inputs; defends against unrecognized extensions; defaults to <code>text/plain</code>.                                                                                            </td><td data-label="Conceptual notes"> Ensures stable output even for misnamed or malformed files.                                                                                                                                            </td></tr><tr><td data-label="Logic / Structure"> <strong>Security & limitations</strong>: still development-only; no HTTPS, auth, or rate-limiting. CORS wide open for convenience. Path sanitization remains basic.                                                                                          </td><td data-label="Conceptual notes"> Acceptable for internal preview; should not be deployed in production.                                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Inter-module dependencies</strong>: relies on <code>html_renderer</code>, optional <code>convert</code>, <code>sanitize</code>, and possibly <code>core_table</code>. Detects their presence dynamically at import time.                                                                         </td><td data-label="Conceptual notes"> Maintains same loose coupling philosophy: modular, safe fallbacks, optional enrichment.                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Overall structure</strong>: <code>server_01.py</code> provides base serving and threading; <code>server_02.py</code> augments with API endpoints, diagnostics, dynamic rendering, and developer utilities.                                                                 </td><td data-label="Conceptual notes"> Together, they form a self-contained, extensible dev server for HTML-based project pipelines.                                                                                                          </td></tr></tbody></table></div><div class="row-count">Rows: 17</div></div><div class="table-caption" id="Table5" data-table="Docu_0114_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Subsystem / Flow**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Subsystem / Flow</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Interlinking and Data Path**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Interlinking and Data Path</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Subsystem / Flow"> <strong>Overall architecture</strong>                  </td><td data-label="Conceptual Interlinking and Data Path"> Two tightly coupled subsystems: <strong>HTML Renderer</strong> (responsible for safe, consistent transformation of HTML fragments and tables) and <strong>Server</strong> (runtime delivery and developer orchestration). Together they implement a complete document-rendering and preview pipeline for local environments.                                                                       </td></tr><tr><td data-label="Subsystem / Flow"> <strong>Data flow (high level)</strong>                </td><td data-label="Conceptual Interlinking and Data Path"> <strong>Input source → html_renderer → server response</strong>.<br>• Text or HTML fragments are normalized, sanitized (if optional sanitizers present), wrapped with UI assets, and converted to bytes.<br>• The server receives the processed HTML/bytes and serves them via HTTP with correct headers.<br>• Optional watcher and reload system ensure live updates during editing. </td></tr><tr><td data-label="Subsystem / Flow"> <strong>Rendering pipeline (html_renderer)</strong>    </td><td data-label="Conceptual Interlinking and Data Path"> 1️⃣ <em>Ensure title & heading attributes →</em> 2️⃣ <em>Inject UI assets (CSS/JS) →</em> 3️⃣ <em>Wrap tables with metadata (JSON payloads) →</em> 4️⃣ <em>Convert newlines in cells →</em> 5️⃣ <em>Minify HTML →</em> 6️⃣ <em>Return HTML or bytes.</em><br>Configurable through <code>_renderer_config</code>, with runtime overrides.                                                                                      </td></tr><tr><td data-label="Subsystem / Flow"> <strong>Table handling subsystem</strong>              </td><td data-label="Conceptual Interlinking and Data Path"> Uses regex to detect <code>&lt;table&gt;</code> blocks, assigns unique IDs, and wraps each with structured <code>&lt;div class=&quot;table-wrapper&quot;&gt;</code> markup plus JSON payloads for JS hydration. Optional fallback to script-block embedding when JSON exceeds safe attribute length.                                                                                                                 </td></tr><tr><td data-label="Subsystem / Flow"> <strong>Asset injection link</strong>                  </td><td data-label="Conceptual Interlinking and Data Path"> Shared helpers between html_renderer_01/02 ensure CSS and JS paths are always present in served pages. Server uses identical logic when dynamically injecting HTML fragments at runtime.                                                                                                                                                                                 </td></tr><tr><td data-label="Subsystem / Flow"> <strong>Optional imports & fallback ecosystem</strong> </td><td data-label="Conceptual Interlinking and Data Path"> Both modules define placeholder renderers (<code>render_html</code>, <code>render_table</code>, etc.). The system operates even if advanced helpers (e.g., Markdown converters, sanitizers) are missing, reporting their absence via <code>get_import_diagnostics()</code>.                                                                                                                               </td></tr><tr><td data-label="Subsystem / Flow"> <strong>Configuration propagation</strong>             </td><td data-label="Conceptual Interlinking and Data Path"> <code>_renderer_config</code> acts as global but copy-safe dict shared across modules. Server can call <code>get_renderer_config()</code> to synchronize asset paths, minify flags, and size limits for table JSON attributes.                                                                                                                                                                 </td></tr><tr><td data-label="Subsystem / Flow"> <strong>Error resilience pattern</strong>              </td><td data-label="Conceptual Interlinking and Data Path"> Both subsystems employ pervasive <code>try/except</code> with log-and-continue strategy. Rendering failures revert to unmodified content; server failures return readable fallback responses. This prevents total pipeline breakdown.                                                                                                                                               </td></tr><tr><td data-label="Subsystem / Flow"> <strong>Inter-module call graph (simplified)</strong>  </td><td data-label="Conceptual Interlinking and Data Path"> <code>server → html_renderer._finalize_html()</code> → (<em>ensure_title</em>, <em>inject_assets</em>, <em>wrap_tables</em>, <em>convert_newlines</em>, <em>minify</em>) → returns bytes → <code>server.do_GET()</code> writes response.<br>Optional: <code>server</code> → <code>render_html</code>/<code>convert</code>/<code>sanitize</code> (if provided) → <code>html_renderer</code>.                                                                                              </td></tr><tr><td data-label="Subsystem / Flow"> <strong>Concurrency and atomicity</strong>             </td><td data-label="Conceptual Interlinking and Data Path"> Renderer: stateless, string/bytes only — thread-safe.<br>Server: uses <code>ThreadingHTTPServer</code> and watcher threads; manages shared reload state via atomic timestamp/lock. No cross-thread mutable globals except safe flags.                                                                                                                                               </td></tr><tr><td data-label="Subsystem / Flow"> <strong>Dynamic rendering flow</strong>                </td><td data-label="Conceptual Interlinking and Data Path"> When hitting a route like <code>/fragments/x</code>, server may call a custom converter (Markdown→HTML) then delegate to html_renderer for wrapping, producing identical table/asset formatting as static pages.                                                                                                                                                                    </td></tr><tr><td data-label="Subsystem / Flow"> <strong>Diagnostics and developer UX</strong>          </td><td data-label="Conceptual Interlinking and Data Path"> <code>get_import_diagnostics()</code> exposes renderer module status. Server’s <code>/api/diagnostics</code> endpoint surfaces these to browser or API consumers. Start-up logs report asset injection and port info.                                                                                                                                                                          </td></tr><tr><td data-label="Subsystem / Flow"> <strong>Error and fallback hierarchy</strong>          </td><td data-label="Conceptual Interlinking and Data Path"> <code>html_renderer</code> silently returns original content on parse/minify failure → <code>server</code> wraps that in a 200 OK response → user sees partially rendered page instead of crash. Fallback templates handle 404/500 with minimal HTML if renderer absent.                                                                                                                       </td></tr><tr><td data-label="Subsystem / Flow"> <strong>Edge-case handling coverage</strong>           </td><td data-label="Conceptual Interlinking and Data Path"> • Missing <code>&lt;head&gt;</code>/<code>&lt;body&gt;</code> handled by injection fallbacks.<br>• Oversized JSON payloads handled by switching from data-attribute to script block.<br>• Nested or malformed tables logged but skipped.<br>• Non-ASCII text preserved (<code>ensure_ascii=False</code>).<br>• Newlines in <code>&lt;td&gt;</code> converted safely to <code>&lt;br&gt;</code>.                                                         </td></tr><tr><td data-label="Subsystem / Flow"> <strong>Security boundary</strong>                     </td><td data-label="Conceptual Interlinking and Data Path"> Development-oriented. Sanitization optional and delegated. Regex-based parsing means potential fragility on untrusted input; server path normalization defends against traversal.                                                                                                                                                                                        </td></tr><tr><td data-label="Subsystem / Flow"> <strong>Watcher and reload linkage</strong>            </td><td data-label="Conceptual Interlinking and Data Path"> <code>server_02.py</code> reload endpoint communicates with front-end JS injected by html_renderer’s UI assets. File watcher triggers timestamp update → clients poll <code>/api/reload</code> → automatic refresh.                                                                                                                                                                            </td></tr><tr><td data-label="Subsystem / Flow"> <strong>Extensibility points</strong>                  </td><td data-label="Conceptual Interlinking and Data Path"> • Assign external renderers (<code>render_html</code>, <code>render_table</code>, etc.).<br>• Extend route table in server with new <code>/api/...</code> endpoints.<br>• Override <code>_renderer_config</code> for theming and performance tuning.<br>• Plug in sanitizer or Markdown converter modules seamlessly.                                                                                                </td></tr><tr><td data-label="Subsystem / Flow"> <strong>Limitations / production notes</strong>        </td><td data-label="Conceptual Interlinking and Data Path"> • Regex HTML parsing fragile on malformed markup.<br>• No HTTPS, auth, or rate limiting.<br>• CORS wide open; no cache headers tuned for production.<br>• Logging verbose under load.<br>• Designed purely for development/test preview use.                                                                                                                             </td></tr><tr><td data-label="Subsystem / Flow"> <strong>Overall system behavior</strong>               </td><td data-label="Conceptual Interlinking and Data Path"> The pair forms a <strong>self-contained HTML rendering and preview stack</strong>: developer writes or converts source → renderer formats HTML with consistent titles/tables/assets → server serves or auto-reloads it live in the browser. Reliable, modular, and fault-tolerant, optimized for developer feedback cycles rather than deployment.                                    </td></tr></tbody></table></div><div class="row-count">Rows: 19</div></div><div class="table-caption" id="Table6" data-table="Docu_0114_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Logic / Structure"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Purpose & surface behavior</strong><br>Bootstrap utilities for the table viewer UI, feature flags, and shared helper functions used across the project. Initializes <code>window.tvConfig</code>, detects the script base URL, ensures <code>data-index-url</code> / <code>data-worker-url</code> attributes on <code>&lt;body&gt;</code>, and attaches an “extra” script loader. </td><td data-label="Conceptual Notes"> The file is a central runtime utility bundle intended to be drop-in compatible with existing TV2.x sites. It both <em>initializes</em> environment defaults and <em>exposes</em> helper APIs on <code>window.tvUtils</code> / <code>window.__tv_utils</code> for other modules to reuse.                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Feature flags & config</strong><br><code>window.tvConfig</code> defaults (highlight, debounceMs, chunkSize); <code>TV_DEBUG</code> logging helpers (dbgInfo/warn/debug/error); <code>setTvSearchConfig(cfg)</code> for runtime override.                                                                                                                         </td><td data-label="Conceptual Notes"> Config is defensive (type checks, safe defaults) so modules can rely on <code>window.tvConfig</code>. Debug logging gated by <code>window.tvDebug</code>. Useful for runtime tuning without rebuilding.                                                                                                                                                                            </td></tr><tr><td data-label="Logic / Structure"> <strong>Environment detection</strong><br><code>detectScriptBase()</code> finds base URL from <code>document.currentScript</code>, scripts list, or <code>location</code> fallback; sets <code>TV_BASE</code> and <code>window.__tv_base</code>.                                                                                                                                               </td><td data-label="Conceptual Notes"> Robust URL join helper <code>joinUrl(base, rel)</code> included; ensures other resources (index, worker, extra.js) are resolved relative to script base. Fallbacks present for older browsers or unusual <code>&lt;script&gt;</code> loading patterns.                                                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>DOM readiness & attribute enforcement</strong><br><code>ensureIndexAndWorkerAttrs(base)</code> sets <code>data-index-url</code> and <code>data-worker-url</code> on <code>&lt;body&gt;</code> (or uses existing attributes). Called on DOMContentLoaded or immediately if ready.                                                                                                  </td><td data-label="Conceptual Notes"> This creates implicit dependencies: modules expect <code>&lt;body&gt;</code> attributes or the defaults; failure to set these will still fallback to computed defaults. Good for embedding the bundle without extra configuration.                                                                                                                                            </td></tr><tr><td data-label="Logic / Structure"> <strong>PTTScroll (neutral)</strong><br>Provides <code>window.PTTScroll</code> API (enable/disable/initObserver/scrollToTop) — implemented in "neutral" (no-op scroll) mode by default; uses <code>MutationObserver</code> to dispatch <code>ptt:renderStable</code>.                                                                                                    </td><td data-label="Conceptual Notes"> Scroll handling is intentionally conservative to avoid competing automatic scrolling; still exposes hooks for enabling a scroll implementation. Uses <code>MutationObserver</code> to detect viewer DOM changes and fire a stable event.                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Dynamic script loader</strong><br><code>loadExtraSequentially(possiblePaths, onDone, onAllFailed)</code> loads candidates sequentially (creates <code>&lt;script&gt;</code> elements, onerror fallback). <code>startExtraLoader()</code> operates only if not already attached.                                                                                        </td><td data-label="Conceptual Notes"> Loader chooses several candidate paths (e.g., <code>extra.js</code>, <code>assets/extra.js</code>) and falls back gracefully; avoids duplicate loads via guard flags. Useful for optional feature extensions.                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Shared utilities exported</strong><br><code>window.tvUtils</code> / <code>window.__tv_utils</code> expose: <code>copyToClipboard</code>, <code>sanitizeFileName</code>, <code>downloadBlob</code>, <code>showToast</code>, <code>debounce</code>, <code>getSearchEl</code>, plus markdown/table helpers: <code>formatCellForMarkdown</code>, <code>tableToMarkdownLines</code>, <code>tableToCSV</code>-style behavior.                                  </td><td data-label="Conceptual Notes"> Utilities include modern and legacy fallbacks (Clipboard API → execCommand), safe filename sanitization, toast queueing with duration heuristics, and table → Markdown conversion that escapes <code>                                                                                                                                                                               | </code> and handles newlines. These functions are designed to be reused by other modules (e.g., table export, markdown export, copy buttons).                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>User feedback / UI helpers</strong><br>Toast system with queueing (<code>_toastQueue</code>), container creation, style injection, compute duration heuristics. Inline CSS injection for TOC and export-markdown hiding.                                                                                                                   </td><td data-label="Conceptual Notes"> Toasts use DOM insertion and timed removal; they attempt to reuse Shared overrides if present. Inline CSS insertion aims to hide export-markdown controls early and to force a compact inline TOC layout. These changes affect presentation globally.                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Resilience & safety patterns</strong><br>Lots of <code>try/catch</code>, <code>safe(fn)</code> wrapper, <code>once()</code> idempotency helper, defensive type checks, fallbacks for missing APIs.                                                                                                                                                               </td><td data-label="Conceptual Notes"> File is intentionally defensive for embedding in various host pages and older browsers. Expect minimal runtime exceptions; errors are mostly swallowed to avoid breaking host pages.                                                                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Concurrency & async patterns</strong><br>Uses <code>debounce</code>, <code>setTimeout</code> for delays, <code>MutationObserver</code> for async DOM stability, sequential script loading to avoid race conditions, <code>once()</code> to guard one-time ops.                                                                                                              </td><td data-label="Conceptual Notes"> No heavy worker/threading here; concurrency concern is DOM mutation ordering and script load races — handled by sequential loaders and observers; network calls or long-running jobs are expected to be in other modules.                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Integrations & assumptions</strong><br>Expects DOM elements like <code>#tables-viewer</code>, <code>#output-container</code>, and global objects <code>window.PTT</code>, <code>window.PTTScroll</code> consumers. Provides hooks (<code>ptt:renderStable</code>) and <code>window.tvIndexUrl</code> / <code>window.tvWorkerUrl</code>.                                                                      </td><td data-label="Conceptual Notes"> Module is integration-focused: it sets global variables and events other modules rely on. When embedding, ensure target containers exist or consumers handle defaults. The header mentions behavior like injecting HTML from <code>/api/render</code>, <code>client_req_id</code> generation and caption injection — these are part of the runtime contract (see header comment).  </td></tr><tr><td data-label="Logic / Structure"> <strong>Edge cases & special handling</strong><br>Table → Markdown escapes <code>                                                                                                                                                                                                                                                            | </code>; newline handling normalizes CR/LF; fallback copy uses textarea + <code>execCommand</code>; CSS injection guarded; many fast-fail <code>try/catch</code> blocks.                                                                                                                                                                                                                                   </td><td data-label="Conceptual Notes"> Good handling for Markdown export edge cases (pipes, multiline cells). Potential limitations: heavy DOM mutations might create many toasts; <code>downloadBlob</code> uses <code>URL.createObjectURL</code> (revoked after timeout) — older browsers may fail.  </td></tr></tbody></table></div><div class="row-count">Rows: 12</div></div><div class="table-caption" id="Table7" data-table="Docu_0114_07" style="margin-top:2mm;margin-left:3mm;"><strong>Table 7</strong></div>
<div class="table-wrapper" data-table-id="table-7"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Logic / Structure"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Purpose & overall behavior</strong><br>Implements interactive table expansion/collapse, column visibility toggling, and copy/export controls for rendered HTML tables. Acts as a front-end controller for the table viewer UI. </td><td data-label="Conceptual Notes"> Core user-facing module built atop helpers from <code>script.core.js</code>. Directly manipulates DOM tables generated by the backend/renderer. Focuses on accessibility, usability, and resilience when handling many nested tables. </td></tr><tr><td data-label="Logic / Structure"> <strong>Initialization flow</strong><br>Executed after DOM load; finds all <code>table[data-tv-table]</code> elements. Builds per-table controls (expand/collapse all, copy markdown, copy CSV, download, hide/show columns).                     </td><td data-label="Conceptual Notes"> Designed for late binding — runs after HTML injection or live updates. Rebuilds toolbars dynamically when new tables appear (supports multiple tables on one page).                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Expand/collapse logic</strong><br>Buttons labeled <code>▸</code> / <code>▾</code> toggle row groups via <code>data-group</code> attributes. “Expand All” toggles all groups at once.                                                                            </td><td data-label="Conceptual Notes"> Each group of rows (with same <code>data-group</code>) can collapse or expand. Internal <code>collapsedGroups</code> tracking ensures idempotent behavior and correct state sync across buttons.                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Column visibility management</strong><br>Each header cell may include a toggle button that hides/shows columns. Hidden state stored via <code>data-hidden</code> or CSS <code>display:none</code>.                                                   </td><td data-label="Conceptual Notes"> Prevents layout flicker by batching style changes. Includes global "reset columns" control. Column toggling triggers custom events to notify other scripts.                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Copy/export features</strong><br>Integrates with <code>tvUtils</code> helpers for clipboard and blob downloads. Provides menu options for Copy as Markdown / Copy as CSV / Download as .md or .csv.                                       </td><td data-label="Conceptual Notes"> Markdown export uses the <code>tvUtils.tableToMarkdownLines()</code> function to ensure consistent escaping. CSV export normalizes line endings and strips HTML markup safely.                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Toolbar generation</strong><br>Creates toolbar DOM elements per table: expand/collapse buttons, export menus, column visibility controls. Buttons use accessible labels and icons.                                             </td><td data-label="Conceptual Notes"> Modular builder pattern: <code>buildToolbar(tableEl)</code> handles all UI assembly, event binding, and ensures one toolbar per table. Custom attributes used to prevent duplicate rebuilds.                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>MutationObserver support</strong><br>Observes changes to table containers (e.g., when new tables injected dynamically). Calls <code>refreshTableToolbars()</code> to attach controls to new tables.                                       </td><td data-label="Conceptual Notes"> Ensures UI self-heals when content replaced or asynchronously rendered. Particularly important for viewer pipelines that replace content via AJAX or worker output.                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>CSS & styling</strong><br>Injects minimal inline CSS rules to handle collapsed row visuals and toolbar layout. Avoids external dependencies.                                                                                   </td><td data-label="Conceptual Notes"> Maintains visual consistency even when host pages lack base styles. Inline injection simplifies portability but limits theming flexibility.                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Keyboard & accessibility</strong><br>Key handlers for focusable buttons; uses <code>aria-pressed</code>, <code>aria-expanded</code>, and title attributes to improve accessibility.                                                                  </td><td data-label="Conceptual Notes"> Good baseline ARIA compliance. Enables keyboard toggling of expansion and visibility; ensures state sync between visual and semantic markers.                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>Event propagation control</strong><br>Stops propagation on toolbar click events to prevent interference with nested event systems.                                                                                             </td><td data-label="Conceptual Notes"> Prevents unwanted behavior if embedded inside a larger app with global listeners.                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Concurrency & safety patterns</strong><br>Uses <code>debounce</code> from <code>tvUtils</code> for resize/update throttling; safe wrappers (<code>try/catch</code>) around DOM lookups and state updates.                                                       </td><td data-label="Conceptual Notes"> Guards against frequent DOM updates or malformed HTML. Tolerates missing elements gracefully.                                                                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration assumptions</strong><br>Assumes <code>window.tvUtils</code> is available (from <code>script.core.js</code>). Uses its <code>copyToClipboard</code>, <code>downloadBlob</code>, and markdown helpers.                                                           </td><td data-label="Conceptual Notes"> If <code>tvUtils</code> missing, module degrades silently (copy/export disabled). Works both standalone and integrated in the full Table Viewer runtime.                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>Edge-case handling</strong><br>Handles nested tables, hidden headers, or malformed structures by skipping invalid rows. Prevents crash when group markers missing.                                                             </td><td data-label="Conceptual Notes"> Ensures robustness when users paste malformed HTML or when rendering engine outputs inconsistent markup.                                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>User experience considerations</strong><br>Minimizes UI flicker by batching DOM updates and using passive event listeners. Automatically hides unused toolbar options (e.g., if no grouped rows).                              </td><td data-label="Conceptual Notes"> Demonstrates attention to detail for responsive UI and efficient DOM handling.                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Overall system role</strong><br>This file governs table-level interaction layer; it transforms static HTML tables into interactive, exportable, collapsible components.                                                        </td><td data-label="Conceptual Notes"> Complements <code>script.core.js</code> (utilities/config) and other rendering modules (HTML generation). Core to end-user interactivity and exporting UX.                                                                            </td></tr></tbody></table></div><div class="row-count">Rows: 15</div></div><div class="table-caption" id="Table8" data-table="Docu_0114_08" style="margin-top:2mm;margin-left:3mm;"><strong>Table 8</strong></div>
<div class="table-wrapper" data-table-id="table-8"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Module"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Module</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual Role &amp; Dependencies"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Role & Dependencies</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Core Concepts &amp; Data Flow"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Core Concepts & Data Flow</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Integration Notes &amp; Edge Handling"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Integration Notes & Edge Handling</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Module"> <strong>script.core.js</strong>           </td><td data-label="Conceptual Role &amp; Dependencies"> Foundation / Utility Layer                                                                                                                                                                                                                               </td><td data-label="Core Concepts &amp; Data Flow"> • Initializes environment, config (<code>tvConfig</code>, <code>tvDebug</code>, <code>tvIndexUrl</code>, <code>tvWorkerUrl</code>).<br>• Exposes shared helpers (<code>tvUtils</code>) for copying, downloading, markdown/CSV export, safe filename generation, toast notifications, debounce, etc.<br>• Manages script base detection and sequential “extra.js” loader.<br>• Dispatches stability events via <code>MutationObserver</code> (<code>ptt:renderStable</code>).                             </td><td data-label="Integration Notes &amp; Edge Handling"> • Serves as the <strong>shared backbone</strong> — all other modules rely on its exported helpers.<br>• Error-tolerant with heavy use of safe wrappers.<br>• Optional: if missing, dependents degrade gracefully.<br>• Handles runtime defaults and guards concurrency via “once()” patterns and sequential script loading.<br>• Edge handling: clipboard API fallback, safe DOM lookups, pipe-escaping for Markdown. </td></tr><tr><td data-label="Module"> <strong>script.table.js</strong>          </td><td data-label="Conceptual Role &amp; Dependencies"> Interaction / UI Layer                                                                                                                                                                                                                                   </td><td data-label="Core Concepts &amp; Data Flow"> • Consumes <code>tvUtils</code> exports (clipboard, markdown, CSV, blob download, debounce).<br>• On load, scans all HTML tables and injects per-table toolbars (expand/collapse, copy/export, column toggle).<br>• Uses MutationObserver to reattach controls on dynamic content injection.<br>• Tracks collapsed row groups via <code>data-group</code>; syncs “Expand All” state.<br>• Normalizes exported Markdown/CSV via helpers from core. </td><td data-label="Integration Notes &amp; Edge Handling"> • Dependent on <strong>script.core.js</strong> — cannot fully function without it.<br>• Integrates seamlessly with the events and toasts established by core.<br>• Adopts accessibility attributes (<code>aria-*</code>), inline CSS injection, and modular event binding.<br>• Edge handling: malformed or nested tables skipped gracefully; controls hidden when unsupported; stable behavior under concurrent DOM updates.    </td></tr><tr><td data-label="Module"> <strong>Inter-module linkage</strong>     </td><td data-label="Conceptual Role &amp; Dependencies"> <strong>script.table.js → script.core.js</strong> (unidirectional, hard dependency)                                                                                                                                                                                   </td><td data-label="Core Concepts &amp; Data Flow"> <code>tvUtils.tableToMarkdownLines</code>, <code>tvUtils.copyToClipboard</code>, <code>tvUtils.downloadBlob</code>, <code>tvUtils.debounce</code> used extensively for UI actions and throttled updates.                                                                                                                                                                                                                                                                </td><td data-label="Integration Notes &amp; Edge Handling"> The shared <code>window.tvUtils</code> object acts as a single importless API surface for runtime modules. Table.js uses these methods as though calling an SDK.                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Module"> <strong>Event Flow</strong>               </td><td data-label="Conceptual Role &amp; Dependencies"> <strong>From core → table</strong> and <strong>internal UI events</strong>                                                                                                                                                                                                         </td><td data-label="Core Concepts &amp; Data Flow"> <code>ptt:renderStable</code> → triggers toolbar rebuilds; <code>MutationObserver</code> ensures new table elements get instrumented.<br><code>Expand/Collapse</code> toggles fire internal events; export actions trigger <code>showToast</code> via core helpers.                                                                                                                                                                                                     </td><td data-label="Integration Notes &amp; Edge Handling"> Events maintain logical consistency and keep asynchronous UI refreshes coordinated.                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Module"> <strong>Concurrency & Safety</strong>     </td><td data-label="Conceptual Role &amp; Dependencies"> Both modules avoid race conditions                                                                                                                                                                                                                       </td><td data-label="Core Concepts &amp; Data Flow"> Core uses sequential script loading; Table uses debounce and safe refresh loops.<br>Both isolate failures using local <code>try/catch</code>.                                                                                                                                                                                                                                                                                          </td><td data-label="Integration Notes &amp; Edge Handling"> Cooperative concurrency model — no blocking operations, pure async coordination through DOM and timers.                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Module"> <strong>User-Facing Flow Summary</strong> </td><td data-label="Conceptual Role &amp; Dependencies"> 1️⃣ Page loads → core initializes env/config.<br>2️⃣ <code>tvUtils</code> becomes available.<br>3️⃣ Table.js loads → attaches toolbars to each table.<br>4️⃣ User expands/collapses, copies, or downloads table content.<br>5️⃣ Toasts display feedback (via core). </td><td data-label="Core Concepts &amp; Data Flow"> Entire user experience pipeline forms a <strong>two-layer architecture</strong>: foundational utilities (core) + interactive layer (table). Designed for safe embedding and progressive enhancement.                                                                                                                                                                                                                                     </td><td data-label="Integration Notes &amp; Edge Handling">                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Module"> <strong>Fallback & Edge Notes</strong>    </td><td data-label="Conceptual Role &amp; Dependencies"> Both resilient under missing dependencies                                                                                                                                                                                                                </td><td data-label="Core Concepts &amp; Data Flow"> Core silently skips “extra.js” if unavailable.<br>Table disables exports if <code>tvUtils</code> undefined.<br>Both tolerate malformed HTML and old browsers.                                                                                                                                                                                                                                                                          </td><td data-label="Integration Notes &amp; Edge Handling"> Prioritizes reliability and silent degradation over hard failures.                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Module"> <strong>Audit Highlights</strong>         </td><td data-label="Conceptual Role &amp; Dependencies"> • Strong modular separation.<br>• No shared mutable state beyond <code>window.tvUtils</code>.<br>• Graceful fallbacks.<br>• High UX polish (ARIA, debounce, minimal flicker).<br>• Low security risk (no eval/dynamic code).                                        </td><td data-label="Core Concepts &amp; Data Flow"> Suitable for embedding in diverse host pages; high portability and robustness.                                                                                                                                                                                                                                                                                                                                              </td><td data-label="Integration Notes &amp; Edge Handling">                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table9" data-table="Docu_0114_09" style="margin-top:2mm;margin-left:3mm;"><strong>Table 9</strong></div>
<div class="table-wrapper" data-table-id="table-9"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Comprehensive Narrative Summary — script.core.js + script.table.js"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Comprehensive Narrative Summary — script.core.js + script.table.js</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Comprehensive Narrative Summary — script.core.js + script.table.js"> The architecture formed by <strong>script.core.js</strong> and <strong>script.table.js</strong> represents a clean two-tier model: one focused on infrastructure and environment setup, and the other centered on direct user interaction and presentation. Both are written defensively, emphasizing resilience, portability, and silent fallback mechanisms that ensure stability even in unpredictable host environments. </td></tr><tr><td data-label="Comprehensive Narrative Summary — script.core.js + script.table.js"> <strong>script.core.js</strong> acts as the foundation. It begins by determining its own runtime context — locating the script’s base URL through inspection of <code>document.currentScript</code>, enumerating existing <code>&lt;script&gt;</code> elements, and falling back to <code>window.location</code> if needed. From this it constructs consistent paths for assets such as the index API and worker files, then embeds them as <code>data-index-url</code> and <code>data-worker-url</code> attributes on the <code>&lt;body&gt;</code>. This guarantees discoverability for any module that needs them later. </td></tr><tr><td data-label="Comprehensive Narrative Summary — script.core.js + script.table.js"> The module defines a global configuration object <code>window.tvConfig</code>, containing parameters like highlight toggling, debounce timing, and chunk sizes. The runtime can adjust these settings through <code>setTvSearchConfig()</code> for quick, code-free reconfiguration. Logging utilities (<code>tvDebug.info</code>, <code>tvDebug.warn</code>, etc.) are gated behind a single flag, ensuring a quiet default while preserving diagnostic power when needed. </td></tr><tr><td data-label="Comprehensive Narrative Summary — script.core.js + script.table.js"> At the heart of this file lies the <strong>tvUtils</strong> library — a shared utility namespace that exposes key behaviors: copying data to clipboard with fallbacks, creating downloadable blobs, sanitizing filenames, rendering toast notifications, generating Markdown or CSV text from tables, and implementing debounce functions. Each helper is crafted to degrade gracefully on older browsers through <code>try/catch</code> wrappers and capability detection. The toast system illustrates this robustness, dynamically building its DOM container, queuing messages, and computing display duration heuristically from message length to maintain consistent UX timing. </td></tr><tr><td data-label="Comprehensive Narrative Summary — script.core.js + script.table.js"> <code>script.core.js</code> also includes environmental monitoring through a <code>MutationObserver</code>, which dispatches a custom <code>ptt:renderStable</code> event once the DOM becomes quiescent. Concurrency is intentionally minimal and event-driven — sequential script loading avoids race conditions, and “once” guards enforce idempotency for initialization routines. The result is a reliable environment layer that initializes predictably without heavy dependency on external frameworks. </td></tr><tr><td data-label="Comprehensive Narrative Summary — script.core.js + script.table.js"> Once this foundation is ready, <strong>script.table.js</strong> loads as the interaction layer. Its mission is to convert static HTML tables into interactive widgets with toolbar controls, collapsible row groups, and export features. Upon DOM readiness, it scans for every <code>table[data-tv-table]</code> element, generating a toolbar for each. The toolbar holds buttons for expanding and collapsing all rows, toggling column visibility, copying content, or exporting it in Markdown and CSV formats. </td></tr><tr><td data-label="Comprehensive Narrative Summary — script.core.js + script.table.js"> Row-group toggling operates through <code>data-group</code> attributes. A simple internal registry remembers which groups are collapsed, ensuring that the “Expand All” control accurately reflects the state across an entire table. Column visibility is managed by adjusting CSS display properties rather than re-rendering elements, minimizing visual flicker. For dynamic interfaces, the module registers a <code>MutationObserver</code> that automatically attaches toolbars to new tables inserted into the DOM, maintaining persistent interactivity even when content updates asynchronously. </td></tr><tr><td data-label="Comprehensive Narrative Summary — script.core.js + script.table.js"> The export system depends on <strong>tvUtils</strong> from the core module. When a user chooses to copy as Markdown, the table script calls <code>tvUtils.tableToMarkdownLines()</code> to produce output with proper escaping for pipes and multi-line text. For CSV or Markdown file downloads, it invokes <code>tvUtils.downloadBlob()</code> with filenames sanitized by <code>tvUtils.sanitizeFileName()</code>. Each successful operation triggers <code>tvUtils.showToast()</code> to inform the user — a cohesive feedback loop shared between both modules. </td></tr><tr><td data-label="Comprehensive Narrative Summary — script.core.js + script.table.js"> Accessibility features are woven throughout: buttons use <code>aria-pressed</code> and <code>aria-expanded</code>, toolbars can be navigated with keyboards, and visual indicators correspond to semantic state. Styling is embedded inline so that the system remains visually consistent even when embedded in host pages without external CSS. Events are carefully contained, with click propagation stopped to prevent interference from parent applications or frameworks. </td></tr><tr><td data-label="Comprehensive Narrative Summary — script.core.js + script.table.js"> Error handling across the module is intentionally forgiving. Each major DOM operation resides in <code>try/catch</code> blocks, allowing the script to skip over malformed tables or missing elements without halting execution. When <code>window.tvUtils</code> is unavailable, export features quietly disable themselves, leaving core expand/collapse behavior functional. This philosophy of silent degradation ensures graceful behavior under partial loads or integration into constrained environments. </td></tr><tr><td data-label="Comprehensive Narrative Summary — script.core.js + script.table.js"> Together, the two scripts create a coherent workflow: <strong>core.js</strong> initializes the environment, provides a global API surface, and guarantees safe defaults; <strong>table.js</strong> builds on that foundation to deliver interactivity and export capabilities directly to end users. Their integration is one-directional and clean — the table module depends on the core utilities but not vice versa. Communication occurs through global namespaces, DOM events, and shared configuration rather than direct imports. </td></tr><tr><td data-label="Comprehensive Narrative Summary — script.core.js + script.table.js"> The resulting architecture is small yet sophisticated: event-driven instead of reactive, declarative rather than monolithic. It embodies reliability through simplicity — the absence of frameworks, reliance on native browser APIs, and thoughtful fallback patterns combine to form a robust, self-sufficient ecosystem. Users experience smooth interactions and responsive feedback, while developers gain predictable extensibility and low maintenance overhead. </td></tr></tbody></table></div><div class="row-count">Rows: 12</div></div><div class="table-caption" id="Table10" data-table="Docu_0114_10" style="margin-top:2mm;margin-left:3mm;"><strong>Table 10</strong></div>
<div class="table-wrapper" data-table-id="table-10"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Logic / Structure"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Primary purpose</strong><br>Builds and maintains an in-page Table of Contents (TOC) derived from heading elements (e.g., <code>h1–h6</code>) inside the rendered content area; provides navigation, collapse/expand, highlight-on-scroll, and optional search/filter controls.                                                          </td><td data-label="Conceptual Notes"> Acts as a usability/navigation layer that helps users orient within long rendered documents. Designed to be injected into the viewer UI and to work even when content is asynchronously replaced.                               </td></tr><tr><td data-label="Logic / Structure"> <strong>Initialization & discovery</strong><br>On DOM ready (or when <code>ptt:renderStable</code> fires) locates the viewer container (e.g., <code>#output-container</code>, or a configured selector) and scans for heading elements. Builds an internal heading index with level, text content, id (creates one if missing), and computed parent chain. </td><td data-label="Conceptual Notes"> Id generation carefully sanitized (slugify + <code>sanitizeFileName</code>-style logic) to prevent collisions; ensures anchor-friendly IDs and consistent navigation. Handles headings that have existing IDs gracefully (preserves them). </td></tr><tr><td data-label="Logic / Structure"> <strong>TOC DOM construction</strong><br>Generates a nested list (<code>&lt;nav&gt;&lt;ul&gt;...</code>) reflecting document hierarchy. Each TOC entry is an anchor (<code>&lt;a href=&quot;#id&quot;&gt;</code>) with optional metadata (depth, section number). Adds expand/collapse toggles for nested groups and a compact "collapse all / expand all" control.                    </td><td data-label="Conceptual Notes"> Uses semantic markup (role=navigation, aria-label) and accessible controls. Visual indenting corresponds to heading levels; insertion point configurable (sidebar, top-of-doc, floating).                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Scroll & highlight synchronization</strong><br>Listens to <code>scroll</code> events (or IntersectionObserver) to determine the currently active heading and highlights the corresponding TOC entry. Optionally updates URL hash on navigation and supports smooth scrolling behavior for anchor clicks.                                </td><td data-label="Conceptual Notes"> Throttles scroll handlers with <code>debounce</code> from core to minimize layout thrash. Uses <code>IntersectionObserver</code> where available to detect visible sections more efficiently. Also supports a "scroll-to-top" quick control.          </td></tr><tr><td data-label="Logic / Structure"> <strong>Dynamic content & MutationObserver</strong><br>Watches the content container for structural changes (new headings, removed sections) and refreshes the TOC accordingly. Debounced refresh to handle bursts of DOM updates.                                                                                                   </td><td data-label="Conceptual Notes"> Ensures TOC stays accurate when content is replaced by AJAX, worker output, or other modules. Carefully diffs old vs new heading lists to preserve collapsed/expanded states when possible.                                     </td></tr><tr><td data-label="Logic / Structure"> <strong>Navigation features</strong><br>Supports clicking anchors, keyboard navigation (arrow keys, Home/End), and optional “search within TOC” input to filter entries. May expose a compact mode for small screens.                                                                                                                </td><td data-label="Conceptual Notes"> Keyboard focus management ensures focal visibility; filtering uses simple substring / fuzzy matching (configurable). Filtered results temporarily expand parents to reveal matches.                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Accessibility & ARIA</strong><br>TOC markup uses roles and ARIA attributes: <code>role=&quot;navigation&quot;</code>, <code>aria-current=&quot;true&quot;</code> for active entry, <code>aria-expanded</code> on toggles; entries are focusable and reachable by keyboard.                                                                                                        </td><td data-label="Conceptual Notes"> Prioritizes screen-reader compatibility — ensures anchor text matches visible text and exposes control labels. Focus traps are avoided; keyboard users can jump into content.                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>Styling & theming</strong><br>Injects minimal inline CSS for layout and collapsed states; allows consumer-provided CSS to override. Provides classes for light/dark theme variations.                                                                                                                                        </td><td data-label="Conceptual Notes"> Inline CSS ensures baseline usability even if host page lacks styles but preserves host theming by using non-specific reset styles.                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration with core utilities</strong><br>Uses <code>tvUtils.debounce</code> for throttling and <code>tvUtils.showToast</code> for informational messages (e.g., “TOC updated”). May use <code>window.tvConfig</code> flags for behavior toggles (autoHashUpdate, smoothScroll).                                                                            </td><td data-label="Conceptual Notes"> If core utilities absent, TOC still functions but without toast messages and with native <code>setTimeout</code> debouncing fallback.                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Edge cases & robustness</strong><br>Handles duplicate or missing heading tags, headings inside hidden elements, or headings that contain HTML markup (code, links). Skips invisible headings (e.g., inside <code>display:none</code>) and avoids creating anchors for extremely short/noisy headings.                                   </td><td data-label="Conceptual Notes"> Sanitizes extracted text to avoid injecting raw HTML into TOC titles. For headings with embedded anchors/links, extracts visible text safely.                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>Performance considerations</strong><br>For very large documents, limits number of TOC entries rendered (configurable <code>maxEntries</code>) and provides a compact indexed mode. Uses batch DOM updates and document fragments to avoid reflow storms.                                                                                </td><td data-label="Conceptual Notes"> Uses diffing to update only changed parts of the TOC when content changes instead of rebuilding the entire structure.                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Optional features / extras</strong><br>Supports deep-linking with scroll offset correction (for sticky headers), persistent collapse state (via <code>localStorage</code>), printing-friendly TOC, and mobile compact toggle.                                                                                                           </td><td data-label="Conceptual Notes"> Persistent state is namespaced to avoid collisions with other installations. Offset correction accounts for fixed header heights and optional scroll padding.                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>Security & safety</strong><br>No eval or remote content loading. All generated IDs and anchor hrefs are sanitized and URL-encoded.                                                                                                                                                                                           </td><td data-label="Conceptual Notes"> Low security risk; main attack surface is DOM insertion of heading text — mitigated by text-only insertion (no innerHTML with untrusted content).                                                                               </td></tr><tr><td data-label="Logic / Structure"> <strong>Developer hooks & events</strong><br>Emits custom events on update (<code>toc:updated</code>, <code>toc:entryClick</code>) and exposes <code>rebuildToc()</code> / <code>destroyToc()</code> public methods for external control.                                                                                                                                        </td><td data-label="Conceptual Notes"> Useful for test harnesses, analytics hooks, or integrations with other components (e.g., highlight-on-search).                                                                                                                  </td></tr></tbody></table></div><div class="row-count">Rows: 14</div></div><div class="table-caption" id="Table11" data-table="Docu_0114_11" style="margin-top:2mm;margin-left:3mm;"><strong>Table 11</strong></div>
<div class="table-wrapper" data-table-id="table-11"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Logic / Structure"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Primary purpose</strong><br>Implements dynamic list management for rendered document sections — typically index lists, file trees, or search result panels. Handles lazy expansion of nested items, on-demand loading, and state persistence. </td><td data-label="Conceptual Notes"> The module provides an interface layer between static HTML listings and user-driven exploration. It complements <code>script.toc.js</code> by dealing with itemized data rather than headings, focusing on collapsibility, selection, and data-driven rendering. </td></tr><tr><td data-label="Logic / Structure"> <strong>Initialization flow</strong><br>Runs after DOM ready or when triggered by <code>ptt:renderStable</code>. Scans for list containers (<code>ul[data-tv-list]</code>, or <code>[data-list-type]</code>) and builds interaction controls for each.                                 </td><td data-label="Conceptual Notes"> Uses delegation for performance — attaches one listener per container instead of per-item. Detects nested sublists and marks them for lazy expansion.                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Expand/collapse logic</strong><br>Defines click handlers on caret icons or <code>[data-expand]</code> toggles to open or close nested lists. Tracks collapsed nodes with internal state (e.g., <code>data-collapsed=&quot;true&quot;</code>).                                 </td><td data-label="Conceptual Notes"> Behaves recursively, ensuring nested sections mirror the parent’s open/closed behavior. Prevents unnecessary reflows by toggling <code>display:none</code> or class states.                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Lazy loading / async fetch</strong><br>Optional: When a list item has a <code>data-src</code> attribute, expansion triggers asynchronous fetch to populate its children. Supports JSON or HTML fragment formats.                                         </td><td data-label="Conceptual Notes"> Provides built-in fallback if fetch fails — displays an inline toast (“Failed to load”) using <code>tvUtils.showToast</code>. Async fetching uses <code>fetch()</code> with timeout and error guards.                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Filtering & search integration</strong><br>Accepts a linked search box (<code>input[data-tv-list-filter]</code>) to filter visible list entries by keyword. Filters apply recursively and collapse non-matching branches.                                </td><td data-label="Conceptual Notes"> Uses <code>tvUtils.debounce</code> for input events. For large lists, can throttle filtering to every 200–300 ms to preserve responsiveness. Highlights matched terms with <code>&lt;mark&gt;</code> wrappers.                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Selection & highlighting</strong><br>Tracks currently selected item via <code>data-selected</code> or CSS class. Optionally scrolls the active item into view and dispatches <code>list:itemSelected</code> events.                                                 </td><td data-label="Conceptual Notes"> Allows integration with content display modules or previews. Selection model is single-selection by default but supports multi-select if enabled via config.                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Keyboard accessibility</strong><br>Arrow keys navigate between list items; Enter expands/collapses nodes; Home/End jump to top/bottom.                                                                                                        </td><td data-label="Conceptual Notes"> ARIA attributes (<code>role=&quot;tree&quot;</code>, <code>aria-expanded</code>, <code>aria-selected</code>) applied to improve screen-reader support.                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Dynamic updates & MutationObserver</strong><br>Listens for external changes to container contents and refreshes event bindings automatically.                                                                                                 </td><td data-label="Conceptual Notes"> Ensures stability when content is re-rendered dynamically (e.g., search updates or progressive loading). Debounced observer avoids redundant refreshes.                                                                                               </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration with core utilities</strong><br>Depends heavily on <code>tvUtils</code> for debounce, toast notifications, and optional clipboard or download features when exporting list items. Uses <code>tvConfig</code> for configurable timings.                  </td><td data-label="Conceptual Notes"> Maintains graceful fallback if <code>tvUtils</code> missing — internal replacements used for basic debounce and console warnings only.                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Export / copy support</strong><br>Allows exporting visible list items as plain text or Markdown bullets. Integrates with <code>tvUtils.copyToClipboard</code> and <code>tvUtils.showToast</code>.                                                                   </td><td data-label="Conceptual Notes"> Similar export flow to <code>script.table.js</code>: collects visible nodes, converts to Markdown (<code>- Item</code> lines), and copies or downloads them.                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Persistence & state restoration</strong><br>Optionally stores expanded/collapsed and selected states in <code>localStorage</code> under a namespaced key (<code>tvListState:&lt;containerId&gt;</code>). Restores them on reload.                                         </td><td data-label="Conceptual Notes"> Namespacing prevents collision between multiple instances on one page. Restoration tolerant of missing elements (skips non-existent nodes).                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Performance considerations</strong><br>Virtualizes very long lists by rendering visible items only and adding placeholder spacers. Uses intersection-based lazy rendering to keep memory low.                                                 </td><td data-label="Conceptual Notes"> For extremely large datasets, uses scroll-based batching to append new visible items as needed.                                                                                                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Styling & layout</strong><br>Injects minimal CSS for indent levels, toggle icons, and highlight effects. Adapts to host page fonts and color themes.                                                                                          </td><td data-label="Conceptual Notes"> Inline styles ensure baseline usability without external CSS. Supports light/dark via CSS variables or body attributes.                                                                                                                               </td></tr><tr><td data-label="Logic / Structure"> <strong>Error handling</strong><br>Async fetches guarded with <code>try/catch</code>; errors log to console and trigger toasts. Internal checks verify element existence before modifying attributes.                                                            </td><td data-label="Conceptual Notes"> Avoids halting on errors; if remote data missing, keeps placeholder node collapsed.                                                                                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>Event architecture</strong><br>Dispatches custom events: <code>list:loaded</code>, <code>list:itemSelected</code>, <code>list:expanded</code>, <code>list:collapsed</code>. Allows external modules to hook into user actions.                                                            </td><td data-label="Conceptual Notes"> Facilitates integration with other parts of the viewer (e.g., selecting a list item can scroll to a table or section in another pane).                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Edge cases & fallback handling</strong><br>Skips hidden or non-element children; normalizes whitespace; handles items inserted via copy/paste or script injection.                                                                            </td><td data-label="Conceptual Notes"> Defensive parsing prevents null references or unintended text nodes from breaking traversal logic.                                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Security & safety</strong><br>Does not use <code>innerHTML</code> for fetched JSON-based content; uses text node insertion or sanitized template injection.                                                                                              </td><td data-label="Conceptual Notes"> Very low security surface; no remote eval or arbitrary code execution.                                                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Overall system role</strong><br>Acts as the interactive list/outline layer for structured data navigation. Complements the TOC (heading-based) and Table (data-based) modules, forming the triad of user exploration interfaces.              </td><td data-label="Conceptual Notes"> Connects conceptually with <code>script.core.js</code> for utilities and with <code>script.toc.js</code> for similar hierarchical navigation principles. Shares design language, accessibility, and defensive coding ethos.                                                 </td></tr></tbody></table></div><div class="row-count">Rows: 18</div></div><div class="table-caption" id="Table12" data-table="Docu_0114_12" style="margin-top:2mm;margin-left:3mm;"><strong>Table 12</strong></div>
<div class="table-wrapper" data-table-id="table-12"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>Overview (single-sentence)</strong> — Four cooperating front-end modules form a compact, dependency-light viewer toolkit: <code>script.core.js</code> provides environment, config and shared utilities; <code>script.table.js</code> supplies table interactivity and export; <code>script.toc.js</code> builds a heading-based Table of Contents and scroll-sync; <code>script.list.js</code> manages hierarchical item lists with lazy loading and selection. Together they enable navigation, exploration, and export of rendered document content while degrading gracefully in constrained environments. </td></tr><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>Architectural separation</strong> — The system intentionally follows a layered, one-directional dependency model: <em>core</em> → utility surface (<code>window.tvUtils</code>, <code>window.tvConfig</code>, events), while <em>table</em>, <em>toc</em>, and <em>list</em> are consumers of that surface. None of the UI modules mutates core behavior; they only call utilities and subscribe to DOM or custom events. This minimizes coupling and simplifies embedding into arbitrary host pages. </td></tr><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>Key shared contracts & globals</strong> — <code>window.tvUtils</code> (copy/download/toast/debounce/markdown/CSV helpers); <code>window.tvConfig</code> (runtime toggles); <code>ptt:renderStable</code> custom event (DOM quiescence); body attributes <code>data-index-url</code> / <code>data-worker-url</code> (asset discovery). UI modules assume these contracts but implement fallbacks so core absence leads to partial, non-fatal degradation. </td></tr><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>Data & control flow (typical user path)</strong> — Page loads → core initializes base URLs and config → core exposes <code>tvUtils</code> and dispatches <code>ptt:renderStable</code> → <code>table</code>, <code>toc</code>, and <code>list</code> detect content and attach toolbars/controls → user interacts (collapse/expand, copy/export, navigate) → UI modules call <code>tvUtils</code> for I/O and show feedback via toasts → DOM mutations from user or async renders trigger observers to refresh UI bindings. </td></tr><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>Event map (important signals)</strong> — <code>ptt:renderStable</code> (core → UI modules to (re)build); <code>toc:updated</code>, <code>toc:entryClick</code> (toc → external hooks); <code>list:loaded</code>, <code>list:itemSelected</code>, <code>list:expanded</code>, <code>list:collapsed</code> (list → integrations); internal events from table: <code>table:toolbarReady</code>, <code>table:exported</code>; UI → core uses <code>tvUtils.showToast</code>. Events are namespaced and intended for loose coupling. </td></tr><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>Export & I/O contract</strong> — Exports are standardized: table → Markdown/CSV via <code>tvUtils.tableToMarkdownLines()</code> + <code>tvUtils.downloadBlob()</code>; list → Markdown bullets or plain text via <code>tvUtils.copyToClipboard()</code>; all file names pass through <code>tvUtils.sanitizeFileName()</code>. Clipboard and download paths include legacy fallbacks (textarea + <code>execCommand</code>, <code>createObjectURL</code>) to support older browsers. </td></tr><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>Concurrency model</strong> — Lightweight, event-driven and cooperative: debounced scroll and resize handlers, <code>MutationObserver</code>-driven refreshes, sequential script loader for optional extras, and <code>once()</code> guards for idempotency. No heavy parallel computation; async remote fetches (list lazy loading) are guarded with timeouts and error handling to avoid blocking UI. </td></tr><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>Accessibility & UX standards</strong> — ARIA attributes applied (<code>aria-expanded</code>, <code>aria-pressed</code>, <code>aria-current</code>, <code>role=&quot;navigation&quot;</code>/<code>role=&quot;tree&quot;</code>), keyboard navigation for lists/toc/toolbars, visible focus states, and toast feedback for user actions. Inline CSS provides baseline visuals; host styling may override for theming. </td></tr><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>Dynamic content resilience</strong> — Each UI module uses <code>MutationObserver</code> + debounce to detect and reattach to newly injected content. When refreshing, modules attempt to preserve user state (collapsed groups, selected items) via diffing or localStorage namespacing. They skip malformed elements and avoid wholesale rebuilds when diffing is possible. </td></tr><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>State persistence & namespacing</strong> — Persistent UI state (expanded/collapsed, selected nodes) may be stored in <code>localStorage</code> under namespaced keys (e.g., <code>tvListState:&lt;id&gt;</code> or <code>tvTocState:&lt;id&gt;</code>). Namespacing reduces collision risk across multiple instances on the same page or across projects loaded into the same origin. </td></tr><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>Performance safeguards</strong> — For large documents/lists the system: (1) limits TOC entries (<code>maxEntries</code>) or provides compact mode; (2) virtualizes very long lists by rendering only visible ranges; (3) batches DOM writes via document fragments; (4) uses <code>IntersectionObserver</code> to reduce scroll handler cost. Debounce thresholds are configurable via <code>tvConfig</code>. </td></tr><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>Security & injection safety</strong> — All modules avoid <code>eval()</code> and minimize <code>innerHTML</code>. Heading and list text are inserted as text nodes or sanitized slugs for anchors; fetched HTML fragments are handled carefully and JSON is preferred. IDs and hrefs are URL-encoded/sanitized. The primary attack surface is user-provided HTML in headings/lists — mitigated by text-only insertion and sanitization. </td></tr><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>Error modes & graceful degradation</strong> — If <code>tvUtils</code> missing: exports/toasts degrade (disabled or use console warnings), but core navigation/expand-collapse remains functional where implemented locally. If fetch for lazy list items fails, module shows toast and leaves placeholder collapsed. Modules prefer to skip broken elements rather than throw fatal exceptions. </td></tr><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>Developer API & extension points</strong> — Public methods: <code>rebuildToc()</code>, <code>destroyToc()</code>, <code>refreshTableToolbars()</code>, <code>buildToolbar(tableEl)</code>, list: <code>loadNode(nodeId)</code>/<code>restoreState()</code>. Events described above let analytics or host apps integrate without needing to modify module internals. Extra scripts can be loaded sequentially via core’s extra loader to add features. </td></tr><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>Testing & audit checklist</strong> — Unit/Integration focus: (1) verify <code>ptt:renderStable</code> triggers on real content churn; (2) table export correctness (pipe escaping, multiline cell handling); (3) toc scroll-sync with sticky headers; (4) list lazy-fetch error recovery and state restore; (5) ARIA attribute presence and keyboard navigation; (6) localStorage state namespacing and expiry behavior. </td></tr><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>Upgrade & refactor recommendations</strong> — (1) Replace global namespace with explicit module registration (e.g., <code>window.tvRegistry.register(&#x27;table&#x27;, api)</code>) to ease testing and avoid global collisions; (2) extract a tiny DOM helper library shared between UI modules for diffing and fragment updates; (3) formalize config schema with validation for <code>tvConfig</code>; (4) add unit tests around export stringification and slug generation; (5) add opt-in telemetry hooks to measure render/interaction latencies. </td></tr><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>Known limitations & open questions</strong> — (1) Theme theming is limited because many styles are inline; (2) state restoration heuristics may fail when content IDs are not stable; (3) virtualized lists need careful keyboard focus management; (4) how to coordinate multiple viewer instances on same origin — concurrency of localStorage keys needs operational policy. </td></tr><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>Operational summary</strong> — This suite is designed for portability and predictable embedding. It favors defensive, readable code over feature bloat, with prioritized user-facing concerns: accurate navigation (TOC), efficient exploration (list), interactive data (table), and shared UX primitives (core). The architecture supports progressive enhancement, easy debugging, and incremental feature addition via the extra loader. </td></tr><tr><td data-label="Consolidated Interlinked Conceptual Project Map — script.core.js, script.table.js, script.toc.js, script.list.js"> <strong>Approval / next step</strong> — If this consolidated map matches expectations I will: (A) produce a visual dependency diagram (SVG) and (B) generate a prioritized refactor checklist with code-location mapping. Do you <strong>approve</strong> this consolidated project map and which next step do you want (diagram / refactor checklist / unit-test plan / other)? </td></tr></tbody></table></div><div class="row-count">Rows: 19</div></div><div class="table-caption" id="Table13" data-table="Docu_0114_13" style="margin-top:2mm;margin-left:3mm;"><strong>Table 13</strong></div>
<div class="table-wrapper" data-table-id="table-13"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Category**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Category</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Objective**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Objective</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Key Actions / Validation Points**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Key Actions / Validation Points</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Category"> <strong>Scope & Safety Pass</strong>        </td><td data-label="Objective"> Identify global side effects, blocking operations, and assumptions about <code>html_renderer.py</code>. </td><td data-label="Key Actions / Validation Points"> • Review top-to-bottom for global variable modifications.<br>• Check if any blocking I/O or infinite loops exist.<br>• Verify assumptions on <code>html_renderer</code> imports and usage. </td></tr><tr><td data-label="Category"> <strong>Compatibility Checks</strong>       </td><td data-label="Objective"> Validate interaction between <code>server.py</code> and <code>html_renderer.py</code> (and other local modules).   </td><td data-label="Key Actions / Validation Points"> • Confirm correct import names and paths.<br>• Ensure expected function return types match (<code>str</code> vs <code>bytes</code>).<br>• Check for backward compatibility with existing APIs.        </td></tr><tr><td data-label="Category"> <strong>Request Handling</strong>           </td><td data-label="Objective"> Securely serve requests with proper file handling and MIME types.                            </td><td data-label="Key Actions / Validation Points"> • Validate path resolution to block directory traversal.<br>• Ensure MIME type correctness for all served assets.<br>• Confirm correct static file routing logic.               </td></tr><tr><td data-label="Category"> <strong>Threading / Concurrency</strong>    </td><td data-label="Objective"> Ensure safe concurrent request handling.                                                     </td><td data-label="Key Actions / Validation Points"> • Verify use of <code>ThreadingHTTPServer</code> or similar.<br>• Prevent shared mutable global state.<br>• Confirm thread-safe access to shared resources.                                </td></tr><tr><td data-label="Category"> <strong>Encoding / Bytes Handling</strong>  </td><td data-label="Objective"> Maintain consistent encoding in all responses.                                               </td><td data-label="Key Actions / Validation Points"> • Guarantee all HTTP responses are bytes.<br>• Add <code>charset=utf-8</code> in Content-Type headers.<br>• Apply <code>.encode(&#x27;utf-8&#x27;)</code> where needed.                                         </td></tr><tr><td data-label="Category"> <strong>Error Handling & Fallbacks</strong> </td><td data-label="Objective"> Improve robustness and error recovery.                                                       </td><td data-label="Key Actions / Validation Points"> • Wrap <code>render</code> and critical operations in <code>try/except</code>.<br>• Return user-safe error pages on failure.<br>• Log stack traces for diagnostics.                                   </td></tr><tr><td data-label="Category"> <strong>APIs / Endpoints</strong>           </td><td data-label="Objective"> Maintain API stability and expected behavior.                                                </td><td data-label="Key Actions / Validation Points"> • Preserve all existing <code>/api/*</code> routes.<br>• Retain <code>/api/diagnostics</code> and <code>/api/reload</code> if already defined.<br>• Avoid introducing breaking changes.                          </td></tr><tr><td data-label="Category"> <strong>Logging & Observability</strong>    </td><td data-label="Objective"> Improve traceability and debugging safety.                                                   </td><td data-label="Key Actions / Validation Points"> • Use timestamped structured logging.<br>• Avoid logging sensitive data.<br>• Ensure errors include context but not secrets.                                                    </td></tr><tr><td data-label="Category"> <strong>Security</strong>                   </td><td data-label="Objective"> Prevent misuse or unsafe file access.                                                        </td><td data-label="Key Actions / Validation Points"> • Restrict CORS to localhost by default.<br>• Sanitize and validate all query parameters.<br>• Avoid unsafe path concatenations.                                                </td></tr><tr><td data-label="Category"> <strong>Final Validation</strong>           </td><td data-label="Objective"> Produce validated and review-ready output.                                                   </td><td data-label="Key Actions / Validation Points"> • Run static syntax and linting checks.<br>• Generate a side-by-side patch view.<br>• Provide concise explanations for each modification.                                       </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>