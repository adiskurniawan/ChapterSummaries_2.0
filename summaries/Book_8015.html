<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1761618818">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      // Delegate addEventListener/removeEventListener to visible button
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      // Delegate onclick assignments
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      // Delegate focus/blur
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
      // If legacy code used direct addEventListener earlier than this script, listeners would already exist
      // on alias element; attempt to re-dispatch those by cloning them to visible button is non-trivial.
      // This approach covers the common case where legacy scripts query the alias and bind after DOM ready.
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li>
<li class="toc-item"><a class="toc-link" href="#Table7">Table 7</a></li>
<li class="toc-item"><a class="toc-link" href="#Table8">Table 8</a></li>
<li class="toc-item"><a class="toc-link" href="#Table9">Table 9</a></li>
<li class="toc-item"><a class="toc-link" href="#Table10">Table 10</a></li>
<li class="toc-item"><a class="toc-link" href="#Table11">Table 11</a></li>
<li class="toc-item"><a class="toc-link" href="#Table12">Table 12</a></li>
<li class="toc-item"><a class="toc-link" href="#Table13">Table 13</a></li>
<li class="toc-item"><a class="toc-link" href="#Table14">Table 14</a></li>
<li class="toc-item"><a class="toc-link" href="#Table15">Table 15</a></li>
<li class="toc-item"><a class="toc-link" href="#Table16">Table 16</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Book_8015_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic/Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic/Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic/Structure"> <strong>1. Goal</strong>                      </td><td data-label="Conceptual Notes"> Wrap each rendered <code>&lt;table&gt;</code> with an interactive container and toolbar without editing any files inside <code>render/</code>.                                                                                                                                                                                     </td></tr><tr><td data-label="Logic/Structure"> <strong>2. Source of change</strong>          </td><td data-label="Conceptual Notes"> Modify <code>html_renderer.py</code> only. Do not touch <code>render/*</code> or <code>assets/style.css</code>. Add new assets under <code>assets/</code> (e.g. <code>table_ui.js</code>, <code>table_ui.css</code>).                                                                                                                                                    </td></tr><tr><td data-label="Logic/Structure"> <strong>3. Output markup</strong>             </td><td data-label="Conceptual Notes"> On table emission <code>html_renderer.py</code> will: add <code>&lt;div class=&quot;ptt-table&quot; id=&quot;Table{n}&quot; data-ptt-json=&quot;...&quot;&gt;</code> wrapper, include per-table toolbar markup, and place the original <code>&lt;table&gt;</code> inside <code>.table-body</code>. <code>data-ptt-json</code> holds escaped JSON for exports.                                           </td></tr><tr><td data-label="Logic/Structure"> <strong>4. IDs & anchors</strong>             </td><td data-label="Conceptual Notes"> Generate deterministic IDs <code>Table1, Table2, ...</code>. Emit anchor links for global navigation if <code>index.html</code> includes nav placeholder.                                                                                                                                                                    </td></tr><tr><td data-label="Logic/Structure"> <strong>5. JS hooks</strong>                  </td><td data-label="Conceptual Notes"> New <code>assets/table_ui.js</code> will handle collapse/expand, copy, export (CSV/JSON/MD), and global toolbar actions. Use client-side only. Do not require server changes except static serving.                                                                                                               </td></tr><tr><td data-label="Logic/Structure"> <strong>6. CSS</strong>                       </td><td data-label="Conceptual Notes"> Add <code>assets/table_ui.css</code> for UI styles. Do not modify <code>assets/style.css</code>. New CSS will be loaded alongside existing CSS.                                                                                                                                                                              </td></tr><tr><td data-label="Logic/Structure"> <strong>7. Fallback</strong>                  </td><td data-label="Conceptual Notes"> If JS disabled, the wrapper will still render the <code>&lt;table&gt;</code> and toolbar buttons will be hidden via <code>&lt;noscript&gt;</code> or CSS. No functional regression.                                                                                                                                                      </td></tr><tr><td data-label="Logic/Structure"> <strong>8. Server/static</strong>             </td><td data-label="Conceptual Notes"> <code>server.py</code> or static config may need to serve new asset files. If <code>server.py</code> already serves <code>assets/</code>, no change required. Otherwise I will add minimal static route.                                                                                                                                </td></tr><tr><td data-label="Logic/Structure"> <strong>9. Security / size</strong>           </td><td data-label="Conceptual Notes"> <code>data-ptt-json</code> must be size-aware. For very large tables prefer a hidden <code>&lt;script type=&quot;application/json&quot; data-ptt=&quot;...&quot;&gt;</code> block to avoid attribute-length limits.                                                                                                                                    </td></tr><tr><td data-label="Logic/Structure"> <strong>10. Backward compatibility</strong>   </td><td data-label="Conceptual Notes"> No changes to <code>render/*</code> means existing renderer output remains identical except wrapped. Consumers of raw <code>render</code> functions remain unaffected.                                                                                                                                                       </td></tr><tr><td data-label="Logic/Structure"> <strong>11. Tests</strong>                    </td><td data-label="Conceptual Notes"> Tests to run:<br>1) Render a sample input and confirm wrapper present and original table HTML unchanged.<br>2) Confirm <code>data-ptt-json</code> parses to original table data.<br>3) Confirm page renders with JS disabled.<br>4) Confirm assets (<code>table_ui.js</code>, <code>table_ui.css</code>) are referenced in output HTML. </td></tr><tr><td data-label="Logic/Structure"> <strong>12. Risks</strong>                    </td><td data-label="Conceptual Notes"> Large table JSON in attributes may hit browser limits. Changing <code>html_renderer.py</code> must preserve encoding and escaping to avoid XSS. Ensure no network calls.                                                                                                                                          </td></tr><tr><td data-label="Logic/Structure"> <strong>13. Deliverables on approval</strong> </td><td data-label="Conceptual Notes"> Full revised <code>html_renderer.py</code> file in copy-code block, new <code>assets/table_ui.js</code> and <code>assets/table_ui.css</code> (one file at a time per workflow), 15-point verification checklist, changelog entry, rollback command, and minimal test commands.                                                          </td></tr><tr><td data-label="Logic/Structure"> <strong>14. Implementation order</strong>     </td><td data-label="Conceptual Notes"> 1) <code>html_renderer.py</code> conceptual patch. 2) <code>templates/index.html</code> minor insertion for global toolbar. 3) <code>assets/table_ui.js</code>. 4) <code>assets/table_ui.css</code>. 5) optional <code>server.py</code> static serve addition if required.                                                                                    </td></tr><tr><td data-label="Logic/Structure"> <strong>15. Constraints</strong>              </td><td data-label="Conceptual Notes"> Do not modify any file in <code>render/</code> or <code>assets/style.css</code>. Follow project workflow: one file change at a time and wait for approval before applying next.                                                                                                                                              </td></tr></tbody></table></div><div class="row-count">Rows: 15</div></div><div class="table-caption" id="Table2" data-table="Book_8015_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Tables Viewer v2.1 item**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Tables Viewer v2.1 item</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **PasteToTable — current state &amp; action**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>PasteToTable — current state & action</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Tables Viewer v2.1 item"> <strong>core_assets (asset discovery, embedding, SRI, copy logic)</strong> </td><td data-label="PasteToTable — current state &amp; action"> Already recommended by v2.1. <strong>Action:</strong> implement or extend in <code>render/core_assets.py</code> if missing. But <strong>do not modify any <code>render/</code> files</strong> per your rule. Instead adapt caller sites outside <code>render/</code> (<code>html_renderer.py</code>, <code>templates/index.html</code>, <code>server.py</code>) to use existing <code>core_assets</code> behavior. </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>core_renderer (orchestration shim)</strong>                        </td><td data-label="PasteToTable — current state &amp; action"> Optional in v2.1. <strong>Action:</strong> keep orchestration changes outside locked <code>render/</code> files. Modify <code>html_renderer.py</code> to provide the orchestration and compatibility layer.                                                                                                                                    </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>core_io (atomic write, tmp dirs)</strong>                          </td><td data-label="PasteToTable — current state &amp; action"> High priority for reliability. <strong>Action:</strong> implement required atomic I/O helpers in <code>utils.py</code> or <code>render/convert.py</code> (you allowed <code>convert.py</code>). Prefer <code>utils.py</code> first then mirror into <code>convert.py</code> if renderer needs it.                                                                               </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>core_table (canonical table renderer)</strong>                     </td><td data-label="PasteToTable — current state &amp; action"> Present and must remain unchanged in <code>render/</code>. <strong>Action:</strong> ensure <code>html_renderer.py</code> uses it as-is and does not wrap or alter markup that affects typography.                                                                                                                                              </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>core_utils (sanitize, sri_attr, streaming helpers)</strong>        </td><td data-label="PasteToTable — current state &amp; action"> High leverage. <strong>Action:</strong> implement small helpers in <code>utils.py</code> and expose from <code>render/convert.py</code> if necessary. Do not edit other <code>render/</code> files.                                                                                                                                                       </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>client assets (worker.js, xlsx libs, UI JS/CSS)</strong>           </td><td data-label="PasteToTable — current state &amp; action"> v2.1 uses <code>worker.js</code> and optional large libs. <strong>Action:</strong> add new UI assets under <code>assets/</code> (<code>table_ui.js</code>, <code>table_ui.css</code>) and update <code>templates/index.html</code> to load them. Do not change <code>assets/style.css</code>.                                                                                              </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>HTML/CSS font & reset rules</strong>                               </td><td data-label="PasteToTable — current state &amp; action"> Typography mismatch likely due to missing font, reset, or load order. <strong>Action:</strong> update <code>templates/index.html</code> to include the exact font links and ensure <code>assets/style.css</code> loads in identical order. Add a small <code>assets/typography_override.css</code> if needed.                                             </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>Sanitizer / convert behavior</strong>                              </td><td data-label="PasteToTable — current state &amp; action"> v2.1 notes show sanitizer can strip classes/styles. <strong>Action:</strong> adjust <code>render/convert.py</code> (allowed) to preserve classes/attributes required for typography. Keep other <code>render/</code> files untouched.                                                                                                          </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>Load order / JS fallbacks</strong>                                 </td><td data-label="PasteToTable — current state &amp; action"> v2.1 supports JS-disabled fallback. <strong>Action:</strong> update <code>templates/index.html</code> and <code>assets/script.js</code> to reproduce that behavior.                                                                                                                                                                            </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>Priority list</strong>                                             </td><td data-label="PasteToTable — current state &amp; action"> High: fonts/load order, <code>html_renderer.py</code> wrapper behavior, <code>render/convert.py</code> attribute preservation, <code>templates/index.html</code> asset links. Medium: add UI assets, atomic I/O helpers. Low: core_renderer refactor.                                                                                        </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>Quick tests (minimal)</strong>                                     </td><td data-label="PasteToTable — current state &amp; action"> 1) Render sample table and compare computed <code>font-family</code>, <code>font-size</code>, <code>line-height</code> to v2.1. 2) Inspect <code>&lt;td&gt;</code> classes/inline styles for preservation. 3) Verify <code>assets/style.css</code> is loaded in same order. 4) Verify page with JS disabled.                                                             </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>Constraint reminder</strong>                                       </td><td data-label="PasteToTable — current state &amp; action"> <strong>Do not modify</strong> any files in <code>render/</code> except <code>render/convert.py</code>. <strong>Do not modify</strong> <code>assets/style.css</code>. All other changes must be outside <code>render/</code>.                                                                                                                                                     </td></tr></tbody></table></div><div class="row-count">Rows: 12</div></div><div class="table-caption" id="Table3" data-table="Book_8015_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Step / Focus Area**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Step / Focus Area</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Strategic Plan for Matching Benchmark Typography**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Strategic Plan for Matching Benchmark Typography</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Step / Focus Area"> <strong>1. Visual Analysis</strong>                     </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Capture all font, spacing, border, color, and alignment metrics from the benchmark table ([Book_9001.html#Table4](https://adiskurniawan.github.io/ChapterSummaries_2.0/summaries/Book_9001.html#Table4)). Document differences with current output. </td></tr><tr><td data-label="Step / Focus Area"> <strong>2. CSS Integrity</strong>                       </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Lock <code>assets/style.css</code> since it already matches Table Viewer 2.1. Verify loaded version in browser is the same file, not overridden by cache or embedded style.                                                                                    </td></tr><tr><td data-label="Step / Focus Area"> <strong>3. HTML Output Layer</strong>                   </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Audit <code>html_renderer.py</code> and <code>templates/index.html</code> for missing or extra wrappers, classes, or attributes that alter spacing, text alignment, or font inheritance. Align structure exactly to Table Viewer 2.1 markup.                              </td></tr><tr><td data-label="Step / Focus Area"> <strong>4. Table Conversion Logic</strong>              </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Focus changes in <code>render/convert.py</code> to ensure HTML output structure (tags, nesting, indentation) fully matches the reference output. Avoid logic that injects extra inline styles.                                                                 </td></tr><tr><td data-label="Step / Focus Area"> <strong>5. JS Behavior</strong>                         </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Check <code>assets/script.js</code> for dynamic DOM styling or table transformation that may modify widths or alignment. Neutralize or sync with Table Viewer 2.1’s JavaScript if differences exist.                                                           </td></tr><tr><td data-label="Step / Focus Area"> <strong>6. Template Rendering</strong>                  </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Adjust <code>templates/index.html</code> only to ensure page-level CSS inheritance (font, background, container width) matches benchmark. No additional styling.                                                                                               </td></tr><tr><td data-label="Step / Focus Area"> <strong>7. Data Flow Consistency</strong>               </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Verify <code>main.py</code>, <code>server.py</code>, and <code>utils.py</code> feed consistent, sanitized HTML data into renderer without escaping or wrapping deviations that affect rendering.                                                                                     </td></tr><tr><td data-label="Step / Focus Area"> <strong>8. Pixel Comparison Test</strong>               </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Generate side-by-side screenshots of benchmark vs current output. Use computed CSS metrics (font-family, line-height, letter-spacing) for verification.                                                                                             </td></tr><tr><td data-label="Step / Focus Area"> <strong>9. Accessibility + Responsive Behavior</strong> </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Validate that typography consistency holds under zoom and small screens without distorting line spacing or table width.                                                                                                                             </td></tr><tr><td data-label="Step / Focus Area"> <strong>10. Final Verification</strong>                 </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Produce final regression suite comparing exported table HTML against benchmark HTML snippet for tag order, attributes, and computed style equivalence.                                                                                              </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table4" data-table="Book_8015_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Step / Focus Area**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Step / Focus Area</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Expanded Strategic Plan for Matching Benchmark Typography**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Expanded Strategic Plan for Matching Benchmark Typography</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Step / Focus Area"> <strong>1. Visual Analysis</strong>                     </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Perform a detailed audit of the benchmark table ([Book_9001.html#Table4](https://adiskurniawan.github.io/ChapterSummaries_2.0/summaries/Book_9001.html#Table4)), recording: <br>1. Font-family, weight, style, and fallback fonts. <br>2. Font-size per table, row, header, and cell. <br>3. Line-height, letter-spacing, and word-spacing. <br>4. Cell padding, table margins, border width and color. <br>5. Background and text color. <br>6. Text alignment, vertical alignment, and header alignment. <br>7. Table width, container width, and max-width constraints. <br>Document all deviations from current PasteToTable output with precise CSS and HTML selectors. </td></tr><tr><td data-label="Step / Focus Area"> <strong>2. CSS Integrity</strong>                       </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Ensure <code>assets/style.css</code> matches Table Viewer 2.1 exactly. <br>1. Confirm correct load order in <code>templates/index.html</code>. <br>2. Prevent cache or injected styles from overriding <code>style.css</code>. <br>3. Check for media queries or theme-specific overrides. <br>4. Optionally add a small supplemental <code>table_ui.css</code> for UI controls that does not touch typography. <br>5. Verify no inline styles or JS-modified styles are changing inherited typography.                                                                                                                                                                                                                  </td></tr><tr><td data-label="Step / Focus Area"> <strong>3. HTML Output Layer</strong>                   </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Audit <code>html_renderer.py</code> and <code>templates/index.html</code>: <br>1. Ensure all <code>&lt;table&gt;</code> elements have the same nesting and wrappers as benchmark (e.g., <code>.table-container</code>, <code>.table-body</code>). <br>2. Verify all classes, IDs, and data attributes that control style or alignment are preserved. <br>3. Ensure <code>&lt;th&gt;</code> and <code>&lt;td&gt;</code> semantic usage matches benchmark (row headers, column headers, rowspan/colspan). <br>4. Confirm no extra <code>&lt;div&gt;</code> or <code>&lt;span&gt;</code> wrappers that interfere with inheritance. <br>5. Validate HTML escaping and sanitizer do not remove essential attributes.                                                                                               </td></tr><tr><td data-label="Step / Focus Area"> <strong>4. Table Conversion Logic</strong>              </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Focus on <code>render/convert.py</code> for controlled modifications: <br>1. Preserve class names, IDs, and inline attributes required for typography. <br>2. Maintain tag nesting and indentation identical to benchmark output. <br>3. Ensure no additional <code>&lt;style&gt;</code> or <code>&lt;font&gt;</code> attributes are injected. <br>4. Convert or normalize whitespace to match benchmark. <br>5. Preserve table data fidelity for export and display.                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Step / Focus Area"> <strong>5. JS Behavior</strong>                         </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Review <code>assets/script.js</code> and <code>assets/worker.js</code>: <br>1. Identify any scripts that modify table width, font, or alignment dynamically. <br>2. Disable or modify JS affecting typography to match benchmark behavior. <br>3. Implement collapse/expand and export features without affecting typography. <br>4. Validate responsive behavior and zoom interactions maintain spacing and alignment. <br>5. Ensure scripts do not inject inline styles that override CSS.                                                                                                                                                                                                       </td></tr><tr><td data-label="Step / Focus Area"> <strong>6. Template Rendering</strong>                  </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Adjust <code>templates/index.html</code> only for page-level consistency: <br>1. Verify <code>&lt;meta charset=&quot;utf-8&quot;&gt;</code> and <code>&lt;!doctype html&gt;</code> are present. <br>2. Ensure correct <code>&lt;link&gt;</code> to <code>assets/style.css</code> (and supplemental UI CSS if needed). <br>3. Confirm container widths, font inheritance, and background colors match benchmark. <br>4. Do not introduce new typography rules. <br>5. Include anchor navigation and global toolbar placeholders if benchmark uses them.                                                                                                                                                                                                          </td></tr><tr><td data-label="Step / Focus Area"> <strong>7. Data Flow Consistency</strong>               </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Audit <code>main.py</code>, <code>server.py</code>, <code>utils.py</code>: <br>1. Verify HTML passed to renderer is consistent with expected benchmark table structure. <br>2. Ensure no additional escaping or sanitation modifies spacing, inline styles, or class attributes. <br>3. Confirm that JSON or other structured table data retains all required fields for rendering. <br>4. Check for transformations that may alter header or cell content affecting typography.                                                                                                                                                                                                                              </td></tr><tr><td data-label="Step / Focus Area"> <strong>8. Pixel Comparison Test</strong>               </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Perform objective visual comparison: <br>1. Capture high-resolution screenshots of benchmark and PasteToTable output side-by-side. <br>2. Compare font-family, font-size, line-height, letter-spacing, cell padding, and border widths. <br>3. Use browser devtools to inspect computed styles and ensure all matches. <br>4. Confirm rendering matches across multiple browsers and zoom levels. <br>5. Generate automated regression tests for CSS and DOM attributes.                                                                                                                                                                                                     </td></tr><tr><td data-label="Step / Focus Area"> <strong>9. Accessibility + Responsive Behavior</strong> </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Validate typography consistency under accessibility and responsive conditions: <br>1. Zoom in/out and check line spacing, table width, and font scaling. <br>2. Confirm text remains readable and aligned at different viewport widths. <br>3. Test keyboard navigation and screen reader fallback for table structure. <br>4. Ensure collapse/expand and toolbar actions do not distort typography.                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Step / Focus Area"> <strong>10. Final Verification</strong>                 </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Create a comprehensive regression and verification suite: <br>1. Compare rendered HTML tag order, classes, and attributes to benchmark snippet. <br>2. Confirm CSS inheritance matches benchmark. <br>3. Validate that exported HTML, CSV, Markdown, and PDF outputs preserve typography. <br>4. Document any remaining small deviations and iterate. <br>5. Confirm no changes occurred in <code>render/</code> files or <code>assets/style.css</code>.                                                                                                                                                                                                                                           </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table5" data-table="Book_8015_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Step / Focus Area**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Step / Focus Area</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Strategic Plan for Matching Benchmark Typography**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Strategic Plan for Matching Benchmark Typography</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **My Task (Minimal)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>My Task (Minimal)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Step / Focus Area"> <strong>1. Visual Analysis</strong>                     </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Perform a meticulous audit of the benchmark table ([Book_9001.html#Table4](https://adiskurniawan.github.io/ChapterSummaries_2.0/summaries/Book_9001.html#Table4)) including: <br>• Exact font-family, weight, style, fallback fonts. <br>• Font-size per table, header, body, and footer. <br>• Line-height, letter-spacing, word-spacing. <br>• Cell padding, row spacing, table margins, border width and color. <br>• Background and text color of headers and cells. <br>• Text alignment (horizontal/vertical) and header alignment. <br>• Table width, container width, max-width, and responsive constraints. <br>Document all differences and compute delta values vs current PasteToTable output. </td><td data-label="My Task (Minimal)"> Inspect benchmark table; note every metric and difference.                       </td></tr><tr><td data-label="Step / Focus Area"> <strong>2. CSS Integrity</strong>                       </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Ensure <code>assets/style.css</code> is identical to Table Viewer 2.1. Steps: <br>• Confirm correct load order in <code>templates/index.html</code>. <br>• Prevent any caching or inline style overrides. <br>• Verify media queries and theme-specific rules match benchmark. <br>• Add optional <code>table_ui.css</code> for UI controls only, ensuring it does not touch typography. <br>• Confirm no JS or dynamic style changes override inherited styles. <br>• Cross-check all inherited font-family, font-size, line-height, and spacing.                                                                                                                                                                                          </td><td data-label="My Task (Minimal)"> Verify CSS load order; prepare supplemental UI CSS only.                         </td></tr><tr><td data-label="Step / Focus Area"> <strong>3. HTML Output Layer</strong>                   </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Audit <code>html_renderer.py</code> and <code>templates/index.html</code> for markup fidelity: <br>• Ensure every <code>&lt;table&gt;</code> has the same wrappers and nesting (<code>.table-container</code>, <code>.table-body</code>, etc.). <br>• Preserve all class names, IDs, and data attributes critical to styling. <br>• Verify <code>&lt;th&gt;</code> and <code>&lt;td&gt;</code> semantic use, including <code>rowspan</code>/<code>colspan</code>. <br>• Ensure no extra <code>&lt;div&gt;</code> or <code>&lt;span&gt;</code> wrappers interfere with font inheritance. <br>• Validate HTML escaping and sanitizer do not remove essential attributes or add inline styles.                                                                                                                                                                       </td><td data-label="My Task (Minimal)"> Review rendered table output; confirm wrappers, classes, IDs.                    </td></tr><tr><td data-label="Step / Focus Area"> <strong>4. Table Conversion Logic</strong>              </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Focus changes in <code>render/convert.py</code>: <br>• Preserve original class names, IDs, and attributes. <br>• Maintain exact tag nesting and indentation. <br>• Avoid injecting <code>&lt;style&gt;</code> or <code>font</code> attributes. <br>• Normalize whitespace and remove extra line breaks that affect spacing. <br>• Ensure exported or intermediate data does not alter HTML representation.                                                                                                                                                                                                                                                                                                                                        </td><td data-label="My Task (Minimal)"> Modify <code>convert.py</code> to preserve attributes and structure.                        </td></tr><tr><td data-label="Step / Focus Area"> <strong>5. JS Behavior</strong>                         </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Review <code>assets/script.js</code> and <code>assets/worker.js</code>: <br>• Identify DOM manipulations affecting widths, alignment, or typography. <br>• Neutralize changes that conflict with benchmark. <br>• Implement collapse/expand, copy, and export features without affecting visual style. <br>• Confirm responsive behavior and zoom maintain spacing/alignment. <br>• Ensure scripts do not inject inline styles that override CSS.                                                                                                                                                                                                                                                                                </td><td data-label="My Task (Minimal)"> Audit JS; disable or fix code affecting typography; confirm responsive behavior. </td></tr><tr><td data-label="Step / Focus Area"> <strong>6. Template Rendering</strong>                  </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Adjust <code>templates/index.html</code> for page-level consistency: <br>• Verify <code>&lt;meta charset=&quot;utf-8&quot;&gt;</code> and <code>&lt;!doctype html&gt;</code> are present. <br>• Ensure correct <code>&lt;link&gt;</code> to <code>assets/style.css</code> (and optional supplemental CSS). <br>• Confirm container width, body font inheritance, background color, and padding match benchmark. <br>• Do not introduce new typography rules. <br>• Include placeholders for global toolbar and table navigation if benchmark uses them.                                                                                                                                                                                                                                       </td><td data-label="My Task (Minimal)"> Update template links and container markup; ensure correct inheritance.          </td></tr><tr><td data-label="Step / Focus Area"> <strong>7. Data Flow Consistency</strong>               </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Verify all server and utility pipelines (<code>main.py</code>, <code>server.py</code>, <code>utils.py</code>) feed sanitized HTML consistently: <br>• No added escaping, inline styles, or class removals. <br>• JSON or structured table data preserves all required fields for rendering. <br>• No transformations altering header or cell content affecting typography. <br>• Ensure backend logic does not inject additional wrappers or text nodes.                                                                                                                                                                                                                                                                                    </td><td data-label="My Task (Minimal)"> Audit data path; fix escaping, ensure renderer receives correct HTML.            </td></tr><tr><td data-label="Step / Focus Area"> <strong>8. Pixel Comparison Test</strong>               </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Objective visual verification: <br>• Capture side-by-side high-resolution screenshots of benchmark vs PasteToTable output. <br>• Compare computed CSS metrics: font-family, font-size, line-height, letter-spacing, word-spacing, cell padding, and border widths. <br>• Check alignment of headers, cells, and table body. <br>• Validate rendering in multiple browsers. <br>• Generate automated regression tests that flag any deviations.                                                                                                                                                                                                                                                             </td><td data-label="My Task (Minimal)"> Take screenshots; record metrics; create comparison checklist.                   </td></tr><tr><td data-label="Step / Focus Area"> <strong>9. Accessibility + Responsive Behavior</strong> </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Confirm typography consistency under accessibility and responsive conditions: <br>• Zoom in/out and verify spacing and alignment. <br>• Check table width and font scaling at different viewport sizes. <br>• Test keyboard navigation and screen reader fallback for proper table semantics. <br>• Validate collapse/expand and toolbar actions do not distort typography. <br>• Ensure no font or spacing breaks at small or large screens.                                                                                                                                                                                                                                                              </td><td data-label="My Task (Minimal)"> Test zoom, viewport, and screen reader behavior; note issues.                    </td></tr><tr><td data-label="Step / Focus Area"> <strong>10. Final Verification</strong>                 </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Comprehensive regression suite: <br>• Compare rendered HTML tag order, classes, and attributes against benchmark snippet. <br>• Confirm CSS inheritance matches benchmark (computed styles). <br>• Validate exported HTML, CSV, Markdown, PDF preserve typography. <br>• Document remaining minor deviations. <br>• Confirm no changes in <code>render/</code> files or <code>assets/style.css</code>. <br>• Produce report showing full pixel, style, and DOM equivalence.                                                                                                                                                                                                                                                      </td><td data-label="My Task (Minimal)"> Run regression tests; log deviations; confirm immutable files untouched.         </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table6" data-table="Book_8015_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Difference**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Difference</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Details, impact, and minimal fix**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Details, impact, and minimal fix</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Difference"> <strong>1. <code>_apply_left_col_heading</code> implementation</strong> </td><td data-label="Details, impact, and minimal fix"> <strong>Observed:</strong> Present as a local function in PasteToTable <code>convert.py</code> but not defined in the Table Viewer <code>convert.py</code> you provided. Table Viewer likely uses a shared/util implementation. <br><strong>Impact:</strong> High. It wraps first-column text in <code>&lt;div class=&quot;left-col-heading&quot;&gt;&lt;strong&gt;…&lt;/strong&gt;…&lt;/div&gt;</code> and can change font weight, spacing, vertical rhythm, and line-breaking. This is the most likely cause of typography drift. <br><strong>Minimal fix:</strong> Replace the local implementation with a safe import-from-utils + conservative fallback identity. i.e.: </td></tr></tbody></table></div><div class="row-count">Rows: 1</div></div><div class="table-caption" id="Table7" data-table="Book_8015_07" style="margin-top:2mm;margin-left:3mm;"><strong>Table 7</strong></div>
<div class="table-wrapper" data-table-id="table-7"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Item**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Item</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Item"> 1. Utils wrapper fallback </td><td data-label="Notes"> This preserves Table Viewer behavior when utils provides it and avoids adding inconsistent wrapping when not required. </td></tr><tr><td data-label="Item"> 2. Bullet / Unicode regex sets </td><td data-label="Notes"> Observed: Slightly different bullet character classes between files (_BULLET_LEADING_RE, _BULLET_PAT). <br>Impact: Low (visual lists only). Not directly typography for table cells, but can change inline list rendering inside cells. <br>Minimal fix: Copy the Table Viewer regex lines verbatim into PasteToTable convert.py to ensure identical parsing of bullets. </td></tr><tr><td data-label="Item"> 3. CSV sniffing / parse behavior </td><td data-label="Notes"> Observed: Both files implement CSV parsing; differences are minor (sniffer usage and sanitization). <br>Impact: Low. Only affects content parsing not CSS. <br>Minimal fix: No urgent change. Keep as-is or unify to Table Viewer version if you want strict parity. </td></tr><tr><td data-label="Item"> 4. Markdown table parser </td><td data-label="Notes"> Observed: Both implement robust pipe-table parsing; implementations are equivalent. <br>Impact: Low. Parsing differences could change header cell content (thus CSS selectors) only in edge cases. <br>Minimal fix: Keep current PasteToTable parser. No change required unless specific failing cases found. </td></tr><tr><td data-label="Item"> 5. HTML wrapper / heading and heading-bar markup </td><td data-label="Notes"> Observed: Both render_table implementations emit identical heading bar, h3 id table-{idx}, table-wrapper, and tv-table markup. <br>Impact: Low. These are consistent. <br>Minimal fix: None. Ensure assets/style.css contains matching selectors (it is locked and claimed identical). </td></tr><tr><td data-label="Item"> 6. Inline styles in header wrapper </td><td data-label="Notes"> Observed: Both include style="display:flex;... margin-bottom:5px;" on .table-header-wrapper. <br>Impact: Medium. Inline spacing here can affect vertical rhythm. Table Viewer also used similar inline style per provided file. <br>Minimal fix: Leave unchanged for parity. If final pixel test fails, move to CSS-only (but style.css is locked so only add a supplemental UI CSS if necessary). </td></tr><tr><td data-label="Item"> 7. sanitize_bold_html / markdown fallback </td><td data-label="Notes"> Observed: Both use same fallback imports and conservative markdown fallback. <br>Impact: Low. Affects which tags are preserved. <br>Minimal fix: No change. Ensure utils implementation (if used) matches Table Viewer. </td></tr><tr><td data-label="Item"> 8. Character normalisation / zero-width removals </td><td data-label="Notes"> Observed: Slight syntax variation (re.sub patterns), functionally equivalent. <br>Impact: Negligible. <br>Minimal fix: None. </td></tr><tr><td data-label="Item"> 9. Presence of extra helper functions (convert_structure, convert_text_to_html) </td><td data-label="Notes"> Observed: PasteToTable has these higher-level helpers. Table Viewer also had equivalents. <br>Impact: None on typography. <br>Minimal fix: None. </td></tr><tr><td data-label="Item"> 10. Overall DOM output parity </td><td data-label="Notes"> Observed: Except for _apply_left_col_heading and minor regex character sets, the rendered HTML fragments are effectively identical (same classes, ids, and structure). <br>Impact: The left-col wrapping is the single highest-leverage difference. Fixing that is likely to resolve typography mismatch. <br>Minimal fix: Implement the import fallback for _apply_left_col_heading and unify bullet regex. </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table8" data-table="Book_8015_08" style="margin-top:2mm;margin-left:3mm;"><strong>Table 8</strong></div>
<div class="table-wrapper" data-table-id="table-8"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Focus**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Focus</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Status / Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Status / Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Next Steps**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Next Steps</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Focus"> <code>render/convert.py</code>  </td><td data-label="Status / Notes"> Fully revised, verified, compatible with Table Viewer 2.1 typography. Does <strong>not directly import <code>core.py</code></strong>; uses <code>core_assets</code> and <code>core_table</code> safely. </td><td data-label="Next Steps"> Keep unchanged; confirm behavior in <code>main.py</code> execution.                                            </td></tr><tr><td data-label="Focus"> <code>render/core.py</code>     </td><td data-label="Status / Notes"> Present, contains fallbacks and delegation wrappers for <code>convert.py</code>, <code>core_table</code>, <code>core_assets</code>, <code>markdown</code>, <code>sanitize</code>.                                </td><td data-label="Next Steps"> Audit all modifiable files for references; confirm safe deletion or replacement.                    </td></tr><tr><td data-label="Focus"> Dependencies         </td><td data-label="Status / Notes"> <code>convert.py</code> depends on <code>core_assets</code> and <code>core_table</code>; no other file in session confirmed to call <code>core.py</code> explicitly yet.                              </td><td data-label="Next Steps"> Scan <code>main.py</code>, <code>server.py</code>, <code>html_renderer.py</code>, <code>utils.py</code>, <code>templates/index.html</code>, <code>assets/*.js</code>. </td></tr><tr><td data-label="Focus"> Immutable files      </td><td data-label="Status / Notes"> <code>render/convert.py</code> and <code>assets/style.css</code> locked; must remain untouched.                                                                                 </td><td data-label="Next Steps"> Proceed to auditing modifiable files for <code>core.py</code> references.                                      </td></tr><tr><td data-label="Focus"> Audit goal           </td><td data-label="Status / Notes"> Determine whether <code>core.py</code> can be safely removed without breaking <code>convert.py</code> or other pipelines.                                                       </td><td data-label="Next Steps"> Collect dependency map, log all calls/imports, produce final safe recommendation.                   </td></tr><tr><td data-label="Focus"> Execution validation </td><td data-label="Status / Notes"> Current plan does not require running <code>main.py</code> yet but is advisable to confirm runtime behavior after file audits.                                       </td><td data-label="Next Steps"> After audit, optionally run <code>main.py</code> to confirm <code>convert.py</code> works independently of <code>core.py</code>.     </td></tr></tbody></table></div><div class="row-count">Rows: 6</div></div><div class="table-caption" id="Table9" data-table="Book_8015_09" style="margin-top:2mm;margin-left:3mm;"><strong>Table 9</strong></div>
<div class="table-wrapper" data-table-id="table-9"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Item**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Item</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Notes / Comparison / Next steps**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Notes / Comparison / Next steps</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Item"> <strong>File compared</strong>                     </td><td data-label="Notes / Comparison / Next steps"> PasteToTable <code>main.py</code> (server entry) vs Table Viewer <code>main.py</code> (batch CLI renderer).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Item"> <strong>Overall role</strong>                      </td><td data-label="Notes / Comparison / Next steps"> Table Viewer <code>main.py</code> is a standalone batch processor that discovers <code>.md</code> files, robustly parses tables, sanitizes, and writes HTML (prefers <code>render_html</code> when available). PasteToTable <code>main.py</code> is a lightweight web app launcher that loads config, ensures storage, and starts a Flask/ASGI app via <code>create_app(cfg)</code>.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Item"> <strong>Renderer loading</strong>                  </td><td data-label="Notes / Comparison / Next steps"> Table Viewer uses a defensive dynamic loader (<code>importlib.util.spec_from_file_location</code>) to prefer a local <code>html_renderer.py</code> and falls back to module import, with clear warnings. PasteToTable relies on <code>html_renderer.create_app</code> being importable at startup. <strong>Consider</strong> adopting Table Viewer's dynamic loader pattern inside <code>html_renderer</code> to support both embedded and installed renderers.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Item"> <strong>Config & paths</strong>                    </td><td data-label="Notes / Comparison / Next steps"> Table Viewer uses hard-coded absolute folders (<code>md_folder</code>, <code>output_folder</code>) — convenient for local batch runs but not portable. PasteToTable reads <code>cfg = load_env()</code> and uses <code>STORAGE_PATH</code>/<code>PORT</code>. <strong>Recommendation:</strong> parameterize Table Viewer paths (env / CLI args) before merging.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Item"> <strong>Parsing robustness</strong>                </td><td data-label="Notes / Comparison / Next steps"> Table Viewer bundles <code>_safe_read_csv</code>, <code>parse_markdown_tables</code>, conservative <code>markdown_to_html</code>, inline-code preservation, and Dropbox-path sanitization. PasteToTable <code>main.py</code> lacks parsing logic (delegates to renderer). If PasteToTable must import Table Viewer's parsing, place these functions into <code>render/</code> (allowed files) or <code>html_renderer.py</code> and add unit tests.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Item"> <strong>Sanitization</strong>                      </td><td data-label="Notes / Comparison / Next steps"> Table Viewer intentionally removes/shortens Dropbox paths with regex-based sanitizer. PasteToTable should adopt the same sanitizer to avoid leaking local paths when saving or rendering user tables.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Item"> <strong>HTML output & fallback</strong>            </td><td data-label="Notes / Comparison / Next steps"> Table Viewer prefers <code>render_html(all_tables, output_html, markdown_to_html)</code> and falls back to a minimal safe HTML writer that preserves inline code and avoids injecting <code>&lt;br&gt;</code>. PasteToTable's renderer must also guarantee no <code>&lt;br&gt;</code> injections inside table cells to match Table Viewer 2.1 typography.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Item"> <strong>Error handling & resilience</strong>       </td><td data-label="Notes / Comparison / Next steps"> Table Viewer is defensive (many try/except blocks, fallbacks, graceful messages). PasteToTable <code>main.py</code> is simpler and should inherit similar defensive patterns around renderer failures, file I/O, and parsing exceptions.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Item"> <strong>Portability & safety</strong>              </td><td data-label="Notes / Comparison / Next steps"> Table Viewer uses OS-specific paths and prints; contains Windows multiprocessing freeze guard. PasteToTable should keep environment-driven configuration and add an equivalent multiprocessing guard only where needed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Item"> <strong>Potential risks</strong>                   </td><td data-label="Notes / Comparison / Next steps"> Table Viewer: absolute paths reduce portability; verbose prints rather than structured logging; reading many files in-memory may be heavy. PasteToTable: running Flask <code>app.run()</code> in production is not recommended — use proper WSGI server.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Item"> <strong>Concrete recommendations</strong>          </td><td data-label="Notes / Comparison / Next steps"> 1) Parameterize Table Viewer paths via env/CLI and avoid hard-coded Dropbox roots.<br>2) Move <code>parse_markdown_tables</code>, <code>_safe_read_csv</code>, <code>markdown_to_html</code>, and <code>_sanitize_dropbox_paths_df</code> into <code>render/core_utils.py</code> or <code>html_renderer.py</code> (respect locked files rules).<br>3) Adopt Table Viewer's dynamic renderer loader pattern inside PasteToTable's renderer fallback path.<br>4) Add structured logging (use <code>make_logger</code>) instead of plain <code>print()</code> in Table Viewer code when integrated.<br>5) Add unit tests for parsing, sanitization, and rendering to ensure no <code>&lt;br&gt;</code> injection.                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Item"> <strong>Verification checklist (10 items)</strong> </td><td data-label="Notes / Comparison / Next steps"> 1. Confirm <code>html_renderer.create_app(cfg)</code> still returns app after merging parser. <br>2. Run <code>parse_markdown_tables()</code> on representative Book_8015 and Book_9001 tables — expect same table counts as Table Viewer. <br>3. Ensure no <code>&lt;br&gt;</code> inserted into any table cell after render (search output HTML for <code>&lt;td&gt;</code> containing <code>&lt;br&gt;</code>). <br>4. Validate inline backtick code is preserved as <code>&lt;code&gt;</code> in HTML. <br>5. Confirm <code>_sanitize_dropbox_paths_df</code> replaces local Dropbox paths with basenames or <code>&lt;redacted&gt;</code>. <br>6. Test fallback writer when <code>render_html</code> is missing — output valid UTF-8 HTML files. <br>7. Pass malformed CSV/markdown through <code>_safe_read_csv</code> to ensure graceful skipping of bad lines. <br>8. Verify environment-driven paths override hard-coded ones (STORAGE_PATH / MD_FOLDER / OUTPUT_FOLDER). <br>9. Run a quick integration that loads 50+ markdown files to check memory/IO behavior. <br>10. Confirm multiprocessing freeze guard present for Windows if using parallel workers. </td></tr><tr><td data-label="Item"> <strong>Suggested immediate next action</strong>   </td><td data-label="Notes / Comparison / Next steps"> I can prepare a <strong>safe patch</strong> that: (A) extracts Table Viewer's parsing & sanitizer into <code>render/core_utils.py</code> (or <code>html_renderer.py</code> if you prefer), (B) replaces hard-coded paths with config-driven values, and (C) adds 10 unit tests above. Approve and I'll produce the single-file patch(s) and tests.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Item"> <strong>Acknowledgement</strong>                   </td><td data-label="Notes / Comparison / Next steps"> Benchmark table (for typography/visual parity) acknowledged: [https://adiskurniawan.github.io/ChapterSummaries_2.0/summaries/Book_9001.html#Table4](https://adiskurniawan.github.io/ChapterSummaries_2.0/summaries/Book_9001.html#Table4) — I'll preserve that style in any changes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         </td></tr></tbody></table></div><div class="row-count">Rows: 14</div></div><div class="table-caption" id="Table10" data-table="Book_8015_10" style="margin-top:2mm;margin-left:3mm;"><strong>Table 10</strong></div>
<div class="table-wrapper" data-table-id="table-10"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Target (Table Viewer 2.1)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Target (Table Viewer 2.1)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Current (PasteToTable) &amp; Proposed fix (why)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Current (PasteToTable) & Proposed fix (why)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Target (Table Viewer 2.1)"> <strong>Font loading</strong>: Explicit link(s) or <code>@import</code> that Table Viewer uses (Inter / system fallback). Loaded <strong>before</strong> <code>assets/style.css</code> so CSS uses correct font metrics.     </td><td data-label="Current (PasteToTable) &amp; Proposed fix (why)"> <strong>Check</strong> if PasteToTable loads same font links in <code>&lt;head&gt;</code> and in same order. <strong>If missing or later</strong>, add the same <code>&lt;link rel=&quot;stylesheet&quot; href=&quot;...&quot;&gt;</code> before <code>assets/style.css</code>. (Fixes line-height / bold weight differences.)         </td></tr><tr><td data-label="Target (Table Viewer 2.1)"> <strong>CSS order</strong>: <code>reset</code> → <code>fonts</code> → <code>core style</code> → <code>page overrides</code>. TV2.1 may include small override block in page <code>&lt;style&gt;</code> for table-area.                                 </td><td data-label="Current (PasteToTable) &amp; Proposed fix (why)"> Ensure <code>assets/style.css</code> is loaded at the same point and any small inline scoping CSS (only if needed) is inserted exactly like TV2.1. Avoid adding global overrides that change other UI.                                                 </td></tr><tr><td data-label="Target (Table Viewer 2.1)"> <strong>Table wrapper structure</strong>: TV2.1 wraps each fragment using <code>.table-container</code> and places <code>h3</code>/title markup and optionally <code>.table-body</code> consistently.                      </td><td data-label="Current (PasteToTable) &amp; Proposed fix (why)"> Verify PasteToTable <code>html_renderer.py</code> emits identical wrapper tags, ids, and <code>class</code> values. If missing, we change <code>html_renderer.py</code> or page post-processing to insert the expected wrapper. (This ensures existing CSS selectors apply.) </td></tr><tr><td data-label="Target (Table Viewer 2.1)"> <strong>Per-table toolbar placement</strong>: TV2.1 places toolbar markup (if any) at same DOM location relative to <code>.table-container</code> (above/below).                                     </td><td data-label="Current (PasteToTable) &amp; Proposed fix (why)"> If PasteToTable toolbar is inserted inside the table or at a different place, move it to match TV2.1 markup. JS then finds the controls reliably.                                                                                           </td></tr><tr><td data-label="Target (Table Viewer 2.1)"> <strong>Global toolbar & resultCount</strong>: TV2.1 has toolbar placement and <code>resultCount</code> location. Duplicate <code>resultCount</code> occurrences can affect screen readers/styles.              </td><td data-label="Current (PasteToTable) &amp; Proposed fix (why)"> Ensure the <code>#resultCount</code> placement and aria attributes match TV2.1. Avoid duplicate visible counters unless TV2.1 does so intentionally.                                                                                                   </td></tr><tr><td data-label="Target (Table Viewer 2.1)"> <strong>Script order</strong>: TV2.1 loads <code>script.js</code> and then enhancement scripts (e.g., table UI script) in same sequence, typically <code>defer</code> to preserve DOM timing.                   </td><td data-label="Current (PasteToTable) &amp; Proposed fix (why)"> Confirm PasteToTable script ordering matches TV2.1 (important for prettyPrint/normalizeTables and table UI attaching). If not, reorder script includes (keep <code>defer</code>).                                                                      </td></tr><tr><td data-label="Target (Table Viewer 2.1)"> <strong>Pretty-printing / whitespace</strong>: TV2.1 may pretty-print inserted table HTML to produce line breaks inside <code>&lt;table&gt;</code> for better bold/line-height rendering in some browsers. </td><td data-label="Current (PasteToTable) &amp; Proposed fix (why)"> Ensure <code>prettyPrintTablesIfCompact</code> or equivalent runs exactly the same way in PasteToTable (same heuristics). If it was disabled or differs, align logic in inline script or <code>assets/script.js</code>.                                           </td></tr><tr><td data-label="Target (Table Viewer 2.1)"> <strong>Sanitizer behavior / attributes</strong>: Table Viewer preserves <code>class</code> attributes on <code>&lt;table&gt;</code> and <code>&lt;th&gt;</code> that drive styling (e.g., <code>class=&quot;ptt-table data-table&quot;</code>).            </td><td data-label="Current (PasteToTable) &amp; Proposed fix (why)"> If PasteToTable conversion/sanitizer strips classes/ids, update <code>render/convert.py</code> to preserve them (only it will be edited per your permission). This is critical so CSS selectors apply.                                                 </td></tr><tr><td data-label="Target (Table Viewer 2.1)"> <strong>Heading tags/IDs</strong>: TV2.1 ensures H1/H3 have specific classes/IDs that CSS targets.                                                                                        </td><td data-label="Current (PasteToTable) &amp; Proposed fix (why)"> Make sure <code>html_renderer.py</code> or renderers produce identical H1/H3 markup and IDs (e.g., <code>id=&quot;Table1&quot;</code>). If not, change <code>html_renderer.py</code> to add <code>id</code>/class attributes.                                                                     </td></tr><tr><td data-label="Target (Table Viewer 2.1)"> <strong>Responsive rules</strong>: TV2.1 uses certain meta viewport and media queries to adjust font-size/padding for small screens.                                                      </td><td data-label="Current (PasteToTable) &amp; Proposed fix (why)"> Confirm paste page includes same viewport meta and no extra inline styles override responsive table styles.                                                                                                                                 </td></tr><tr><td data-label="Target (Table Viewer 2.1)"> <strong>Whitespace-sensitive markup</strong>: TV2.1 may enforce <code>white-space: pre-wrap;</code> on <code>&lt;td&gt;</code> or <code>word-break</code> behavior.                                                              </td><td data-label="Current (PasteToTable) &amp; Proposed fix (why)"> Verify <code>assets/style.css</code> selectors apply to the same class names in PasteToTable DOM. If classes differ, restore them.                                                                                                                     </td></tr><tr><td data-label="Target (Table Viewer 2.1)"> <strong>Accessibility attributes</strong>: aria-live / roles / labels used by TV2.1 for table container updates.                                                                          </td><td data-label="Current (PasteToTable) &amp; Proposed fix (why)"> Keep exactly the same attributes (e.g., <code>aria-live=&quot;polite&quot;</code>) to avoid differences in screen-reader announcements and potential CSS hooks.                                                                                                  </td></tr><tr><td data-label="Target (Table Viewer 2.1)"> <strong>No inline style overrides</strong>: TV2.1 avoids inline <code>style</code> attributes on table cells that alter typography; they rely on CSS instead.                                        </td><td data-label="Current (PasteToTable) &amp; Proposed fix (why)"> Ensure PasteToTable scripts do not inject inline <code>style</code> values (widths, font-size) that override stylesheet; if they do, neutralize them or make them conditional.                                                                         </td></tr><tr><td data-label="Target (Table Viewer 2.1)"> <strong>Toolbar icons / buttons</strong>: Button text vs icons may change vertical rhythm. TV2.1 uses small buttons with padding defined in CSS.                                          </td><td data-label="Current (PasteToTable) &amp; Proposed fix (why)"> Ensure button markup and classes match TV2.1 so padding/font sizing stays identical.                                                                                                                                                        </td></tr><tr><td data-label="Target (Table Viewer 2.1)"> <strong>Script-based formatting (bold/markdown)</strong>: TV2.1’s renderer leaves <code>&lt;strong&gt;</code>/<code>&lt;b&gt;</code> vs <code>&lt;em&gt;</code> consistent.                                                                  </td><td data-label="Current (PasteToTable) &amp; Proposed fix (why)"> Confirm that <code>convert.py</code> emits <code>&lt;strong&gt;</code> for bold and not plain <code>&lt;b&gt;</code>, and that inline tags are not stripped. If mismatch, we’ll update <code>convert.py</code>.                                                                                     </td></tr><tr><td data-label="Target (Table Viewer 2.1)"> <strong>Final visual check</strong>: compute <code>getComputedStyle()</code> for a sample TD/TH in both renditions (font-family, font-size, font-weight, line-height, padding, color).               </td><td data-label="Current (PasteToTable) &amp; Proposed fix (why)"> We'll provide test snippets (JS console) to run locally for pixel-perfect comparison and generate a prioritized list of remaining differences.                                                                                              </td></tr></tbody></table></div><div class="row-count">Rows: 16</div></div><div class="table-caption" id="Table11" data-table="Book_8015_11" style="margin-top:2mm;margin-left:3mm;"><strong>Table 11</strong></div>
<div class="table-wrapper" data-table-id="table-11"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Area"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Area</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Table Viewer (ref)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Table Viewer (ref)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by PasteToTable (current)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">PasteToTable (current)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Impact / Recommendation"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Impact / Recommendation</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Area"> Parser robustness    </td><td data-label="Table Viewer (ref)">                                                                                         <code>parse_markdown_tables</code> same robust <code>_split_row_keep_code</code> / divider heuristic </td><td data-label="PasteToTable (current)"> Very similar; minor reformatting differences                                                                          </td><td data-label="Impact / Recommendation"> <strong>No change needed</strong> — keep TV2.1 implementation (it’s slightly more compact)                                                                            </td></tr><tr><td data-label="Area"> CSV handling         </td><td data-label="Table Viewer (ref)">                                                                     <code>parse_csv_tables</code> uses <code>csv.Sniffer</code>, pads rows, returns <code>rows, header</code> style as dict — identical </td><td data-label="PasteToTable (current)"> Same semantics                                                                                                        </td><td data-label="Impact / Recommendation"> <strong>Keep TV2.1 implementation</strong> (already present in PasteToTable)                                                                                          </td></tr><tr><td data-label="Area"> <code>render_table</code> shape </td><td data-label="Table Viewer (ref)"> Table Viewer uses <code>.table-wrapper</code>, <code>.table-heading-bar</code>, <code>tv-table</code> classes and <strong>removes inline width</strong>, controlling widths via CSS classes (<code>tv-col-left</code>/<code>tv-col</code>) </td><td data-label="PasteToTable (current)"> PasteToTable already lifted most changes; both produce similar DOM but tiny differences in comments and small helpers </td><td data-label="Impact / Recommendation"> <strong>Use TV2.1 <code>render_table</code> as base</strong>, keep PasteToTable additions (tools, toggles, row-count) — ensure DOM class names match <code>assets/style.css</code> exactly. </td></tr><tr><td data-label="Area"> <code>markdown renderer</code>  </td><td data-label="Table Viewer (ref)">                                                                      TV2.1 chooses <code>markdown.get_markdown_renderer()</code> if available; fallback <code>_simple_md</code> is identical </td><td data-label="PasteToTable (current)"> Same behavior in PasteToTable                                                                                         </td><td data-label="Impact / Recommendation"> <strong>Keep as-is</strong> (consistent)                                                                                                                              </td></tr><tr><td data-label="Area"> <code>utils</code> dependencies </td><td data-label="Table Viewer (ref)">                                                                                                  Table Viewer falls back if <code>..utils</code> missing but expects helper names </td><td data-label="PasteToTable (current)"> PasteToTable already includes conservative fallbacks; also provides <code>_apply_left_col_heading</code> fallback                </td><td data-label="Impact / Recommendation"> <strong>Keep PasteToTable fallbacks</strong> (safer for environments without utils). Merge so both match.                                                             </td></tr><tr><td data-label="Area"> Extra API            </td><td data-label="Table Viewer (ref)">                                                                             Table Viewer exports parse/render/extract; <strong>no convert_structure / convert_text_to_html</strong> </td><td data-label="PasteToTable (current)"> PasteToTable includes <code>convert_structure</code> and <code>convert_text_to_html</code> wrappers used by server UI                       </td><td data-label="Impact / Recommendation"> <strong>Preserve PasteToTable extras</strong> — they are needed by the app and harmless.                                                                              </td></tr><tr><td data-label="Area"> Minor differences    </td><td data-label="Table Viewer (ref)">                                                                                      regex quoting, docstrings, code layout, variable names, small comment differences </td><td data-label="PasteToTable (current)"> No behavioural differences                                                                                            </td><td data-label="Impact / Recommendation"> <strong>Prefer TV2.1 formatting where clearer; keep semantics</strong>                                                                                                </td></tr></tbody></table></div><div class="row-count">Rows: 7</div></div><div class="table-caption" id="Table12" data-table="Book_8015_12" style="margin-top:2mm;margin-left:3mm;"><strong>Table 12</strong></div>
<div class="table-wrapper" data-table-id="table-12"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Area"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Area</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Expected in  CODE0 "><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Expected in  CODE0 </div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Expected from  CODE1 "><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Expected from  CODE1 </div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Impact / Recommendation"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Impact / Recommendation</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Area"> Table container selector    </td><td data-label="Expected in  CODE0 ">               A stable wrapper element with explicit id/class, e.g. <code>&lt;div id=&quot;table-area&quot; class=&quot;table-wrapper&quot;&gt;</code> </td><td data-label="Expected from  CODE1 "> Convert returns HTML that places the table inside the same wrapper markup or returns a top-level <code>.table-wrapper</code> element. </td><td data-label="Impact / Recommendation"> <strong>Must match exactly.</strong> If names differ the page CSS/JS will not style or find the table. Ensure id/class names are identical. </td></tr><tr><td data-label="Area"> Wrapper classes & structure </td><td data-label="Expected in  CODE0 ">                Uses TV2.1 classes: <code>.table-wrapper</code>, <code>.table-heading-bar</code>, <code>.tv-table</code>, <code>.tv-col-left</code>, <code>.tv-col</code> </td><td data-label="Expected from  CODE1 ">                 Convert should produce those classes or produce minimal markup that the template wraps with these classes. </td><td data-label="Impact / Recommendation"> Align class names to <code>assets/style.css</code>. Prefer convert to output classes, not inline styles.                                  </td></tr><tr><td data-label="Area"> Column width handling       </td><td data-label="Expected in  CODE0 ">                           No inline width attributes in HTML. CSS classes control width (<code>tv-col-left</code>, <code>tv-col</code>) </td><td data-label="Expected from  CODE1 ">                     Convert must <strong>not</strong> emit <code>style=&quot;width:...&quot;</code> on cells or columns. If it does, CSS will be overridden. </td><td data-label="Impact / Recommendation"> Strip inline widths in <code>convert.py</code> or ensure convert emits only semantic classes.                                             </td></tr><tr><td data-label="Area"> Heading bar / title         </td><td data-label="Expected in  CODE0 ">          Template includes a heading bar area for controls (<code>.table-heading-bar</code>) or placeholder for server title </td><td data-label="Expected from  CODE1 ">                    Convert should not clobber/duplicate heading bar. If convert outputs its own heading, names must match. </td><td data-label="Impact / Recommendation"> Use single source: prefer template heading and keep convert focused on table markup.                                           </td></tr><tr><td data-label="Area"> Data attributes / hooks     </td><td data-label="Expected in  CODE0 ">                                 Template may expect <code>data-*</code> attributes or <code>id</code>s for JS (export, copy, row-count) </td><td data-label="Expected from  CODE1 ">                                    Convert should preserve <code>data-*</code> and <code>id</code> values on table elements if present in input. </td><td data-label="Impact / Recommendation"> Ensure sanitizer in <code>convert.py</code> preserves data attributes. Add allowlist if needed.                                           </td></tr><tr><td data-label="Area"> Sanitizer behavior          </td><td data-label="Expected in  CODE0 ">                                                Template expects classes and some attributes to survive conversion </td><td data-label="Expected from  CODE1 ">                                       <code>render/sanitize.py</code> or convert must not strip classes/attributes required by CSS/JS </td><td data-label="Impact / Recommendation"> Update sanitize to preserve <code>class</code>, <code>id</code>, <code>data-*</code>, <code>role</code>, <code>aria-*</code>.                                                         </td></tr><tr><td data-label="Area"> Script load order           </td><td data-label="Expected in  CODE0 ">                                                <code>style.css</code> then TV2.1-like helper scripts then <code>assets/script.js</code> </td><td data-label="Expected from  CODE1 ">                                                               <code>assets/script.js</code> expects DOM structure produced by convert </td><td data-label="Impact / Recommendation"> Ensure <code>index.html</code> loads CSS first, then vendor scripts, then <code>assets/script.js</code> at end of body.                              </td></tr><tr><td data-label="Area"> Table injection point       </td><td data-label="Expected in  CODE0 "> Template should include a known placeholder (e.g., <code>&lt;!-- TABLE-PLACEHOLDER --&gt;</code> or <code>&lt;div id=&quot;table-area&quot;&gt;&lt;/div&gt;</code>) </td><td data-label="Expected from  CODE1 ">                      Convert returns HTML string. Server inserts it at the placeholder or the frontend replaces innerHTML. </td><td data-label="Impact / Recommendation"> Standardize on one injection method. Prefer server-side insertion into the placeholder before sending.                         </td></tr><tr><td data-label="Area"> Export / xlsx hooks         </td><td data-label="Expected in  CODE0 ">                             Template might include script tags or global variables for export libraries (SheetJS) </td><td data-label="Expected from  CODE1 ">                Convert should not embed large libraries inline. It should only add export buttons with expected selectors. </td><td data-label="Impact / Recommendation"> Keep external libs in <code>index.html</code> and only emit buttons in convert output with known selectors.                               </td></tr><tr><td data-label="Area"> Accessibility classes       </td><td data-label="Expected in  CODE0 ">                                                     TV2.1 uses stable classes (e.g., for headings in left column) </td><td data-label="Expected from  CODE1 ">                                    Convert should mark left-column headings consistently (e.g., <code>th</code> with <code>.left-heading</code>) </td><td data-label="Impact / Recommendation"> Preserve semantic elements (<code>th</code>, <code>thead</code>, <code>tbody</code>) so CSS selectors work.                                                     </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table13" data-table="Book_8015_13" style="margin-top:2mm;margin-left:3mm;"><strong>Table 13</strong></div>
<div class="table-wrapper" data-table-id="table-13"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Area"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Area</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Current requirement / expectation"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Current requirement / expectation</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Planned change / effect"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Planned change / effect</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Area"> Table injection point     </td><td data-label="Current requirement / expectation"> Must provide a single, stable placeholder for server-side or client-side insertion. Example: <code>&lt;div id=&quot;table-area&quot; class=&quot;table-wrapper&quot;&gt;&lt;/div&gt;</code> </td><td data-label="Planned change / effect"> Ensure <code>#table-area</code> exists. Use class <code>table-wrapper</code> so CSS selectors from TV2.1 apply immediately. No other wrappers.                                                                                                            </td></tr><tr><td data-label="Area"> Wrapper & classes         </td><td data-label="Current requirement / expectation">                                                            Table Viewer 2.1 expects <code>.table-wrapper &gt; .table-heading-bar</code> and <code>.tv-table</code> inside </td><td data-label="Planned change / effect"> Ensure template contains <code>.table-heading-bar</code> placeholder (empty or server-filled) and an inner container where <code>convert.py</code> can put the <code>&lt;table class=&quot;tv-table&quot;&gt;</code>.                                                                </td></tr><tr><td data-label="Area"> Script/CSS order          </td><td data-label="Current requirement / expectation">                     CSS must load before any DOM-manipulating script. <code>assets/script.js</code> must load after table HTML and after helper/vendor libs </td><td data-label="Planned change / effect"> Ensure <code>&lt;link rel=&quot;stylesheet&quot; href=&quot;/assets/style.css&quot;&gt;</code> is in <code>&lt;head&gt;</code> and <code>&lt;script src=&quot;/assets/script.js&quot;&gt;</code> is at end of <code>&lt;body&gt;</code> after <code>#table-area</code>. Do not modify <code>assets/script.js</code>.                                        </td></tr><tr><td data-label="Area"> Avoid double-wrapping     </td><td data-label="Current requirement / expectation">                                                             If template already wraps output, convert.py should not add another <code>.table-wrapper</code> </td><td data-label="Planned change / effect"> Standardize: template supplies outer <code>.table-wrapper</code>. Convert should output only the <code>&lt;table&gt;</code> and inner fragments. If convert outputs wrapper, server should strip or template should accept it. For now prefer template wrapper. </td></tr><tr><td data-label="Area"> Data / hook attributes    </td><td data-label="Current requirement / expectation">                                                                            JS relies on selectors and <code>data-*</code> attributes on elements it queries </td><td data-label="Planned change / effect"> Preserve existing <code>id</code>, <code>class</code>, and <code>data-*</code> placeholders in template. Do not alter buttons (per your warning).                                                                                                                    </td></tr><tr><td data-label="Area"> Accessibility / semantics </td><td data-label="Current requirement / expectation">                                                                           Use semantic area landmarks so CSS selectors and screen readers behave </td><td data-label="Planned change / effect"> Use <code>&lt;main&gt;</code>, <code>&lt;section id=&quot;table-area&quot; class=&quot;table-wrapper&quot; role=&quot;region&quot; aria-label=&quot;Table area&quot;&gt;</code>                                                                                                                               </td></tr></tbody></table></div><div class="row-count">Rows: 6</div></div><div class="table-caption" id="Table14" data-table="Book_8015_14" style="margin-top:2mm;margin-left:3mm;"><strong>Table 14</strong></div>
<div class="table-wrapper" data-table-id="table-14"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Area"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Area</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Impact"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Impact</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Recommendation"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Recommendation</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Area"> <strong>File paths (HTML references)</strong>    </td><td data-label="Impact"> PasteToTable likely uses relative paths like <code>assets/script.js</code>, assuming assets are beside <code>templates/index.html</code>. Table Viewer’s combined folder may differ (<code>../assets/...</code> or absolute).              </td><td data-label="Recommendation"> Verify <code>&lt;link&gt;</code> and <code>&lt;script&gt;</code> paths inside <code>templates/index.html</code>. They must point correctly <strong>relative to where <code>main.py</code> serves HTML</strong> (PasteToTable expects <code>/assets/...</code>).                       </td></tr><tr><td data-label="Area"> <strong>Static file serving (server.py)</strong> </td><td data-label="Impact"> If both projects read from different asset directories, Flask (or your HTTP server) may serve outdated versions.                                                                                          </td><td data-label="Recommendation"> Ensure <code>server.py</code> static route points to <code>assets</code>. You can symlink or mirror-copy assets into output folders after testing.                                         </td></tr><tr><td data-label="Area"> <strong>CSS load order</strong>                  </td><td data-label="Impact"> Mixing asset folders can reorder <code>style.css</code> and JS includes. That affects typography alignment with Table Viewer 2.1.                                                                                    </td><td data-label="Recommendation"> Check the final <code>&lt;head&gt;</code> order in generated HTML. It must match Table Viewer’s index.html exactly.                                                                                                    </td></tr><tr><td data-label="Area"> <strong>Shared <code>render/convert.py</code></strong>      </td><td data-label="Impact"> Conversion logic defines class names, wrappers, and HTML structure. If Table Viewer and PasteToTable share this file, minor behavioral divergence (like missing <code>.table-wrapper</code>) will propagate to both. </td><td data-label="Recommendation"> Confirm <code>render/convert.py</code> in PasteToTable has the same DOM tags/classes as Table Viewer’s. If not, adjust PasteToTable’s version to include <code>tv-table</code>, <code>.table-wrapper</code>, and <code>.table-heading-bar</code>. </td></tr><tr><td data-label="Area"> <strong>Output folder (output_combined)</strong> </td><td data-label="Impact"> If PasteToTable writes HTML or exports there, relative paths may break (<code>../assets/...</code> vs <code>/assets/...</code>).                                                                                                </td><td data-label="Recommendation"> Ensure all export routines in <code>html_renderer.py</code> and <code>utils.safe_join()</code> resolve paths consistently. Use absolute references or mirror-copy assets during export.                                     </td></tr><tr><td data-label="Area"> <strong>JS behavior</strong>                     </td><td data-label="Impact"> <code>assets/script.js</code> controls post-render adjustments (width, buttons). Shared use can trigger unwanted DOM manipulation if HTML structure differs.                                                         </td><td data-label="Recommendation"> Since you confirmed <code>script.js</code> works correctly, do <strong>not</strong> modify it. Just ensure HTML class names and structure match its expectations.                                                             </td></tr></tbody></table></div><div class="row-count">Rows: 6</div></div><div class="table-caption" id="Table15" data-table="Book_8015_15" style="margin-top:2mm;margin-left:3mm;"><strong>Table 15</strong></div>
<div class="table-wrapper" data-table-id="table-15"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Logic / Structure"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual notes (design + high-leverage effects)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual notes (design + high-leverage effects)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> Two target containers in template: "page area" and "table area" </td><td data-label="Conceptual notes (design + high-leverage effects)"> <code>convert.py</code> may emit either a full page HTML or a fragment/table HTML. Template must expose both stable, semantically named containers (example ids: <code>#page-area</code>, <code>#table-area</code>). JS chooses which to fill based on response type.                                </td></tr><tr><td data-label="Logic / Structure"> Clear, deterministic selectors and attributes                   </td><td data-label="Conceptual notes (design + high-leverage effects)"> Use simple IDs (<code>id=&quot;page-area&quot;</code>, <code>id=&quot;table-area&quot;</code>) and data attributes for JS (<code>data-target=&quot;page&quot;</code> / <code>data-target=&quot;table&quot;</code>). Avoid ambiguous class-only selectors.                                                                                               </td></tr><tr><td data-label="Logic / Structure"> Minimal placeholder content and ARIA                            </td><td data-label="Conceptual notes (design + high-leverage effects)"> Provide empty wrappers and minimal fallback text so the UI remains functional when server returns error or plain text. Include <code>role=&quot;region&quot;</code> and <code>aria-label</code>.                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> Client-side insertion points and format expectations            </td><td data-label="Conceptual notes (design + high-leverage effects)"> <code>assets/script.js</code> currently expects a specific container. Ensure template matches that. If server returns full HTML page the client should inject into <code>#page-area</code> via <code>innerHTML</code>. If server returns table fragment or <code>&lt;table&gt;</code> HTML inject into <code>#table-area</code>. </td></tr><tr><td data-label="Logic / Structure"> Distinguish full-page vs fragment via wrapper tag or header     </td><td data-label="Conceptual notes (design + high-leverage effects)"> Server can prefix JSON meta <code>meta.converted</code> or add a wrapper class (<code>&lt;div class=&quot;tv-page&quot;&gt;</code> vs <code>&lt;div class=&quot;tv-table&quot;&gt;</code>). Template JS should detect this and route accordingly. Prefer JSON meta if available; fallback to DOM inspection (<code>&lt;table</code> or <code>&lt;h1</code>).     </td></tr><tr><td data-label="Logic / Structure"> Avoid changing convert.py                                       </td><td data-label="Conceptual notes (design + high-leverage effects)"> Adjusting template and JS is lower risk. Keep convert.py outputs unchanged. Template should be tolerant to both outputs.                                                                                                                                            </td></tr><tr><td data-label="Logic / Structure"> CSS and layout implications                                     </td><td data-label="Conceptual notes (design + high-leverage effects)"> Ensure both containers inherit the correct typography and layout from <code>assets/style.css</code>. Do not change global CSS; place minimal container-specific utility classes if needed.                                                                                     </td></tr><tr><td data-label="Logic / Structure"> Backwards compatibility                                         </td><td data-label="Conceptual notes (design + high-leverage effects)"> Preserve previous element ids/classes used by legacy TV2.1 where possible. Add new IDs as aliases if necessary.                                                                                                                                                     </td></tr><tr><td data-label="Logic / Structure"> Testing hooks                                                   </td><td data-label="Conceptual notes (design + high-leverage effects)"> Add hidden test attributes (<code>data-test-target</code>) to quickly validate injection points in automated checks or visual diffs.                                                                                                                                           </td></tr></tbody></table></div><div class="row-count">Rows: 9</div></div><div class="table-caption" id="Table16" data-table="Book_8015_16" style="margin-top:2mm;margin-left:3mm;"><strong>Table 16</strong></div>
<div class="table-wrapper" data-table-id="table-16"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Logic/Structure"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic/Structure</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic/Structure"> HTML <code>&lt;head&gt;</code>: font links, CSS links, meta tags, viewport, and <code>&lt;title&gt;</code> </td><td data-label="Conceptual Notes"> Must match Table Viewer 2.1 exactly. Differences break typography or responsive scaling.                                           </td></tr><tr><td data-label="Logic/Structure"> <code>&lt;body&gt;</code> wrappers and table containers                                   </td><td data-label="Conceptual Notes"> Structure (<code>.table-wrapper</code>, <code>.table-container</code>, <code>.table-header-wrapper</code>) must match 2.1. Avoid extra <code>&lt;div&gt;</code>s or missing classes. </td></tr><tr><td data-label="Logic/Structure"> Toolbar buttons and IDs (<code>toggleAllBtn</code>, <code>backToTop</code>, <code>modeBtn</code>)         </td><td data-label="Conceptual Notes"> IDs and class names must be identical; JS expects them. Inline button text can differ but should match default 2.1 text.           </td></tr><tr><td data-label="Logic/Structure"> Search box and placement                                                 </td><td data-label="Conceptual Notes"> <code>#searchBox</code> (or equivalent) must exist in same hierarchy as 2.1.                                                                  </td></tr><tr><td data-label="Logic/Structure"> Script includes                                                          </td><td data-label="Conceptual Notes"> <code>script.js</code>, optional <code>extra.js</code>, XLSX libs, and other required JS must be included in the same order. Avoid duplication.          </td></tr><tr><td data-label="Logic/Structure"> Optional inline styles                                                   </td><td data-label="Conceptual Notes"> Minimal. Prefer stylesheet; only preserve 2.1-specific inline styles (like table widths if 2.1 sets them).                         </td></tr><tr><td data-label="Logic/Structure"> Semantic headings (<code>h1</code>, <code>h2</code>, <code>h3</code>)                                     </td><td data-label="Conceptual Notes"> For TOC and row linking, must mirror 2.1.                                                                                          </td></tr><tr><td data-label="Logic/Structure"> Mobile meta + responsive wrappers                                        </td><td data-label="Conceptual Notes"> Ensure <code>&lt;meta name=&quot;viewport&quot;&gt;</code> and flex wrappers match 2.1.                                                                       </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>