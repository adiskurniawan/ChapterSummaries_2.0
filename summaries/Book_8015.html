<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1760363328">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      // Delegate addEventListener/removeEventListener to visible button
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      // Delegate onclick assignments
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      // Delegate focus/blur
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
      // If legacy code used direct addEventListener earlier than this script, listeners would already exist
      // on alias element; attempt to re-dispatch those by cloning them to visible button is non-trivial.
      // This approach covers the common case where legacy scripts query the alias and bind after DOM ready.
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li>
<li class="toc-item"><a class="toc-link" href="#Table7">Table 7</a></li>
<li class="toc-item"><a class="toc-link" href="#Table8">Table 8</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Book_8015_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic/Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic/Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic/Structure"> <strong>1. Goal</strong>                      </td><td data-label="Conceptual Notes"> Wrap each rendered <code>&lt;table&gt;</code> with an interactive container and toolbar without editing any files inside <code>render/</code>.                                                                                                                                                                                     </td></tr><tr><td data-label="Logic/Structure"> <strong>2. Source of change</strong>          </td><td data-label="Conceptual Notes"> Modify <code>html_renderer.py</code> only. Do not touch <code>render/*</code> or <code>assets/style.css</code>. Add new assets under <code>assets/</code> (e.g. <code>table_ui.js</code>, <code>table_ui.css</code>).                                                                                                                                                    </td></tr><tr><td data-label="Logic/Structure"> <strong>3. Output markup</strong>             </td><td data-label="Conceptual Notes"> On table emission <code>html_renderer.py</code> will: add <code>&lt;div class=&quot;ptt-table&quot; id=&quot;Table{n}&quot; data-ptt-json=&quot;...&quot;&gt;</code> wrapper, include per-table toolbar markup, and place the original <code>&lt;table&gt;</code> inside <code>.table-body</code>. <code>data-ptt-json</code> holds escaped JSON for exports.                                           </td></tr><tr><td data-label="Logic/Structure"> <strong>4. IDs & anchors</strong>             </td><td data-label="Conceptual Notes"> Generate deterministic IDs <code>Table1, Table2, ...</code>. Emit anchor links for global navigation if <code>index.html</code> includes nav placeholder.                                                                                                                                                                    </td></tr><tr><td data-label="Logic/Structure"> <strong>5. JS hooks</strong>                  </td><td data-label="Conceptual Notes"> New <code>assets/table_ui.js</code> will handle collapse/expand, copy, export (CSV/JSON/MD), and global toolbar actions. Use client-side only. Do not require server changes except static serving.                                                                                                               </td></tr><tr><td data-label="Logic/Structure"> <strong>6. CSS</strong>                       </td><td data-label="Conceptual Notes"> Add <code>assets/table_ui.css</code> for UI styles. Do not modify <code>assets/style.css</code>. New CSS will be loaded alongside existing CSS.                                                                                                                                                                              </td></tr><tr><td data-label="Logic/Structure"> <strong>7. Fallback</strong>                  </td><td data-label="Conceptual Notes"> If JS disabled, the wrapper will still render the <code>&lt;table&gt;</code> and toolbar buttons will be hidden via <code>&lt;noscript&gt;</code> or CSS. No functional regression.                                                                                                                                                      </td></tr><tr><td data-label="Logic/Structure"> <strong>8. Server/static</strong>             </td><td data-label="Conceptual Notes"> <code>server.py</code> or static config may need to serve new asset files. If <code>server.py</code> already serves <code>assets/</code>, no change required. Otherwise I will add minimal static route.                                                                                                                                </td></tr><tr><td data-label="Logic/Structure"> <strong>9. Security / size</strong>           </td><td data-label="Conceptual Notes"> <code>data-ptt-json</code> must be size-aware. For very large tables prefer a hidden <code>&lt;script type=&quot;application/json&quot; data-ptt=&quot;...&quot;&gt;</code> block to avoid attribute-length limits.                                                                                                                                    </td></tr><tr><td data-label="Logic/Structure"> <strong>10. Backward compatibility</strong>   </td><td data-label="Conceptual Notes"> No changes to <code>render/*</code> means existing renderer output remains identical except wrapped. Consumers of raw <code>render</code> functions remain unaffected.                                                                                                                                                       </td></tr><tr><td data-label="Logic/Structure"> <strong>11. Tests</strong>                    </td><td data-label="Conceptual Notes"> Tests to run:<br>1) Render a sample input and confirm wrapper present and original table HTML unchanged.<br>2) Confirm <code>data-ptt-json</code> parses to original table data.<br>3) Confirm page renders with JS disabled.<br>4) Confirm assets (<code>table_ui.js</code>, <code>table_ui.css</code>) are referenced in output HTML. </td></tr><tr><td data-label="Logic/Structure"> <strong>12. Risks</strong>                    </td><td data-label="Conceptual Notes"> Large table JSON in attributes may hit browser limits. Changing <code>html_renderer.py</code> must preserve encoding and escaping to avoid XSS. Ensure no network calls.                                                                                                                                          </td></tr><tr><td data-label="Logic/Structure"> <strong>13. Deliverables on approval</strong> </td><td data-label="Conceptual Notes"> Full revised <code>html_renderer.py</code> file in copy-code block, new <code>assets/table_ui.js</code> and <code>assets/table_ui.css</code> (one file at a time per workflow), 15-point verification checklist, changelog entry, rollback command, and minimal test commands.                                                          </td></tr><tr><td data-label="Logic/Structure"> <strong>14. Implementation order</strong>     </td><td data-label="Conceptual Notes"> 1) <code>html_renderer.py</code> conceptual patch. 2) <code>templates/index.html</code> minor insertion for global toolbar. 3) <code>assets/table_ui.js</code>. 4) <code>assets/table_ui.css</code>. 5) optional <code>server.py</code> static serve addition if required.                                                                                    </td></tr><tr><td data-label="Logic/Structure"> <strong>15. Constraints</strong>              </td><td data-label="Conceptual Notes"> Do not modify any file in <code>render/</code> or <code>assets/style.css</code>. Follow project workflow: one file change at a time and wait for approval before applying next.                                                                                                                                              </td></tr></tbody></table></div><div class="row-count">Rows: 15</div></div><div class="table-caption" id="Table2" data-table="Book_8015_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Tables Viewer v2.1 item**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Tables Viewer v2.1 item</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **PasteToTable — current state &amp; action**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>PasteToTable — current state & action</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Tables Viewer v2.1 item"> <strong>core_assets (asset discovery, embedding, SRI, copy logic)</strong> </td><td data-label="PasteToTable — current state &amp; action"> Already recommended by v2.1. <strong>Action:</strong> implement or extend in <code>render/core_assets.py</code> if missing. But <strong>do not modify any <code>render/</code> files</strong> per your rule. Instead adapt caller sites outside <code>render/</code> (<code>html_renderer.py</code>, <code>templates/index.html</code>, <code>server.py</code>) to use existing <code>core_assets</code> behavior. </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>core_renderer (orchestration shim)</strong>                        </td><td data-label="PasteToTable — current state &amp; action"> Optional in v2.1. <strong>Action:</strong> keep orchestration changes outside locked <code>render/</code> files. Modify <code>html_renderer.py</code> to provide the orchestration and compatibility layer.                                                                                                                                    </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>core_io (atomic write, tmp dirs)</strong>                          </td><td data-label="PasteToTable — current state &amp; action"> High priority for reliability. <strong>Action:</strong> implement required atomic I/O helpers in <code>utils.py</code> or <code>render/convert.py</code> (you allowed <code>convert.py</code>). Prefer <code>utils.py</code> first then mirror into <code>convert.py</code> if renderer needs it.                                                                               </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>core_table (canonical table renderer)</strong>                     </td><td data-label="PasteToTable — current state &amp; action"> Present and must remain unchanged in <code>render/</code>. <strong>Action:</strong> ensure <code>html_renderer.py</code> uses it as-is and does not wrap or alter markup that affects typography.                                                                                                                                              </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>core_utils (sanitize, sri_attr, streaming helpers)</strong>        </td><td data-label="PasteToTable — current state &amp; action"> High leverage. <strong>Action:</strong> implement small helpers in <code>utils.py</code> and expose from <code>render/convert.py</code> if necessary. Do not edit other <code>render/</code> files.                                                                                                                                                       </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>client assets (worker.js, xlsx libs, UI JS/CSS)</strong>           </td><td data-label="PasteToTable — current state &amp; action"> v2.1 uses <code>worker.js</code> and optional large libs. <strong>Action:</strong> add new UI assets under <code>assets/</code> (<code>table_ui.js</code>, <code>table_ui.css</code>) and update <code>templates/index.html</code> to load them. Do not change <code>assets/style.css</code>.                                                                                              </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>HTML/CSS font & reset rules</strong>                               </td><td data-label="PasteToTable — current state &amp; action"> Typography mismatch likely due to missing font, reset, or load order. <strong>Action:</strong> update <code>templates/index.html</code> to include the exact font links and ensure <code>assets/style.css</code> loads in identical order. Add a small <code>assets/typography_override.css</code> if needed.                                             </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>Sanitizer / convert behavior</strong>                              </td><td data-label="PasteToTable — current state &amp; action"> v2.1 notes show sanitizer can strip classes/styles. <strong>Action:</strong> adjust <code>render/convert.py</code> (allowed) to preserve classes/attributes required for typography. Keep other <code>render/</code> files untouched.                                                                                                          </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>Load order / JS fallbacks</strong>                                 </td><td data-label="PasteToTable — current state &amp; action"> v2.1 supports JS-disabled fallback. <strong>Action:</strong> update <code>templates/index.html</code> and <code>assets/script.js</code> to reproduce that behavior.                                                                                                                                                                            </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>Priority list</strong>                                             </td><td data-label="PasteToTable — current state &amp; action"> High: fonts/load order, <code>html_renderer.py</code> wrapper behavior, <code>render/convert.py</code> attribute preservation, <code>templates/index.html</code> asset links. Medium: add UI assets, atomic I/O helpers. Low: core_renderer refactor.                                                                                        </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>Quick tests (minimal)</strong>                                     </td><td data-label="PasteToTable — current state &amp; action"> 1) Render sample table and compare computed <code>font-family</code>, <code>font-size</code>, <code>line-height</code> to v2.1. 2) Inspect <code>&lt;td&gt;</code> classes/inline styles for preservation. 3) Verify <code>assets/style.css</code> is loaded in same order. 4) Verify page with JS disabled.                                                             </td></tr><tr><td data-label="Tables Viewer v2.1 item"> <strong>Constraint reminder</strong>                                       </td><td data-label="PasteToTable — current state &amp; action"> <strong>Do not modify</strong> any files in <code>render/</code> except <code>render/convert.py</code>. <strong>Do not modify</strong> <code>assets/style.css</code>. All other changes must be outside <code>render/</code>.                                                                                                                                                     </td></tr></tbody></table></div><div class="row-count">Rows: 12</div></div><div class="table-caption" id="Table3" data-table="Book_8015_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Step / Focus Area**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Step / Focus Area</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Strategic Plan for Matching Benchmark Typography**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Strategic Plan for Matching Benchmark Typography</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Step / Focus Area"> <strong>1. Visual Analysis</strong>                     </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Capture all font, spacing, border, color, and alignment metrics from the benchmark table ([Book_9001.html#Table4](https://adiskurniawan.github.io/ChapterSummaries_2.0/summaries/Book_9001.html#Table4)). Document differences with current output. </td></tr><tr><td data-label="Step / Focus Area"> <strong>2. CSS Integrity</strong>                       </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Lock <code>assets/style.css</code> since it already matches Table Viewer 2.1. Verify loaded version in browser is the same file, not overridden by cache or embedded style.                                                                                    </td></tr><tr><td data-label="Step / Focus Area"> <strong>3. HTML Output Layer</strong>                   </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Audit <code>html_renderer.py</code> and <code>templates/index.html</code> for missing or extra wrappers, classes, or attributes that alter spacing, text alignment, or font inheritance. Align structure exactly to Table Viewer 2.1 markup.                              </td></tr><tr><td data-label="Step / Focus Area"> <strong>4. Table Conversion Logic</strong>              </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Focus changes in <code>render/convert.py</code> to ensure HTML output structure (tags, nesting, indentation) fully matches the reference output. Avoid logic that injects extra inline styles.                                                                 </td></tr><tr><td data-label="Step / Focus Area"> <strong>5. JS Behavior</strong>                         </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Check <code>assets/script.js</code> for dynamic DOM styling or table transformation that may modify widths or alignment. Neutralize or sync with Table Viewer 2.1’s JavaScript if differences exist.                                                           </td></tr><tr><td data-label="Step / Focus Area"> <strong>6. Template Rendering</strong>                  </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Adjust <code>templates/index.html</code> only to ensure page-level CSS inheritance (font, background, container width) matches benchmark. No additional styling.                                                                                               </td></tr><tr><td data-label="Step / Focus Area"> <strong>7. Data Flow Consistency</strong>               </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Verify <code>main.py</code>, <code>server.py</code>, and <code>utils.py</code> feed consistent, sanitized HTML data into renderer without escaping or wrapping deviations that affect rendering.                                                                                     </td></tr><tr><td data-label="Step / Focus Area"> <strong>8. Pixel Comparison Test</strong>               </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Generate side-by-side screenshots of benchmark vs current output. Use computed CSS metrics (font-family, line-height, letter-spacing) for verification.                                                                                             </td></tr><tr><td data-label="Step / Focus Area"> <strong>9. Accessibility + Responsive Behavior</strong> </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Validate that typography consistency holds under zoom and small screens without distorting line spacing or table width.                                                                                                                             </td></tr><tr><td data-label="Step / Focus Area"> <strong>10. Final Verification</strong>                 </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Produce final regression suite comparing exported table HTML against benchmark HTML snippet for tag order, attributes, and computed style equivalence.                                                                                              </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table4" data-table="Book_8015_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Step / Focus Area**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Step / Focus Area</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Expanded Strategic Plan for Matching Benchmark Typography**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Expanded Strategic Plan for Matching Benchmark Typography</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Step / Focus Area"> <strong>1. Visual Analysis</strong>                     </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Perform a detailed audit of the benchmark table ([Book_9001.html#Table4](https://adiskurniawan.github.io/ChapterSummaries_2.0/summaries/Book_9001.html#Table4)), recording: <br>1. Font-family, weight, style, and fallback fonts. <br>2. Font-size per table, row, header, and cell. <br>3. Line-height, letter-spacing, and word-spacing. <br>4. Cell padding, table margins, border width and color. <br>5. Background and text color. <br>6. Text alignment, vertical alignment, and header alignment. <br>7. Table width, container width, and max-width constraints. <br>Document all deviations from current PasteToTable output with precise CSS and HTML selectors. </td></tr><tr><td data-label="Step / Focus Area"> <strong>2. CSS Integrity</strong>                       </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Ensure <code>assets/style.css</code> matches Table Viewer 2.1 exactly. <br>1. Confirm correct load order in <code>templates/index.html</code>. <br>2. Prevent cache or injected styles from overriding <code>style.css</code>. <br>3. Check for media queries or theme-specific overrides. <br>4. Optionally add a small supplemental <code>table_ui.css</code> for UI controls that does not touch typography. <br>5. Verify no inline styles or JS-modified styles are changing inherited typography.                                                                                                                                                                                                                  </td></tr><tr><td data-label="Step / Focus Area"> <strong>3. HTML Output Layer</strong>                   </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Audit <code>html_renderer.py</code> and <code>templates/index.html</code>: <br>1. Ensure all <code>&lt;table&gt;</code> elements have the same nesting and wrappers as benchmark (e.g., <code>.table-container</code>, <code>.table-body</code>). <br>2. Verify all classes, IDs, and data attributes that control style or alignment are preserved. <br>3. Ensure <code>&lt;th&gt;</code> and <code>&lt;td&gt;</code> semantic usage matches benchmark (row headers, column headers, rowspan/colspan). <br>4. Confirm no extra <code>&lt;div&gt;</code> or <code>&lt;span&gt;</code> wrappers that interfere with inheritance. <br>5. Validate HTML escaping and sanitizer do not remove essential attributes.                                                                                               </td></tr><tr><td data-label="Step / Focus Area"> <strong>4. Table Conversion Logic</strong>              </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Focus on <code>render/convert.py</code> for controlled modifications: <br>1. Preserve class names, IDs, and inline attributes required for typography. <br>2. Maintain tag nesting and indentation identical to benchmark output. <br>3. Ensure no additional <code>&lt;style&gt;</code> or <code>&lt;font&gt;</code> attributes are injected. <br>4. Convert or normalize whitespace to match benchmark. <br>5. Preserve table data fidelity for export and display.                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Step / Focus Area"> <strong>5. JS Behavior</strong>                         </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Review <code>assets/script.js</code> and <code>assets/worker.js</code>: <br>1. Identify any scripts that modify table width, font, or alignment dynamically. <br>2. Disable or modify JS affecting typography to match benchmark behavior. <br>3. Implement collapse/expand and export features without affecting typography. <br>4. Validate responsive behavior and zoom interactions maintain spacing and alignment. <br>5. Ensure scripts do not inject inline styles that override CSS.                                                                                                                                                                                                       </td></tr><tr><td data-label="Step / Focus Area"> <strong>6. Template Rendering</strong>                  </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Adjust <code>templates/index.html</code> only for page-level consistency: <br>1. Verify <code>&lt;meta charset=&quot;utf-8&quot;&gt;</code> and <code>&lt;!doctype html&gt;</code> are present. <br>2. Ensure correct <code>&lt;link&gt;</code> to <code>assets/style.css</code> (and supplemental UI CSS if needed). <br>3. Confirm container widths, font inheritance, and background colors match benchmark. <br>4. Do not introduce new typography rules. <br>5. Include anchor navigation and global toolbar placeholders if benchmark uses them.                                                                                                                                                                                                          </td></tr><tr><td data-label="Step / Focus Area"> <strong>7. Data Flow Consistency</strong>               </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Audit <code>main.py</code>, <code>server.py</code>, <code>utils.py</code>: <br>1. Verify HTML passed to renderer is consistent with expected benchmark table structure. <br>2. Ensure no additional escaping or sanitation modifies spacing, inline styles, or class attributes. <br>3. Confirm that JSON or other structured table data retains all required fields for rendering. <br>4. Check for transformations that may alter header or cell content affecting typography.                                                                                                                                                                                                                              </td></tr><tr><td data-label="Step / Focus Area"> <strong>8. Pixel Comparison Test</strong>               </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Perform objective visual comparison: <br>1. Capture high-resolution screenshots of benchmark and PasteToTable output side-by-side. <br>2. Compare font-family, font-size, line-height, letter-spacing, cell padding, and border widths. <br>3. Use browser devtools to inspect computed styles and ensure all matches. <br>4. Confirm rendering matches across multiple browsers and zoom levels. <br>5. Generate automated regression tests for CSS and DOM attributes.                                                                                                                                                                                                     </td></tr><tr><td data-label="Step / Focus Area"> <strong>9. Accessibility + Responsive Behavior</strong> </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Validate typography consistency under accessibility and responsive conditions: <br>1. Zoom in/out and check line spacing, table width, and font scaling. <br>2. Confirm text remains readable and aligned at different viewport widths. <br>3. Test keyboard navigation and screen reader fallback for table structure. <br>4. Ensure collapse/expand and toolbar actions do not distort typography.                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Step / Focus Area"> <strong>10. Final Verification</strong>                 </td><td data-label="Expanded Strategic Plan for Matching Benchmark Typography"> Create a comprehensive regression and verification suite: <br>1. Compare rendered HTML tag order, classes, and attributes to benchmark snippet. <br>2. Confirm CSS inheritance matches benchmark. <br>3. Validate that exported HTML, CSV, Markdown, and PDF outputs preserve typography. <br>4. Document any remaining small deviations and iterate. <br>5. Confirm no changes occurred in <code>render/</code> files or <code>assets/style.css</code>.                                                                                                                                                                                                                                           </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table5" data-table="Book_8015_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Step / Focus Area**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Step / Focus Area</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Strategic Plan for Matching Benchmark Typography**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Strategic Plan for Matching Benchmark Typography</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **My Task (Minimal)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>My Task (Minimal)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Step / Focus Area"> <strong>1. Visual Analysis</strong>                     </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Perform a meticulous audit of the benchmark table ([Book_9001.html#Table4](https://adiskurniawan.github.io/ChapterSummaries_2.0/summaries/Book_9001.html#Table4)) including: <br>• Exact font-family, weight, style, fallback fonts. <br>• Font-size per table, header, body, and footer. <br>• Line-height, letter-spacing, word-spacing. <br>• Cell padding, row spacing, table margins, border width and color. <br>• Background and text color of headers and cells. <br>• Text alignment (horizontal/vertical) and header alignment. <br>• Table width, container width, max-width, and responsive constraints. <br>Document all differences and compute delta values vs current PasteToTable output. </td><td data-label="My Task (Minimal)"> Inspect benchmark table; note every metric and difference.                       </td></tr><tr><td data-label="Step / Focus Area"> <strong>2. CSS Integrity</strong>                       </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Ensure <code>assets/style.css</code> is identical to Table Viewer 2.1. Steps: <br>• Confirm correct load order in <code>templates/index.html</code>. <br>• Prevent any caching or inline style overrides. <br>• Verify media queries and theme-specific rules match benchmark. <br>• Add optional <code>table_ui.css</code> for UI controls only, ensuring it does not touch typography. <br>• Confirm no JS or dynamic style changes override inherited styles. <br>• Cross-check all inherited font-family, font-size, line-height, and spacing.                                                                                                                                                                                          </td><td data-label="My Task (Minimal)"> Verify CSS load order; prepare supplemental UI CSS only.                         </td></tr><tr><td data-label="Step / Focus Area"> <strong>3. HTML Output Layer</strong>                   </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Audit <code>html_renderer.py</code> and <code>templates/index.html</code> for markup fidelity: <br>• Ensure every <code>&lt;table&gt;</code> has the same wrappers and nesting (<code>.table-container</code>, <code>.table-body</code>, etc.). <br>• Preserve all class names, IDs, and data attributes critical to styling. <br>• Verify <code>&lt;th&gt;</code> and <code>&lt;td&gt;</code> semantic use, including <code>rowspan</code>/<code>colspan</code>. <br>• Ensure no extra <code>&lt;div&gt;</code> or <code>&lt;span&gt;</code> wrappers interfere with font inheritance. <br>• Validate HTML escaping and sanitizer do not remove essential attributes or add inline styles.                                                                                                                                                                       </td><td data-label="My Task (Minimal)"> Review rendered table output; confirm wrappers, classes, IDs.                    </td></tr><tr><td data-label="Step / Focus Area"> <strong>4. Table Conversion Logic</strong>              </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Focus changes in <code>render/convert.py</code>: <br>• Preserve original class names, IDs, and attributes. <br>• Maintain exact tag nesting and indentation. <br>• Avoid injecting <code>&lt;style&gt;</code> or <code>font</code> attributes. <br>• Normalize whitespace and remove extra line breaks that affect spacing. <br>• Ensure exported or intermediate data does not alter HTML representation.                                                                                                                                                                                                                                                                                                                                        </td><td data-label="My Task (Minimal)"> Modify <code>convert.py</code> to preserve attributes and structure.                        </td></tr><tr><td data-label="Step / Focus Area"> <strong>5. JS Behavior</strong>                         </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Review <code>assets/script.js</code> and <code>assets/worker.js</code>: <br>• Identify DOM manipulations affecting widths, alignment, or typography. <br>• Neutralize changes that conflict with benchmark. <br>• Implement collapse/expand, copy, and export features without affecting visual style. <br>• Confirm responsive behavior and zoom maintain spacing/alignment. <br>• Ensure scripts do not inject inline styles that override CSS.                                                                                                                                                                                                                                                                                </td><td data-label="My Task (Minimal)"> Audit JS; disable or fix code affecting typography; confirm responsive behavior. </td></tr><tr><td data-label="Step / Focus Area"> <strong>6. Template Rendering</strong>                  </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Adjust <code>templates/index.html</code> for page-level consistency: <br>• Verify <code>&lt;meta charset=&quot;utf-8&quot;&gt;</code> and <code>&lt;!doctype html&gt;</code> are present. <br>• Ensure correct <code>&lt;link&gt;</code> to <code>assets/style.css</code> (and optional supplemental CSS). <br>• Confirm container width, body font inheritance, background color, and padding match benchmark. <br>• Do not introduce new typography rules. <br>• Include placeholders for global toolbar and table navigation if benchmark uses them.                                                                                                                                                                                                                                       </td><td data-label="My Task (Minimal)"> Update template links and container markup; ensure correct inheritance.          </td></tr><tr><td data-label="Step / Focus Area"> <strong>7. Data Flow Consistency</strong>               </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Verify all server and utility pipelines (<code>main.py</code>, <code>server.py</code>, <code>utils.py</code>) feed sanitized HTML consistently: <br>• No added escaping, inline styles, or class removals. <br>• JSON or structured table data preserves all required fields for rendering. <br>• No transformations altering header or cell content affecting typography. <br>• Ensure backend logic does not inject additional wrappers or text nodes.                                                                                                                                                                                                                                                                                    </td><td data-label="My Task (Minimal)"> Audit data path; fix escaping, ensure renderer receives correct HTML.            </td></tr><tr><td data-label="Step / Focus Area"> <strong>8. Pixel Comparison Test</strong>               </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Objective visual verification: <br>• Capture side-by-side high-resolution screenshots of benchmark vs PasteToTable output. <br>• Compare computed CSS metrics: font-family, font-size, line-height, letter-spacing, word-spacing, cell padding, and border widths. <br>• Check alignment of headers, cells, and table body. <br>• Validate rendering in multiple browsers. <br>• Generate automated regression tests that flag any deviations.                                                                                                                                                                                                                                                             </td><td data-label="My Task (Minimal)"> Take screenshots; record metrics; create comparison checklist.                   </td></tr><tr><td data-label="Step / Focus Area"> <strong>9. Accessibility + Responsive Behavior</strong> </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Confirm typography consistency under accessibility and responsive conditions: <br>• Zoom in/out and verify spacing and alignment. <br>• Check table width and font scaling at different viewport sizes. <br>• Test keyboard navigation and screen reader fallback for proper table semantics. <br>• Validate collapse/expand and toolbar actions do not distort typography. <br>• Ensure no font or spacing breaks at small or large screens.                                                                                                                                                                                                                                                              </td><td data-label="My Task (Minimal)"> Test zoom, viewport, and screen reader behavior; note issues.                    </td></tr><tr><td data-label="Step / Focus Area"> <strong>10. Final Verification</strong>                 </td><td data-label="Strategic Plan for Matching Benchmark Typography"> Comprehensive regression suite: <br>• Compare rendered HTML tag order, classes, and attributes against benchmark snippet. <br>• Confirm CSS inheritance matches benchmark (computed styles). <br>• Validate exported HTML, CSV, Markdown, PDF preserve typography. <br>• Document remaining minor deviations. <br>• Confirm no changes in <code>render/</code> files or <code>assets/style.css</code>. <br>• Produce report showing full pixel, style, and DOM equivalence.                                                                                                                                                                                                                                                      </td><td data-label="My Task (Minimal)"> Run regression tests; log deviations; confirm immutable files untouched.         </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table6" data-table="Book_8015_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Difference**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Difference</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Details, impact, and minimal fix**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Details, impact, and minimal fix</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Difference"> <strong>1. <code>_apply_left_col_heading</code> implementation</strong> </td><td data-label="Details, impact, and minimal fix"> <strong>Observed:</strong> Present as a local function in PasteToTable <code>convert.py</code> but not defined in the Table Viewer <code>convert.py</code> you provided. Table Viewer likely uses a shared/util implementation. <br><strong>Impact:</strong> High. It wraps first-column text in <code>&lt;div class=&quot;left-col-heading&quot;&gt;&lt;strong&gt;…&lt;/strong&gt;…&lt;/div&gt;</code> and can change font weight, spacing, vertical rhythm, and line-breaking. This is the most likely cause of typography drift. <br><strong>Minimal fix:</strong> Replace the local implementation with a safe import-from-utils + conservative fallback identity. i.e.: </td></tr></tbody></table></div><div class="row-count">Rows: 1</div></div><div class="table-caption" id="Table7" data-table="Book_8015_07" style="margin-top:2mm;margin-left:3mm;"><strong>Table 7</strong></div>
<div class="table-wrapper" data-table-id="table-7"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Item**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Item</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Item"> 1. Utils wrapper fallback </td><td data-label="Notes"> This preserves Table Viewer behavior when utils provides it and avoids adding inconsistent wrapping when not required. </td></tr><tr><td data-label="Item"> 2. Bullet / Unicode regex sets </td><td data-label="Notes"> Observed: Slightly different bullet character classes between files (_BULLET_LEADING_RE, _BULLET_PAT). <br>Impact: Low (visual lists only). Not directly typography for table cells, but can change inline list rendering inside cells. <br>Minimal fix: Copy the Table Viewer regex lines verbatim into PasteToTable convert.py to ensure identical parsing of bullets. </td></tr><tr><td data-label="Item"> 3. CSV sniffing / parse behavior </td><td data-label="Notes"> Observed: Both files implement CSV parsing; differences are minor (sniffer usage and sanitization). <br>Impact: Low. Only affects content parsing not CSS. <br>Minimal fix: No urgent change. Keep as-is or unify to Table Viewer version if you want strict parity. </td></tr><tr><td data-label="Item"> 4. Markdown table parser </td><td data-label="Notes"> Observed: Both implement robust pipe-table parsing; implementations are equivalent. <br>Impact: Low. Parsing differences could change header cell content (thus CSS selectors) only in edge cases. <br>Minimal fix: Keep current PasteToTable parser. No change required unless specific failing cases found. </td></tr><tr><td data-label="Item"> 5. HTML wrapper / heading and heading-bar markup </td><td data-label="Notes"> Observed: Both render_table implementations emit identical heading bar, h3 id table-{idx}, table-wrapper, and tv-table markup. <br>Impact: Low. These are consistent. <br>Minimal fix: None. Ensure assets/style.css contains matching selectors (it is locked and claimed identical). </td></tr><tr><td data-label="Item"> 6. Inline styles in header wrapper </td><td data-label="Notes"> Observed: Both include style="display:flex;... margin-bottom:5px;" on .table-header-wrapper. <br>Impact: Medium. Inline spacing here can affect vertical rhythm. Table Viewer also used similar inline style per provided file. <br>Minimal fix: Leave unchanged for parity. If final pixel test fails, move to CSS-only (but style.css is locked so only add a supplemental UI CSS if necessary). </td></tr><tr><td data-label="Item"> 7. sanitize_bold_html / markdown fallback </td><td data-label="Notes"> Observed: Both use same fallback imports and conservative markdown fallback. <br>Impact: Low. Affects which tags are preserved. <br>Minimal fix: No change. Ensure utils implementation (if used) matches Table Viewer. </td></tr><tr><td data-label="Item"> 8. Character normalisation / zero-width removals </td><td data-label="Notes"> Observed: Slight syntax variation (re.sub patterns), functionally equivalent. <br>Impact: Negligible. <br>Minimal fix: None. </td></tr><tr><td data-label="Item"> 9. Presence of extra helper functions (convert_structure, convert_text_to_html) </td><td data-label="Notes"> Observed: PasteToTable has these higher-level helpers. Table Viewer also had equivalents. <br>Impact: None on typography. <br>Minimal fix: None. </td></tr><tr><td data-label="Item"> 10. Overall DOM output parity </td><td data-label="Notes"> Observed: Except for _apply_left_col_heading and minor regex character sets, the rendered HTML fragments are effectively identical (same classes, ids, and structure). <br>Impact: The left-col wrapping is the single highest-leverage difference. Fixing that is likely to resolve typography mismatch. <br>Minimal fix: Implement the import fallback for _apply_left_col_heading and unify bullet regex. </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table8" data-table="Book_8015_08" style="margin-top:2mm;margin-left:3mm;"><strong>Table 8</strong></div>
<div class="table-wrapper" data-table-id="table-8"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Focus**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Focus</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Status / Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Status / Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Next Steps**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Next Steps</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Focus"> <code>render/convert.py</code>  </td><td data-label="Status / Notes"> Fully revised, verified, compatible with Table Viewer 2.1 typography. Does <strong>not directly import <code>core.py</code></strong>; uses <code>core_assets</code> and <code>core_table</code> safely. </td><td data-label="Next Steps"> Keep unchanged; confirm behavior in <code>main.py</code> execution.                                            </td></tr><tr><td data-label="Focus"> <code>render/core.py</code>     </td><td data-label="Status / Notes"> Present, contains fallbacks and delegation wrappers for <code>convert.py</code>, <code>core_table</code>, <code>core_assets</code>, <code>markdown</code>, <code>sanitize</code>.                                </td><td data-label="Next Steps"> Audit all modifiable files for references; confirm safe deletion or replacement.                    </td></tr><tr><td data-label="Focus"> Dependencies         </td><td data-label="Status / Notes"> <code>convert.py</code> depends on <code>core_assets</code> and <code>core_table</code>; no other file in session confirmed to call <code>core.py</code> explicitly yet.                              </td><td data-label="Next Steps"> Scan <code>main.py</code>, <code>server.py</code>, <code>html_renderer.py</code>, <code>utils.py</code>, <code>templates/index.html</code>, <code>assets/*.js</code>. </td></tr><tr><td data-label="Focus"> Immutable files      </td><td data-label="Status / Notes"> <code>render/convert.py</code> and <code>assets/style.css</code> locked; must remain untouched.                                                                                 </td><td data-label="Next Steps"> Proceed to auditing modifiable files for <code>core.py</code> references.                                      </td></tr><tr><td data-label="Focus"> Audit goal           </td><td data-label="Status / Notes"> Determine whether <code>core.py</code> can be safely removed without breaking <code>convert.py</code> or other pipelines.                                                       </td><td data-label="Next Steps"> Collect dependency map, log all calls/imports, produce final safe recommendation.                   </td></tr><tr><td data-label="Focus"> Execution validation </td><td data-label="Status / Notes"> Current plan does not require running <code>main.py</code> yet but is advisable to confirm runtime behavior after file audits.                                       </td><td data-label="Next Steps"> After audit, optionally run <code>main.py</code> to confirm <code>convert.py</code> works independently of <code>core.py</code>.     </td></tr></tbody></table></div><div class="row-count">Rows: 6</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>