<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;}</style>
<link rel="stylesheet" href="assets/style.css?v=1758564630">
<link rel="stylesheet" href="assets/overrides.css?v=1758564630">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header"><div><h1>Tables Viewer v2.1</h1></div><div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" type="search" placeholder="Search" aria-label="Search tables" style="min-width:420px; width:44ch;"/>
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllMdBtn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy all tables as markdown">Copy All Tables (Markdown)</button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset all tables">Reset All Tables</button>
</div></div>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#table-1">Table 1</a></li></ul></div></div>
<div class="table-wrapper" data-table-id="table-1"><h3 id="table-1">Table 1</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xls-btn" data-action="export-xls" onclick="exportTableXLSX(this)">Export XLS</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr>
        <th style="width:28.57%;" onclick="sortTableByColumn(0,0)" role="button" aria-label="Sort by **Path / File**">
          <div class="th-with-sort">
            <div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Path / File</strong></div>
            <button class="sort-btn sort-state-0" onclick="event.stopPropagation(); headerSortButtonClicked(0,0, this)" title="Toggle sort" aria-label="Toggle sort">
              <span class="sort-icon" aria-hidden="true"></span>
            </button>
          </div>
        </th>
        <th style="width:71.43%;" onclick="sortTableByColumn(0,1)" role="button" aria-label="Sort by **Explanation**">
          <div class="th-with-sort">
            <div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Explanation</strong></div>
            <button class="sort-btn sort-state-0" onclick="event.stopPropagation(); headerSortButtonClicked(0,1, this)" title="Toggle sort" aria-label="Toggle sort">
              <span class="sort-icon" aria-hidden="true"></span>
            </button>
          </div>
        </th></tr></thead><tbody><tr><td data-label="Path / File"><p><strong>D:\Dropbox\Projects\tables\<em>viewer\</em>v2\&#95;1\</strong><br>Root directory</p></td><td data-label="Explanation"><p>Root project directory. This is the base workspace where all source code, assets, utilities, and generated outputs live. It is designed to be self-contained so that you can zip the folder, copy it to another machine, or version-control it without breaking dependencies. The naming convention (`tables<em>viewer</em>v2<em>1`) indicates this is version 2.1 of the <em>Tables Viewer</em> project. Root directory contains the entry point script (`main.py`), helper modules, renderer subpackage, static assets, and the output folder. Subfolders are organized by responsibility: `render` contains Python logic, `assets` contains CSS/JS, `output</em>combined` stores generated HTML bundles. This layout encourages modularity and maintainability by isolating core logic from presentation and generated artifacts.</p></td></tr>
<tr><td data-label="Path / File"><p><strong>render\</strong><br>Renderer subpackage</p></td><td data-label="Explanation"><p>Primary code subpackage dedicated to rendering operations. Every file in this folder contributes to the transformation of raw tabular data into clean, styled HTML documents that can be viewed in a browser. By convention, `render` handles all operations beyond simple helpers: data cleaning, type management, input/output conversions, HTML table assembly, and sanitization. Keeping all render-specific logic in one place allows easier testing and replacement. For example, if later you need to generate PDF output instead of HTML, you can extend this subpackage without touching unrelated files.</p></td></tr>
<tr><td data-label="Path / File"><p><strong>render\core.py</strong><br>Main orchestrator</p></td><td data-label="Explanation"><p>Central orchestration module for rendering. It ties together functionality from other modules in the `render` folder. Responsibilities: <br>(1) define the main API entry points for rendering (e.g., `render<em>html`, `render</em>tables`), <br>(2) coordinate the pipeline stages—sanitization, conversion, HTML structure creation, and post-processing, <br>(3) handle high-level options such as theme, table ordering, header placement, metadata injection. This file is intentionally kept as a single unified core rather than split across multiple `core<em>&#42;` files, reducing overhead. Users typically do not edit this unless they want to change the rendering pipeline itself. Other scripts like `main.py` or `html</em>renderer.py` call into `core.py` for their work.</p></td></tr>
<tr><td data-label="Path / File"><p><strong>render\convert.py</strong><br>Data normalization</p></td><td data-label="Explanation"><p>Module that converts raw tabular data into normalized formats suitable for rendering. It accepts inputs such as CSV data, Excel tables, Markdown tables, Pandas DataFrames, or custom JSON objects. Functions in this module perform type coercion, normalization of headers, detection of column datatypes, and transformation into Python structures (lists of dicts, lists of lists, etc.). Conversion ensures consistent downstream processing. For example, whether the source is a Markdown table or an Excel file, after passing through `convert.py` the resulting structure will look the same to the renderer. This abstraction makes the rendering pipeline format-agnostic. The module is often extended when new input sources are supported.</p></td></tr>
<tr><td data-label="Path / File"><p><strong>render\markdown.py</strong><br>Markdown parser</p></td><td data-label="Explanation"><p>Specialized parser and converter for Markdown tables. Markdown table syntax varies in complexity (pipes, alignment markers, escaped characters). This module isolates all Markdown handling so that other parts of the system do not need to worry about parsing. It provides functions like `parse<em>markdown</em>table(text)` or `markdown<em>to</em>structured&#95;rows(text)`. Once parsed, data flows into `convert.py` for normalization. The separation of Markdown logic here prevents clutter in `convert.py` and makes it easy to swap in an external Markdown parser if needed.</p></td></tr>
<tr><td data-label="Path / File"><p><strong>render\io\&#95;utils.py</strong><br>Input/output helpers</p></td><td data-label="Explanation"><p>Input/output utilities for working with external files and streams. Provides functions like `read<em>csv</em>file(path)`, `read<em>excel</em>file(path)`, `load<em>json(path)`, or generic `load</em>file(path, type)`. It also includes safe writing functions to save rendered HTML into the `output<em>combined` folder, ensuring that assets are copied and links are correct. By keeping I/O in one module, the rendering pipeline can be tested independently of the filesystem (mocking `io</em>utils` in unit tests). This design enforces separation of concerns: core rendering logic never directly touches disk, it only receives data through `io&#95;utils`.</p></td></tr>
<tr><td data-label="Path / File"><p><strong>render\sanitize.py</strong><br>Safety and cleanup</p></td><td data-label="Explanation"><p>Handles data sanitization and safety measures before rendering. Includes: <br>(1) escaping HTML special characters to prevent injection, <br>(2) removing dangerous inline scripts or event attributes from table content, <br>(3) trimming whitespace, normalizing Unicode, and ensuring consistent encoding, <br>(4) optional enforcement of safe subset of HTML tags if user data contains raw markup. This is critical because the renderer generates HTML for direct browser consumption, so without sanitization malicious input could lead to cross-site scripting. Centralizing sanitization ensures every rendering path benefits from the same protections.</p></td></tr>
<tr><td data-label="Path / File"><p><strong>render\types.py</strong><br>Shared type system</p></td><td data-label="Explanation"><p>Defines type hints, data structures, and enums used across the rendering pipeline. Examples: `TableData`, `Cell`, `Header`, `RenderOptions`. This makes code more readable and helps catch errors early through static type checking. `types.py` also documents what kind of objects each stage of the pipeline expects and returns. By sharing types across modules, you reduce the risk of mismatched structures. In long term, this file can expand to include Pydantic models or TypedDicts to enforce stricter contracts.</p></td></tr>
<tr><td data-label="Path / File"><p><strong>assets\</strong><br>Static resources</p></td><td data-label="Explanation"><p>Static resource directory. Contains non-Python files needed for rendering output, mostly styling and client-side scripts. These files are copied into the `output&#95;combined/assets` folder during rendering to ensure outputs are self-contained. Organizing them in `assets` keeps source control clean and ensures predictable bundling. If you want to change how the output HTML looks or behaves, you edit files here rather than the Python logic.</p></td></tr>
<tr><td data-label="Path / File"><p><strong>assets\style.css</strong><br>Main stylesheet</p></td><td data-label="Explanation"><p>Main stylesheet that defines base theme, colors, fonts, spacing, and table presentation rules. Contains CSS variables for theme customization (header background, row striping, hover highlights). Modular design allows easy overrides without rewriting everything. The Python renderer injects links to this CSS into the generated HTML header. Users can edit this to globally change visual style.</p></td></tr>
<tr><td data-label="Path / File"><p><strong>assets\script.js</strong><br>Interactive behavior</p></td><td data-label="Explanation"><p>Core JavaScript functionality. Provides interactive features such as column sorting, row highlighting, filtering, or dynamic resizing. The script is loaded by every rendered HTML page, ensuring consistent behavior across outputs. It typically contains event listeners attached to table headers and UI controls. Kept separate from inline HTML for maintainability.</p></td></tr>
<tr><td data-label="Path / File"><p><strong>assets\worker.js</strong><br>Background worker</p></td><td data-label="Explanation"><p>Optional Web Worker script for heavy operations (sorting large tables, searching, filtering) without blocking the main UI thread. Improves responsiveness when rendering big datasets. The renderer may register this worker automatically if table size exceeds certain thresholds. Splitting into a worker script isolates performance-critical logic.</p></td></tr>
<tr><td data-label="Path / File"><p><strong>assets\overrides.css</strong><br>User overrides</p></td><td data-label="Explanation"><p>Secondary stylesheet meant for user overrides. Loaded after `style.css` so that rules defined here take precedence. This provides a non-destructive way to customize styling without touching the main stylesheet. For example, if you want to change table font size or header color, you put your changes in `overrides.css`. It enables maintainability because `style.css` can be updated by the project without losing user customization.</p></td></tr>
<tr><td data-label="Path / File"><p><strong>output\&#95;combined\</strong><br>Generated output</p></td><td data-label="Explanation"><p>Output folder generated at runtime. All rendered HTML documents are written here, along with a copy of assets. The goal is to produce a self-contained bundle that can be opened in a browser without depending on source directories. The folder may contain multiple HTML files if you render several datasets. Assets are copied automatically, so each output remains portable. This folder should not be manually edited; it is regenerated by the renderer.</p></td></tr>
<tr><td data-label="Path / File"><p><strong>output\&#95;combined\assets\</strong><br>Copied assets</p></td><td data-label="Explanation"><p>Copied version of the `assets` folder. When rendering, the system duplicates CSS/JS files here so that output HTML links are relative and functional even if shared or hosted. Example: if you send the `output&#95;combined` folder to another person, they can open the HTML and see styled, interactive tables without needing the project source.</p></td></tr>
<tr><td data-label="Path / File"><p><strong>html\&#95;renderer.py</strong><br>API façade</p></td><td data-label="Explanation"><p>Wrapper module that provides compatibility with legacy entry point `main.py`. It exposes a simplified API to trigger rendering without requiring users to know the internal structure of the `render` package. Typically imports from `render.core` and forwards calls. Acts as a façade for external integration. If another project imports this repo as a library, `html&#95;renderer.py` is the intended interface.</p></td></tr>
<tr><td data-label="Path / File"><p><strong>utils.py</strong><br>Low-level helpers</p></td><td data-label="Explanation"><p>General helper functions not tied specifically to rendering. Could include string utilities, logging setup, configuration loaders, or path helpers. Serves as a catch-all for small functions used in multiple modules. The design keeps `render` modules focused on their domain while avoiding code duplication. Over time, `utils.py` should be refactored into more specific modules if it grows too large.</p></td></tr>
<tr><td data-label="Path / File"><p><strong>helpers.py</strong><br>Convenience helpers</p></td><td data-label="Explanation"><p>Higher-level helper functions that bridge between application logic and rendering. For example, functions to batch render multiple datasets, generate default metadata, or integrate with external libraries. While `utils.py` holds low-level helpers, `helpers.py` contains mid-level convenience functions. Often used directly by `main.py`.</p></td></tr>
<tr><td data-label="Path / File"><p><strong>main.py</strong><br>Entry point</p></td><td data-label="Explanation"><p>Application entry point. When you run the project (`python main.py`), this script is executed. It typically parses command line arguments or configuration, loads data, and then invokes rendering via `core.py` or `html&#95;renderer.py`. This file defines the overall workflow: input → conversion → rendering → output. Users who are not developers mainly interact with this file. It serves as the face of the program.</p></td></tr>
</tbody></table></div>
  <div class='row-count'></div>
</div>
<script src="assets/script.js?v=1758564630" defer></script>
<script src="assets/worker.js?v=1758564630" defer></script>

<script>
(function(){
  const template = "{table}_{date}";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', '');
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) {
          alert('Export refused: html too large');
          return;
        }
        if(window.Worker) {
          const worker = new Worker((function(){
            try{ return 'assets/worker.js'; }catch(e){ return null; }
          })());
          if(worker){
            worker.postMessage({html:html, format:'pdf'});
            worker.onmessage = function(e){ console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
          } else {
            alert('Worker not available');
          }
        } else {
          alert('Export worker not supported in this environment.');
        }
      } catch(err) {
        console.warn('Export failed', err);
        alert('Export worker not available. See console for details.');
      }
    });
  }
})();
</script>

</div>
</body>
</html>