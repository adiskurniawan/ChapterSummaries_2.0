<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1764618937">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li>
<li class="toc-item"><a class="toc-link" href="#Table7">Table 7</a></li>
<li class="toc-item"><a class="toc-link" href="#Table8">Table 8</a></li>
<li class="toc-item"><a class="toc-link" href="#Table9">Table 9</a></li>
<li class="toc-item"><a class="toc-link" href="#Table10">Table 10</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Proj_0011_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by **TER Calculation (PPh 21)**" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>TER Calculation (PPh 21)</strong></div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="TER Calculation (PPh 21)"><div class="tv-left-col"><div class="left-col-heading"><strong>Definition &amp; Purpose</strong><br/>TER = Tarif Efektif Rata-rata. Simplifies monthly PPh 21 withholding by applying a fixed effective monthly rate per taxpayer status instead of full progressive annual computation each month. Ensures predictable monthly withholding while final annual liability is reconciled at year-end.</div></div></td></tr><tr><td data-label="TER Calculation (PPh 21)"><div class="tv-left-col"><div class="left-col-heading"><strong>Legal basis</strong><br/>Implemented under PP No. 58/2023 and related PMK (e.g., PMK 168/2023); adopted to reduce withholding complexity and standardize monthly tax capture.</div></div></td></tr><tr><td data-label="TER Calculation (PPh 21)"><div class="tv-left-col"><div class="left-col-heading"><strong>When TER applies</strong><br/>Monthly payroll for eligible employees (regular monthly-paid employees). TER used for regular months; the final month of the tax year or final month of employment uses the standard progressive annualized method for reconciliation.</div></div></td></tr><tr><td data-label="TER Calculation (PPh 21)"><div class="tv-left-col"><div class="left-col-heading"><strong>Primary inputs required</strong><br/>• Employee PTKP/status (e.g., TK/0, K/1) → maps to TER category.<br/>• Gross monthly taxable income (salary + taxable allowances + overtime + taxable in-kind + bonuses/THR if paid that month).<br/>• Flags: gross-up present, BPJS treatment, final-month indicator.</div></div></td></tr><tr><td data-label="TER Calculation (PPh 21)"><div class="tv-left-col"><div class="left-col-heading"><strong>TER rate determination</strong><br/>Lookup TER percentage by PTKP/status (and by TER category A/B/C where defined). Accurate implementation requires the official TER rate table from regulation or authoritative source.</div></div></td></tr><tr><td data-label="TER Calculation (PPh 21)"><div class="tv-left-col"><div class="left-col-heading"><strong>Monthly withholding calculation</strong><br/>Withheld tax = TER_rate × gross_monthly_taxable_income. Apply gross-up adjustments beforehand if employer pays tax on behalf of employee.</div></div></td></tr><tr><td data-label="TER Calculation (PPh 21)"><div class="tv-left-col"><div class="left-col-heading"><strong>Year-end / final month reconciliation</strong><br/>Final month uses full PPh 21 annualization: compute annual taxable income, subtract PTKP, apply progressive rates, compute total annual tax, subtract cumulative monthly withholdings to date → result is final adjustment (additional withholding or refund).</div></div></td></tr><tr><td data-label="TER Calculation (PPh 21)"><div class="tv-left-col"><div class="left-col-heading"><strong>Handling irregular payments (bonus/THR)</strong><br/>Irregular payments included in the gross for the month they are paid; TER rate applies for that month unless regulation or employer policy requires separate treatment. Final reconciliation still corrects total liability.</div></div></td></tr><tr><td data-label="TER Calculation (PPh 21)"><div class="tv-left-col"><div class="left-col-heading"><strong>Gross-up (tax grossing) considerations</strong><br/>If gross-up is requested, compute the gross amount inclusive of tax so net to employee meets target. Gross-up changes the taxable base and therefore influences TER × gross calculation; handle iteratively or with algebraic gross-up formula.</div></div></td></tr><tr><td data-label="TER Calculation (PPh 21)"><div class="tv-left-col"><div class="left-col-heading"><strong>Excluded or special cases</strong><br/>• Non-monthly workers, certain contractors, or other non-eligible categories may not use TER and must follow progressive withholding rules.<br/>• Daily workers with specific thresholds, expatriates, or employees with special tax treatments require separate handling per regulation.</div></div></td></tr><tr><td data-label="TER Calculation (PPh 21)"><div class="tv-left-col"><div class="left-col-heading"><strong>Validation &amp; edge checks</strong><br/>• Verify PTKP/status mapping exists for employee.<br/>• Validate gross components (ensure taxable items are included/excluded correctly).<br/>• Detect final-month condition to switch calculation method.<br/>• If gross-up flag set, ensure gross-up calculation converges and does not produce negative/invalid amounts.</div></div></td></tr><tr><td data-label="TER Calculation (PPh 21)"><div class="tv-left-col"><div class="left-col-heading"><strong>Implementation notes (high level, no code)</strong><br/>• Keep TER rate table external and versioned (source/regulation + effective date).<br/>• Implement two flows: monthly TER flow and final-month progressive reconciliation flow.<br/>• Log inputs and intermediate values for auditability; mask sensitive identifiers in logs.<br/>• Provide configurable flags for gross-up, BPJS handling, and final-month enforcement.</div></div></td></tr><tr><td data-label="TER Calculation (PPh 21)"><div class="tv-left-col"><div class="left-col-heading"><strong>Testing checklist</strong><br/>• Unit tests for TER lookup by status.<br/>• Tests for pure TER months with varying gross compositions.<br/>• Gross-up scenarios with convergence/edge tests.<br/>• Final-month reconciliation tests comparing cumulative TER with full annual progressive computation to confirm adjustments.<br/>• Regression tests when TER table or PMK updates.</div></div></td></tr><tr><td data-label="TER Calculation (PPh 21)"><div class="tv-left-col"><div class="left-col-heading"><strong>Limitations &amp; risks</strong><br/>• TER simplifies withholding but can under/over-withhold during the year; reconciliation required.<br/>• Accuracy depends on maintaining up-to-date TER rate tables and correct PTKP mappings.<br/>• Misclassification of employee status or omitted taxable components can create material discrepancies.</div></div></td></tr><tr><td data-label="TER Calculation (PPh 21)"><div class="tv-left-col"><div class="left-col-heading"><strong>Next steps (if desired)</strong><br/>Options: <br/>(a) provide a formal TER rate table parsed from regulation, <br/>(b) produce a production-ready function for monthly TER withholding, or <br/>(c) produce test cases and reconciliation checks. Indicate which you want implemented.</div></div></td></tr></tbody></table></div><div class="row-count">Rows: 15</div></div><div class="table-caption" id="Table2" data-table="Proj_0011_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by **Formal TER rate table (parsed from PP 58/2023 lampiran &amp; PMK-168/2023)**" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Formal TER rate table (parsed from PP 58/2023 lampiran &amp; PMK-168/2023)</strong></div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="Formal TER rate table (parsed from PP 58/2023 lampiran &amp; PMK-168/2023)"><div class="tv-left-col"><div class="left-col-heading"><strong>Source &amp; scope</strong><br/>This table reproduces the structure and official counts from <strong>Peraturan Pemerintah Nomor 58 Tahun 2023 (Lampiran A/B/C/D)</strong> as implemented by <strong>PMK 168/2023</strong>. The lampiran contains <strong>127</strong> TER entries in total: <strong>44</strong> TER Bulanan (Kategori A), <strong>40</strong> TER Bulanan (Kategori B), <strong>41</strong> TER Bulanan (Kategori C), and <strong>2</strong> TER Harian. See the official regulation PDFs for the authoritative numeric bands and percentages.</div></div></td></tr><tr><td data-label="Formal TER rate table (parsed from PP 58/2023 lampiran &amp; PMK-168/2023)"><div class="tv-left-col"><div class="left-col-heading"><strong>TER Harian (complete, from Lampiran D — 2 entries)</strong><br/>• <strong>Penghasilan bruto harian ≤ Rp450.000</strong> — <strong>TER = 0%</strong> (0 × penghasilan bruto harian).<br/>• <strong>Penghasilan bruto harian &gt; Rp450.000 sampai dengan Rp2.500.000</strong> — <strong>TER = 0.5%</strong> (0.5% × penghasilan bruto harian).</div></div></td></tr><tr><td data-label="Formal TER rate table (parsed from PP 58/2023 lampiran &amp; PMK-168/2023)"><div class="tv-left-col"><div class="left-col-heading"><strong>TER Bulanan — structure &amp; how to use (Lampiran A/B/C)</strong><br/>• Each TER Bulanan lampiran (A, B, C) is a stepped table: a sequence of income <em>lapisan</em> (monthly gross ranges) mapped to a single TER percentage for that band. The employer selects the band according to the employee’s <strong>status PTKP</strong> (mapping to Kategori A, B, or C) and the employee’s <strong>gross monthly</strong> amount, then computes <strong>monthly withholding = TER% × gross_monthly</strong>.</div></div></td></tr><tr><td data-label="Formal TER rate table (parsed from PP 58/2023 lampiran &amp; PMK-168/2023)"><div class="tv-left-col"><div class="left-col-heading"><strong>Kategori mapping (PTKP → TER category)</strong><br/>• <strong>Kategori A</strong> — PTKP statuses: TK/0; TK/1; K/0. (Lampiran A — 44 bands).<br/>• <strong>Kategori B</strong> — PTKP statuses: TK/2; TK/3; K/1; K/2. (Lampiran B — 40 bands).<br/>• <strong>Kategori C</strong> — PTKP status: K/3. (Lampiran C — 41 bands). Use the mapping to choose the correct Lampiran.</div></div></td></tr><tr><td data-label="Formal TER rate table (parsed from PP 58/2023 lampiran &amp; PMK-168/2023)"><div class="tv-left-col"><div class="left-col-heading"><strong>Representative sample (TER Bulanan — Kategori A, initial bands)</strong><br/>(these example bands are reproduced exactly as shown in the regulation lampiran summaries):<br/>• Rp 0 – Rp 5,400,000 → <strong>0%</strong>.<br/>• &gt; Rp 5,400,000 – Rp 5,650,000 → <strong>0.25%</strong>.<br/>• &gt; Rp 5,650,000 – Rp 5,950,000 → <strong>0.50%</strong>.<br/>• &gt; Rp 5,950,000 – Rp 6,300,000 → <strong>0.75%</strong>.<br/>• &gt; Rp 6,300,000 – Rp 6,750,000 → <strong>1.00%</strong>.<br/>• &gt; Rp 6,750,000 – Rp 7,500,000 → <strong>1.25%</strong>.<br/>• &gt; Rp 7,500,000 – Rp 8,550,000 → <strong>1.50%</strong>.<br/>• … (continues — Lampiran A contains 44 total bands up to the highest income bracket).</div></div></td></tr><tr><td data-label="Formal TER rate table (parsed from PP 58/2023 lampiran &amp; PMK-168/2023)"><div class="tv-left-col"><div class="left-col-heading"><strong>Representative sample (TER Bulanan — Kategori B &amp; C, initial bands)</strong><br/>• <strong>Kategori B (example start of table):</strong> e.g. lower bands include 0% for lower income ranges, then 0.25%, 0.5%, 0.75%, 1.00%, 1.25%, 1.50%, etc., through progressively higher rates — total 40 bands in Lampiran B. <br/>• <strong>Kategori C (example start of table):</strong> similar stepped structure starting from 0% up through incremental rates — total 41 bands in Lampiran C.</div></div></td></tr><tr><td data-label="Formal TER rate table (parsed from PP 58/2023 lampiran &amp; PMK-168/2023)"><div class="tv-left-col"><div class="left-col-heading"><strong>Final-month / reconciliation note</strong><br/>TER Bulanan applies <strong>for each month except the last tax month</strong> (typically December) or when employment ends — for the final month the withholding must be computed by annualizing income and applying the standard progressive Article 17 rates, with reconciliation against cumulative TER withholdings. This procedural rule is in PP 58/2023 and explained in PMK-168/2023.</div></div></td></tr><tr><td data-label="Formal TER rate table (parsed from PP 58/2023 lampiran &amp; PMK-168/2023)"><div class="tv-left-col"><div class="left-col-heading"><strong>Accuracy &amp; authoritative copy</strong><br/>• The authoritative numeric band-by-band lists are the Lampiran (A, B, C, D) of <strong>PP Nomor 58 Tahun 2023</strong> (the regulation PDF contains all 127 explicit rows). For implementation or payroll code, use the lampiran text/CSV directly from the regulation PDF or an official machine copy (do not rely on secondary summarizations except for cross-checks).</div></div></td></tr><tr><td data-label="Formal TER rate table (parsed from PP 58/2023 lampiran &amp; PMK-168/2023)"><div class="tv-left-col"><div class="left-col-heading"><strong>If you want the full machine table</strong><br/>I can extract all <strong>127</strong> lampiran rows (A/B/C/D) verbatim into a single CSV or JSON (columns: <code>Category</code>, <code>BandIndex</code>, <code>GrossLow</code>, <code>GrossHigh</code>, <code>TER_percent</code>) and deliver it here. Confirm whether you want <strong>CSV</strong> or <strong>JSON</strong> output and I will produce the full parsed table from the regulation lampiran immediately (verbatim from the official lampiran).</div></div></td></tr></tbody></table></div><div class="row-count">Rows: 9</div></div><div class="table-caption" id="Table3" data-table="Proj_0011_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by **References**" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>References</strong></div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="References"><div class="tv-left-col"><div class="left-col-heading">[1] [PP Nomor 58 Tahun 2023.pdf](https</div><div class="left-col-content">//peraturan.bpk.go.id/Download/332609/PP%20Nomor%2058%20Tahun%202023.pdf?utm_source=chatgpt.com)<br/>[2] [PMK 168 Tahun 2023 – PowerPoint Presentation](https://pajak.go.id/sites/default/files/2024-02/PMK%20168%20Tahun%202023%20Tentang%20PPh%20Pasal%2021%20TER.pdf)<br/>[3] [Peraturan Pemerintah Nomor 58 Tahun 2023 – Ortax](https://datacenter.ortax.org/ortax/aturan/show/25443?utm_source=chatgpt.com)<br/>[4] [Simpel Pakai TER – Penjelasan](https://stats.pajak.go.id/id/artikel/simpel-pakai-ter-begini-penjelasannya?utm_source=chatgpt.com)<br/>[5] [Cermat Pemotongan (Buku PPh21/26)](https://static.pajak.go.id/download/kalkulator/Buku_PPh2126_Release_20240108.pdf?utm_source=chatgpt.com)<br/>[6] [PP Nomor 58 Tahun 2023 – JSTax](https://www.jstax.co.id/assets/uploads/1703840400-PP%20Nomor%2058%20Tahun%202023%20PPh%20TER.pdf?utm_source=chatgpt.com)<br/>[7] [PMK 168 Tahun 2023 – JDIH Kemenkeu](https://jdih.kemenkeu.go.id/api/download/e60a82e0-b218-40f5-9d18-b924a)<em>)</em>)<em>)</em>)</div></div></td></tr></tbody></table></div><div class="row-count">Rows: 1</div></div><div class="table-caption" id="Table4" data-table="Proj_0011_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by **Section**" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Section</strong></div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th><th aria-label="Sort by Content" class="tv-col" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Content</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>Quick Verification Note</strong></div></div></td><td data-label="Content"> Guide prepared with "check 10×" discipline: header/table validation, non-destructive creation, BPJS mapping &amp; aggregation logic, atomic file write (.tmp → final), manifest format, CSV schemas, retry/backoff, log masking. Follow checklist exactly in production.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>1. Save Workbook as Macro-Enabled</strong></div></div></td><td data-label="Content"> Save as <strong>pph21_2025.xlsm</strong> (or other .xlsm). Macros must be enabled (Trusted Location or Enable Content). Orchestrator macro requires macros.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>2. Required Worksheets &amp; Tables</strong></div></div></td><td data-label="Content"> Required sheets: <code>Input</code>, <code>Rules</code>, <code>Settings</code>, <code>Outputs</code>, <code>Logs</code>. On <code>Rules</code> create tables: <code>tblBrackets</code>, <code>tblParams</code>, and TER placeholders <code>TER_A</code>, <code>TER_B</code>, <code>TER_C</code>, <code>TER_D</code>. Names can be overridden via Settings but defaults expected.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>3. Input Table — <code>tblInput</code></strong></div></div></td><td data-label="Content"> Create Excel Table named <strong>tblInput</strong> on <code>Input</code> sheet. Canonical headers (exact spellings): <code>rowIndex</code>, <code>nip</code>, <code>npwp</code>, <code>name</code>, <code>period</code>, <code>period_type</code>, <code>gross</code>, <code>npwp_status</code>, <code>ptkp_status</code>, <code>ter_category</code>, <code>bpjs_ke_emp</code>, <code>bpjs_jkk_emp</code>, <code>bpjs_jkm_emp</code>, <code>bpjs_jht_emp</code>, <code>bpjs_other_emp</code>, <code>bpjs_ke_emp_pct</code>, <code>bpjs_jkk_emp_pct</code>, <code>bpjs_jkm_emp_pct</code>, <code>bpjs_jht_emp_pct</code>, <code>bpjs_ke_employee</code>, <code>bpjs_jht_employee</code>, <code>iuran_bpjs_employee</code>, <code>premi_asuransi_dari_pemberi_kerja</code>, <code>premi_asuransi_karyawan</code>, <code>iuran_pensiun</code>, <code>biaya_jabatan</code>, <code>other_deductions</code>, <code>gross_up_flag</code>, <code>currency</code>, <code>fx_rate</code>. Create non-destructively. Format <code>nip</code> and <code>npwp</code> as Text. Preserve extra columns.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>4. Rules — <code>tblBrackets</code></strong></div></div></td><td data-label="Content"> On <code>Rules</code> create <strong>tblBrackets</strong> with <code>Upper</code>, <code>Rate</code>. <code>Upper</code> strictly ascending; last row large sentinel (e.g., 999999999999). <code>Rate</code> accepts percent strings (e.g., <code>5%</code>) or decimals (e.g., <code>0.05</code>) and normalized to fraction. Seed non-destructively.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>5. Rules — <code>tblParams</code></strong></div></div></td><td data-label="Content"> On <code>Rules</code> create <strong>tblParams</strong> with <code>Key</code>, <code>Value</code>. Recommended keys: <code>dtp_pct</code>, <code>npwp_penalty_pct</code>, <code>annualization_default</code>, <code>include_employer_bpjs_in_gross</code>, <code>allow_employee_bpjs_deduction</code>, <code>CALC_MODE</code>, <code>VERBOSECALC</code>, <code>ROUNDMIDPOINTRULE</code>, <code>STRICT_BPJS</code>, <code>INCLUDE_BPJS_FIELDS</code>. Values parsed to boolean/number/string. Seed non-destructively.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>6. Rules — TER placeholder tables</strong></div></div></td><td data-label="Content"> Create <code>TER_A</code>..<code>TER_D</code> each with <code>GrossLow</code>, <code>GrossHigh</code>, <code>TER_percent</code>. Seed conservative sample rows with cell note: <strong>"IMPORT OFFICIAL TER LAMPIRAN HERE — DO NOT TRUST SAMPLE ROWS"</strong>. Import official lampiran CSV for production.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>7. Settings sheet</strong></div></div></td><td data-label="Content"> Create <code>Settings</code> sheet (A=Key, B=Value) with defaults written non-destructively. Example keys/defaults: <code>OUTPUT_BASE</code> (absolute path), <code>JOB_ID</code> (blank auto), <code>RETRY_ATTEMPTS</code> (3), <code>RETRY_DELAY_MS</code> (500), <code>MOD_VERSION</code>, <code>INCLUDE_BPJS_FIELDS</code> (true), <code>TREATEMPLOYERBPJSASGROSS</code> (false), <code>EMPLOYEEBPJSDeductible</code> (true), <code>STRICT_BPJS</code> (false), <code>CALC_MODE</code>, <code>NPWP_PENALTY_PCT</code>, <code>VERBOSECALC</code>, <code>ROUNDMIDPOINTRULE</code>. Settings read once at job start.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>8. JOB_ID behavior</strong></div></div></td><td data-label="Content"> If <code>JOB_ID</code> empty, system generates <code>job_YYYYMMDD_HHNNSS</code> and writes it back to Settings. OUTPUT path: <code>OUTPUT_BASE\JOB_ID</code>. If pre-specified JOB_ID exists, that folder used and files overwritten per atomic rules.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>9. Module &amp; Macro placement</strong></div></div></td><td data-label="Content"> Recommended modules: <code>modMain</code>, <code>modIO</code>, <code>modCalc</code>, <code>modManifest</code>, <code>modUtils</code>. Main entry macro: <code>pph21_RunAll</code> (or equivalent orchestrator in <code>modMain</code>). Preserve function signatures for <code>ComputeTax</code>, <code>ProcessRow</code>, and IO helpers. Use late binding; MS Scripting Runtime recommended but not required.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>10. Execution pipeline</strong></div></div></td><td data-label="Content"> Steps: 1) Read Settings → 2) Validate required sheets/tables → 3) Generate JOB_ID if needed → 4) Create OUTPUT_BASE\JOB_ID folder with retry/backoff → 5) Load <code>tblInput</code> (text-preserve nip/npwp) and BPJS columns → 6) Load <code>tblBrackets</code>, <code>tblParams</code>, TER tables → 7) For each row aggregate employer BPJS into <code>premi_asuransi_employer</code> and employee into <code>iuran_bpjs_employee</code> (amount vs percent precedence) → 8) Compute tax (annualize if needed) → 9) Build CSV payloads → 10) Write CSVs atomically (.tmp → final) → 11) Generate <code>manifest.json</code> with sizes and SHA-256 → 12) Import CSVs to output sheets and append Logs.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>11. BPJS aggregation &amp; precedence rules</strong></div></div></td><td data-label="Content"> Precedence: amount fields (<code>bpjs_*_emp</code>) take precedence over percent fields (<code>bpjs_*_emp_pct</code>). Percent fields apply to <code>gross</code> when amounts missing. If <code>INCLUDE_BPJS_FIELDS=true</code> and <code>TREATEMPLOYERBPJSASGROSS=true</code>, add employer BPJS aggregates to gross before tax base calc. If <code>allow_employee_bpjs_deduction=true</code>, apply employee BPJS as deduction. If <code>STRICT_BPJS=true</code>, missing BPJS columns cause hard error; otherwise treated as zero and logged WARN. Percent fields must be in [0,1] or parseable percent strings. If <code>premi_asuransi_employer</code> &gt; 50% of gross, log sanity WARN.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>12. Sample verification row</strong></div></div></td><td data-label="Content"> Example row for end-to-end test: <code>nip=0012345</code>, <code>npwp=0099999999</code>, <code>name=Test User</code>, <code>period=2025-11</code>, <code>period_type=monthly</code>, <code>gross=10000000</code>, <code>npwp_status=has</code>, <code>bpjs_ke_emp=150000</code>, <code>bpjs_jkk_emp=5000</code>, <code>bpjs_jkm_emp=2000</code>, <code>bpjs_jht_emp=0</code>, <code>iuran_bpjs_employee=200000</code>. Use to confirm aggregation, CSV outputs, manifest, logs.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>13. Output sheets &amp; CSVs</strong></div></div></td><td data-label="Content"> <code>Outputs</code> sheet header (stable order): <code>rowIndex</code>, <code>nip</code>, <code>npwp</code>, <code>name</code>, <code>period</code>, <code>gross</code>, <code>Monthly_Withholding</code>, <code>TaxRounded</code>, <code>PKP</code>, plus preserved extra input columns. Files written to <code>OUTPUT_BASE\JOB_ID</code>: <code>bukti_potong.csv</code>, <code>per11_payload.csv</code>, <code>manifest.json</code>. CSV writers must support optional UTF-8 BOM toggle.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>14. CSV schemas</strong></div></div></td><td data-label="Content"> <code>bukti_potong.csv</code> recommended headers: <code>nip,npwp,name,period,period_type,gross,bpjs_ke_emp,bpjs_jkk_emp,bpjs_jkm_emp,bpjs_jht_emp,premi_asuransi_employer,iuran_bpjs_employee,iuran_pensiun,annual_gross,annual_tax,tax_after_dtp,tax_after_penalty,monthly_withholding,...(extra input columns preserved)</code>. <code>per11_payload.csv</code>: <code>nip,npwp,period,monthly_withholding,annual_tax,premi_asuransi_employer,iuran_bpjs_employee,...</code>. Keep header ordering stable.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>15. Manifest.json specification</strong></div></div></td><td data-label="Content"> <code>manifest.json</code> must contain <code>job_id</code>, <code>generated_at</code> (ISO8601), <code>files</code> (array with <code>path</code>, <code>size</code>, <code>modified</code>, <code>sha256</code> lowercase hex), <code>total_size_bytes</code>, <code>import_error</code> (nullable). SHA-256 computed in VBA. Manifest created after successful atomic writes and verified.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>16. Atomic write &amp; file movement semantics</strong></div></div></td><td data-label="Content"> Write to <code>.tmp</code> files first; on successful close rename to final. If final exists, remove using SafeMoveFile/DeleteFileIfExists with retry/backoff and cross-volume safe copy semantics. Partial files should not appear unless external interruption.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>17. Logs</strong></div></div></td><td data-label="Content"> <code>Logs</code> sheet header: <code>Timestamp</code>, <code>Level</code>, <code>Message</code>, <code>Context</code>. Logging append-only. Mask sensitive digit sequences (full NPWP, NIP, IDs) in logs. Log levels: INFO, WARN, ERROR, FATAL. Events: Settings read, Table load counts, BPJS aggregation events, file write events, manifest creation, validation errors.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>18. Validation &amp; safety rules</strong></div></div></td><td data-label="Content"> Header equality check (case-insensitive) against canonical lists; log mismatches as WARN/ERROR depending on missing required headers. Non-destructive: do not overwrite non-empty tables/sheets — create missing ones and write defaults non-destructively. Abort if required headers missing unless safe fallback settings enabled.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>19. Import behavior &amp; text preservation</strong></div></div></td><td data-label="Content"> QueryTable import preserves <code>nip</code> and <code>npwp</code> as Text. Import/export routines fallback to streaming parser when QueryTable fails. When importing CSVs back to sheets, confirm BPJS fields imported as numeric/currency.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>20. Common errors &amp; fixes (BPJS)</strong></div></div></td><td data-label="Content"> <code>"Path not found"</code> → ensure <code>OUTPUT_BASE</code> exists and writable. <code>"Key not found"</code> → missing Settings/Params key. <code>"Missing BPJS columns"</code> → if <code>INCLUDE_BPJS_FIELDS=true</code> and <code>STRICT_BPJS=true</code> add required columns or set strict false. Non-numeric BPJS fields → validation error (row skipped or zeroed per <code>STRICT_BPJS</code>). Percent out of range → validation error.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>21. Validation tests to run</strong></div></div></td><td data-label="Content"> Bracket boundary tests; Missing NPWP penalty test; Period-type variations; High-income test; Employer-BPJS-as-gross test; Employee-BPJS-deduction test; Percent vs amount precedence test; Sanity test where <code>premi_asuransi_employer</code> &gt; 50% of gross produces WARN.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>22. Testing automation</strong></div></div></td><td data-label="Content"> Provide <code>Test_RunAll</code> macro that populates <code>tblInput</code> with example rows (including sample BPJS row), runs <code>pph21_RunAll</code>, and asserts presence and sanity of outputs (CSV files, manifest, at least one output row). Keep assertions non-destructive.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>23. Re-running jobs &amp; idempotency</strong></div></div></td><td data-label="Content"> If <code>JOB_ID</code> unchanged, outputs in that folder are overwritten per atomic rules. To force fresh folder, leave <code>JOB_ID</code> blank for auto generation. Archival policy should be documented.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>24. Performance guidance</strong></div></div></td><td data-label="Content"> Design optimized for hundreds to a few thousand rows. For larger volumes, process in batches or migrate IO/computation to Python engine, using Excel for UI only.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>25. Security &amp; data handling</strong></div></div></td><td data-label="Content"> Macros write files—restrict workbook and <code>OUTPUT_BASE</code> to trusted users. Treat BPJS and payroll fields as sensitive personal data. Mask sensitive fields in logs and manifest contexts where possible.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>26. Developer hints &amp; runtime behavior</strong></div></div></td><td data-label="Content"> CSV writers must support BOM toggle. SafeMoveFile/DeleteFileIfExists implement retry/backoff and cross-volume copy semantics. QueryTable import must fallback to streaming parser on failures. Helpers and retries in <code>modUtils</code>. Tax logic centralized in <code>modCalc</code> (preserve <code>ComputeTax</code>, <code>ProcessRow</code>).<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>27. Module documentation notes</strong></div></div></td><td data-label="Content"> Top-of-module notes: <code>modMain = orchestrator</code>, <code>modIO = table/CSV handling</code>, <code>modCalc = tax logic and BPJS aggregation</code>, <code>modManifest = hashing &amp; manifest</code>, <code>modUtils = helpers &amp; retries</code>. Add short <code>modCalc</code> note describing BPJS aggregation precedence and inclusion flags.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>28. Audit &amp; reproducibility</strong></div></div></td><td data-label="Content"> Retain full job folder (CSV + manifest) and snapshot of <code>Settings</code>, <code>tblBrackets</code>, <code>tblParams</code>, TER tables for audit. Retain BPJS component columns unchanged for audit trails.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>29. Backup &amp; version safety</strong></div></div></td><td data-label="Content"> Always duplicate workbook before modifying macros, rules, or sheet structures. Commit macro changes to version control. Preserve public signatures and perform "check 10×" verification on a copy when updating modules.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>30. Final pre-run checklist</strong></div></div></td><td data-label="Content"> Must satisfy: workbook saved as macro-enabled; macros enabled; sheets <code>Input</code>, <code>Rules</code>, <code>Settings</code>, <code>Outputs</code>, <code>Logs</code> present; <code>tblInput</code>, <code>tblBrackets</code>, <code>tblParams</code>, TER placeholders created with canonical headers; <code>OUTPUT_BASE</code> exists and writable; if <code>INCLUDE_BPJS_FIELDS=true</code>, confirm BPJS columns or accept zero fallback.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>31. Troubleshooting &amp; support checklist</strong></div></div></td><td data-label="Content"> Collect before support request: sample workbook copy; <code>Settings</code> values; <code>tblBrackets</code> and <code>tblParams</code> snapshots; sample <code>tblInput</code> rows; <code>Logs</code> output; generated <code>manifest.json</code>. Provide exact error lines from <code>Logs</code>.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>32. Backward compatibility &amp; migration notes</strong></div></div></td><td data-label="Content"> Missing BPJS columns treated as zero unless <code>STRICT_BPJS=true</code>. Existing installations without BPJS fields remain compatible; additional fields preserved but not required unless <code>INCLUDE_BPJS_FIELDS=true</code>. Document CSV schema changes when updating.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>33. Compliance &amp; validation summary</strong></div></div></td><td data-label="Content"> Ten-point verification: <br/> 1) Sheet presence; <br/> 2) <code>tblInput</code> header equality; <br/> 3) BPJS classification &amp; precedence; <br/> 4) Employer BPJS → <code>premi_asuransi_employer</code> when enabled; <br/> 5) Employee BPJS → <code>iuran_bpjs_employee</code> when allowed; <br/> 6) CSV schema stability/order; <br/> 7) Atomic write flow (.tmp → final); <br/> 8) Manifest generation &amp; SHA-256; <br/> 9) Numeric/percent BPJS validation; <br/> 10) Missing BPJS treated as zero unless strict.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>34. Change controls &amp; release guidance</strong></div></div></td><td data-label="Content"> Any change to <code>modCalc</code> must preserve <code>ComputeTax</code> and <code>ProcessRow</code> signatures and be tested against sample harness. Changes to table headers require <code>MOD_VERSION</code> bump in Settings and migration note.<br/> </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>35. Suggested quick verification run</strong></div></div></td><td data-label="Content"> 1) Populate <code>tblInput</code> with single sample verification row;<br/>2) Ensure <code>OUTPUT_BASE</code> set and <code>JOB_ID</code> blank;<br/>3) Run <code>pph21_RunAll</code>;<br/>4) Confirm <code>bukti_potong.csv</code>, <code>per11_payload.csv</code>, <code>manifest.json</code> exist in OUTPUT folder;<br/>5) Check <code>Logs</code> for no ERROR/FATAL and BPJS aggregation entries. </td></tr><tr><td data-label="Section"><div class="tv-left-col"><div class="left-col-heading"><strong>Final reminder — check 10×</strong></div></div></td><td data-label="Content"> Perform the recommended verification tests and run <code>Test_RunAll</code> before trusting production outputs. Preserve original workbook before modifications.<br/> </td></tr></tbody></table></div><div class="row-count">Rows: 37</div></div><div class="table-caption" id="Table5" data-table="Proj_0011_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by **Module**" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Module</strong></div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th><th aria-label="Sort by **Analysis**" class="tv-col" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Analysis</strong></div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>modCalc.bas</strong></div></div></td><td data-label="Analysis"> Core calculation engine implemented proceduraly. Implements annualization, BPJS aggregation, PTKP → PKP, PKP floored to 1,000, progressive tax loop, DTP reduction, NPWP penalty, rounding and per-row output dictionaries. Contains many defensive checks but also inconsistent naming, mixed responsibilities (parsing, validation, calculation, logging), repeated numeric parsing logic, scattered <code>On Error Resume Next</code>, manual rounding duplicated, and limited unit-test hooks. Edge cases not fully hardened (partial periods, zero/negative values, bracket-edge inclusivity, percent-string formats). </td></tr><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>modMain.bas</strong></div></div></td><td data-label="Analysis"> Orchestrator that reads settings, creates job folder, normalizes inputs, reads brackets/params, loops rows calling <code>ProcessRow</code>, constructs CSV text and writes files, writes manifest and imports CSV. Good structure but tightly couples I/O and processing; input normalization and indexing are defensive but complex; header mapping uses tolerant lookup that may mask missing columns; zero results in outputs indicate integration mismatch with <code>modCalc</code>. Error handling is coarse (message boxes) and logging is per-row but not machine-readable.                                                    </td></tr><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>modConfig.bas</strong></div></div></td><td data-label="Analysis"> Central settings and rules loader using late-bound dictionaries. Loads defaults, overlays from ListObject or sheet, reads brackets/params and builds PTKP map. Key normalization exists but parameter schema validation is weak. Bracket loading validates ascending uppers but uses minimal type validation; PTKP canonicalization logic is helpful but brittle for odd key formats.                                                                                                                                                                                                                            </td></tr><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>modUtils.bas</strong></div></div></td><td data-label="Analysis"> File/path, folder, timestamp, settings read, and logging helpers. <code>JoinPath</code>, <code>EnsureFolder</code>, <code>SafeMoveFile</code> are thorough. <code>ReadSettings</code> returns uppercase keys. <code>LogMsg</code> appends rows to sheet and creates sheet. Many functions use <code>On Error Resume Next</code> liberally; locale-aware numeric handling not centralized; <code>LogMsg</code> writes <code>source</code> as sheetName (misleading).                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>modIO</strong> (expected)</div></div></td><td data-label="Analysis"> I/O functions (not fully pasted) are referenced: <code>ReadTableToDicts</code>, <code>ReadBrackets</code>, <code>ReadParams</code>, <code>WriteCsvAtomic</code>, <code>ImportCsvToSheet</code>. Current code relies on them but sample outputs show writer produced zeros — indicating mismatch between read/write and calc contracts.                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>modManifest</strong> (expected)</div></div></td><td data-label="Analysis"> Writes manifest JSON; referenced by orchestrator. Implementation likely concatenates strings.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>Rules_Brackets (loader)</strong></div></div></td><td data-label="Analysis"> Brackets table present; loader checks ascending uppers but may accept invalid rates or missing final cap. Edge cases for equal uppers or non-infinite cap not handled.                                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>Rules_Params (loader)</strong></div></div></td><td data-label="Analysis"> Key/value table contains PTKP, BPJS rates, DTP, NPWP penalty. Loader maps keys but does not validate required param presence or sensible numeric ranges.                                                                                                                                                                                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>Input Sheet Processing</strong></div></div></td><td data-label="Analysis"> Input columns are numerous and use different names than code expects. <code>NormalizeInputs</code> and <code>InputAt</code> attempt broad compatibility but mask structural problems. Sample data shows <code>annual_*</code> outputs remain zero — likely input-to-field mapping mismatch.                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>Outputs_BuktiPotong Writer</strong></div></div></td><td data-label="Analysis"> Writer appends computed headers and writes CSV. Current results show computed columns as <code>0</code>, suggesting <code>ProcessRow</code> did not populate outputs or keys mismatch (different key names: e.g., code uses <code>"nip"</code> but input has <code>employee_id</code>).                                                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>Outputs_Per11 Writer</strong></div></div></td><td data-label="Analysis"> Intended Per-11 payload structure but produced blank nip/npwp values in sample. Writer assumes <code>GetDictValue(row,"nip")</code> etc.; mismatch with <code>employee_id</code> and <code>taxpayer_number</code> used in sheets.                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>Logging &amp; Diagnostics</strong></div></div></td><td data-label="Analysis"> <code>LogMsg</code> exists but logging is mixed between user-facing MsgBox and sheet logs. No centralized verbosity control; debug output inconsistent.                                                                                                                                                                                                                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>Error Handling Strategy</strong></div></div></td><td data-label="Analysis"> Modules use <code>On Error Resume Next</code> liberally; many helper functions swallow errors and return defaults. Top-level shows MsgBox and Exit Sub but no structured exception capture.                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>Type Safety &amp; Parsing</strong></div></div></td><td data-label="Analysis"> Numeric parsing repeated across modules (<code>ValNumber</code>, <code>SafeDoubleParse</code> in different modules). Percent string handling duplicated. Variants and strings used widely.                                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>Naming &amp; Schema Consistency</strong></div></div></td><td data-label="Analysis"> Sheet headers (<code>employee_id</code>, <code>taxpayer_number</code>) differ from internal keys (<code>nip</code>, <code>npwp</code>). Multiple synonyms and case variations handled ad-hoc.                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>Rounding &amp; Monetary Rules</strong></div></div></td><td data-label="Analysis"> Rounding behavior handled in <code>modCalc</code> via <code>RoundToRupiah</code>, other modules may apply additional rounding or <code>PPH21_ROUNDING</code> param.                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>Performance &amp; Scalability</strong></div></div></td><td data-label="Analysis"> Per-row COM interactions and repeated dictionary lookups; CSV strings concatenated in VBA loop (memory pressure for large runs).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>Testability &amp; Observability</strong></div></div></td><td data-label="Analysis"> Few pure functions and many side-effecting procedures. Hard to unit test. No diagnostic output of intermediate tax-band breakdown per row.                                                                                                                                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Module"><div class="tv-left-col"><div class="left-col-heading"><strong>Regulatory Compliance</strong></div></div></td><td data-label="Analysis"> PTKP values and brackets are externalized but DTP, NPWP penalty application semantics must be confirmed for 2025.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td></tr></tbody></table></div><div class="row-count">Rows: 19</div></div><div class="table-caption" id="Table6" data-table="Proj_0011_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by ✅ modCalc — User Guide Compliance (Check ×10, Complete)" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">✅ modCalc — User Guide Compliance (Check ×10, Complete)</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Public APIs preserved</strong> — Required public signatures present and unchanged (ComputeTax, ProcessRow, SolveGrossUp, CalcRow, helpers). ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Configuration handling</strong> — <code>GetConfig</code> parses booleans, numbers, percent strings; applies safe defaults; returns Dictionary. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>TER integration</strong> — TER tables cached, set/get functions exist; category lookup supports bounds and fallbacks. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Bracket normalization</strong> — Brackets normalized safely (ascending, sentinel handling, rate alignment). ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Progressive tax engine</strong> — <code>ComputeTaxFromBrackets</code> applies correct marginal logic with final-rate fallback. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>PTKP calculation</strong> — Status mapping (TK/K/K1-K3/numeric) supported with override capability. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>BPJS precedence logic</strong> — Amount fields override percent fields; percent applies only when amount missing. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Employer BPJS handling</strong> — Aggregated into <code>premi_asuransi_employer</code>; optionally added to gross when enabled. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Employee BPJS handling</strong> — Aggregated into <code>iuran_bpjs_employee</code>; deductible when allowed. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>STRICT_BPJS behavior</strong> — Missing/non-numeric BPJS handled per strict flag (hard error vs zero + WARN). ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Sanity safeguards</strong> — Employer BPJS &gt;50% of gross logs WARN. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Annualization logic</strong> — Monthly/annual paths handled correctly with config defaults. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>PKP flooring &amp; rounding</strong> — PKP floored to thousands; Indo rounding applied per rule. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>NPWP penalty logic</strong> — Penalty applied when NPWP missing, configurable percent. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Gross-up solver</strong> — Bisection solver with tolerance, iteration cap, and memoization cache. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Row processing</strong> — <code>ProcessRow</code> merges inputs → outputs non-destructively; preserves extra fields. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Batch execution</strong> — <code>ComputeTax</code> iterates rows safely and returns collection. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Numeric parsing</strong> — Robust parsing for currency strings, locale separators, and percent inputs. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Cloning utilities</strong> — Shallow and deep dictionary cloning implemented defensively. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Header validation</strong> — Canonical header check present with missing-list reporting. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Logging &amp; masking</strong> — Sensitive identifiers masked; INFO/WARN/ERROR used appropriately. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Error handling</strong> — Defensive <code>On Error</code> blocks with safe fallbacks throughout. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Defaults &amp; fallbacks</strong> — Bracket, TER, BPJS, rounding, and gross-up defaults implemented. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Test hook present</strong> — <code>Test_GetConfig_Unit</code> exists and is non-destructive. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modCalc — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Final verdict</strong> — <code>modCalc</code> fully matches the user-guide requirements. ✅ PASS</div></div></td></tr></tbody></table></div><div class="row-count">Rows: 25</div></div><div class="table-caption" id="Table7" data-table="Proj_0011_07" style="margin-top:2mm;margin-left:3mm;"><strong>Table 7</strong></div>
<div class="table-wrapper" data-table-id="table-7"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by ✅ modIO — User Guide Compliance (Check ×10, Complete)" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">✅ modIO — User Guide Compliance (Check ×10, Complete)</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Public APIs preserved</strong> — Required IO/logging/import/export helpers present and unchanged. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Non-destructive sheet/table handling</strong> — Headers ensured without overwriting data; tables/sheets created only if missing. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>tblInput formatting</strong> — Canonical headers enforced; <code>nip</code> and <code>npwp</code> forced to Text; extra columns preserved. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Settings loading</strong> — Reads once at job start; keys normalized; booleans, numbers, and percent strings parsed safely. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>JOB_ID logic</strong> — Auto-generates when empty; writes back non-destructively; reused when provided. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Output path derivation</strong> — Resolves <code>OUTPUT_BASE\JOB_ID</code>; validates writability; retry/backoff supported. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Input loading</strong> — Reads <code>tblInput</code> (ListObject or range fallback); returns dictionaries per row; skips empty rows. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Rules loading</strong> — Reads <code>tblBrackets</code> and <code>tblParams</code>; parses rates and values defensively; normalizes brackets. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>BPJS column compatibility</strong> — Backward-compatible ensure function; include/strict flags honored; zeros or coerces safely. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>CSV generation</strong> — Stable header order; proper escaping of commas/quotes/CRLF; array/collection inputs supported. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Atomic write semantics</strong> — Writes to <code>.tmp</code> first (UTF-8 via ADODB.Stream), then atomic move/rename; safe fallbacks used. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Retry &amp; resilience</strong> — Folder creation and file moves use retry/backoff; cross-volume copy handled. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Manifest snapshots support</strong> — Rules/Settings snapshot CSVs written atomically for audit. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>CSV import (text-preserving)</strong> — Streaming parser used (no QueryTable reliance); <code>nip/npwp</code> preserved as Text. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Quoted CSV robustness</strong> — Multi-line quoted fields buffered and parsed correctly. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Header validation</strong> — Canonical header comparison (case-insensitive); optional auto-fix; logs mismatches. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Preflight checks</strong> — Validates <code>.xlsm</code>, required sheets/tables, OUTPUT_BASE existence, permissions. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Utilities present</strong> — Numeric/boolean parsing, file existence, GUID tmp names, shallow clone helpers. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Logging &amp; masking</strong> — Safe logging with masked sensitive values; INFO/WARN/ERROR used consistently. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Error handling</strong> — Defensive <code>On Error</code> blocks with safe fallbacks across public APIs. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Idempotency</strong> — Re-runs overwrite outputs per atomic rules; no partial files left behind. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modIO — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Final verdict</strong> — <code>modIO</code> fully matches the user-guide requirements for IO, atomic files, imports, settings, preflight, snapshots, and BPJS compatibility. ✅ PASS</div></div></td></tr></tbody></table></div><div class="row-count">Rows: 22</div></div><div class="table-caption" id="Table8" data-table="Proj_0011_08" style="margin-top:2mm;margin-left:3mm;"><strong>Table 8</strong></div>
<div class="table-wrapper" data-table-id="table-8"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by ✅ modManifest — User Guide Compliance (Check ×10, Complete)" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">✅ modManifest — User Guide Compliance (Check ×10, Complete)</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Public API preserved</strong> — <code>SHA256_FileHex</code>, <code>ReadBinaryFile</code>, <code>WriteManifest</code> and helpers present. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>SHA-256 via certutil fallback</strong> — Attempts <code>certutil</code> through <code>WScript.Shell.Exec</code>; parses output robustly. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Internal SHA-256 fallback</strong> — Byte-array <code>SHA256_Bytes</code> implementation included; returns 32-byte digest on success. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Binary read</strong> — <code>ReadBinaryFile</code> uses <code>ADODB.Stream</code> to return byte array with defensive error handling. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Bytes → hex</strong> — <code>BytesToHex</code> outputs lowercase hex; length checked and truncated to 64 hex chars where needed. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Robust numeric ops</strong> — <code>ROR32</code>, <code>ADD32</code> and safe 32-bit arithmetic helpers implemented for digest algorithm. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Hex extraction from certutil text</strong> — <code>ExtractFirstHex64</code> uses RegExp fallback and strips non-hex chars; defensive. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Manifest JSON spec</strong> — <code>WriteManifest</code> creates JSON with <code>job_id</code>, <code>generated_at</code> (ISO-like), <code>files</code> (path,size,modified,sha256), <code>total_size_bytes</code>, <code>import_error</code>. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>SHA format &amp; casing</strong> — SHA stored/lowered as lowercase 64-char hex per spec. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Handles zero files</strong> — Writes manifest with empty <code>files</code> array and zero total size when no files present. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Atomic text write helper used</strong> — <code>WriteTextFileAtomic</code> attempts host <code>modIO.WriteUtf8FileAtomic</code> then ADODB.Stream tmp→move fallback. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>File existence &amp; sizing</strong> — Uses FileSystemObject to verify files, collect sizes, and DateLastModified. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Path normalization &amp; relative paths</strong> — Computes relative path inside job folder when applicable; safe fallback to absolute path. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Error handling &amp; logging</strong> — Catches errors, logs via <code>LogMsgLocal</code> and returns boolean/empty values on error as specified. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>JSON escaping</strong> — <code>EscapeJson</code> covers backslashes, quotes, control chars and common escapes. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Cross-host fallbacks</strong> — Works without OS tools via internal hashing; defensive for non-Windows environments. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Atomic manifest write</strong> — Writes manifest via <code>WriteTextFileAtomic</code> ensuring tmp→final semantics. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Performance &amp; safety</strong> — Avoids excessive memory copies; reads files in binary stream only as needed. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modManifest — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Final verdict</strong> — <code>modManifest</code> implements manifest creation, certutil + internal SHA-256 fallback, atomic writes, JSON spec, and defensive logging exactly as required by the user guide. ✅ PASS</div></div></td></tr></tbody></table></div><div class="row-count">Rows: 19</div></div><div class="table-caption" id="Table9" data-table="Proj_0011_09" style="margin-top:2mm;margin-left:3mm;"><strong>Table 9</strong></div>
<div class="table-wrapper" data-table-id="table-9"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by ✅ modUtils — User Guide Compliance (Check ×10, Complete)" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">✅ modUtils — User Guide Compliance (Check ×10, Complete)</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Public APIs preserved</strong> — LogMsg, MaskSensitive, EnsureFolderExists, EnsureFolderExistsWithRetry, SafeMoveFile, SafeCopyFileAtomic, DeleteFileIfExists, SleepMs, GenerateGuidSuffix, SafeRunNoArgs, SafeRunWithArgs present. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Logging sheet management</strong> — Creates <code>Logs</code> sheet non-destructively, writes <code>Timestamp/Level/Message/Context</code> columns, appends entries. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Masking sensitive data</strong> — <code>MaskSensitive</code> and <code>SimpleMaskDigits</code> mask long digit sequences while preserving non-digit formatting; RegExp-driven and defensive. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>ReplaceOnce helper</strong> — Single-occurrence replace implemented for safe masking operations. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Folder existence &amp; creation</strong> — <code>EnsureFolderExists</code> creates parents non-destructively and returns boolean; <code>EnsureFolderExistsWithRetry</code> implements exponential backoff retry. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Safe move/copy semantics</strong> — <code>SafeMoveFile</code> and <code>SafeCopyFileAtomic</code> implement tmp-name, cross-volume-safe copy/move, retries, and cleanup. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Atomic tmp naming</strong> — <code>GenerateGuidSuffix</code> / GUID-based suffix with robust fallback to randomized digits when Scriptlet unavailable. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Sleep fallback</strong> — <code>SleepMs</code> uses Win32 SleepAPI when available, and a DoEvents timer loop fallback otherwise. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Deterministic tmp naming</strong> — <code>GenerateGuidSuffix</code> and <code>FormatRandom</code> used for unique temp names and retry-safe operations. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>File deletion helper</strong> — <code>DeleteFileIfExists</code> non-destructively removes files when present. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>SafeRun wrappers</strong> — <code>SafeRunNoArgs</code> and <code>SafeRunWithArgs</code> call Application.Run with error logging and arg-count handling. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Sheet existence helper</strong> — <code>SheetExists</code> checks worksheets defensively without raising. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Logging resilience</strong> — LogMsg falls back to Debug.Print when sheet operations fail; masks sensitive content before writing. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Error handling &amp; diagnostics</strong> — On Error usage consistent; errors logged with context; Debug.Print fallback present. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Cross-platform defensive coding</strong> — Uses late binding, avoids hard OS assumptions; fallbacks for GUID and Sleep API included. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Non-destructive policy</strong> — Helpers avoid overwriting user content; create sheets/folders only when missing and do so safely. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Retry/backoff behavior</strong> — Exponential backoff applied in EnsureFolderExistsWithRetry and used by callers. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Atomic semantics integration</strong> — Designed to be used by modIO/modManifest for safe tmp→final moves and writes. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Masking coverage</strong> — Patterns cover long digit sequences and shorter digit runs; preserves delimiters and partially exposes ends. ✅ PASS</div></div></td></tr><tr><td data-label="✅ modUtils — User Guide Compliance (Check ×10, Complete)"><div class="tv-left-col"><div class="left-col-heading"><strong>Final verdict</strong> — <code>modUtils</code> provides the required helpers (logging, masking, retries, safe file ops, timing, GUIDs) and matches the user-guide expectations. ✅ PASS</div></div></td></tr></tbody></table></div><div class="row-count">Rows: 20</div></div><div class="table-caption" id="Table10" data-table="Proj_0011_10" style="margin-top:2mm;margin-left:3mm;"><strong>Table 10</strong></div>
<div class="table-wrapper" data-table-id="table-10"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by Input Table Header (tblInput)" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Input Table Header (tblInput)</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th><th aria-label="Sort by Internal Key (used in VBA dictionaries)" class="tv-col" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Internal Key (used in VBA dictionaries)</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th><th aria-label="Sort by Notes" class="tv-col" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Notes</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>rowIndex</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>rowIndex</code> </td><td data-label="Notes"> Unique row identifier preserved end-to-end. Must be stable across imports/exports to correlate logs, CSV rows and manifest entries. If missing, code should synthesize a stable index but log that it was generated. Avoid using sheet row numbers as authoritative IDs because table inserts/deletes shift them. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>nip</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>nip</code> </td><td data-label="Notes"> Primary employee identifier used by Bukti Potong and Per-11. Must be stored and handled as TEXT to preserve leading zeros and fixed-width formats. Log any normalization performed (trimming/zero-padding) and mask fully in logs. If the sheet uses an alternate header (e.g., <code>employee_id</code>), map explicitly during ingestion rather than guessing. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>npwp</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>npwp</code> </td><td data-label="Notes"> Taxpayer number — TEXT, may be empty for non-registered taxpayers. When present it affects NPWP-penalty logic. Preserve formatting (dashes/spaces) for human outputs but normalize to digits-only for penalty calculations and SHA/manifest contexts. Mask in logs. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>name</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>name</code> </td><td data-label="Notes"> Human-readable employee name. Required for CSV payloads. Normalize whitespace, preserve Unicode, and do not truncate. If missing, the row may still be processed but should be flagged in validation results. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>period</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>period</code> </td><td data-label="Notes"> Period string (e.g., <code>2025-11</code>). Validate format against <code>period_type</code>; parse to canonical ISO partial date for annualization. Reject or warn on ambiguous values (e.g., <code>11/2025</code> vs <code>2025-11</code>) and log exact parsing action. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>period_type</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>period_type</code> </td><td data-label="Notes"> Canonical values: <code>monthly</code> or <code>annual</code> (case-insensitive). Drives annualization and scaling logic. If absent, use <code>annualization_default</code> from settings and log defaulting. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>gross</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>gross</code> </td><td data-label="Notes"> Primary numeric gross pay for the period indicated by <code>period_type</code>. Parse via centralized numeric parser (locale-aware, strips currency symbols), coerce to Double, and log when coercion was required. Do not accept negative gross without explicit override; flag as ERROR. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>npwp_status</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>npwp_status</code> </td><td data-label="Notes"> Controls NPWP penalty application; canonical values include <code>has</code> / <code>no</code> or boolean equivalents. Normalize to known enumeration and log ambiguous values. If unknown, treat as <code>no</code> and emit WARN. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>ptkp_status</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>ptkp_status</code> </td><td data-label="Notes"> Maps to PTKP category (single, married, dependents). Validate against PTKP table values; when unmatched, fall back to a conservative PTKP (lowest) and log. Changes in PTKP mapping must be auditable. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>ter_category</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>ter_category</code> </td><td data-label="Notes"> Category for TER lookups (<code>TER_A</code>..<code>TER_D</code>). Validate presence and refer to TER tables loaded into <code>modCalc</code>; missing categories should default to no-TER and produce a WARN. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>bpjs_ke_emp</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>bpjs_ke_emp</code> </td><td data-label="Notes"> Employer contribution (amount) for healthcare (KE). Amount precedence: if present and numeric, it overrides the corresponding percent field. Validate as &gt;=0 and log conversions from percent-based inputs used as fallback. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>bpjs_jkk_emp</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>bpjs_jkk_emp</code> </td><td data-label="Notes"> Employer work-accident contribution (amount). Same precedence and validation as KE. Ensure consistent units and log if value suspiciously large (&gt;50% of gross). </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>bpjs_jkm_emp</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>bpjs_jkm_emp</code> </td><td data-label="Notes"> Employer life/accident contribution (amount). Validate and log conversions and anomalies. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>bpjs_jht_emp</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>bpjs_jht_emp</code> </td><td data-label="Notes"> Employer retirement/pension (amount). Used when aggregating <code>premi_asuransi_employer</code> if <code>INCLUDE_BPJS_FIELDS</code> is true. Presence affects tax base when <code>TREATEMPLOYERBPJSASGROSS</code> is enabled. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>bpjs_other_emp</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>bpjs_other_emp</code> </td><td data-label="Notes"> Any other employer-provided premium amounts. Included in employer aggregation; validate numeric and log if nonzero. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>bpjs_ke_emp_pct</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>bpjs_ke_emp_pct</code> </td><td data-label="Notes"> Percent fallback for KE if amount missing. Accepts <code>5%</code>, <code>0.05</code>, or <code>5</code>. Normalize to fraction in <code>[0,1]</code>. If parsed value out-of-range, emit ERROR for that row. Document whether percent was applied or ignored. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>bpjs_jkk_emp_pct</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>bpjs_jkk_emp_pct</code> </td><td data-label="Notes"> Percent fallback for JKK; same parsing and validation as KE percent. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>bpjs_jkm_emp_pct</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>bpjs_jkm_emp_pct</code> </td><td data-label="Notes"> Percent fallback for JKM; same rules. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>bpjs_jht_emp_pct</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>bpjs_jht_emp_pct</code> </td><td data-label="Notes"> Percent fallback for JHT; same rules and validation. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>bpjs_ke_employee</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>bpjs_ke_employee</code> </td><td data-label="Notes"> Employee-paid KE amount. When <code>allow_employee_bpjs_deduction=true</code> this reduces taxable income. Preserve numeric type and log if deduction exceeds gross (sanity WARN). </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>bpjs_jht_employee</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>bpjs_jht_employee</code> </td><td data-label="Notes"> Employee JHT amount. Treated like other employee contributions with deduction semantics controlled by settings. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>iuran_bpjs_employee</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>iuran_bpjs_employee</code> </td><td data-label="Notes"> Canonical total employee BPJS contribution. If missing, compute as sum of known employee BPJS fields; record calculation steps in detailed trace when VERBOSECALC is enabled. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>premi_asuransi_dari_pemberi_kerja</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>premi_asuransi_employer</code> </td><td data-label="Notes"> Aggregated employer premiums used in outputs. Computed from employer BPJS amounts (or percent-of-gross fallbacks) and other employer-paid insurances. If <code>TREATEMPLOYERBPJSASGROSS=true</code>, this value may be folded into <code>gross</code> prior to PKP computation — log this decision and arithmetic. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>premi_asuransi_karyawan</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>premi_asuransi_employee</code> </td><td data-label="Notes"> Employee-paid insurance premiums (not BPJS), treated as deduction where rules allow. Validate and normalize; include in <code>iuran_bpjs_employee</code> if semantics require. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>iuran_pensiun</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>iuran_pensiun</code> </td><td data-label="Notes"> Pension contribution deduction. Validate range and apply to DTP/PKP as configured. If absent, default to 0 and log when STRICT_BPJS is true. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>biaya_jabatan</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>biaya_jabatan</code> </td><td data-label="Notes"> Job expense deduction; apply annualization and rounding rules consistently. Provide clear trace of whether standard fixed-percentage or explicit value used. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>other_deductions</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>other_deductions</code> </td><td data-label="Notes"> Miscellaneous deductions. Treat conservatively: accept numeric only after parsing; log any non-numeric entries and either coerce (with WARN) or skip per STRICT_BPJS. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>gross_up_flag</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>gross_up_flag</code> </td><td data-label="Notes"> Boolean flag indicating gross-up behavior. Coerce from common textual values (<code>Y/N</code>,<code>TRUE/FALSE</code>) and log defaulting. When present, adjust withholding logic accordingly and record in manifest snapshot. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>currency</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>currency</code> </td><td data-label="Notes"> Currency ISO code if amounts provided in non-IDR currency. If present, <code>fx_rate</code> must be provided or row flagged. Currency conversions must be logged and reversible for audit. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><code>fx_rate</code></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>fx_rate</code> </td><td data-label="Notes"> Numeric FX rate (to IDR). Validate &gt;0. Use centralized parser and log conversion step. Missing rate when <code>currency</code> not IDR should cause row-level ERROR unless settings permit. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><em>(computed)</em></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>annual_gross</code> </td><td data-label="Notes"> Derived internal field: gross scaled to annual basis per <code>period_type</code> and <code>annualization_default</code>. Store intermediate rounding and scale factors; when annualization applied, include an audit trace entry per row. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><em>(computed)</em></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>annual_tax</code> </td><td data-label="Notes"> Tax computed on annual PKP using bracket tables. Calculation must be deterministic; record bracket-level breakdown (taxable slices, rate applied, tax per-slice) in verbose trace. </td></tr><tr><td data-label="Input Table Header (tblInput)"><div class="tv-left-col"><div class="left-col-content"><em>(computed)</em></div></div></td><td data-label="Internal Key (used in VBA dictionaries)"> <code>monthly_withholding</code> </td><td data-label="Notes"> Final output: monthly withholding. Derived from <code>annual_tax</code> and rounding rules; record rounding mode used and pre/post-round values in logs when VERBOSECALC is enabled. </td></tr></tbody></table></div><div class="row-count">Rows: 33</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>