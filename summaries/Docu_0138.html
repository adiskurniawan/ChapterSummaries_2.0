<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1767518016">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Docu_0138_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Enhancement Report"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Enhancement Report</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Enhancement Report"> <strong>Goal:</strong> Produce a concise, single-document analysis of provided code changes. Verify which files appeared, summarize modifications, identify risks, and recommend next steps. Conservative wording used where content was missing. </td></tr><tr><td data-label="Enhancement Report"> <strong>Revised Files Observed:</strong> markdown.py; render/core_table.py; render/core_renderer.py; render/sanitize.py; render/core_utils.py; render/core_io.py; main.py. Note: convert.py referenced but not supplied. </td></tr><tr><td data-label="Enhancement Report"> <strong>markdown.py — Key Changes:</strong> Strong inline-only table-cell renderer; underscore handling; fenced/inline code stashing; strict sanitizer allowlist; external-link rel-rewrite; table stashing including CSV-block detection; optional LRU caching; controlled extension set; extensive fallbacks when python-markdown is absent. </td></tr><tr><td data-label="Enhancement Report"> <strong>render/core_table.py — Key Changes:</strong> Robust CSV detection and parsing with pandas and no-pandas fallbacks; safer escaping for pipes/underscores; enhanced cell rendering with truncation safeguards; idempotent asset/header emission; defensive CSV/JSON/XLSX export utilities; row filtering and sorting helpers. </td></tr><tr><td data-label="Enhancement Report"> <strong>render/core_renderer.py — Key Changes:</strong> Input normalization for pipe-tables, HTML tables, CSV, DataFrame-like objects; internal parsing helpers; fallback inline rendering; safe fragment orchestration; asset embedding preserved; stable hash–based deduplication. </td></tr><tr><td data-label="Enhancement Report"> <strong>render/sanitize.py — Key Changes:</strong> Tight allowlist sanitizer; bleach-backed when available; fallback HTMLParser-based cleaner; removal of on* and style attributes; strict data:image rules; script-tag neutralization except inside code/pre blocks. </td></tr><tr><td data-label="Enhancement Report"> <strong>render/core_utils.py — Key Changes:</strong> Hardened helpers; caption sanitizer (sanitize_caption_html), caption normalizer, prepare_caption; ALLOW_CAPTION_HTML disabled by default; uses bleach if available; newline→<br> only in captions (not general sanitization). </td></tr><tr><td data-label="Enhancement Report"> <strong>render/core_io.py — Key Changes:</strong> Safe atomic writes via same-directory temp file + os.replace; deterministic tmp_frag_dir_for; encoding/dialect sniff for CSV; extract_table_source and read_csv_rows utilities. </td></tr><tr><td data-label="Enhancement Report"> <strong>main.py — Key Changes:</strong> Conservative markdown→DataFrame pipeline; inline-code stashing; strict pipe-table/CSV detection; Dropbox-path sanitization; DataFrame→HTML converter with no forced <br>; fallback rendering when html_renderer missing; pandas CSV compatibility for multiple versions. </td></tr><tr><td data-label="Enhancement Report"> <strong>Unchanged / Preserved Behavior:</strong> High-level parse→fragment→HTML flow; DataFrame behaviors when pandas is present; asset inclusion strategy; no automatic <br> in table cells. </td></tr><tr><td data-label="Enhancement Report"> <strong>User Requirements Satisfied:</strong> No <br> inside cells; inline backtick code preserved; safer CSV/table parsing; defensive fallbacks. </td></tr><tr><td data-label="Enhancement Report"> <strong>Assumptions:</strong> Only supplied files treated as authoritative; optional deps may or may not be installed; standard filesystem expected. </td></tr><tr><td data-label="Enhancement Report"> <strong>Remaining Risks / Unknowns:</strong> convert.py not reviewed; sanitizer omission of <br> could conflict with any external expectations; differences when bleach is absent; heuristic CSV detection limits; atomicity reliability on network filesystems. </td></tr><tr><td data-label="Enhancement Report"> <strong>Verification Steps:</strong> <br> (1) Run smoke tests; <br> (2) Compare raw vs rendered cell fidelity; <br> (3) Sanitizer adversarial tests; <br> (4) CSV variations matrix; <br> (5) Export CSV/JSON/XLSX validation; <br> (6) Embedded vs linked assets; <br> (7) Renderer fallback paths; <br> (8) Atomic write tests on actual FS; <br> (9) Performance on large tables. </td></tr><tr><td data-label="Enhancement Report"> <strong>Future Upgrade Options:</strong> Add unit tests; optional strict CSV schema mode; dependency-check harness; unify caption <br> policy; network-FS atomicity investigation. </td></tr><tr><td data-label="Enhancement Report"> <strong>Integration Notes:</strong> Client asset IDs preserved; caption utilities expected in client code; atomic write and tmp-frag helpers safe drop-ins. </td></tr><tr><td data-label="Enhancement Report"> <strong>Security / Stability:</strong> Attribute filtering reduces XSS; script tags neutralized; atomic write lowers corruption risk; behavior differs with missing optional deps. </td></tr><tr><td data-label="Enhancement Report"> <strong>Audit / Logging:</strong> Modules log PARSE_TRY / PARSE_OK / PARSE_FAIL; consider unified logging format. </td></tr><tr><td data-label="Enhancement Report"> <strong>Cross-check Validation:</strong> Stashing pipelines consistent across modules; sanitizer aligns with table protection logic; main.py matches no-<br> policy. </td></tr><tr><td data-label="Enhancement Report"> <strong>Performance:</strong> Small/medium tables trivial; large tables rely mostly on pandas overhead; truncation safeguards present. </td></tr><tr><td data-label="Enhancement Report"> <strong>Maintenance Recommendations:</strong> Add test suites; back up labels.json and groups_index.json before bulk use; document fallback behavior. </td></tr><tr><td data-label="Enhancement Report"> <strong>Verification Environment:</strong> Python 3.8+; optional deps: pandas, bleach, bs4, charset detection libs, openpyxl/xlsxwriter. Test on real production filesystem. </td></tr><tr><td data-label="Enhancement Report"> <strong>Final Assessment:</strong> Revisions are conservative and consistent; inline code preserved; no <br> inserted in cells; fallbacks robust. convert.py must be checked when provided. </td></tr><tr><td data-label="Enhancement Report"> <strong>Memory State:</strong> Based solely on files shown in this session; ready to rescan if more files are supplied. </td></tr></tbody></table></div><div class="row-count">Rows: 24</div></div><div class="table-caption" id="Table2" data-table="Docu_0138_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Current Behavior (Before Revision)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Current Behavior (Before Revision)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Revised Behavior (After Revision)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Revised Behavior (After Revision)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Current Behavior (Before Revision)"> Fails on <code>&lt;br&gt;</code> inside table cells; parser misinterprets these as row breaks. </td><td data-label="Revised Behavior (After Revision)"> <code>&lt;br&gt;</code> stripped by sanitizer; multi-line cells rejected cleanly instead of corrupting table layout. </td></tr><tr><td data-label="Current Behavior (Before Revision)"> Long paragraphs and bullets cause pipe-table detection to split content into multiple unintended rows. </td><td data-label="Revised Behavior (After Revision)"> Complex multi-line cells trigger fallback literal-text mode; parser avoids accidental row splits. </td></tr><tr><td data-label="Current Behavior (Before Revision)"> Bullet lists inside one cell produce malformed rows and misaligned columns. </td><td data-label="Revised Behavior (After Revision)"> Lists inside cells still unsupported, but now handled safely: table dropped → safe literal output. </td></tr><tr><td data-label="Current Behavior (Before Revision)"> Sanitizer behavior inconsistent; sometimes drops HTML, sometimes leaks <code>&lt;br&gt;</code> in captions. </td><td data-label="Revised Behavior (After Revision)"> Sanitizer unified: no <code>&lt;br&gt;</code> allowed in cells; captions only may convert newline→<code>&lt;br&gt;</code>. </td></tr><tr><td data-label="Current Behavior (Before Revision)"> <code>_restore_protection_entities</code> breaks when encountering HTML inside cells. </td><td data-label="Revised Behavior (After Revision)"> Protected sequences restored reliably because HTML is removed before stashing/restore. </td></tr><tr><td data-label="Current Behavior (Before Revision)"> Table may parse partially and produce broken HTML that the viewer cannot render. </td><td data-label="Revised Behavior (After Revision)"> Table never partially parses; invalid structures produce controlled fallback instead of broken output. </td></tr><tr><td data-label="Current Behavior (Before Revision)"> Multi-block content (paragraphs + bullets + code) leads to truncated rows and missing chunks. </td><td data-label="Revised Behavior (After Revision)"> Multi-block content outside table rules results in one consistent fallback block, not missing chunks. </td></tr><tr><td data-label="Current Behavior (Before Revision)"> Unpredictable behavior when DOM includes complex Markdown/HTML inside a cell. </td><td data-label="Revised Behavior (After Revision)"> Deterministic behavior: complex cells are refused and rendered literally, never as a malformed table. </td></tr><tr><td data-label="Current Behavior (Before Revision)"> Parser attempts to interpret every line with <code>|</code> as a row → high corruption risk. </td><td data-label="Revised Behavior (After Revision)"> Parser now checks structural validity; multi-line, HTML-heavy cells no longer treated as table rows. </td></tr><tr><td data-label="Current Behavior (Before Revision)"> Overall: inconsistent failure, corrupted cells, misaligned rows. </td><td data-label="Revised Behavior (After Revision)"> Overall: safe failure, no corruption, stable fallback output. </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table3" data-table="Docu_0138_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Files requiring revision (priority order)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Files requiring revision (priority order)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Files requiring revision (priority order)"> <strong>1) render/core_table.py</strong> — Priority: High. Fix table parsing to reject or correctly normalize multi-line HTML/<code>&lt;br&gt;</code>/list content inside a single cell; ensure stashing/restoration order (stash code → sanitize → parse → restore). Harden CSV detection so pipe conflicts and in-cell pipes don't split rows. Add explicit validation that each detected row has same column count; if not, treat as non-table and return fallback. Add unit tests for multiline-cell inputs. </td></tr><tr><td data-label="Files requiring revision (priority order)"> <strong>2) render/sanitize.py</strong> — Priority: High. Make sanitizer behavior deterministic for table-cell inputs: remove/normalize <code>&lt;br&gt;</code> before table parsing (or provide an opt-in allowlist for captions only). Ensure attribute stripping and URL checks run <em>before</em> stashing/parse steps that rely on clean HTML. Add an API to sanitize-preserve-inline-code (i.e., do not escape backticks). Add tests with malicious payloads and <code>&lt;br&gt;</code>-heavy content. </td></tr><tr><td data-label="Files requiring revision (priority order)"> <strong>3) markdown.py</strong> — Priority: High. Ensure table stashing (<code>_stash_tables</code>) and code-fence stashing occur in correct precedence relative to sanitizer and that stash tokens cannot be confused with pipe characters. Improve fallback for “complex cell” detection — return stable literal block instead of partial parse. Add LRU-cached render invalidation for stash variants. </td></tr><tr><td data-label="Files requiring revision (priority order)"> <strong>4) render/core_renderer.py</strong> — Priority: High. Update orchestration to call sanitizer and stash helpers in the new correct order; add a strict validation step after parsing that either accepts the table or routes the whole block to fallback/plain rendering. Ensure dedup/hash logic accounts for fallback paths. </td></tr><tr><td data-label="Files requiring revision (priority order)"> <strong>5) main.py</strong> — Priority: Medium-High. Update the top-level pipeline to refuse ingestion of complex single-cell HTML tables: detect heavy-HTML cells early and route to pre-formatting (split into rows/tables) or plain pre-block output. Ensure backward-compatible behavior when html_renderer is absent. Add CLI/harness mode for bulk validation. </td></tr><tr><td data-label="Files requiring revision (priority order)"> <strong>6) render/core_utils.py</strong> — Priority: Medium. Add helper utilities: <code>is_multiline_html_cell()</code>, <code>normalize_cell_text_for_idempotency()</code>, and caption-specific sanitize helpers. Ensure ALLOW_CAPTION_HTML flag is consistently used by caller modules. </td></tr><tr><td data-label="Files requiring revision (priority order)"> <strong>7) render/core_io.py</strong> — Priority: Medium. Add safe extraction helpers for literal fallback outputs (e.g., write original block to <code>.fallbacks/</code> with metadata) and ensure read_csv_rows does not attempt to parse multi-line HTML blocks as CSV. Include tests for network FS atomicity. </td></tr><tr><td data-label="Files requiring revision (priority order)"> <strong>8) convert.py</strong> — Priority: Unknown (Critical if present). <strong>Action:</strong> Inspect immediately — file was referenced in session but not supplied. If it transforms/consumes tables, it must be updated to honor the new rejection/fallback semantics and to avoid reintroducing <code>&lt;br&gt;</code> into cells. </td></tr><tr><td data-label="Files requiring revision (priority order)"> <strong>9) client JS (script.core.js / script.table.js / TOC modules)</strong> — Priority: Low-Medium. Ensure any client-side code that expects multi-line-cell content (e.g., <code>initRenderedContent</code> that adds <code>&lt;br&gt;</code> or <code>tabindex</code>) is compatible with server-side sanitizer changes. Where focus/aria code depends on generated ids, ensure id generation helpers match server slug logic. </td></tr><tr><td data-label="Files requiring revision (priority order)"> <strong>10) tests/</strong> — Priority: High (additions). Add unit tests: <code>test_ensure_no_br_in_cells</code>, <code>test_multiline_cell_rejection</code>, <code>test_fallback_literal_output</code>, <code>test_stash_restore_order</code>. Add integration tests (headless DOM) for pipe-table with embedded HTML and bullet lists. </td></tr><tr><td data-label="Files requiring revision (priority order)"> <strong>Verification checklist (run after changes):</strong><br>• Run unit tests added above. <br>• Smoke-run main pipeline on representative documents including the problematic input. <br>• Confirm tables that are valid still render unchanged. <br>• Confirm problematic input is not partially parsed — it should produce a single fallback literal block or be properly split. <br>• Run sanitizer adversarial suite (XSS, data: urls, on* attributes). <br>• Confirm no regressions on captions (newlines→<code>&lt;br&gt;</code> only if ALLOW_CAPTION_HTML or caption-specific path). </td></tr><tr><td data-label="Files requiring revision (priority order)"> <strong>Notes & caveats:</strong><br>• I reviewed the session-provided files and cross-checked references and call-sites multiple times. convert.py was not provided — assume critical until confirmed. <br>• Make changes incrementally and run the verification checklist after each file update to avoid breaking the project. </td></tr></tbody></table></div><div class="row-count">Rows: 12</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>