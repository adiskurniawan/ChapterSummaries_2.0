<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1760589909">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      // Delegate addEventListener/removeEventListener to visible button
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      // Delegate onclick assignments
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      // Delegate focus/blur
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
      // If legacy code used direct addEventListener earlier than this script, listeners would already exist
      // on alias element; attempt to re-dispatch those by cloning them to visible button is non-trivial.
      // This approach covers the common case where legacy scripts query the alias and bind after DOM ready.
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li>
<li class="toc-item"><a class="toc-link" href="#Table7">Table 7</a></li>
<li class="toc-item"><a class="toc-link" href="#Table8">Table 8</a></li>
<li class="toc-item"><a class="toc-link" href="#Table9">Table 9</a></li>
<li class="toc-item"><a class="toc-link" href="#Table10">Table 10</a></li>
<li class="toc-item"><a class="toc-link" href="#Table11">Table 11</a></li>
<li class="toc-item"><a class="toc-link" href="#Table12">Table 12</a></li>
<li class="toc-item"><a class="toc-link" href="#Table13">Table 13</a></li>
<li class="toc-item"><a class="toc-link" href="#Table14">Table 14</a></li>
<li class="toc-item"><a class="toc-link" href="#Table15">Table 15</a></li>
<li class="toc-item"><a class="toc-link" href="#Table16">Table 16</a></li>
<li class="toc-item"><a class="toc-link" href="#Table17">Table 17</a></li>
<li class="toc-item"><a class="toc-link" href="#Table18">Table 18</a></li>
<li class="toc-item"><a class="toc-link" href="#Table19">Table 19</a></li>
<li class="toc-item"><a class="toc-link" href="#Table20">Table 20</a></li>
<li class="toc-item"><a class="toc-link" href="#Table21">Table 21</a></li>
<li class="toc-item"><a class="toc-link" href="#Table22">Table 22</a></li>
<li class="toc-item"><a class="toc-link" href="#Table23">Table 23</a></li>
<li class="toc-item"><a class="toc-link" href="#Table24">Table 24</a></li>
<li class="toc-item"><a class="toc-link" href="#Table25">Table 25</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Book_8013_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Topic**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Topic</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Details**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Details</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Topic"> <strong>Goal</strong>                                  </td><td data-label="Details"> Seamlessly integrate PasteToTable’s table rendering pipeline with Table Viewer front-end/back-end, ensuring: <br>• Preservation of all rich content in cells (fenced code, diagrams, math, images, nested tables). <br>• Consistent sanitization and export behavior. <br>• Minimal disruption to existing public APIs (<code>render_table</code>, <code>render_html</code>, <code>render_page</code>). <br>• One-file safe commits, verifiable at each step.                                     </td></tr><tr><td data-label="Topic"> <strong>Constraints</strong>                           </td><td data-label="Details"> • Must not break existing PasteToTable functionality. <br>• Align with Table Viewer CSS/JS/rendering expectations (<code>tv-table</code>, <code>tv-col</code>, etc.). <br>• Strong sanitization; no untrusted HTML. <br>• Preserve inline math/diagrams and nested HTML blocks. <br>• Maintain column width, header classes, and accessibility attributes.                                                                                                                             </td></tr><tr><td data-label="Topic"> <strong>Phase 1: Audit & Mapping</strong>              </td><td data-label="Details"> • File Audit: Map PasteToTable render files (<code>convert.py</code>, <code>core_table.py</code>, <code>core_renderer.py</code>, <code>sanitize.py</code>) against Table Viewer behavior. <br>• Class & Attribute Alignment: Matrix of CSS/HTML classes used vs Table Viewer (<code>tv-table</code>, <code>tv-col-left</code>, <code>cell-math</code>, etc.). <br>• Feature Gap Analysis: Identify missing features (e.g., <code>&lt;ol&gt;</code> numbering, nested tables, export triggers). <br>• Deliverable: Audit table with required mappings and gaps. </td></tr><tr><td data-label="Topic"> <strong>Phase 2: Renderer Normalization</strong>       </td><td data-label="Details"> • Header & Cell HTML: Ensure <code>render_table</code> outputs Table Viewer-ready HTML. <br>• Cell Type Preservation: Preserve diagrams, math, code, images, nested tables in <code>&lt;td&gt;</code> with proper wrappers (<code>cell-diagram</code>, <code>cell-math</code>, <code>cell-code</code>). <br>• Ordered List Handling: Normalize lists (<code>&lt;ol&gt;</code>, <code>&lt;ul&gt;</code>) inside cells while keeping rendering sequence. <br>• Deliverable: Updated <code>convert.py</code> and <code>core_table.py</code> for Table Viewer compatibility.              </td></tr><tr><td data-label="Topic"> <strong>Phase 3: Sanitization & Security</strong>      </td><td data-label="Details"> • Preserve Allowed Tags: <code>&lt;pre&gt;</code>, <code>&lt;code&gt;</code>, <code>&lt;ol&gt;</code>, <code>&lt;ul&gt;</code>, <code>&lt;li&gt;</code>, <code>&lt;strong&gt;</code>, <code>&lt;em&gt;</code>, <code>&lt;img&gt;</code>, <code>&lt;math&gt;</code>. <br>• Strip Dangerous Attributes: block <code>on*</code>, <code>script</code>, <code>iframe</code>. <br>• Flag Optional Rich Media: <code>allow_rich_media=True/False</code>. <br>• Deliverable: Sanitizer updated to Table Viewer standards without breaking exports.                                                                                                                            </td></tr><tr><td data-label="Topic"> <strong>Phase 4: CSS & Layout Synchronization</strong> </td><td data-label="Details"> • Align <code>tv-col-left</code>, <code>tv-col</code> widths, header alignment, <code>role=table</code>. <br>• Ensure <code>.cell-diagram</code>, <code>.cell-math</code>, <code>.cell-code</code> CSS matches Table Viewer. <br>• Minimal inline styles; prefer class-based rendering. <br>• Deliverable: CSS alignment verified on sample tables.                                                                                                                                                                                </td></tr><tr><td data-label="Topic"> <strong>Phase 5: Export Compatibility</strong>         </td><td data-label="Details"> • Markdown, CSV, XLSX exports preserve content; retain HTML for Table Viewer HTML. <br>• Fenced code blocks appear properly in Markdown. <br>• Table Viewer search/indexing sees cell text correctly. <br>• Deliverable: Export tested across all formats.                                                                                                                                                                                                       </td></tr><tr><td data-label="Topic"> <strong>Phase 6: Integration Testing</strong>          </td><td data-label="Details"> • Smoke-test full PasteToTable → Table Viewer pipeline with multiple cell types. <br>• Verify: <br> – Ordered lists render sequentially. <br> – Nested tables display correctly. <br> – Code/math blocks render with proper classes. <br> – Export formats preserve content. <br>• Log diff reports for every step (HTML, Markdown, CSV).                                                                                                                        </td></tr><tr><td data-label="Topic"> <strong>Phase 7: Stepwise Upgrade Workflow</strong>    </td><td data-label="Details"> Steps: <br>1. Audit & map classes. <br>2. Normalize cell rendering. <br>3. Update sanitizer. <br>4. Align CSS and roles. <br>5. Export verification. <br>6. Integration tests & QA. <br>7. Safe commit & approval before release. <br>• Each step: single-file or isolated change. No multi-file commits. Full verification before proceeding. Preserve public APIs and function signatures.                                                                     </td></tr></tbody></table></div><div class="row-count">Rows: 9</div></div><div class="table-caption" id="Table2" data-table="Book_8013_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Module / File**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Module / File</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Module / File"> <strong>render/convert.py</strong>       </td><td data-label="Logic / Structure"> Core conversion of Markdown/HTML/text → Table Viewer-ready HTML. Normalizes <code>&lt;td&gt;</code> content, applies cell wrappers (<code>cell-code</code>, <code>cell-math</code>, <code>cell-diagram</code>), handles <code>&lt;ol&gt;/&lt;ul&gt;</code> inside cells, nested tables, and fallback rendering. </td><td data-label="Conceptual Notes"> Preserves inner HTML, wraps tables/cells with Table Viewer classes (<code>tv-table</code>, <code>tv-col-left</code>, <code>tv-col</code>), sanitizes unsafe tags, ensures export compatibility (HTML, Markdown, CSV/XLSX), integrates with <code>sanitize.py</code> and <code>core_table.py</code>. </td></tr><tr><td data-label="Module / File"> <strong>render/core_table.py</strong>    </td><td data-label="Logic / Structure"> Table-level helpers; wraps <code>render_table</code>. Builds <code>&lt;thead&gt;</code>/<code>&lt;tbody&gt;</code>, applies column classes, validates list numbering, manages nested tables.                                                                                        </td><td data-label="Conceptual Notes"> Ensures first column <code>&lt;th&gt;</code> → <code>tv-col-left</code>, others → <code>tv-col</code>; preserves nested tables (<code>tv-nested-table</code>); coordinates with <code>convert.py</code> content; validates <code>&lt;ol&gt;/&lt;ul&gt;</code> sequences; prepares export-ready HTML.                             </td></tr><tr><td data-label="Module / File"> <strong>render/core_renderer.py</strong> </td><td data-label="Logic / Structure"> Page and fragment assembly. Combines multiple fragments/tables into complete HTML pages, injects CSS/JS assets, handles TOC placement.                                                                                                 </td><td data-label="Conceptual Notes"> Ensures all tables have correct classes, cell wrappers preserved; sanitizes full pages (<code>allow_rich_media</code> optional); concurrent rendering supported; exports compatible with Markdown, CSV, XLSX.                                           </td></tr><tr><td data-label="Module / File"> <strong>render/markdown.py</strong>      </td><td data-label="Logic / Structure"> Markdown → HTML conversion for tables, code, math, diagrams, lists.                                                                                                                                                                    </td><td data-label="Conceptual Notes"> Wraps fenced code blocks (<code>cell-code</code>), math (<code>cell-math</code>), diagrams (<code>cell-diagram</code>); preserves nested tables and <code>&lt;ol&gt;/&lt;ul&gt;</code> sequences; works with Table Viewer CSS; ensures safe HTML via <code>sanitize.py</code>.                                  </td></tr><tr><td data-label="Module / File"> <strong>render/sanitize.py</strong>      </td><td data-label="Logic / Structure"> Sanitization of HTML fragments, table cells, and full pages.                                                                                                                                                                           </td><td data-label="Conceptual Notes"> Strips unsafe tags (<code>&lt;script&gt;</code>, <code>&lt;iframe&gt;</code>), event attributes (<code>on*</code>); preserves <code>&lt;pre&gt;</code>, <code>&lt;code&gt;</code>, <code>&lt;ol&gt;</code>, <code>&lt;ul&gt;</code>, <code>&lt;li&gt;</code>, <code>&lt;img&gt;</code>, <code>&lt;math&gt;</code>; <code>allow_rich_media</code> flag for optional content; ensures Table Viewer-safe HTML.                 </td></tr><tr><td data-label="Module / File"> <strong>render/core_utils.py</strong>    </td><td data-label="Logic / Structure"> Utility functions for escaping, validation, and helpers across modules.                                                                                                                                                                </td><td data-label="Conceptual Notes"> <code>_escape_html</code>, <code>_validate_numbering</code>, <code>_ensure_class</code>, <code>_flatten_nested_tables</code>, <code>_is_rich_media</code>, <code>_clean_label_for_datalabel</code>; ensures consistent CSS application, cell content safety, and export integrity.                             </td></tr><tr><td data-label="Module / File"> <strong>render/core_assets.py</strong>   </td><td data-label="Logic / Structure"> Asset discovery and embedding.                                                                                                                                                                                                         </td><td data-label="Conceptual Notes"> Provides CSS/JS asset management, inline embedding, copying, SRI computation; needed for Table Viewer front-end styling (<code>tv-table</code>, cell wrappers, math/diagram CSS).                                                                       </td></tr><tr><td data-label="Module / File"> <strong>render/core_io.py</strong>       </td><td data-label="Logic / Structure"> File I/O utilities, atomic writes, temp directories.                                                                                                                                                                                   </td><td data-label="Conceptual Notes"> Supports thread/process-safe fragment writes, avoids race conditions; ensures HTML export integrity.                                                                                                                                         </td></tr><tr><td data-label="Module / File"> <strong>render/io_utils.py</strong>      </td><td data-label="Logic / Structure"> Low-level atomic write helpers.                                                                                                                                                                                                        </td><td data-label="Conceptual Notes"> Provides <code>_atomic_write_text</code> or similar fallback; used by <code>core_io.py</code> and <code>html_renderer.py</code>.                                                                                                                                              </td></tr><tr><td data-label="Module / File"> <strong>html_renderer.py</strong>        </td><td data-label="Logic / Structure"> High-level page rendering helper.                                                                                                                                                                                                      </td><td data-label="Conceptual Notes"> Merges fragments, manages fallback rendering, TOC, and assets; coordinates with <code>convert.py</code>, <code>core_table.py</code>, and <code>core_renderer.py</code>.                                                                                                       </td></tr><tr><td data-label="Module / File"> <strong>utils.py</strong>                </td><td data-label="Logic / Structure"> Misc helpers at project root.                                                                                                                                                                                                          </td><td data-label="Conceptual Notes"> Can include logging, environment detection, and helper wrappers used by <code>main.py</code> or <code>server.py</code>.                                                                                                                                            </td></tr><tr><td data-label="Module / File"> <strong>main.py / server.py</strong>     </td><td data-label="Logic / Structure"> Entrypoints.                                                                                                                                                                                                                           </td><td data-label="Conceptual Notes"> Invokes rendering pipeline; sends HTML to Table Viewer front-end; handles file I/O and server requests.                                                                                                                                      </td></tr><tr><td data-label="Module / File"> <strong>assets/</strong>                 </td><td data-label="Logic / Structure"> Front-end CSS/JS.                                                                                                                                                                                                                      </td><td data-label="Conceptual Notes"> <code>style.css</code> defines Table Viewer table and cell styles; <code>script.js</code> optional UI enhancements; <code>worker.js</code> optional indexing/search features.                                                                                                 </td></tr><tr><td data-label="Module / File"> <strong>templates/index.html</strong>    </td><td data-label="Logic / Structure"> Base HTML template.                                                                                                                                                                                                                    </td><td data-label="Conceptual Notes"> Receives rendered tables and fragments; Table Viewer front-end hooks; ensures proper class and role assignment.                                                                                                                              </td></tr><tr><td data-label="Module / File"> <strong>saved_tables/</strong>           </td><td data-label="Logic / Structure"> Persistent storage.                                                                                                                                                                                                                    </td><td data-label="Conceptual Notes"> Stores exported tables (HTML, Markdown, CSV/XLSX) for retrieval or re-rendering.                                                                                                                                                             </td></tr></tbody></table></div><div class="row-count">Rows: 15</div></div><div class="table-caption" id="Table3" data-table="Book_8013_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>           </td><td data-label="Conceptual Notes"> <code>core_table.py</code> handles the assembly, formatting, and rendering of table structures in PasteToTable. It transforms normalized data into HTML tables ready for Table Viewer, including header/footer management, row/cell attributes, and content wrapping.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions</strong>        </td><td data-label="Conceptual Notes"> 1. <code>render_table(data, **kwargs)</code> – core table assembly function generating <code>&lt;table&gt;</code> HTML.<br>2. <code>_render_header(cols, **kwargs)</code> – generates <code>&lt;thead&gt;</code> and <code>&lt;th&gt;</code> elements with proper classes and attributes.<br>3. <code>_render_body(rows, **kwargs)</code> – generates <code>&lt;tbody&gt;</code> and <code>&lt;tr&gt;/&lt;td&gt;</code> elements, applies cell content from <code>convert.py</code> normalization.<br>4. <code>_apply_cell_classes(cell_content, cell_type)</code> – wraps content in <code>cell-code</code>, <code>cell-math</code>, <code>cell-diagram</code> as needed.<br>5. <code>_validate_numbering(rows)</code> – ensures <code>&lt;ol&gt;</code> numbering is sequential inside cells.<br>6. <code>_sanitize_cell_content(content, allow_rich_media=False)</code> – ensures safety while preserving allowed HTML.<br>7. <code>_assemble_table_html(header_html, body_html)</code> – combines <code>&lt;thead&gt;</code> and <code>&lt;tbody&gt;</code> into a single <code>&lt;table&gt;</code> element with <code>tv-table</code> class. </td></tr><tr><td data-label="Logic / Structure"> <strong>Header & Column Handling</strong> </td><td data-label="Conceptual Notes"> 1. First column <code>&lt;th&gt;</code> → <code>tv-col-left</code>.<br>2. Other columns <code>&lt;th&gt;</code> → <code>tv-col</code>.<br>3. Table element <code>&lt;table&gt;</code> → <code>tv-table</code>, <code>role=table</code>.<br>4. Preserve column widths and alignment using CSS classes.<br>5. Optional <code>&lt;caption&gt;</code> support for accessibility.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Row & Cell Handling</strong>      </td><td data-label="Conceptual Notes"> 1. Iterate over rows and cells, applying normalized content from <code>convert.py</code>.<br>2. Wrap code/math/diagram blocks in cell wrappers.<br>3. Handle empty cells and missing content gracefully.<br>4. Preserve nested tables inside cells, optionally adding <code>tv-nested-table</code> class.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>List Normalization</strong>       </td><td data-label="Conceptual Notes"> 1. Ensure <code>&lt;ol&gt;</code> inside cells renumber sequentially.<br>2. <code>&lt;ul&gt;</code> lists maintain proper indentation and structure.<br>3. Apply this before wrapping content in Table Viewer classes.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>  </td><td data-label="Conceptual Notes"> 1. Strip unsafe tags: <code>&lt;script&gt;</code>, <code>&lt;iframe&gt;</code>, <code>&lt;object&gt;</code>.<br>2. Strip event attributes: <code>on*</code>.<br>3. Preserve allowed tags: <code>&lt;pre&gt;</code>, <code>&lt;code&gt;</code>, <code>&lt;ol&gt;</code>, <code>&lt;ul&gt;</code>, <code>&lt;li&gt;</code>, <code>&lt;strong&gt;</code>, <code>&lt;em&gt;</code>, <code>&lt;img&gt;</code>, <code>&lt;math&gt;</code>.<br>4. <code>allow_rich_media</code> flag for gated external content.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Nested Tables</strong>            </td><td data-label="Conceptual Notes"> 1. Fully preserve <code>&lt;table&gt;</code> elements inside cells.<br>2. Optional <code>tv-nested-table</code> class for CSS styling.<br>3. Ensure proper nesting in HTML without breaking outer table structure.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Compatibility</strong>     </td><td data-label="Conceptual Notes"> 1. HTML export must match Table Viewer standards (<code>tv-table</code>, <code>tv-col-left</code>, <code>tv-col</code>).<br>2. Markdown export should preserve fenced code, math, and lists.<br>3. CSV/XLSX exports: plain text, stripping HTML where necessary.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>       </td><td data-label="Conceptual Notes"> 1. Validate header and body alignment.<br>2. Verify cell content wrappers (<code>cell-code</code>, <code>cell-math</code>, <code>cell-diagram</code>).<br>3. Confirm sequential <code>&lt;ol&gt;</code> numbering inside cells.<br>4. Test nested tables and edge cases (empty cells, long content).<br>5. Check CSS class application matches Table Viewer expectations.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>       </td><td data-label="Conceptual Notes"> 1. Works with <code>convert.py</code> for normalized cell content.<br>2. Works with <code>sanitize.py</code> for safe HTML.<br>3. Front-end Table Viewer CSS expects <code>tv-table</code>, <code>tv-col-left</code>, <code>tv-col</code>, <code>tv-nested-table</code>.<br>4. Exports compatible with Markdown, HTML, CSV, XLSX.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong> </td><td data-label="Conceptual Notes"> 1. Audit current <code>_render_header</code> and <code>_render_body</code> logic; map class usage.<br>2. Wrap cell content with Table Viewer classes according to type.<br>3. Normalize <code>&lt;ol&gt;</code>/<code>&lt;ul&gt;</code> sequences inside cells.<br>4. Ensure nested tables are preserved with optional <code>tv-nested-table</code> class.<br>5. Adjust <code>&lt;th&gt;</code>/<code>&lt;td&gt;</code> classes to <code>tv-col-left</code>/<code>tv-col</code>.<br>6. Apply sanitization with <code>allow_rich_media</code> flag.<br>7. Validate export formats: HTML, Markdown, CSV/XLSX.<br>8. Add regression tests for headers, rows, lists, nested tables, and empty cells.<br>9. Ensure logging and error reporting are intact for misformatted data.                                                                                                                                                                                                           </td></tr></tbody></table></div><div class="row-count">Rows: 11</div></div><div class="table-caption" id="Table4" data-table="Book_8013_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>                   </td><td data-label="Conceptual Notes"> <code>core_renderer.py</code> is responsible for assembling complete HTML pages and table fragments, handling rendering order, sanitization, and integration with Table Viewer CSS/JS. It manages page-level elements, fragment metadata, and ensures all tables and cell content conform to Table Viewer expectations.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions</strong>                </td><td data-label="Conceptual Notes"> 1. <code>render_page(fragments, **kwargs)</code> – assembles multiple table/text fragments into a complete HTML page.<br>2. <code>render_fragments_concurrently(fragments, max_workers=4, **kwargs)</code> – concurrent rendering of multiple fragments with thread/process safety.<br>3. <code>_assemble_page_html(header_html, body_html, assets_html)</code> – merges tables, headers, and CSS/JS assets.<br>4. <code>_inject_table_classes(table_html)</code> – ensures all tables use <code>tv-table</code>, headers/columns have <code>tv-col-left</code>/<code>tv-col</code>.<br>5. <code>_sanitize_html(page_html, allow_rich_media=False)</code> – final sanitization for page-level content.<br>6. <code>_extract_fragment_metadata(fragment_html)</code> – optional extraction for indexing, TOC generation, or search highlighting.<br>7. <code>_fallback_render_fragment(fragment_text)</code> – fallback rendering for unsupported fragment types. </td></tr><tr><td data-label="Logic / Structure"> <strong>Table & Cell Handling</strong>            </td><td data-label="Conceptual Notes"> 1. Receives normalized cell content from <code>convert.py</code> and <code>core_table.py</code>.<br>2. Ensures nested tables maintain proper HTML structure and <code>tv-nested-table</code> class.<br>3. Wraps code/math/diagram cells in <code>cell-code</code>, <code>cell-math</code>, <code>cell-diagram</code> wrappers if missing.<br>4. Validates header <code>&lt;th&gt;</code> classes: first column <code>tv-col-left</code>, others <code>tv-col</code>.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>          </td><td data-label="Conceptual Notes"> 1. Strip unsafe tags (<code>&lt;script&gt;</code>, <code>&lt;iframe&gt;</code>, <code>&lt;object&gt;</code>), event attributes (<code>on*</code>).<br>2. Preserve allowed tags (<code>&lt;pre&gt;</code>, <code>&lt;code&gt;</code>, <code>&lt;ol&gt;</code>, <code>&lt;ul&gt;</code>, <code>&lt;li&gt;</code>, <code>&lt;img&gt;</code>, <code>&lt;math&gt;</code>).<br>3. <code>allow_rich_media</code> flag controls optional inclusion of external content.<br>4. Sanitization occurs after full HTML assembly to avoid stripping valid nested content.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Fragment Rendering & Concurrency</strong> </td><td data-label="Conceptual Notes"> 1. Supports concurrent fragment rendering for performance.<br>2. Thread/process-safe rendering with fallback mechanisms.<br>3. Extracts fragment metadata for indexing, TOC, and Table Viewer search highlighting.<br>4. Logs errors or skipped fragments for debugging.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Compatibility</strong>             </td><td data-label="Conceptual Notes"> 1. HTML export: fully Table Viewer-ready with correct classes and structure.<br>2. Markdown export: preserves fenced code, math, lists.<br>3. CSV/XLSX export: plain text, stripping HTML where needed.<br>4. Ensures nested tables and cell wrappers remain intact across exports.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Page Assembly & Assets</strong>           </td><td data-label="Conceptual Notes"> 1. Combines multiple tables/fragments into a single HTML page.<br>2. Injects CSS/JS assets needed by Table Viewer (<code>tv-table</code>, column styles, <code>cell-code</code> styling, math rendering CSS/JS).<br>3. TOC placement directly under headers if present.<br>4. Supports optional asset fallbacks if missing (inline CSS/JS).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>               </td><td data-label="Conceptual Notes"> 1. Verify correct <code>tv-table</code>, <code>tv-col-left</code>, <code>tv-col</code>, and <code>tv-nested-table</code> class usage.<br>2. Test sequential <code>&lt;ol&gt;</code> numbering and <code>&lt;ul&gt;</code> preservation in all cells.<br>3. Confirm cell wrappers (<code>cell-code</code>, <code>cell-math</code>, <code>cell-diagram</code>) exist where appropriate.<br>4. Validate fragment assembly, metadata extraction, and TOC placement.<br>5. Cross-browser checks for Table Viewer front-end integration.                                                                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>               </td><td data-label="Conceptual Notes"> 1. Works with <code>convert.py</code> for normalized cell content.<br>2. Works with <code>core_table.py</code> for table assembly.<br>3. Works with <code>sanitize.py</code> for page-level sanitization.<br>4. Front-end Table Viewer expects classes: <code>tv-table</code>, <code>tv-col-left</code>, <code>tv-col</code>, <code>tv-nested-table</code>.<br>5. Exports must remain compatible with Markdown, CSV, XLSX viewers.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong>         </td><td data-label="Conceptual Notes"> 1. Audit page and fragment rendering logic, identifying where Table Viewer classes are applied or missing.<br>2. Ensure all table fragments receive <code>tv-table</code>, <code>tv-col-left</code>, <code>tv-col</code>, and cell wrappers.<br>3. Sanitize full page HTML after assembly, preserving nested content.<br>4. Implement <code>allow_rich_media</code> flag for optional external content.<br>5. Test concurrent fragment rendering with thread/process safety.<br>6. Verify metadata extraction, TOC placement, and search indexing.<br>7. Validate all exports: HTML, Markdown, CSV, XLSX.<br>8. Log errors and provide fallback rendering for unsupported fragments.<br>9. Add regression tests for multiple fragment scenarios and nested tables.                                                                                                                             </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table5" data-table="Book_8013_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>           </td><td data-label="Conceptual Notes"> <code>sanitize.py</code> handles security and content safety for tables and full HTML pages. It strips unsafe elements while preserving allowed tags for Table Viewer and provides optional rich media handling.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions</strong>        </td><td data-label="Conceptual Notes"> 1. <code>sanitize_html(html_content, allow_rich_media=False)</code> – main entry point for sanitizing HTML pages or fragments.<br>2. <code>_strip_unsafe_tags(html_fragment)</code> – removes <code>&lt;script&gt;</code>, <code>&lt;iframe&gt;</code>, <code>&lt;object&gt;</code>, <code>&lt;embed&gt;</code> and other potentially dangerous tags.<br>3. <code>_strip_event_attributes(tag)</code> – removes <code>on*</code> event attributes to prevent XSS.<br>4. <code>_preserve_allowed_tags(tag)</code> – allows <code>&lt;pre&gt;</code>, <code>&lt;code&gt;</code>, <code>&lt;ol&gt;</code>, <code>&lt;ul&gt;</code>, <code>&lt;li&gt;</code>, <code>&lt;strong&gt;</code>, <code>&lt;em&gt;</code>, <code>&lt;img&gt;</code>, <code>&lt;math&gt;</code>.<br>5. <code>sanitize_cell_content(cell_html, allow_rich_media=False)</code> – ensures cell-level sanitization without breaking inner HTML structure.<br>6. <code>allow_rich_media</code> flag – enables optional embedding of external content such as images or media if explicitly allowed. </td></tr><tr><td data-label="Logic / Structure"> <strong>Cell & Table Handling</strong>    </td><td data-label="Conceptual Notes"> 1. Sanitizes each <code>&lt;td&gt;</code> and <code>&lt;th&gt;</code> content, preserving allowed tags.<br>2. Maintains wrappers: <code>cell-code</code>, <code>cell-math</code>, <code>cell-diagram</code>.<br>3. Preserves nested tables with optional <code>tv-nested-table</code> class.<br>4. Ensures <code>&lt;ol&gt;</code> and <code>&lt;ul&gt;</code> are not stripped and numbering remains sequential.                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Page-Level Sanitization</strong>  </td><td data-label="Conceptual Notes"> 1. Applied after full page assembly in <code>core_renderer.py</code>.<br>2. Preserves table structures: <code>tv-table</code>, <code>tv-col-left</code>, <code>tv-col</code>.<br>3. Strips unsafe tags at the page level without affecting nested tables or fragments.<br>4. Supports optional rich media with gating via <code>allow_rich_media</code>.                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Security Measures</strong>        </td><td data-label="Conceptual Notes"> 1. Fully removes scriptable or executable elements (<code>&lt;script&gt;</code>, <code>&lt;iframe&gt;</code>, <code>&lt;object&gt;</code>, <code>on*</code> attributes).<br>2. Prevents injection of unsafe HTML or JS via cell content or page-level HTML.<br>3. Optional flag for external rich content ensures controlled inclusion.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Considerations</strong>    </td><td data-label="Conceptual Notes"> 1. HTML export: preserves Table Viewer classes and allowed content.<br>2. Markdown export: stripped content must remain readable; fenced code preserved.<br>3. CSV/XLSX exports: plain text only, no HTML tags.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>       </td><td data-label="Conceptual Notes"> 1. Verify allowed tags (<code>&lt;pre&gt;</code>, <code>&lt;code&gt;</code>, <code>&lt;ol&gt;</code>, <code>&lt;ul&gt;</code>, <code>&lt;li&gt;</code>, <code>&lt;img&gt;</code>, <code>&lt;math&gt;</code>) remain intact.<br>2. Confirm all <code>cell-*</code> wrappers survive sanitization.<br>3. Test nested tables, diagrams, code, and math blocks.<br>4. Validate behavior with <code>allow_rich_media=True</code> and <code>False</code>.<br>5. Ensure no unsafe tags or attributes survive sanitization.                                                                                                                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>       </td><td data-label="Conceptual Notes"> 1. Works with <code>convert.py</code> for cell-level content.<br>2. Works with <code>core_table.py</code> for row and header sanitization.<br>3. Works with <code>core_renderer.py</code> for page-level HTML.<br>4. Ensures Table Viewer integration safety: <code>tv-table</code>, <code>tv-col-left</code>, <code>tv-col</code>, <code>tv-nested-table</code> remain intact.<br>5. Compatible with Markdown, CSV, XLSX exports.                                                                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong> </td><td data-label="Conceptual Notes"> 1. Audit all sanitization functions and identify points where allowed tags might be stripped.<br>2. Update <code>_preserve_allowed_tags</code> to include <code>cell-code</code>, <code>cell-math</code>, <code>cell-diagram</code> wrappers.<br>3. Implement <code>allow_rich_media</code> gating consistently across cell and page sanitization.<br>4. Ensure <code>&lt;ol&gt;</code>/<code>&lt;ul&gt;</code> numbering is preserved after sanitization.<br>5. Validate nested table preservation with optional <code>tv-nested-table</code> class.<br>6. Test exports: HTML, Markdown, CSV/XLSX.<br>7. Add regression tests for edge cases: empty cells, deeply nested tables, mixed content.<br>8. Confirm that unsafe tags (<code>&lt;script&gt;</code>, <code>&lt;iframe&gt;</code>, <code>on*</code>) are fully stripped.                                                                          </td></tr></tbody></table></div><div class="row-count">Rows: 9</div></div><div class="table-caption" id="Table6" data-table="Book_8013_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>           </td><td data-label="Conceptual Notes"> <code>markdown.py</code> handles parsing of Markdown content into HTML fragments, ensuring compatibility with Table Viewer. It preserves fenced code blocks, math expressions, diagrams, nested tables, and lists, while applying CSS wrappers and sanitization hooks.                                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions</strong>        </td><td data-label="Conceptual Notes"> 1. <code>markdown_to_html(md_text, **kwargs)</code> – main function converting Markdown into HTML.<br>2. <code>_convert_fenced_code_blocks(md_text)</code> – detects ``<code> blocks and wraps them in </code><pre><code><code> with </code>cell-code<code> class.&lt;br&gt;3. </code>_convert_math_blocks(md_text)<code> – identifies math/KaTeX delimiters (</code>$...$<code>, </code>$$...$$<code>) and wraps in </code>cell-math<code>.&lt;br&gt;4. </code>_convert_diagram_blocks(md_text)<code> – converts ASCII diagrams or mermaid code into </code>cell-diagram<code> wrapped HTML.&lt;br&gt;5. </code>_convert_lists(md_text)<code> – ensures </code><ol><code>/</code><ul><code> lists are rendered sequentially inside table cells.&lt;br&gt;6. </code>_sanitize_fragment(html_fragment, allow_rich_media=False)` – optional sanitization before passing to core renderer. </td></tr><tr><td data-label="Logic / Structure"> <strong>Table & Cell Handling</strong>    </td><td data-label="Conceptual Notes"> 1. Converts Markdown tables into <code>&lt;table&gt;</code> elements with <code>tv-table</code> class.<br>2. Applies <code>tv-col-left</code> to first column <code>&lt;th&gt;</code> and <code>tv-col</code> to other <code>&lt;th&gt;</code> elements.<br>3. Nested tables inside Markdown are preserved and optionally get <code>tv-nested-table</code> class.<br>4. Inline HTML inside table cells is preserved for diagrams, math, or code.                                                                                                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Logic / Structure"> <strong>List Normalization</strong>       </td><td data-label="Conceptual Notes"> 1. <code>&lt;ol&gt;</code> numbering inside table cells is normalized to ensure sequential order.<br>2. <code>&lt;ul&gt;</code> lists preserve indentation and bullet points.<br>3. List normalization occurs before cell wrapper assignment to avoid double-wrapping.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>  </td><td data-label="Conceptual Notes"> 1. Strips unsafe tags (<code>&lt;script&gt;</code>, <code>&lt;iframe&gt;</code>, <code>&lt;object&gt;</code>, <code>&lt;embed&gt;</code>).<br>2. Removes event attributes (<code>on*</code>) to prevent XSS.<br>3. Preserves allowed tags: <code>&lt;pre&gt;</code>, <code>&lt;code&gt;</code>, <code>&lt;ol&gt;</code>, <code>&lt;ul&gt;</code>, <code>&lt;li&gt;</code>, <code>&lt;img&gt;</code>, <code>&lt;math&gt;</code>.<br>4. <code>allow_rich_media</code> flag gates optional external content inclusion.                                                                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Compatibility</strong>     </td><td data-label="Conceptual Notes"> 1. HTML export: Table Viewer-ready with proper classes and nested structures.<br>2. Markdown export: fenced code, math, and lists preserved.<br>3. CSV/XLSX exports: plain text, stripping Markdown/HTML where necessary.<br>4. Ensures consistent rendering across multiple export formats.                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>       </td><td data-label="Conceptual Notes"> 1. Verify fenced code blocks are wrapped in <code>cell-code</code>.<br>2. Confirm math expressions are wrapped in <code>cell-math</code> and rendered properly.<br>3. Test diagrams wrapped in <code>cell-diagram</code>.<br>4. Validate sequential <code>&lt;ol&gt;</code> numbering inside table cells.<br>5. Test nested table rendering and Table Viewer CSS alignment (<code>tv-table</code>, <code>tv-col-left</code>, <code>tv-col</code>).<br>6. Confirm sanitization preserves allowed HTML and removes unsafe content.                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>       </td><td data-label="Conceptual Notes"> 1. Works with <code>convert.py</code> for normalized cell content.<br>2. Works with <code>core_table.py</code> for assembling tables.<br>3. Works with <code>sanitize.py</code> for safe HTML output.<br>4. Front-end Table Viewer expects classes: <code>tv-table</code>, <code>tv-col-left</code>, <code>tv-col</code>, <code>tv-nested-table</code>.<br>5. Compatible with Markdown, HTML, CSV, XLSX exports.                                                                                                                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong> </td><td data-label="Conceptual Notes"> 1. Audit Markdown → HTML conversion logic for table, code, math, diagram handling.<br>2. Ensure all <code>&lt;pre&gt;&lt;code&gt;</code> blocks get <code>cell-code</code> class.<br>3. Wrap math/KaTeX content in <code>cell-math</code> and diagrams in <code>cell-diagram</code>.<br>4. Normalize <code>&lt;ol&gt;</code>/<code>&lt;ul&gt;</code> numbering and indentation.<br>5. Preserve inline HTML in table cells.<br>6. Apply sanitization with <code>allow_rich_media</code> flag.<br>7. Validate nested table rendering with optional <code>tv-nested-table</code> class.<br>8. Verify export formats: HTML, Markdown, CSV, XLSX.<br>9. Add regression tests for edge cases: empty cells, nested content, mixed code/math/diagram content.                                                                 </td></tr></tbody></table></div><div class="row-count">Rows: 9</div></div><div class="table-caption" id="Table7" data-table="Book_8013_07" style="margin-top:2mm;margin-left:3mm;"><strong>Table 7</strong></div>
<div class="table-wrapper" data-table-id="table-7"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>           </td><td data-label="Conceptual Notes"> <code>core_utils.py</code> contains shared utility functions for table and HTML rendering. Functions support normalization, validation, escaping, and helper operations needed by <code>convert.py</code>, <code>core_table.py</code>, <code>core_renderer.py</code>, and <code>sanitize.py</code>.                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions</strong>        </td><td data-label="Conceptual Notes"> 1. <code>_clean_label_for_datalabel(label)</code> – cleans column headers and cell labels for HTML <code>data-*</code> attributes.<br>2. <code>_escape_html(text)</code> – safely escapes text to prevent HTML injection.<br>3. <code>_validate_numbering(ol_list)</code> – ensures ordered lists (<code>&lt;ol&gt;</code>) are sequential.<br>4. <code>_ensure_class(element, class_name)</code> – adds a CSS class to an HTML element if missing.<br>5. <code>_deep_copy_html(html_fragment)</code> – safely duplicates HTML fragments without breaking inner structure.<br>6. <code>_is_rich_media(tag)</code> – checks whether a tag represents optional rich media (images, videos, iframes).<br>7. <code>_flatten_nested_tables(html_fragment)</code> – helper for nested table handling, if needed for certain exports. </td></tr><tr><td data-label="Logic / Structure"> <strong>Cell & Table Handling</strong>    </td><td data-label="Conceptual Notes"> 1. Provides utilities for column and cell validation (<code>_clean_label_for_datalabel</code>).<br>2. Assists in applying Table Viewer CSS classes consistently (<code>_ensure_class</code>).<br>3. Helps maintain sequential <code>&lt;ol&gt;</code> numbering via <code>_validate_numbering</code>.<br>4. Supports nested tables with <code>_flatten_nested_tables</code>.                                                                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>  </td><td data-label="Conceptual Notes"> 1. <code>_escape_html</code> ensures text is safe when inserted into HTML.<br>2. <code>_is_rich_media</code> enables <code>allow_rich_media</code> gating.<br>3. Works in conjunction with <code>sanitize.py</code> to maintain safe HTML output.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Compatibility</strong>     </td><td data-label="Conceptual Notes"> 1. Supports HTML export with safe text and proper CSS classes.<br>2. Assists Markdown conversion via safe escaping.<br>3. Helps maintain plain text for CSV/XLSX exports by providing clean labels and escaped content.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>       </td><td data-label="Conceptual Notes"> 1. Verify <code>_escape_html</code> does not double-escape valid HTML content.<br>2. Validate <code>_validate_numbering</code> with various <code>&lt;ol&gt;</code> list structures inside table cells.<br>3. Test <code>_ensure_class</code> correctly adds missing Table Viewer classes (<code>tv-col-left</code>, <code>tv-col</code>, <code>tv-nested-table</code>).<br>4. Check <code>_flatten_nested_tables</code> preserves inner HTML structure.<br>5. Confirm <code>_is_rich_media</code> correctly identifies optional external content.                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>       </td><td data-label="Conceptual Notes"> 1. Used by <code>convert.py</code> for cell normalization and escaping.<br>2. Used by <code>core_table.py</code> for header and row processing.<br>3. Used by <code>core_renderer.py</code> for fragment and page assembly.<br>4. Works with <code>sanitize.py</code> for content validation and gating rich media.<br>5. Ensures consistent Table Viewer CSS application across all modules.                                                                                                                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong> </td><td data-label="Conceptual Notes"> 1. Audit all utility functions and ensure proper escaping and safety.<br>2. Ensure <code>_clean_label_for_datalabel</code> generates safe <code>data-*</code> attributes for Table Viewer.<br>3. Validate <code>_validate_numbering</code> for ordered lists inside cells.<br>4. Confirm <code>_ensure_class</code> is used consistently for Table Viewer CSS (<code>tv-table</code>, <code>tv-col-left</code>, <code>tv-col</code>, <code>tv-nested-table</code>).<br>5. Test <code>_is_rich_media</code> in combination with <code>allow_rich_media</code> flag.<br>6. Verify <code>_flatten_nested_tables</code> preserves inner HTML for HTML export.<br>7. Add regression tests to ensure utilities behave consistently across modules and exports.                                                                                       </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table8" data-table="Book_8013_08" style="margin-top:2mm;margin-left:3mm;"><strong>Table 8</strong></div>
<div class="table-wrapper" data-table-id="table-8"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>             </td><td data-label="Conceptual Notes"> <code>convert.py</code> is the central module converting input Markdown/HTML/text into HTML tables compatible with Table Viewer. It handles table parsing, cell normalization, content sanitization, and export-ready HTML generation.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions</strong>          </td><td data-label="Conceptual Notes"> 1. <code>render_table(data, **kwargs)</code> – converts structured table data into HTML with Table Viewer classes.<br>2. <code>render_html(raw_text, **kwargs)</code> – converts raw Markdown/HTML text into full HTML fragments.<br>3. <code>render_page(fragments, **kwargs)</code> – assembles multiple fragments into a complete HTML page.<br>4. <code>_normalize_cell_content(content)</code> – ensures proper inner HTML, wrapping code, math, diagrams.<br>5. <code>_wrap_fenced_code_blocks(cell_html)</code> – wraps <code>&lt;pre&gt;&lt;code&gt;</code> content in <code>cell-code</code>.<br>6. <code>_wrap_math_blocks(cell_html)</code> – wraps KaTeX/LaTeX math in <code>cell-math</code>.<br>7. <code>_wrap_diagram_blocks(cell_html)</code> – wraps ASCII/diagram content in <code>cell-diagram</code>.<br>8. <code>_normalize_lists(cell_html)</code> – ensures <code>&lt;ol&gt;</code>/<code>&lt;ul&gt;</code> numbering and structure inside cells.<br>9. <code>_sanitize_html(cell_html, allow_rich_media=False)</code> – strips unsafe tags, retains allowed HTML.<br>10. <code>_fallback_render_html(raw_text)</code> – backup renderer when primary conversion fails. </td></tr><tr><td data-label="Logic / Structure"> <strong>Cell Content Handling</strong>      </td><td data-label="Conceptual Notes"> 1. Preserve <code>&lt;td&gt;</code> inner HTML for code, math, diagrams, nested tables.<br>2. Escape unsafe text but do not double-escape valid HTML inside cells.<br>3. Apply Table Viewer CSS classes: <code>cell-code</code>, <code>cell-math</code>, <code>cell-diagram</code>.<br>4. Normalize lists inside cells; ordered lists renumber sequentially.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Header & Column Classes</strong>    </td><td data-label="Conceptual Notes"> 1. First column headers <code>&lt;th&gt;</code> → <code>tv-col-left</code>.<br>2. Other columns <code>&lt;th&gt;</code> → <code>tv-col</code>.<br>3. Table element <code>&lt;table&gt;</code> → <code>tv-table</code> with <code>role=table</code>.<br>4. Column width hints preserved via CSS classes, avoiding inline styles.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Nested Tables</strong>              </td><td data-label="Conceptual Notes"> 1. Preserve fully nested <code>&lt;table&gt;</code> inside <code>&lt;td&gt;</code>.<br>2. Optional <code>tv-nested-table</code> class for CSS handling.<br>3. Ensure proper indentation and no HTML breaking tags.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>    </td><td data-label="Conceptual Notes"> 1. Strip unsafe tags: <code>&lt;script&gt;</code>, <code>&lt;iframe&gt;</code>, <code>&lt;object&gt;</code>.<br>2. Strip event attributes: <code>on*</code>.<br>3. Preserve allowed tags: <code>&lt;pre&gt;</code>, <code>&lt;code&gt;</code>, <code>&lt;ol&gt;</code>, <code>&lt;ul&gt;</code>, <code>&lt;li&gt;</code>, <code>&lt;strong&gt;</code>, <code>&lt;em&gt;</code>, <code>&lt;img&gt;</code>, <code>&lt;math&gt;</code>.<br>4. <code>allow_rich_media</code> flag for gated external content.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Markdown & Export Handling</strong> </td><td data-label="Conceptual Notes"> 1. Convert fenced code blocks to HTML with <code>cell-code</code>.<br>2. Preserve math and diagram blocks.<br>3. Export formats:<br> • HTML → Table Viewer-ready with proper classes<br> • Markdown → fenced code, list preservation, math LaTeX<br> • CSV/XLSX → plain text, stripping HTML where necessary                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Fallback & Logging</strong>         </td><td data-label="Conceptual Notes"> 1. <code>_fallback_render_html</code> for unsupported input.<br>2. Thread/process-safe fragment rendering.<br>3. Logs detailed errors for misformatted cells or missing assets.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>         </td><td data-label="Conceptual Notes"> 1. Verify sequential numbering in <code>&lt;ol&gt;</code> inside cells.<br>2. Confirm nested tables render correctly.<br>3. Ensure code/math/diagram wrappers exist in output HTML.<br>4. Validate column widths, alignment, and Table Viewer CSS.<br>5. Confirm export formats maintain data integrity.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>         </td><td data-label="Conceptual Notes"> 1. Works with <code>core_table.py</code> for table assembly.<br>2. Works with <code>sanitize.py</code> for safe HTML.<br>3. Compatible with Table Viewer CSS (<code>tv-table</code>, <code>tv-col-left</code>, <code>tv-col</code>).<br>4. Should integrate smoothly with front-end search/indexing in Table Viewer.<br>5. Exports should remain compatible with Markdown viewers and CSV/XLSX parsers.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong>   </td><td data-label="Conceptual Notes"> 1. Audit current Markdown → HTML conversion, identify escape points.<br>2. Normalize <code>&lt;td&gt;</code> content with Table Viewer wrappers.<br>3. Wrap code/math/diagram blocks appropriately.<br>4. Normalize lists inside cells (<code>&lt;ol&gt;</code> numbering, <code>&lt;ul&gt;</code> structure).<br>5. Adjust header and column classes.<br>6. Implement sanitization with <code>allow_rich_media</code> flag.<br>7. Validate exports across HTML, Markdown, CSV/XLSX.<br>8. Test nested tables and edge cases.<br>9. Add logging and fallback mechanisms.<br>10. Confirm integration with Table Viewer front-end CSS and behavior.                                                                                                                                                                                                                                                                                                                                                                                                    </td></tr></tbody></table></div><div class="row-count">Rows: 11</div></div><div class="table-caption" id="Table9" data-table="Book_8013_09" style="margin-top:2mm;margin-left:3mm;"><strong>Table 9</strong></div>
<div class="table-wrapper" data-table-id="table-9"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>           </td><td data-label="Conceptual Notes"> <code>core_assets.py</code> manages discovery, embedding, and preparation of assets required by PasteToTable HTML output and Table Viewer front-end. Assets include CSS (<code>style.css</code>), JS (<code>script.js</code>), and optionally worker scripts (<code>worker.js</code>). The module ensures assets are available, optionally embedded inline, and can be copied to output directories for standalone deployment.                                                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions</strong>        </td><td data-label="Conceptual Notes"> 1. <code>list_available_assets()</code> – enumerates all CSS/JS files available for embedding or copying.<br>2. <code>get_inline_css(asset_name=&quot;style.css&quot;)</code> – reads CSS file and returns content for inline embedding.<br>3. <code>get_inline_js(asset_name=&quot;script.js&quot;)</code> – reads JS file and returns content for inline embedding.<br>4. <code>copy_assets_to(dest_dir)</code> – copies all assets to a target folder, preserving folder structure.<br>5. <code>_compute_sri(asset_path)</code> – computes Subresource Integrity (SRI) hash for secure embedding in <code>&lt;link&gt;</code> or <code>&lt;script&gt;</code> tags.<br>6. <code>prepare_assets(embed_inline=False, dest_dir=None)</code> – orchestrates asset preparation: inline embedding or copying, returns HTML snippets for inclusion in rendered pages.<br>7. <code>write_overrides_css(css_text, dest_path)</code> – writes optional override CSS for custom styling. </td></tr><tr><td data-label="Logic / Structure"> <strong>CSS & JS Handling</strong>        </td><td data-label="Conceptual Notes"> 1. <code>style.css</code> provides Table Viewer styling: <code>tv-table</code>, <code>tv-col-left</code>, <code>tv-col</code>, <code>tv-nested-table</code>, <code>cell-code</code>, <code>cell-math</code>, <code>cell-diagram</code>.<br>2. <code>script.js</code> optionally provides front-end behaviors: search, sorting, collapsible tables.<br>3. <code>worker.js</code> (optional) supports future client-side indexing or highlighting.<br>4. Inline embedding ensures HTML pages are standalone; copying allows reusable asset directories.                                                                                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>  </td><td data-label="Conceptual Notes"> 1. Computes SRI hashes for external inclusion to guarantee integrity.<br>2. Ensures CSS/JS content does not break Table Viewer HTML structure.<br>3. Inline embedding sanitizes content to avoid script injections.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Compatibility</strong>     </td><td data-label="Conceptual Notes"> 1. HTML export includes assets either inline or via <code>&lt;link&gt;</code>/<code>&lt;script&gt;</code> tags.<br>2. Markdown export ignores CSS/JS assets.<br>3. CSV/XLSX exports remain plain text; assets not included.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>       </td><td data-label="Conceptual Notes"> 1. Verify all assets are discovered (<code>list_available_assets</code>).<br>2. Confirm inline CSS/JS embedding works in rendered HTML.<br>3. Validate copied assets appear in output directory correctly.<br>4. Ensure Table Viewer styles are correctly applied: <code>tv-table</code>, cell wrappers.<br>5. Test SRI hash computation and validate integrity.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>       </td><td data-label="Conceptual Notes"> 1. <code>core_renderer.py</code> and <code>html_renderer.py</code> call <code>prepare_assets</code> to include CSS/JS in rendered pages.<br>2. Works with <code>convert.py</code> and <code>core_table.py</code> to ensure tables are styled correctly.<br>3. Supports optional overrides for custom themes.<br>4. Ensures consistent Table Viewer styling across all exports.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong> </td><td data-label="Conceptual Notes"> 1. Audit current asset discovery and embedding logic.<br>2. Ensure all Table Viewer-required CSS classes (<code>tv-table</code>, <code>tv-col-left</code>, <code>tv-col</code>, <code>tv-nested-table</code>) are included in <code>style.css</code>.<br>3. Implement SRI computation for external <code>&lt;link&gt;</code>/<code>&lt;script&gt;</code> inclusion.<br>4. Add option for inline embedding vs copying to <code>dest_dir</code>.<br>5. Test asset inclusion in full HTML pages and validate Table Viewer rendering.<br>6. Add regression tests to check asset availability, inline embedding, SRI hashes, and copied output.                                                                                                                                                                                                                                                                                                       </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table10" data-table="Book_8013_10" style="margin-top:2mm;margin-left:3mm;"><strong>Table 10</strong></div>
<div class="table-wrapper" data-table-id="table-10"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>                 </td><td data-label="Conceptual Notes"> <code>core_io.py</code> provides utilities for reliable, thread- and process-safe file I/O. It ensures HTML fragments, tables, and assets are written atomically, preventing partial writes, race conditions, or corruption. It also manages temporary directories for intermediate rendering.                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions</strong>              </td><td data-label="Conceptual Notes"> 1. <code>atomic_write_text(path, content)</code> – writes text to a file atomically: writes to a temp file first, then renames to target path.<br>2. <code>safe_mkdir(path)</code> – creates directories recursively, avoids race conditions if multiple processes attempt creation.<br>3. <code>get_tmp_dir(base_dir=None)</code> – returns a temporary directory for fragment processing; optional base directory.<br>4. <code>check_path(path)</code> – validates file paths to ensure they are safe and writable.<br>5. <code>_atomic_write_text_fallback(path, content)</code> – fallback write for platforms that do not fully support atomic rename. </td></tr><tr><td data-label="Logic / Structure"> <strong>Atomic Write Logic</strong>             </td><td data-label="Conceptual Notes"> 1. Writes content to a uniquely named temporary file in the same directory as target.<br>2. Renames temp file to target path using atomic <code>os.replace</code> or equivalent.<br>3. Ensures partial writes do not corrupt existing files.<br>4. Fallback mechanism <code>_atomic_write_text_fallback</code> used if <code>os.replace</code> is unavailable or unreliable.                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Temporary Directory Management</strong> </td><td data-label="Conceptual Notes"> 1. Creates per-render temporary directories for fragments.<br>2. Ensures directories are cleaned up after rendering.<br>3. Supports optional base path to centralize temp files.<br>4. Provides predictable location for debugging or caching.                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Path Validation & Safety</strong>       </td><td data-label="Conceptual Notes"> 1. <code>check_path(path)</code> validates directory existence, permissions, and legality of filenames.<br>2. Prevents invalid paths that may break file operations or render pipeline.<br>3. Works in conjunction with <code>atomic_write_text</code> to ensure safe output.                                                                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Compatibility</strong>           </td><td data-label="Conceptual Notes"> 1. HTML export: ensures complete files are written atomically.<br>2. Markdown export: safe writes for <code>.md</code> files.<br>3. CSV/XLSX export: atomic writes prevent partial table files.<br>4. Supports integration with <code>core_assets.py</code> for writing CSS/JS files safely.                                                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>             </td><td data-label="Conceptual Notes"> 1. Verify <code>atomic_write_text</code> creates complete files and preserves existing files on error.<br>2. Test temp directories creation and cleanup.<br>3. Validate path checks with valid and invalid paths.<br>4. Ensure fallback write works on all target platforms.<br>5. Confirm integration with fragment rendering and Table Viewer HTML output.                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>             </td><td data-label="Conceptual Notes"> 1. Used by <code>core_renderer.py</code> and <code>html_renderer.py</code> for writing rendered fragments/pages.<br>2. Works with <code>core_assets.py</code> to safely write copied or override CSS/JS files.<br>3. Provides safe I/O for <code>convert.py</code> exports and Table Viewer-ready HTML files.<br>4. Ensures multi-threaded or multi-process rendering does not corrupt outputs.                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong>       </td><td data-label="Conceptual Notes"> 1. Audit current atomic write logic and fallback paths.<br>2. Ensure <code>get_tmp_dir</code> provides isolated directories per render session.<br>3. Confirm <code>check_path</code> validates directories and filenames robustly.<br>4. Test <code>atomic_write_text</code> with edge cases: existing files, concurrent writes, invalid paths.<br>5. Validate integration with <code>core_renderer.py</code>, <code>html_renderer.py</code>, and <code>core_assets.py</code> writes.<br>6. Add regression tests for temp directories, atomic writes, and fallback behavior.<br>7. Ensure cross-platform reliability for Windows, Linux, and macOS.                   </td></tr></tbody></table></div><div class="row-count">Rows: 9</div></div><div class="table-caption" id="Table11" data-table="Book_8013_11" style="margin-top:2mm;margin-left:3mm;"><strong>Table 11</strong></div>
<div class="table-wrapper" data-table-id="table-11"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>           </td><td data-label="Conceptual Notes"> <code>core_fragments.py</code> manages table and content fragments at a fine-grained level. It extracts individual tables or content blocks, applies rendering, handles metadata (for TOC, indexing, search), and ensures fragments can be combined into full pages safely.                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions</strong>        </td><td data-label="Conceptual Notes"> 1. <code>extract_fragments(html_content)</code> – splits HTML content into discrete fragments (tables, sections, text blocks).<br>2. <code>render_fragment(fragment, **kwargs)</code> – renders a single fragment to HTML with Table Viewer classes and cell wrappers.<br>3. <code>render_fragments_concurrently(fragments, max_workers=4, **kwargs)</code> – concurrent rendering using threads or processes; ensures thread-safe writes.<br>4. <code>_extract_fragment_metadata(fragment_html)</code> – extracts metadata (IDs, titles, headings) for TOC or search indexing.<br>5. <code>combine_fragments(fragments_html)</code> – assembles multiple fragments into a complete HTML page, preserving order.                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Fragment Structure</strong>       </td><td data-label="Conceptual Notes"> 1. Each fragment may be a <code>&lt;table&gt;</code> or <code>&lt;div&gt;</code> containing textual content.<br>2. Applies <code>tv-table</code>, <code>tv-col-left</code>, <code>tv-col</code>, and <code>tv-nested-table</code> classes as needed.<br>3. Wraps code/math/diagram cells with <code>cell-code</code>, <code>cell-math</code>, <code>cell-diagram</code>.<br>4. Preserves nested tables and lists (<code>&lt;ol&gt;/&lt;ul&gt;</code>) in fragments.                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Metadata & Indexing</strong>      </td><td data-label="Conceptual Notes"> 1. Extracts fragment IDs, headings, and optional captions.<br>2. Supports TOC generation for multi-fragment pages.<br>3. Stores searchable metadata for front-end highlighting or indexing.<br>4. Metadata used by <code>core_renderer.py</code> and <code>html_renderer.py</code> for page assembly.                                                                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>  </td><td data-label="Conceptual Notes"> 1. Sanitizes individual fragments using <code>sanitize.py</code> before assembly.<br>2. Supports <code>allow_rich_media</code> flag for optional images, diagrams, or media.<br>3. Ensures unsafe tags and attributes do not leak into final page.                                                                                                                                                                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Compatibility</strong>     </td><td data-label="Conceptual Notes"> 1. HTML export: fragments fully compatible with Table Viewer CSS classes.<br>2. Markdown export: preserves fenced code, math, and lists per fragment.<br>3. CSV/XLSX export: fragments flattened to plain text where applicable.                                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>       </td><td data-label="Conceptual Notes"> 1. Verify fragment extraction correctly splits multiple tables or sections.<br>2. Validate all cell wrappers and nested tables are preserved per fragment.<br>3. Test concurrent rendering with threads/processes and safe assembly.<br>4. Confirm metadata extraction is accurate for TOC and search.<br>5. Regression tests for empty fragments, long content, mixed content (tables + text + math/code/diagrams).                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>       </td><td data-label="Conceptual Notes"> 1. Works with <code>core_renderer.py</code> to assemble full pages from fragments.<br>2. Uses <code>convert.py</code> and <code>core_table.py</code> for normalized cell content per fragment.<br>3. Works with <code>sanitize.py</code> for safe fragment content.<br>4. Front-end Table Viewer relies on consistent CSS classes applied per fragment.                                                                                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong> </td><td data-label="Conceptual Notes"> 1. Audit current fragment extraction and rendering logic.<br>2. Ensure Table Viewer CSS classes are applied to all fragment tables and cells.<br>3. Validate cell wrappers (<code>cell-code</code>, <code>cell-math</code>, <code>cell-diagram</code>) for each fragment.<br>4. Normalize <code>&lt;ol&gt;/&lt;ul&gt;</code> sequences inside fragment cells.<br>5. Apply sanitization with <code>allow_rich_media</code> flag.<br>6. Ensure metadata extraction works for TOC, search, and indexing.<br>7. Test concurrent rendering with thread/process safety.<br>8. Assemble multi-fragment pages and validate order and styling.<br>9. Add regression tests for edge cases: empty fragments, deeply nested tables, mixed content types. </td></tr></tbody></table></div><div class="row-count">Rows: 9</div></div><div class="table-caption" id="Table12" data-table="Book_8013_12" style="margin-top:2mm;margin-left:3mm;"><strong>Table 12</strong></div>
<div class="table-wrapper" data-table-id="table-12"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>              </td><td data-label="Conceptual Notes"> <code>core_compat.py</code> ensures backward compatibility for older versions of PasteToTable modules. It provides aliases, shims, and wrapper functions so that code written against previous APIs (e.g., older <code>render_table</code> or <code>render_page</code> signatures) continues to work without modification.                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions / Aliases</strong> </td><td data-label="Conceptual Notes"> 1. <code>render_table_compat(*args, **kwargs)</code> – wrapper around <code>core_table.render_table</code> ensuring older argument names are supported.<br>2. <code>render_page_compat(*args, **kwargs)</code> – wrapper around <code>core_renderer.render_page</code> with fallback for older metadata parameters.<br>3. <code>render_html_compat(*args, **kwargs)</code> – wrapper around <code>convert.render_html</code> to maintain legacy function calls.<br>4. Optional fallback shims for <code>core_assets.prepare_assets</code>, <code>core_io.atomic_write_text</code>, etc., if older module structure expected. </td></tr><tr><td data-label="Logic / Structure"> <strong>Functionality Mapping</strong>       </td><td data-label="Conceptual Notes"> 1. Maps legacy parameter names to current API parameters.<br>2. Provides default values for missing arguments expected by older code.<br>3. Handles optional deprecated functions with safe no-op or fallback behavior.<br>4. Logs warnings if legacy functions are used, while maintaining backward compatibility.                                                                                                                                                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>          </td><td data-label="Conceptual Notes"> 1. Front-end and server code calling old APIs can rely on <code>core_compat</code> wrappers.<br>2. Ensures older scripts calling <code>render_table</code> or <code>render_page</code> do not break.<br>3. Works transparently with <code>convert.py</code>, <code>core_table.py</code>, <code>core_renderer.py</code>, and <code>sanitize.py</code>.                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>     </td><td data-label="Conceptual Notes"> 1. Delegates all content sanitization to <code>sanitize.py</code> or <code>convert.py</code>. <br>2. Does not alter content; only maps function calls and parameters.                                                                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Compatibility</strong>        </td><td data-label="Conceptual Notes"> 1. Fully compatible with HTML, Markdown, CSV, XLSX exports.<br>2. Ensures legacy scripts producing exports continue to work.                                                                                                                                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>          </td><td data-label="Conceptual Notes"> 1. Verify all legacy API calls are correctly mapped to modern functions.<br>2. Test parameter mapping for <code>render_table</code>, <code>render_page</code>, <code>render_html</code>.<br>3. Ensure fallback shims do not alter output content.<br>4. Confirm that warnings are logged appropriately when deprecated functions are invoked.                                                                                                                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong>    </td><td data-label="Conceptual Notes"> 1. Audit current legacy APIs used across <code>main.py</code>, <code>server.py</code>, and older scripts.<br>2. Implement function wrappers (<code>*_compat</code>) that map legacy parameters to current functions.<br>3. Add optional warnings/logging for deprecated calls.<br>4. Ensure wrappers do not alter sanitized output or Table Viewer CSS classes.<br>5. Add regression tests for old API calls to ensure consistent rendering.<br>6. Confirm that exports (HTML, Markdown, CSV/XLSX) remain unchanged when using compatibility shims.                   </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table13" data-table="Book_8013_13" style="margin-top:2mm;margin-left:3mm;"><strong>Table 13</strong></div>
<div class="table-wrapper" data-table-id="table-13"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>           </td><td data-label="Conceptual Notes"> <code>core.py</code> provides top-level rendering functions, combining <code>convert.py</code>, <code>core_table.py</code>, <code>core_renderer.py</code>, <code>markdown.py</code>, and <code>sanitize.py</code> to produce Table Viewer-ready HTML pages, fragments, or exports. It acts as the primary API for internal scripts, <code>main.py</code>, and server endpoints.                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions</strong>        </td><td data-label="Conceptual Notes"> 1. <code>render_table(*args, **kwargs)</code> – high-level wrapper around <code>core_table.render_table</code> and <code>convert.render_table</code>.<br>2. <code>render_html(*args, **kwargs)</code> – main HTML rendering entry point, calls <code>convert.render_html</code> and optionally <code>sanitize.sanitize_html</code>.<br>3. <code>render_page(fragments, **kwargs)</code> – assembles multiple fragments into a full HTML page using <code>core_renderer.combine_fragments</code> and injects assets via <code>core_assets.prepare_assets</code>.<br>4. <code>render_from_text(text, **kwargs)</code> – converts Markdown or plain text into Table Viewer-ready HTML table(s).<br>5. <code>render_fragments_concurrently(fragments, **kwargs)</code> – optional multi-thread/process fragment rendering via <code>core_fragments</code>. </td></tr><tr><td data-label="Logic / Structure"> <strong>Cell & Table Handling</strong>    </td><td data-label="Conceptual Notes"> 1. All <code>&lt;td&gt;</code>/<code>&lt;th&gt;</code> cells pass through <code>convert.py</code> for normalization.<br>2. Cell wrappers (<code>cell-code</code>, <code>cell-math</code>, <code>cell-diagram</code>) applied consistently.<br>3. <code>&lt;ol&gt;/&lt;ul&gt;</code> sequences normalized per cell.<br>4. Tables wrapped with <code>tv-table</code>, first column <code>&lt;th&gt;</code> → <code>tv-col-left</code>, others → <code>tv-col</code>.<br>5. Nested tables receive <code>tv-nested-table</code> class.                                                                                                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>  </td><td data-label="Conceptual Notes"> 1. Delegates sanitization to <code>sanitize.py</code> with optional <code>allow_rich_media</code> flag.<br>2. Ensures unsafe tags (<code>&lt;script&gt;</code>, <code>&lt;iframe&gt;</code>, <code>on*</code>) are removed.<br>3. Preserves allowed tags for Table Viewer: <code>&lt;pre&gt;</code>, <code>&lt;code&gt;</code>, <code>&lt;ol&gt;</code>, <code>&lt;ul&gt;</code>, <code>&lt;li&gt;</code>, <code>&lt;img&gt;</code>, <code>&lt;math&gt;</code>.                                                                                                                                                                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>Page Assembly & Assets</strong>   </td><td data-label="Conceptual Notes"> 1. Uses <code>core_renderer</code> and <code>core_fragments</code> to assemble fragments into pages.<br>2. Injects CSS/JS assets using <code>core_assets.prepare_assets</code>.<br>3. Handles TOC placement and fragment metadata injection.<br>4. Supports inline embedding or copying of assets for standalone pages.                                                                                                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Compatibility</strong>     </td><td data-label="Conceptual Notes"> 1. HTML export: fully Table Viewer-ready with all classes and wrappers.<br>2. Markdown export: preserves fenced code, math, lists, nested tables.<br>3. CSV/XLSX export: plain text only, no HTML tags.<br>4. Compatible with <code>main.py</code> and <code>server.py</code> pipelines for automated exports.                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>       </td><td data-label="Conceptual Notes"> 1. Validate that <code>render_table</code>, <code>render_html</code>, <code>render_page</code> produce correct Table Viewer HTML.<br>2. Check cell wrappers, nested tables, <code>&lt;ol&gt;/&lt;ul&gt;</code> numbering.<br>3. Test fragment concurrency for safe multi-threaded rendering.<br>4. Confirm asset injection (CSS/JS) works for both inline and copied modes.<br>5. Regression tests for Markdown → HTML conversion, empty tables, and mixed content (code/math/diagram).                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>       </td><td data-label="Conceptual Notes"> 1. Consolidates functionality from <code>convert.py</code>, <code>core_table.py</code>, <code>core_renderer.py</code>, <code>markdown.py</code>, <code>sanitize.py</code>, <code>core_assets.py</code>, and <code>core_fragments.py</code>.<br>2. Serves as main API for <code>main.py</code> and <code>server.py</code>.<br>3. Ensures Table Viewer front-end receives fully compatible HTML with proper CSS classes and structure.<br>4. Works with <code>core_compat.py</code> for backward compatibility when older scripts call legacy functions.                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong> </td><td data-label="Conceptual Notes"> 1. Audit all top-level render functions and ensure proper calls to lower-level modules.<br>2. Confirm consistent cell wrapper application across all table types.<br>3. Validate fragment extraction, concurrency, and page assembly.<br>4. Ensure sanitization (<code>allow_rich_media</code>) is applied consistently.<br>5. Validate asset injection (inline vs copied) and correct CSS/JS classes.<br>6. Test all export formats: HTML, Markdown, CSV, XLSX.<br>7. Add regression tests for empty tables, nested tables, mixed content, fragment assembly, and multi-page exports.<br>8. Ensure integration with <code>core_compat.py</code> for backward-compatible API calls.                                                      </td></tr></tbody></table></div><div class="row-count">Rows: 9</div></div><div class="table-caption" id="Table14" data-table="Book_8013_14" style="margin-top:2mm;margin-left:3mm;"><strong>Table 14</strong></div>
<div class="table-wrapper" data-table-id="table-14"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>           </td><td data-label="Conceptual Notes"> <code>io_utils.py</code> provides low-level file I/O functions, focusing on <strong>atomic writes, fallback mechanisms, and safe path handling</strong>. It ensures that intermediate and final output files (HTML, CSS, JS, fragments) are written safely without partial writes or corruption, supporting multi-threaded and multi-process rendering.                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions</strong>        </td><td data-label="Conceptual Notes"> 1. <code>_atomic_write_text(path, content)</code> – writes text to a file atomically using a temporary file + rename strategy.<br>2. <code>_atomic_write_bytes(path, content_bytes)</code> – similar atomic write for binary content.<br>3. <code>_atomic_write_text_fallback(path, content)</code> – fallback implementation for platforms without robust atomic rename support.<br>4. <code>safe_write(path, content, mode=&quot;w&quot;)</code> – general-purpose safe write wrapper using atomic write where possible.<br>5. <code>tmp_file_path(base_dir, prefix=&quot;tmp&quot;)</code> – generates a unique temporary file path within a directory. </td></tr><tr><td data-label="Logic / Structure"> <strong>Atomic Write Logic</strong>       </td><td data-label="Conceptual Notes"> 1. Writes to a uniquely named temporary file in the same directory.<br>2. Uses <code>os.replace</code> or platform-appropriate rename to atomically move temp file to target path.<br>3. Ensures that failures during write do not overwrite existing files.<br>4. Fallback <code>_atomic_write_text_fallback</code> writes directly to target path safely if atomic rename is unavailable.                                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Temporary File Support</strong>   </td><td data-label="Conceptual Notes"> 1. Generates predictable temp file paths for fragments, assets, or intermediate rendering steps.<br>2. Supports optional prefixes and custom base directories.<br>3. Ensures temp files do not collide between concurrent render threads or processes.                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Path Validation & Safety</strong> </td><td data-label="Conceptual Notes"> 1. Ensures target directories exist before writing.<br>2. Validates filenames to prevent illegal characters or invalid paths.<br>3. Works in conjunction with <code>core_io.py</code> and <code>core_assets.py</code> for safe file operations.                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>  </td><td data-label="Conceptual Notes"> 1. Does not modify content; delegates HTML/text sanitization to <code>sanitize.py</code>.<br>2. Ensures file writes do not create unsafe paths outside of intended directories.                                                                                                                                                                                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Compatibility</strong>     </td><td data-label="Conceptual Notes"> 1. HTML export: ensures complete Table Viewer HTML pages are written atomically.<br>2. CSS/JS export: supports safe writes of assets inline or copied.<br>3. Markdown/CSV/XLSX export: prevents partial files during concurrent writes.                                                                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>       </td><td data-label="Conceptual Notes"> 1. Test <code>_atomic_write_text</code> and <code>_atomic_write_bytes</code> with existing files, concurrent writes, and failures.<br>2. Validate <code>_atomic_write_text_fallback</code> behavior on all target platforms (Windows, Linux, macOS).<br>3. Test <code>tmp_file_path</code> uniqueness under multi-threaded fragment generation.<br>4. Confirm integration with <code>core_io.py</code>, <code>core_assets.py</code>, and fragment writes.                                                                                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>       </td><td data-label="Conceptual Notes"> 1. Used by <code>core_io.py</code> for high-level atomic writes and temp directories.<br>2. Supports <code>core_assets.py</code> for safely writing copied or override CSS/JS files.<br>3. Ensures <code>core_fragments.py</code> can write intermediate fragments safely during concurrent rendering.<br>4. Works with <code>html_renderer.py</code> and <code>core_renderer.py</code> for page assembly output.                                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong> </td><td data-label="Conceptual Notes"> 1. Audit current low-level write functions and fallback logic.<br>2. Ensure atomic write works across all supported platforms.<br>3. Confirm temp file path generation avoids collisions.<br>4. Validate safe write integration with assets, fragments, and final HTML pages.<br>5. Add regression tests for partial write failures, concurrent fragment writes, and fallback scenarios.<br>6. Ensure full compatibility with Table Viewer-ready output and export formats.                                                                                                     </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table15" data-table="Book_8013_15" style="margin-top:2mm;margin-left:3mm;"><strong>Table 15</strong></div>
<div class="table-wrapper" data-table-id="table-15"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>                      </td><td data-label="Conceptual Notes"> <code>assets.py</code> serves as a higher-level interface for managing front-end assets (CSS, JS, worker scripts) for Table Viewer pages. It abstracts file discovery, embedding, copying, and optional overrides for rendering pipelines.                                                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions</strong>                   </td><td data-label="Conceptual Notes"> 1. <code>get_asset_path(asset_name)</code> – returns the full filesystem path to a named asset (CSS, JS, worker).<br>2. <code>embed_css(asset_name=&quot;style.css&quot;)</code> – reads CSS content and returns HTML <code>&lt;style&gt;</code> snippet for inline embedding.<br>3. <code>embed_js(asset_name=&quot;script.js&quot;)</code> – reads JS content and returns <code>&lt;script&gt;</code> snippet for inline embedding.<br>4. <code>copy_assets(dest_dir, include_worker=False)</code> – copies all assets to a target directory; optionally includes <code>worker.js</code>.<br>5. <code>override_css(css_text, dest_path=None)</code> – allows custom CSS overrides to be written or embedded. </td></tr><tr><td data-label="Logic / Structure"> <strong>Asset Discovery & Management</strong>        </td><td data-label="Conceptual Notes"> 1. Relies on <code>core_assets.py</code> for low-level file access and SRI computation.<br>2. Provides convenience functions for embedding inline vs copying to output directories.<br>3. Supports optional inclusion of <code>worker.js</code> for client-side features.                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration with Rendering Pipeline</strong> </td><td data-label="Conceptual Notes"> 1. Called by <code>core_renderer.py</code> and <code>html_renderer.py</code> to inject CSS/JS into pages.<br>2. Works with <code>convert.py</code> and <code>core_table.py</code> to ensure tables receive proper Table Viewer styling.<br>3. Supports inline embedding for standalone HTML pages and copied assets for reusable deployments.                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>             </td><td data-label="Conceptual Notes"> 1. Relies on <code>core_assets.py</code> for safe asset handling and SRI hashing.<br>2. Ensures embedded assets do not break Table Viewer HTML or allow script injection.<br>3. Optionally sanitizes custom override CSS content.                                                                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Compatibility</strong>                </td><td data-label="Conceptual Notes"> 1. HTML export: assets can be embedded inline or copied, fully supporting Table Viewer classes (<code>tv-table</code>, <code>tv-col-left</code>, <code>tv-col</code>, <code>tv-nested-table</code>, cell wrappers).<br>2. Markdown export: ignores CSS/JS assets.<br>3. CSV/XLSX export: plain text only; assets are not relevant.                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>                  </td><td data-label="Conceptual Notes"> 1. Verify <code>get_asset_path</code> returns correct paths.<br>2. Test <code>embed_css</code> and <code>embed_js</code> snippets are valid HTML and inline correctly.<br>3. Confirm copied assets appear correctly in <code>dest_dir</code> and retain integrity.<br>4. Test optional <code>worker.js</code> inclusion.<br>5. Validate override CSS is applied correctly without breaking Table Viewer layout.                                                                                                                                                                                                                               </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>                  </td><td data-label="Conceptual Notes"> 1. Used by <code>core_renderer.py</code> and <code>html_renderer.py</code> during page assembly.<br>2. Works in conjunction with <code>core_assets.py</code> for actual file access and embedding.<br>3. Ensures consistent Table Viewer styling across all HTML exports.                                                                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong>            </td><td data-label="Conceptual Notes"> 1. Audit asset discovery and ensure all required CSS classes are present.<br>2. Validate inline embedding of CSS/JS works for Table Viewer-ready pages.<br>3. Test copying assets to output directories, including optional <code>worker.js</code>.<br>4. Implement override CSS writing and verify applied styles.<br>5. Add regression tests to confirm embedded and copied assets are consistent across multiple exports and render sessions.<br>6. Ensure full compatibility with <code>convert.py</code> and <code>core_table.py</code> for table rendering.                                                       </td></tr></tbody></table></div><div class="row-count">Rows: 9</div></div><div class="table-caption" id="Table16" data-table="Book_8013_16" style="margin-top:2mm;margin-left:3mm;"><strong>Table 16</strong></div>
<div class="table-wrapper" data-table-id="table-16"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>                      </td><td data-label="Conceptual Notes"> <code>cli.py</code> exposes PasteToTable functionality via the command line. It allows users to convert Markdown, HTML, or text into Table Viewer-ready HTML pages or other export formats (Markdown, CSV, XLSX) without writing Python scripts.                                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions / Commands</strong>        </td><td data-label="Conceptual Notes"> 1. <code>main()</code> – entry point for CLI execution, parses command-line arguments and dispatches actions.<br>2. <code>convert_file(input_path, output_path, **kwargs)</code> – converts a single file to Table Viewer-ready output.<br>3. <code>convert_directory(input_dir, output_dir, **kwargs)</code> – recursively converts all supported files in a directory.<br>4. <code>list_assets()</code> – prints available CSS/JS assets for embedding or copying.<br>5. <code>serve(input_path, port=8000)</code> – optional server mode for live preview of rendered tables. </td></tr><tr><td data-label="Logic / Structure"> <strong>Argument Parsing & Options</strong>          </td><td data-label="Conceptual Notes"> 1. Uses <code>argparse</code> or similar library to handle CLI flags.<br>2. Supports options for: input/output paths, export formats, inline vs copied assets, <code>allow_rich_media</code>, verbose logging.<br>3. Ensures consistent defaults for Table Viewer-ready HTML output.                                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration with Rendering Pipeline</strong> </td><td data-label="Conceptual Notes"> 1. Calls high-level functions from <code>core.py</code> (<code>render_table</code>, <code>render_html</code>, <code>render_page</code>).<br>2. Uses <code>core_assets.py</code> / <code>assets.py</code> to inject CSS/JS.<br>3. Works with <code>sanitize.py</code> to ensure safe output.<br>4. Optionally launches a lightweight server (<code>server.py</code>) for live preview.                                                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>             </td><td data-label="Conceptual Notes"> 1. Relies on <code>sanitize.py</code> for HTML/content sanitization.<br>2. Ensures that CLI users cannot output unsafe HTML via unsafe paths or content.<br>3. Optional <code>allow_rich_media</code> flag for safe embedding of images/videos.                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Compatibility</strong>                </td><td data-label="Conceptual Notes"> 1. HTML: fully Table Viewer-ready, supports inline/copy asset options.<br>2. Markdown: preserves fenced code, math, lists.<br>3. CSV/XLSX: outputs plain-text tables.<br>4. Directory conversion: batch exports while preserving folder structure.                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>                  </td><td data-label="Conceptual Notes"> 1. Test single-file conversion for HTML, Markdown, CSV, XLSX.<br>2. Test recursive directory conversion with mixed file types.<br>3. Validate inline vs copied assets.<br>4. Confirm <code>allow_rich_media</code> flag functions correctly.<br>5. Test CLI argument parsing and help messages.                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>                  </td><td data-label="Conceptual Notes"> 1. Main entry point for users running PasteToTable outside Python.<br>2. Interfaces with <code>core.py</code> for all high-level rendering operations.<br>3. Calls <code>core_assets.py</code> / <code>assets.py</code> for front-end asset management.<br>4. Works with <code>server.py</code> for optional live preview.                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong>            </td><td data-label="Conceptual Notes"> 1. Audit argument parsing and ensure defaults align with Table Viewer rendering.<br>2. Validate all CLI commands map correctly to high-level <code>core.py</code> functions.<br>3. Ensure safe file handling for input/output paths.<br>4. Test inline and copied asset modes for HTML export.<br>5. Add regression tests for directory conversions and batch exports.<br>6. Verify integration with <code>server.py</code> and live preview mode.<br>7. Ensure CLI help messages accurately describe options and flags.                        </td></tr></tbody></table></div><div class="row-count">Rows: 9</div></div><div class="table-caption" id="Table17" data-table="Book_8013_17" style="margin-top:2mm;margin-left:3mm;"><strong>Table 17</strong></div>
<div class="table-wrapper" data-table-id="table-17"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>                      </td><td data-label="Conceptual Notes"> <code>types.py</code> defines constants, type hints, and reusable data structures for the PasteToTable project. It ensures <strong>consistent typing, metadata representation, and structured data handling</strong> across modules like <code>convert.py</code>, <code>core_table.py</code>, <code>core_fragments.py</code>, and <code>core_renderer.py</code>.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Types / Data Structures</strong>     </td><td data-label="Conceptual Notes"> 1. <code>Fragment</code> – represents an individual content block or table, with fields such as <code>html_content</code>, <code>metadata</code>, <code>fragment_id</code>.<br>2. <code>TableCell</code> – optional structured representation of a table cell; includes <code>content</code>, <code>cell_type</code> (<code>code</code>, <code>math</code>, <code>diagram</code>, <code>text</code>), and <code>metadata</code>.<br>3. <code>TableRow</code> – optional wrapper for a list of <code>TableCell</code> objects.<br>4. <code>TableData</code> – structured representation of an entire table: list of <code>TableRow</code> objects, optional header metadata.<br>5. <code>Asset</code> – represents a CSS or JS asset with fields <code>name</code>, <code>path</code>, <code>inline_content</code>, <code>sri_hash</code>.<br>6. <code>ExportFormat</code> – enum or string constants defining export types (<code>HTML</code>, <code>Markdown</code>, <code>CSV</code>, <code>XLSX</code>).<br>7. <code>RenderOptions</code> – dataclass or dict representing rendering options such as <code>allow_rich_media</code>, <code>inline_assets</code>, <code>copy_assets</code>, <code>sanitize</code>, <code>verbose_logging</code>. </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration with Rendering Pipeline</strong> </td><td data-label="Conceptual Notes"> 1. <code>Fragment</code>, <code>TableCell</code>, <code>TableRow</code>, <code>TableData</code> used by <code>core_fragments.py</code>, <code>core_table.py</code>, <code>convert.py</code>, and <code>core_renderer.py</code> to standardize table and fragment data structures.<br>2. <code>Asset</code> used by <code>core_assets.py</code> and <code>assets.py</code> for managing CSS/JS embedding and SRI hashing.<br>3. <code>RenderOptions</code> used by <code>core.py</code>, <code>cli.py</code>, and <code>main.py</code> to pass rendering configuration consistently.                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>             </td><td data-label="Conceptual Notes"> 1. Type definitions do not perform sanitization themselves.<br>2. Ensures metadata and content structures are well-typed, enabling consistent sanitization in <code>sanitize.py</code>.<br>3. Helps prevent accidental misuse of rich media or unsafe content by enforcing typed fields.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Compatibility</strong>                </td><td data-label="Conceptual Notes"> 1. <code>ExportFormat</code> ensures consistent handling of HTML, Markdown, CSV, XLSX exports.<br>2. <code>Fragment</code> and <code>TableData</code> structures ensure proper flattening or wrapping of table data for each export type.<br>3. Supports consistent application of Table Viewer classes and wrappers (<code>tv-table</code>, <code>tv-col-left</code>, etc.) across all output formats.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>                  </td><td data-label="Conceptual Notes"> 1. Verify all dataclasses/enums contain correct fields.<br>2. Test type consistency across modules using <code>Fragment</code>, <code>TableCell</code>, <code>TableRow</code>, <code>TableData</code>.<br>3. Confirm <code>Asset</code> objects properly store path, inline content, and SRI hashes.<br>4. Validate <code>RenderOptions</code> fields propagate correctly to <code>core.py</code>, <code>cli.py</code>, and rendering modules.<br>5. Ensure export behavior aligns with type definitions.                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>                  </td><td data-label="Conceptual Notes"> 1. Serves as central type definition module for all rendering-related modules.<br>2. Used by <code>core_table.py</code>, <code>convert.py</code>, <code>core_renderer.py</code>, <code>core_fragments.py</code>, <code>core_assets.py</code>, <code>assets.py</code>, <code>cli.py</code>.<br>3. Ensures consistent metadata and content representation across Table Viewer integration.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong>            </td><td data-label="Conceptual Notes"> 1. Audit existing type definitions for completeness and consistency.<br>2. Ensure <code>Fragment</code>, <code>TableCell</code>, <code>TableRow</code>, <code>TableData</code> fully capture all required Table Viewer metadata.<br>3. Validate <code>Asset</code> and <code>RenderOptions</code> structures for flexibility and correct default values.<br>4. Add type hints and docstrings for all fields.<br>5. Regression test all modules using these types to ensure no broken references.<br>6. Ensure all export formats handle typed structures correctly.                                                                                                                                                                                                                                                                                                                                                                                 </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table18" data-table="Book_8013_18" style="margin-top:2mm;margin-left:3mm;"><strong>Table 18</strong></div>
<div class="table-wrapper" data-table-id="table-18"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>                      </td><td data-label="Conceptual Notes"> <code>main.py</code> serves as the primary entry point for PasteToTable when invoked as a script. It coordinates reading input files, invoking the rendering pipeline, and writing outputs. Often combines CLI-like orchestration with programmatic API usage.                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions</strong>                   </td><td data-label="Conceptual Notes"> 1. <code>main()</code> – top-level function that may parse command-line arguments or hardcoded defaults.<br>2. <code>process_file(input_path, output_path, options)</code> – reads a single file and invokes <code>core.py</code> rendering functions (<code>render_table</code>, <code>render_html</code>, <code>render_page</code>).<br>3. <code>process_directory(input_dir, output_dir, options)</code> – iterates over files in a directory, applies <code>process_file</code> recursively.<br>4. Optional logging, verbose flags, and error handling for batch processing. </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration with Rendering Pipeline</strong> </td><td data-label="Conceptual Notes"> 1. Calls <code>core.py</code> for high-level rendering functions.<br>2. Uses <code>core_assets.py</code> / <code>assets.py</code> to inject CSS/JS.<br>3. Supports fragment handling via <code>core_fragments.py</code>.<br>4. May interact with <code>core_io.py</code> or <code>io_utils.py</code> for safe writes.                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>             </td><td data-label="Conceptual Notes"> 1. Delegates sanitization to <code>sanitize.py</code> via <code>core.py</code>.<br>2. Ensures file writes respect safe paths and directory permissions.<br>3. Handles exceptions to prevent partially written outputs.                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Compatibility</strong>                </td><td data-label="Conceptual Notes"> 1. HTML: fully Table Viewer-ready.<br>2. Markdown, CSV, XLSX: plain text or structured exports.<br>3. Handles batch exports for directories.                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>                  </td><td data-label="Conceptual Notes"> 1. Test single-file processing end-to-end.<br>2. Test directory batch processing.<br>3. Confirm assets are correctly injected (inline or copied).<br>4. Validate fragment rendering for multi-table pages.<br>5. Regression tests for empty files, malformed input, and mixed content.                                                                                                                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>                  </td><td data-label="Conceptual Notes"> 1. Entry point for scripts or automation pipelines.<br>2. Calls <code>core.py</code> rendering API.<br>3. Uses <code>core_assets.py</code> / <code>assets.py</code> for styling and scripts.<br>4. Works with <code>core_io.py</code> / <code>io_utils.py</code> for safe file operations.                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong>            </td><td data-label="Conceptual Notes"> 1. Ensure top-level orchestration correctly invokes <code>core.py</code>.<br>2. Verify proper file/directory handling, logging, and error capture.<br>3. Confirm asset injection and output format consistency.<br>4. Add regression tests for single and batch processing.<br>5. Validate integration with Table Viewer CSS classes and exported HTML.                                                                                                                                             </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table19" data-table="Book_8013_19" style="margin-top:2mm;margin-left:3mm;"><strong>Table 19</strong></div>
<div class="table-wrapper" data-table-id="table-19"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>                      </td><td data-label="Conceptual Notes"> <code>server.py</code> serves as a lightweight web server to provide live preview of rendered tables or pages. It may also expose a minimal API for automated rendering and testing without writing files to disk.                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions / Classes</strong>         </td><td data-label="Conceptual Notes"> 1. <code>start_server(port=8000, host=&quot;127.0.0.1&quot;)</code> – starts a local HTTP server serving rendered HTML pages.<br>2. <code>RequestHandler</code> – custom handler class to serve HTML pages, assets, and optionally accept rendering requests via HTTP POST.<br>3. <code>serve_file(input_path)</code> – renders a single input file and serves it live.<br>4. <code>serve_directory(input_dir)</code> – monitors a directory and serves multiple rendered tables or pages.                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration with Rendering Pipeline</strong> </td><td data-label="Conceptual Notes"> 1. Calls high-level rendering functions from <code>core.py</code> (<code>render_table</code>, <code>render_html</code>, <code>render_page</code>).<br>2. Uses <code>core_assets.py</code> / <code>assets.py</code> to inject CSS/JS for Table Viewer display.<br>3. May utilize <code>core_io.py</code> or <code>io_utils.py</code> for temporary file handling.<br>4. Uses <code>core_fragments.py</code> for fragment-level rendering if serving multi-table pages.                                                                                                                               </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>             </td><td data-label="Conceptual Notes"> 1. Delegates content sanitization to <code>sanitize.py</code> via <code>core.py</code>.<br>2. Ensures HTTP endpoints do not allow unsafe path access.<br>3. Optionally restricts uploaded content or POST requests to safe types (<code>text/markdown</code>, <code>text/html</code>).                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Compatibility</strong>                </td><td data-label="Conceptual Notes"> 1. HTML: fully Table Viewer-ready live preview.<br>2. Optional Markdown export through download endpoints.<br>3. CSV/XLSX exports may be served as downloadable files.                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>                  </td><td data-label="Conceptual Notes"> 1. Test live preview for single tables and multi-fragment pages.<br>2. Validate CSS/JS asset injection in live pages.<br>3. Confirm fragment rendering, TOC, and nested tables display correctly.<br>4. Regression tests for malformed input and missing files.<br>5. Validate concurrent requests do not corrupt output or server state.                                                                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>                  </td><td data-label="Conceptual Notes"> 1. Uses <code>core.py</code> as main rendering API.<br>2. Integrates <code>assets.py</code> / <code>core_assets.py</code> for front-end styling.<br>3. May interact with <code>main.py</code> for automated conversion workflows.<br>4. Front-end Table Viewer relies on correct CSS classes and HTML structure provided by the server.                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong>            </td><td data-label="Conceptual Notes"> 1. Audit HTTP endpoints and ensure safe file serving.<br>2. Confirm <code>render_table</code>, <code>render_html</code>, <code>render_page</code> are correctly called for live preview.<br>3. Validate asset embedding (inline or copied) for served pages.<br>4. Test fragment rendering and multi-table assembly.<br>5. Add regression tests for single and batch previews.<br>6. Ensure proper handling of concurrent requests and temporary files.<br>7. Confirm Table Viewer integration (CSS classes, TOC, nested tables). </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table20" data-table="Book_8013_20" style="margin-top:2mm;margin-left:3mm;"><strong>Table 20</strong></div>
<div class="table-wrapper" data-table-id="table-20"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>               </td><td data-label="Conceptual Notes"> <code>html_renderer.py</code> is a high-level renderer that assembles HTML pages from fragments, applies Table Viewer CSS/JS, handles TOC placement, and provides robust fallback mechanisms if certain lower-level modules are missing or incomplete.                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions / Classes</strong>  </td><td data-label="Conceptual Notes"> 1. <code>render_fragments_concurrently(fragments, **kwargs)</code> – renders multiple fragments in parallel using threads or processes.<br>2. <code>_assemble_page_html(fragments_html, assets_inline=True)</code> – combines fragments into a full HTML page, injects inline CSS/JS or copies assets.<br>3. <code>render_html_from_text(text, **kwargs)</code> – converts Markdown or plain text into Table Viewer-ready HTML.<br>4. <code>_fallback_render_html(content)</code> – fallback rendering if <code>convert.py</code> or <code>core_renderer.py</code> is unavailable.<br>5. <code>_fallback_render_table(table_data)</code> – fallback table renderer.<br>6. <code>render_page_from_fragments(fragments, **kwargs)</code> – high-level page renderer that uses metadata for TOC and indexing. </td></tr><tr><td data-label="Logic / Structure"> <strong>Fragment & Metadata Handling</strong> </td><td data-label="Conceptual Notes"> 1. Each fragment processed with proper cell wrappers (<code>cell-code</code>, <code>cell-math</code>, <code>cell-diagram</code>).<br>2. TOC entries generated from fragment metadata (<code>fragment_id</code>, headings).<br>3. Metadata stored for search indexing and optional highlights.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>Asset & CSS/JS Management</strong>    </td><td data-label="Conceptual Notes"> 1. Uses <code>core_assets.py</code> / <code>assets.py</code> to inject CSS and JS.<br>2. Supports inline embedding or copied assets for standalone pages.<br>3. Ensures Table Viewer classes (<code>tv-table</code>, <code>tv-col-left</code>, <code>tv-col</code>, <code>tv-nested-table</code>) applied consistently.                                                                                                                                                                                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>      </td><td data-label="Conceptual Notes"> 1. Delegates sanitization to <code>sanitize.py</code> via <code>core.py</code>.<br>2. Optional <code>allow_rich_media</code> flag for embedding images, diagrams, or media.<br>3. Fallback methods still sanitize content to prevent unsafe tags (<code>&lt;script&gt;</code>, <code>&lt;iframe&gt;</code>).                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Compatibility</strong>         </td><td data-label="Conceptual Notes"> 1. HTML: fully Table Viewer-ready, supports multi-fragment pages and TOC.<br>2. Markdown: preserves fenced code, lists, math, nested tables.<br>3. CSV/XLSX: not affected; fragments flattened to plain text.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>           </td><td data-label="Conceptual Notes"> 1. Test concurrent fragment rendering.<br>2. Verify fragment assembly, TOC, and metadata.<br>3. Validate fallback renderers produce safe, usable HTML.<br>4. Confirm asset injection (inline vs copied).<br>5. Regression tests for Markdown → HTML conversion and mixed content tables.                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>           </td><td data-label="Conceptual Notes"> 1. Called by <code>main.py</code> and <code>server.py</code> for page rendering.<br>2. Uses <code>core_fragments.py</code> and <code>core_renderer.py</code> for fragment processing.<br>3. Works with <code>core_assets.py</code> / <code>assets.py</code> for CSS/JS injection.<br>4. Integrates with Table Viewer via consistent HTML structure and CSS classes.                                                                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong>     </td><td data-label="Conceptual Notes"> 1. Audit concurrent fragment rendering for correctness and thread/process safety.<br>2. Validate fallback renderers and ensure safe HTML output.<br>3. Confirm metadata extraction for TOC and search indexing.<br>4. Ensure assets are properly embedded or copied.<br>5. Test mixed content, nested tables, and multi-fragment pages.<br>6. Add regression tests for all supported input types and fallback scenarios.<br>7. Ensure Table Viewer CSS classes are applied consistently in all cases.                                                                                                                                                                                                              </td></tr></tbody></table></div><div class="row-count">Rows: 9</div></div><div class="table-caption" id="Table21" data-table="Book_8013_21" style="margin-top:2mm;margin-left:3mm;"><strong>Table 21</strong></div>
<div class="table-wrapper" data-table-id="table-21"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Purpose</strong>                      </td><td data-label="Conceptual Notes"> <code>utils.py</code> contains general-purpose helper functions that support the rendering pipeline, I/O operations, string manipulation, logging, and other utilities needed by <code>main.py</code>, <code>server.py</code>, and rendering modules.                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions</strong>                   </td><td data-label="Conceptual Notes"> 1. <code>escape_html(text)</code> – safely escapes HTML characters to prevent injection.<br>2. <code>normalize_whitespace(text)</code> – removes excess whitespace and standardizes line breaks.<br>3. <code>slugify(text)</code> – converts headings or IDs into URL-safe slugs for fragment IDs and TOC entries.<br>4. <code>validate_path(path)</code> – checks existence, readability, and safety of file paths.<br>5. <code>ensure_dir(path)</code> – creates directories recursively if missing.<br>6. <code>read_file(path)</code> / <code>write_file(path, content)</code> – convenience wrappers for safe I/O, may internally call <code>io_utils.py</code>. </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration with Rendering Pipeline</strong> </td><td data-label="Conceptual Notes"> 1. Used by <code>main.py</code> and <code>server.py</code> for safe file handling and path validation.<br>2. Supports <code>core_fragments.py</code> and <code>core_table.py</code> by providing string normalization and ID generation.<br>3. Assists in safe asset handling when combined with <code>core_assets.py</code> / <code>assets.py</code>.                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>             </td><td data-label="Conceptual Notes"> 1. Escaping and path validation prevent unsafe input from corrupting HTML output or file system.<br>2. Works with <code>sanitize.py</code> to ensure consistent safe handling of user content.                                                                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Compatibility</strong>                </td><td data-label="Conceptual Notes"> 1. Supports HTML, Markdown, CSV, XLSX indirectly by ensuring safe content and normalized formatting.<br>2. Functions like <code>escape_html</code> and <code>slugify</code> help maintain Table Viewer-ready output.                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>                  </td><td data-label="Conceptual Notes"> 1. Validate <code>escape_html</code> produces correct HTML entities.<br>2. Test <code>normalize_whitespace</code> for various input edge cases.<br>3. Ensure <code>slugify</code> generates unique, URL-safe IDs for TOC and fragment metadata.<br>4. Confirm <code>validate_path</code> and <code>ensure_dir</code> handle invalid or missing paths safely.<br>5. Test file read/write wrappers for atomicity and error handling.                                                                                                                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>                  </td><td data-label="Conceptual Notes"> 1. Used widely across root-level scripts (<code>main.py</code>, <code>server.py</code>) and rendering modules.<br>2. Supports asset handling, fragment metadata generation, and safe content preparation.<br>3. Helps ensure consistent Table Viewer-ready HTML and export formats.                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong>            </td><td data-label="Conceptual Notes"> 1. Audit helper functions and confirm consistent behavior across modules.<br>2. Validate safe handling of paths, HTML content, and whitespace.<br>3. Add regression tests for all string and I/O utilities.<br>4. Ensure integration with <code>core_io.py</code> and <code>io_utils.py</code> for safe file operations.<br>5. Confirm Table Viewer compatibility for generated slugs, escaped content, and normalized text.                                                                                                                                                                        </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table22" data-table="Book_8013_22" style="margin-top:2mm;margin-left:3mm;"><strong>Table 22</strong></div>
<div class="table-wrapper" data-table-id="table-22"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>File Purpose</strong>                        </td><td data-label="Conceptual Notes"> <code>style.css</code> contains all CSS rules for rendering PasteToTable tables in Table Viewer. It ensures proper layout, styling of table cells, headers, nested tables, code blocks, math, and diagrams.                                                                                                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Key Classes / Rules</strong>                 </td><td data-label="Conceptual Notes"> 1. <code>.tv-table</code> – main table wrapper.<br>2. <code>.tv-col-left</code> – styling for first column <code>&lt;th&gt;</code> or <code>&lt;td&gt;</code>.<br>3. <code>.tv-col</code> – styling for other table columns.<br>4. <code>.tv-nested-table</code> – styling for nested tables inside a cell.<br>5. <code>.cell-code</code>, <code>.cell-math</code>, <code>.cell-diagram</code> – cell wrappers for code blocks, math, and diagrams.<br>6. General typography, spacing, borders, alternating row colors. </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration with Rendering Pipeline</strong> </td><td data-label="Conceptual Notes"> 1. Linked or embedded in HTML pages generated by <code>core.py</code>, <code>html_renderer.py</code>, <code>main.py</code>, or <code>server.py</code>.<br>2. Works in tandem with <code>assets.py</code> and <code>core_assets.py</code> for inline embedding or copying.<br>3. Ensures Table Viewer-ready pages maintain consistent look and feel across all exports.                                                                                                     </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>             </td><td data-label="Conceptual Notes"> 1. Pure CSS, does not require sanitization.<br>2. Used safely in inline <code>&lt;style&gt;</code> or linked <code>&lt;link&gt;</code> tags.                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Logic / Structure"> <strong>Export Compatibility</strong>                </td><td data-label="Conceptual Notes"> 1. HTML: full styling applied.<br>2. Markdown/CSV/XLSX: ignored (plain-text formats).                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>                  </td><td data-label="Conceptual Notes"> 1. Verify CSS classes match the classes applied in <code>core_table.py</code> and <code>html_renderer.py</code>.<br>2. Test nested tables, code blocks, math cells, and diagrams render correctly.<br>3. Confirm proper alignment of <code>.tv-col-left</code> vs <code>.tv-col</code>.<br>4. Regression tests for responsive layout and consistent spacing.                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>                  </td><td data-label="Conceptual Notes"> 1. Used by <code>assets.py</code> for inline embedding or copying to output directories.<br>2. Linked in HTML pages assembled by <code>html_renderer.py</code> and <code>server.py</code>.                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong>            </td><td data-label="Conceptual Notes"> 1. Audit all CSS classes to ensure they match Table Viewer wrappers applied in code.<br>2. Update styling for new cell types if needed (e.g., rich media, nested tables).<br>3. Test visual rendering in multiple browsers.<br>4. Confirm inline embedding and copied assets produce identical styling results.                                                                                          </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table23" data-table="Book_8013_23" style="margin-top:2mm;margin-left:3mm;"><strong>Table 23</strong></div>
<div class="table-wrapper" data-table-id="table-23"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>File Purpose</strong>                          </td><td data-label="Conceptual Notes"> <code>script.js</code> is the main client-side enhancement script for Table Viewer-rendered tables. Its responsibilities include <strong>interactive table behavior, accessibility, dynamic updates, sorting, search highlighting, fragment navigation, nested table management, and integration hooks for future rich media</strong>. It ensures that tables rendered by <code>core_table.py</code> and <code>html_renderer.py</code> behave consistently in live HTML or server-rendered pages.                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Table Initialization</strong>                  </td><td data-label="Conceptual Notes"> 1. On DOMContentLoaded or deferred execution, scans the document for all <code>.tv-table</code> elements.<br>2. Initializes internal state objects for each table, storing metadata like column count, sortable columns, nested table references, and fragment IDs.<br>3. Applies unique IDs to each table and nested table for DOM targeting.<br>4. Registers tables in a global <code>window.TVTables</code> object to allow API access for debugging, testing, or automation.                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Column Sorting</strong>                        </td><td data-label="Conceptual Notes"> 1. Adds click listeners to <code>.tv-col-left</code> headers for sortable tables.<br>2. Determines column type (numeric, text, code, date, or mixed) by scanning first N rows.<br>3. Performs stable sorting to preserve relative row order in multi-column sorts.<br>4. Handles nested tables by keeping them within parent rows.<br>5. Applies CSS classes (<code>.sorted-asc</code>, <code>.sorted-desc</code>) to visually indicate current sort state.<br>6. Emits custom events (<code>tv:sort</code>) to allow external scripts or extensions to respond to sort actions.                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Row Highlighting & Selection</strong>          </td><td data-label="Conceptual Notes"> 1. Adds hover highlighting to all <code>&lt;tr&gt;</code> elements except headers.<br>2. Supports single-click selection of rows, toggling <code>.selected</code> class.<br>3. Supports multi-select via Shift+Click or Ctrl/Cmd+Click.<br>4. Optional keyboard navigation (up/down arrows) to traverse selected rows.<br>5. Emits events (<code>tv:rowSelected</code>, <code>tv:rowHovered</code>) for external scripts or logging.                                                                                                                                                                                            </td></tr><tr><td data-label="Logic / Structure"> <strong>Nested Table Management</strong>               </td><td data-label="Conceptual Notes"> 1. Collapsible nested tables using <code>.tv-nested-table</code> wrapper.<br>2. Adds toggle buttons on parent row cells to expand/collapse nested content.<br>3. Maintains visual alignment and spacing when collapsing.<br>4. Optional “expand all” / “collapse all” functions exposed on global <code>TVTables</code> API.<br>5. Integrates with fragment metadata for TOC highlighting, ensuring nested tables are navigable via fragment links.                                                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Search & Highlighting</strong>                 </td><td data-label="Conceptual Notes"> 1. Provides optional client-side search highlighting for table content.<br>2. Scans <code>.tv-table</code> cells for matching text or regex patterns.<br>3. Wraps matches with <code>&lt;mark&gt;</code> elements while preserving inner HTML (fenced code, math spans, diagrams).<br>4. Exposes API (<code>TVTables.search(query)</code>) for programmatic search and highlighting.<br>5. Optionally scrolls to first match or highlights across multiple fragments.                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Fragment Navigation & TOC Integration</strong> </td><td data-label="Conceptual Notes"> 1. Supports linking table fragments via <code>fragment_id</code> metadata.<br>2. Adds event hooks for TOC links to scroll to corresponding tables.<br>3. Updates URL hash to reflect currently visible fragment for deep-linking.<br>4. Maintains synchronization between multiple fragments on a single page.                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Accessibility Features</strong>                </td><td data-label="Conceptual Notes"> 1. Adds ARIA roles (<code>role=&quot;table&quot;</code>, <code>role=&quot;columnheader&quot;</code>, <code>role=&quot;row&quot;</code>) for screen readers.<br>2. Supports keyboard navigation for row selection and nested table toggling.<br>3. Maintains focus outline for selected rows and active nested tables.<br>4. Ensures color contrasts for highlights meet WCAG standards.                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Event System & API</strong>                    </td><td data-label="Conceptual Notes"> 1. Exposes global API under <code>window.TVTables</code>:<br> • <code>sort(tableId, colIndex, direction)</code><br> • <code>selectRow(tableId, rowIndex)</code><br> • <code>expandNested(tableId, rowIndex)</code><br> • <code>collapseNested(tableId, rowIndex)</code><br> • <code>search(tableId, query)</code><br>2. Emits custom events (<code>tv:sort</code>, <code>tv:rowSelected</code>, <code>tv:rowHovered</code>, <code>tv:fragmentVisible</code>) for external listeners.<br>3. Allows extensions or plugins to hook into table lifecycle.                                                                                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Asset & Style Coordination</strong>            </td><td data-label="Conceptual Notes"> 1. Relies on <code>style.css</code> for <code>.tv-table</code>, <code>.tv-col-left</code>, <code>.tv-col</code>, <code>.tv-nested-table</code>, and <code>.cell-*</code> classes.<br>2. Adds/removes dynamic CSS classes (<code>.sorted-asc</code>, <code>.sorted-desc</code>, <code>.highlighted</code>, <code>.collapsed</code>) without altering base CSS.<br>3. Ensures compatibility with inline or copied CSS assets.                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Rich Media & Future Extensions</strong>        </td><td data-label="Conceptual Notes"> 1. Optional hooks for embedding diagrams, images, math (KaTeX/MathJax), and code highlighting.<br>2. Worker thread integration possible for client-side processing (e.g., search indexing) using <code>worker.js</code>.<br>3. API allows registering custom renderers for new cell types or interactive widgets.                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Performance Considerations</strong>            </td><td data-label="Conceptual Notes"> 1. Debounces expensive operations (e.g., search highlighting) to avoid layout thrashing.<br>2. Uses <code>requestAnimationFrame</code> for DOM updates during sorting or collapsing nested tables.<br>3. Lazy-loads nested table content when collapsed to reduce initial page render time.                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>Error Handling & Fallbacks</strong>            </td><td data-label="Conceptual Notes"> 1. Wraps DOM manipulations in <code>try/catch</code> to prevent breaking the page.<br>2. Logs warnings to console for missing table classes, invalid fragments, or unsupported features.<br>3. Provides no-op fallbacks if optional features (nested tables, search) are unavailable.                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>                    </td><td data-label="Conceptual Notes"> 1. Validate all table types (simple, nested, multi-fragment, mixed cell types).<br>2. Test sorting (numeric, text, code, date) for correctness and stability.<br>3. Test nested table expand/collapse behavior.<br>4. Test fragment linking, TOC integration, and URL hash updates.<br>5. Validate search highlighting preserves inner HTML (code/math/diagram).<br>6. Confirm accessibility features (ARIA roles, keyboard navigation, focus).<br>7. Test API calls via <code>TVTables</code> for programmatic operations.<br>8. Cross-browser tests for Chrome, Firefox, Safari, Edge. </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>                    </td><td data-label="Conceptual Notes"> 1. Linked or embedded by <code>assets.py</code> or <code>core_assets.py</code>.<br>2. Used in HTML pages generated by <code>html_renderer.py</code> and <code>server.py</code>.<br>3. Operates on Table Viewer classes applied by <code>core_table.py</code> and <code>convert.py</code>.<br>4. Optional integration with <code>worker.js</code> for client-side indexing and processing.                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong>              </td><td data-label="Conceptual Notes"> 1. Audit all table event listeners for performance and correct targeting.<br>2. Ensure API consistency and naming (<code>TVTables</code>).<br>3. Add regression tests for sorting, search, nested tables, fragment navigation, and accessibility.<br>4. Test inline embedding vs copied script inclusion.<br>5. Add hooks for new cell types or future rich media features.<br>6. Confirm compatibility with Table Viewer CSS (<code>style.css</code>) and HTML wrappers.                                                                                                                           </td></tr></tbody></table></div><div class="row-count">Rows: 16</div></div><div class="table-caption" id="Table24" data-table="Book_8013_24" style="margin-top:2mm;margin-left:3mm;"><strong>Table 24</strong></div>
<div class="table-wrapper" data-table-id="table-24"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>File Purpose</strong>                               </td><td data-label="Conceptual Notes"> <code>worker.js</code> is an optional Web Worker script intended to offload <strong>client-side processing tasks</strong> from the main UI thread. Its design supports features like <strong>search indexing, large table operations, fragment pre-processing, and rich media handling</strong> without blocking table interactions in Table Viewer pages.                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Primary Functions / Behavior</strong>               </td><td data-label="Conceptual Notes"> 1. <code>onmessage</code> handler – receives messages from the main thread containing tasks (e.g., search, highlight, fragment indexing, table metadata processing).<br>2. <code>postMessage</code> – sends results or progress updates back to the main thread.<br>3. Task queue management – ensures multiple operations can be queued and processed sequentially or concurrently as needed.<br>4. Error handling – captures errors within the worker and returns structured error messages instead of throwing on the main thread.                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Search Indexing</strong>                            </td><td data-label="Conceptual Notes"> 1. Can build lightweight indices of table content, storing mappings of words, cell positions, and fragment IDs.<br>2. Supports tokenization of table content including text, code blocks, and math spans.<br>3. Returns search result positions to main thread for highlighting via <code>script.js</code>.<br>4. Debounces repetitive indexing requests to avoid redundant computation.                                                                                                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>Fragment Preprocessing</strong>                     </td><td data-label="Conceptual Notes"> 1. Optionally processes multiple fragments in parallel for live preview.<br>2. Computes table or fragment metadata: column types, row counts, fragment IDs, nested table mappings.<br>3. Can preprocess cell content to normalize whitespace, escape HTML, or prepare inline math/code for main thread rendering.                                                                                                                                                                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>Nested Table & Cell Type Analysis</strong>          </td><td data-label="Conceptual Notes"> 1. Scans tables for nested <code>.tv-nested-table</code> elements.<br>2. Builds a lightweight tree structure for nested tables to allow <code>script.js</code> to manage collapse/expand efficiently.<br>3. Classifies cell types: <code>code</code>, <code>math</code>, <code>diagram</code>, <code>text</code>.<br>4. Optional metadata export for fragment TOC or indexing.                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration with Main Thread (<code>script.js</code>)</strong> </td><td data-label="Conceptual Notes"> 1. Receives tasks via <code>postMessage({task: &#x27;index&#x27;, tableId, content})</code>.<br>2. Returns results using <code>postMessage({task: &#x27;indexComplete&#x27;, tableId, index})</code>.<br>3. Communicates asynchronously, allowing <code>script.js</code> to continue UI updates without blocking.<br>4. Integrates with <code>TVTables</code> API for optional search and highlighting.<br>5. Can handle multiple concurrent table or fragment tasks for live preview pages served by <code>server.py</code>.                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Performance & Efficiency</strong>                   </td><td data-label="Conceptual Notes"> 1. Offloads heavy computations (search indexing, fragment preprocessing) from main thread.<br>2. Avoids DOM manipulation inside worker; only processes data.<br>3. Supports batching of large tables to prevent memory spikes.<br>4. Can throttle processing for pages with dozens of fragments or nested tables.                                                                                                                                                                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>Rich Media & Future Extensions</strong>             </td><td data-label="Conceptual Notes"> 1. Designed to allow optional processing of rich media inside cells: diagrams, embedded images, math, or custom HTML content.<br>2. Future hooks may allow pre-rendering of LaTeX/KaTeX math, diagram layout, or syntax highlighting.<br>3. Can provide async processing for client-side Table Viewer plugins/extensions.                                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Error Handling & Robustness</strong>                </td><td data-label="Conceptual Notes"> 1. All exceptions caught inside worker and returned to main thread in structured JSON format.<br>2. Provides status messages for progress, completion, or error to allow <code>script.js</code> to display progress bars or logs.<br>3. Ensures worker does not terminate unexpectedly, allowing retries for failed tasks.                                                                                                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>                         </td><td data-label="Conceptual Notes"> 1. Test indexing for large tables (hundreds/thousands of rows).<br>2. Validate correct mapping of search results to fragment IDs.<br>3. Test nested table metadata generation.<br>4. Regression tests for concurrent tasks and error handling.<br>5. Confirm integration with <code>script.js</code> and <code>TVTables</code> API for highlighting and search.<br>6. Test fallback behavior when worker fails or is unsupported by browser.                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>                         </td><td data-label="Conceptual Notes"> 1. Optional enhancement for live pages rendered by <code>html_renderer.py</code> or served by <code>server.py</code>.<br>2. Works in conjunction with <code>script.js</code> to maintain main-thread responsiveness.<br>3. Provides future-ready hooks for rich media, syntax highlighting, or large dataset processing.<br>4. Communicates with main thread via structured messages (<code>postMessage</code> / <code>onmessage</code>).                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong>                   </td><td data-label="Conceptual Notes"> 1. Audit all message types and task formats for consistency with <code>script.js</code>.<br>2. Add robust error reporting and fallback behavior.<br>3. Test search indexing, fragment preprocessing, and nested table mapping.<br>4. Ensure compatibility with all supported browsers that implement Web Workers.<br>5. Add regression tests for performance on large datasets and multiple fragments.<br>6. Document API for <code>script.js</code> to submit tasks and receive results.<br>7. Plan hooks for future rich media or Table Viewer extension features. </td></tr></tbody></table></div><div class="row-count">Rows: 12</div></div><div class="table-caption" id="Table25" data-table="Book_8013_25" style="margin-top:2mm;margin-left:3mm;"><strong>Table 25</strong></div>
<div class="table-wrapper" data-table-id="table-25"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>File Purpose</strong>               </td><td data-label="Conceptual Notes"> <code>index.html</code> serves as the <strong>base HTML template</strong> for all Table Viewer pages. It provides the foundational structure, links to assets (<code>style.css</code>, <code>script.js</code>), defines placeholders for fragments, TOC, and allows integration with server-side or static rendering pipelines.                                                                                                                                                                                            </td></tr><tr><td data-label="Logic / Structure"> <strong>Base Structure</strong>             </td><td data-label="Conceptual Notes"> 1. <code>&lt;head&gt;</code> – includes <code>&lt;meta charset=&quot;UTF-8&quot;&gt;</code>, viewport settings, optional title placeholder, and links to CSS (<code>style.css</code>) and JS (<code>script.js</code>).<br>2. <code>&lt;body&gt;</code> – contains main container for tables and fragments.<br>3. Placeholder <code>&lt;div id=&quot;toc&quot;&gt;&lt;/div&gt;</code> for Table of Contents linked to fragment IDs.<br>4. Main content container <code>&lt;div id=&quot;content&quot;&gt;&lt;/div&gt;</code> where fragments or tables are injected.<br>5. Optional footer for metadata, licensing, or debug info. </td></tr><tr><td data-label="Logic / Structure"> <strong>Fragment & Table Placement</strong> </td><td data-label="Conceptual Notes"> 1. Fragments inserted into <code>&lt;div id=&quot;content&quot;&gt;</code> by <code>html_renderer.py</code> or <code>server.py</code>.<br>2. Each fragment wrapped in <code>&lt;div class=&quot;fragment&quot; id=&quot;fragment-&lt;id&gt;&quot;&gt;</code> for Table Viewer navigation.<br>3. Tables inside fragments maintain <code>.tv-table</code>, <code>.tv-col-left</code>, <code>.tv-col</code>, and <code>.tv-nested-table</code> classes.<br>4. Fragment metadata (IDs, headings) used for TOC generation and URL hash navigation.                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Asset Integration</strong>          </td><td data-label="Conceptual Notes"> 1. <code>&lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;</code> – provides Table Viewer CSS.<br>2. <code>&lt;script src=&quot;script.js&quot;&gt;&lt;/script&gt;</code> – provides interactive behaviors (sorting, nested table toggling, search highlighting, fragment navigation).<br>3. Optional <code>&lt;script src=&quot;worker.js&quot; type=&quot;module&quot;&gt;&lt;/script&gt;</code> – deferred loading for client-side processing of large tables or fragments.<br>4. Inline CSS/JS injection optional via <code>core_assets.py</code> for standalone pages.             </td></tr><tr><td data-label="Logic / Structure"> <strong>TOC & Navigation</strong>           </td><td data-label="Conceptual Notes"> 1. TOC dynamically generated using fragment headings and IDs.<br>2. Links scroll to corresponding fragment <code>&lt;div&gt;</code> using <code>fragment_id</code>.<br>3. URL hash updates maintain deep-linking to fragments.<br>4. Supports multi-page or multi-fragment setups.                                                                                                                                                                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Accessibility Features</strong>     </td><td data-label="Conceptual Notes"> 1. ARIA roles for tables (<code>role=&quot;table&quot;</code>), headers (<code>role=&quot;columnheader&quot;</code>), rows (<code>role=&quot;row&quot;</code>).<br>2. Focusable elements for fragment links in TOC.<br>3. Ensures keyboard navigation for interactive tables, nested tables, and TOC links.<br>4. Semantic markup helps screen readers navigate tables and fragments.                                                                                                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Sanitization & Security</strong>    </td><td data-label="Conceptual Notes"> 1. Template itself is safe; dynamic content inserted via <code>html_renderer.py</code> is sanitized using <code>sanitize.py</code>.<br>2. Script and style assets trusted or optionally inlined.<br>3. URL hash navigation is escaped to prevent XSS.                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>Testing & QA Notes</strong>         </td><td data-label="Conceptual Notes"> 1. Validate correct fragment injection and TOC linking.<br>2. Test table rendering inside fragments with nested tables, code/math/diagram cells.<br>3. Confirm CSS styling applied correctly across browsers.<br>4. Verify <code>script.js</code> behaviors (sorting, highlighting, nested tables) work when linked via template.<br>5. Regression tests for multiple fragments, deep linking, and live preview via <code>server.py</code>.                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration Points</strong>         </td><td data-label="Conceptual Notes"> 1. Used by <code>html_renderer.py</code> and <code>server.py</code> as base template.<br>2. Works with <code>assets/style.css</code> and <code>assets/script.js</code> for full Table Viewer functionality.<br>3. Fragments injected dynamically from <code>core_fragments.py</code> and <code>convert.py</code> pipelines.<br>4. Optional Web Worker (<code>worker.js</code>) integration for large table processing.                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Stepwise Upgrade Actions</strong>   </td><td data-label="Conceptual Notes"> 1. Audit template for semantic correctness, accessibility, and asset links.<br>2. Confirm fragment placeholders (<code>#content</code>) and TOC (<code>#toc</code>) match <code>html_renderer.py</code> insertion points.<br>3. Validate inline vs linked CSS/JS embedding.<br>4. Test deep-linking and URL hash fragment navigation.<br>5. Ensure compatibility with multiple fragments, nested tables, and multi-page outputs.<br>6. Add regression tests for live preview and static page generation.      </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>