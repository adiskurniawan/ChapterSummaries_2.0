<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1769960840">
<link rel="stylesheet" href="assets/overrides.css?v=1771304680">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li>
<li class="toc-item"><a class="toc-link" href="#Table7">Table 7</a></li>
<li class="toc-item"><a class="toc-link" href="#Table8">Table 8</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="YJKN_0005_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **EQUIPSEA — Accounting manual**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>EQUIPSEA — Accounting manual</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Integrity check statement</strong><br>I scanned the full session and the prior delivered manual content carefully and repeatedly to ensure internal consistency, coherent parameter names, matching EventCode usage and preserved original content. The material below is an expanded, non-reduced superset of prior content with extensive real-world NGO examples, additional technical patterns (Power Query / Power Pivot / DAX / PQ M snippets), operational checklists, escalation matrices, and a dedicated section covering GL extraction options from Microsoft Dynamics 365 (D365) including practical mappings to the GLUpload process. All numbered lists and bullet points use explicit HTML <code>&lt;br&gt;</code> line breaks as requested. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Purpose & objective — further expanded</strong><br>This manual is the authoritative operational and training reference for the Accounting Manager who will operate the EQUIPSEA event ledger end-to-end.<br><br>Primary learning outcomes (expanded):<br>1. Master the entire event lifecycle: Budget approval → Award issuance → Spend capture → Accruals → Bank payment → GL posting → Reconciliation → Audit pack distribution.<br>2. Build automation (PQ → Data Model → GLUpload) to reduce manual errors and shorten reconciliation cycles.<br>3. Implement donor-specific compliance checks (rules engine) and demonstrate traceable remedial actions for exceptions.<br>4. Operate multi-currency and cross-border payment scenarios with correct VAT and withholding accounting.<br>5. Produce an audit-ready index and response playbook for sampled auditor queries.<br><br>Narrative: events aggregate many individually small lines that together create complexity. The accounting manager must treat the entire exercise as a short-lived but fully governed programme ledger with its own lifecycle and immutable evidence trail. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Event facts & master metadata — reinforced design</strong><br>EventMaster recommended schema (expanded fields):<br>• EventCode — unique string (e.g., <code>EQUIPSEA202602</code>).<br>• EventTitle — full official name.<br>• StartDate / EndDate — YYYY-MM-DD.<br>• HostLocation — full postal address and country tax jurisdiction.<br>• PrimaryContactName / Email / Phone.<br>• OrganiserDept / UnitLead.<br>• CurrencyPrimary / OtherCurrencies[] — list of active currencies.<br>• PrimaryBankAccount — account number, bank name, SWIFT/BIC, currency.<br>• ProjectGrantMappings — mapping table (GrantCode, %Allocation, DonorRulesRef).<br>• CutOffCalendar — object of dates keyed by action (BookingCutoff, AdvanceCutoff, ClaimCutoff, AccrualDate, AuditPackDate).<br>• RetentionPolicy — retention period by document type and donor clause overrides.<br>• MaterialityThresholds — accrual threshold, escalation threshold, petty cash threshold.<br>• FolderPaths — canonical local or cloud paths for <code>_raw</code>, <code>_clean</code>, <code>AuditPack</code>, templates.<br>• ChangeLogRef — pointer to <code>ChangeLog</code> workbook entry.<br><br>Operational rules:<br>• Block ingestion of any document lacking EventCode (PQ filter) unless an exception is explicitly logged.<br>• Make EventMaster the single parameter source for all PQ queries, GL uploads and dashboard filters. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Scope & exclusions — expanded with borderline decision rules</strong><br>Scope clarifies what to capture; exclusions keep the ledger clean.<br><br>Included categories (explicit):<br>• Travel awards and award-related reimbursements.<br>• Participant per diems and subsistence costs directly related to event nights.<br>• Venue hire, A-V, catering, materials and printing for event activities.<br>• Local speaker fees, honoraria and short-term consultant costs directly for the event.<br>• Travel agent fees and booking fees tied to participant flights for the event.<br><br>Explicit exclusions & borderline decision matrix:<br>1. Multi-year license purchase for an organisational tool — exclude unless explicitly consumed only for the event and within donor rules.<br>2. Capital item (meet capitalisation threshold) — route to capital project; record only a charge-back if minor consumable.<br>3. HR payroll — exclude unless event-specific stipends or short-term casual payroll are pre-approved and linked to EventCode.<br><br>Decision rule (one-line): if the cost cannot be supported by event attendance, deliverable evidence or donor allowance — route outside event ledger. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Key definitions & recognition principle — expanded clarity</strong><br>Recognition & matching rules (operational):<br>• Use accrual basis: expense is recognised in the period services were rendered (e.g., service date/catering date) not payment date unless expense is prepayment for future events.<br>• Prepayment vs Accrual: prepayment for services in future months → <code>PrepaidExpense</code> amortisation schedule; service rendered within event month → <code>Expense</code> and, if invoice post-month, create <code>Accrued Liability</code>.<br><br>Examples for clarity:<br>• Airfare purchased Jan 10 for travel on Feb 4–6 (event) — recognise expense Feb using accrual if payment is made outside Feb.<br>• Catering on Feb 4, invoice arrived Feb 20 (post close) — at 2026-02 month end: post accrual for catering. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Governance, RACI & responsibilities — practical templates</strong><br>Operational RACI matrix (detailed responsibilities):<br>• Country Director (CD) — Approve policy exceptions, high-value items (> threshold), final authoriser for lost or disallowed costs.<br>• Country Finance Director (CFD) — Approve accruals > materiality threshold, sign off audit pack, approve GL mapping changes.<br>• Accounting Manager — Prepare ControlSheet, maintain PQ queries, create GLUpload, assemble AuditPack, owner of <code>EventMaster</code> and <code>ChangeLog</code> updates.<br>• Payments Officer — Prepare and submit payment batches, reconcile bank results, file bank advices.<br>• Budget Holders — Validate participant attendance and approve cost allocations.<br>• HR / Travel Desk — Provide participant details, confirm travel bookings and attendance proofs.<br>• IT / Data Owner — Enforce folder permissions and backups.<br>• Internal Audit — Independent checks and sample testing.<br><br>Delegation rules during compressed timelines:<br>• Record any temporary delegation in the <code>DelegationLog</code> with start/end dates and replaced approver contact; attach executive email approval. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Pre-workshop controls — expanded checklist & PQ preflight tests</strong><br>Pre-event technical pre-flight checklist (detailed):<br>1. Create/verify EventMaster and parameterise PQ queries.<br>2. Establish <code>_raw</code> ingestion structure: <code>_raw/AP/</code>, <code>_raw/Claims/</code>, <code>_raw/Awards/</code>, <code>_raw/Bank/</code>, <code>_raw/Suppliers/</code>.<br>3. Populate <code>SupplierMaster</code> with taxIDs and bank details for known suppliers.<br>4. Run a PQ dry-run on sample files and validate mapping outputs (rows count, null rate in required fields).<br>5. Confirm <code>FXRates</code> table feeds and ensure nearest-prior logic produces no null rates for event dates.<br>6. Publish <code>CutOffCalendar</code> to programme leads and participants and confirm receipt.<br><br>Pre-event control sheet items to lock in:<br>• Template <code>ControlSheet</code> with protected <code>FXRate</code> and <code>LocalAmount</code> formulas.<br>• Approval workflow: <code>Submitted → Approved → Paid → Reconciled</code> with timestamps and approver IDs. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Travel award management — NGO-specific worked examples</strong><br>Worked example 1 — Small NGO (regional):<br>• NGO context: regional public-health training run by a small NGO with restricted donor funds (Donor A prohibits economy upgrades).<br>• Award P001 — Full travel up to USD 1,000. Participant books economy fare USD 950 and hotel USD 120. Participant requests reimbursement with receipts.<br>• Accounting steps:<br>1. Verify <code>tblAwards</code> P001 details and acceptance.<br>2. PQ ingest claim, map to EventCode and FundingSource (Donor A).<br>3. Verify fare class in itinerary and receipts; ensure local taxi costs are within donor rules.<br>4. Post reimbursement: <code>Dr Travel Expense 1,070 USD / Cr Bank 1,070 USD — EQUIPSEA202602 Participant P001</code>.<br><br>Worked example 2 — Large international NGO (e.g., Save the Children style): cross-funded award with donor restrictions:<br>• Award P010 — Max USD 2,000 funded 70% by DonorX (programme) and 30% by unrestricted local funds.<br>• Participant submits mixed currency receipts (EUR airfare, IDR local transport).<br>• Accounting steps:<br>1. PQ merges Claims_Clean with FXRates to produce LocalAmount in USD for each line.<br>2. Use FundingSplit columns in <code>tblControl</code> to allocate each line to GrantA & LocalFund. <br>3. Create split journal with two project lines or use cost centre split in GL upload: <code>Dr Travel Expense 1,500 USD (GrantA 70%) / Dr Travel Expense 642.86 USD (Local 30%) / Cr Bank 2,142.86 USD</code> (example rounding applied). </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Per diems, subsistence & taxable benefits — country-by-country notes</strong><br>Operational guidance for multiple jurisdictions:<br>• Maintain <code>PerDiemRates</code> with effective dates and country-specific tax flags.<br>• If the per diem exceeds local tax-free thresholds, create <code>Dr Travel Expense (Gross) / Cr Payable</code> and <code>Dr PAYE Withholding / Cr Bank</code> per tax rules.<br>• Use specific country examples:<br>• Indonesia: track whether per diem is considered taxable depending on residence status and local law — consult local adviser and attach tax memo to AuditPack.<br>• UK (for UK-based NGOs): certain allowances can be taxable; consult payroll for PAYE treatment on per diems above statutory amounts.<br><br>Practical per diem posting example:<br>• 3 nights at IDR 500,000 = IDR 1,500,000<br><code>Dr Travel Expense — Per Diem 1,500,000 IDR / Cr Bank 1,500,000 IDR — EQUIPSEA202602 Participant P001</code> </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Advances issuance, reconciliation & recovery — extended policies</strong><br>Detailed advance lifecycle:<br>1. Request & Approval: <code>AdvanceRequest</code> form requiring BudgetHolder + Finance approval for advances > ApprovalThreshold.<br>2. Issuance: bank transfer executed, journal <code>Dr Advances to Staff / Cr Bank</code> with <code>AdvanceID</code> reference saved to <code>_raw/advances/</code>.<br>3. Reconciliation: participant submits receipts; PQ loads them and flags <code>AdvanceID</code> match; compute <code>Variance = Advance - ReceiptsTotal</code>.<br>4. Settlement: if receipts < advance → participant refunds via bank or payroll deduction; if receipts > advance → process reimbursement journal.<br>5. Recovery via payroll: require signed recovery agreement and HR confirmation that deduction will not breach statutory minimum wages.<br><br>Worked example — Advance with under-spend:<br>• Advance USD 500 issued.<br>• Receipts provided USD 350.<br>• Accounting entries:<br><code>Issuance: Dr Advances to Staff 500 / Cr Bank 500</code>.<br><code>Settlement: Dr Travel Expense 350 / Dr Bank (refund) 150 / Cr Advances to Staff 500</code>.<br>• If refund not received: create <code>Exception</code> with <code>Owner = Payroll Liaison</code> and <code>Action = Payroll Deduction</code> with signed consent attached. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Vendor procurement & contracting — NGO procurement nuances</strong><br>Procurement additions for NGOs:<br>• Donor-specific procurement thresholds and supplier conflict-of-interest declarations must be captured in <code>SupplierOnboard</code>.<br>• For humanitarian NGOs, include <code>Localization</code> and <code>VendorCapacity</code> assessments in the evaluation scorecard.<br>• For international suppliers check whether reverse charge VAT applies and capture required documentation.<br><br>Procurement evidence to collect & archive:<br>• RFQ pack, Bid evaluations, Selected supplier offer, Contract/PO, VAT invoices, Delivery/acceptance sign-off and supplier bank details with tax certificates. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Invoice lifecycle & AP ingestion — advanced PQ architecture</strong><br>Robust AP ingestion architecture (expanded):<br>1. <code>_raw</code> ingest rules: use PQ to read all file types, extract filename meta (EventCode, Supplier, InvoiceNo) with regex and fallback logic.<br>2. Normalisation layer: standardise date formats, currency codes, numeric formats and split multi-currency invoices into lines if needed.<br>3. Supplier normalisation: <code>SupplierMapping</code> with manual overrides; maintain <code>SupplierCanonicalName</code> and <code>SupplierID</code> for GL mapping.<br>4. Validation layer: missing EventCode, missing GL mapping, missing tax ID and ineligible keyword filters produce <code>ValidationErrors</code> column.<br>5. Approval feed: <code>Invoices_Clean</code> presented to approvers with <code>ApprovalLink</code> to the <code>ControlSheet</code> row.<br><br>Advanced PQ validations (examples):<br>• <code>if [InvoiceDate] &gt; CutoffDate then error</code> flag.<br>• <code>if [Amount] &lt;= 0 then ValidationError = &quot;Zero or negative amount&quot;</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Currency, FX, VAT & tax compliance — more examples</strong><br>Complex cross-border VAT example (NGO):<br>• Vendor in EU invoices EUR 1,000 + VAT 20%. Donor allows VAT recoverable for NGO if vendor provides correct VAT invoice and NGO VAT registration allows reclaim.<br>• Invoice EUR 1,200 total on 2026-02-04. FX EUR→USD = 1.08 (InvoiceDate).<br>• Journal:<br><code>Dr Workshop Expense 1,080 USD</code><br><code>Dr VAT Recoverable 216 USD</code><br><code>Cr Accounts Payable 1,296 USD</code>.<br><br>Withholding example (regional NGO paying non-resident speaker):<br>• Speaker gross fee GBP 1,000; withholding 20% applies.<br>• Accounting:<br><code>Dr Speaker Expense (Gross) 1,000 GBP / Cr Payable 1,000 GBP</code>.<br><code>Dr Payable 1,000 GBP / Cr Bank (NetPaid) 800 GBP / Cr WithholdingLiab 200 GBP</code>.<br><code>Dr WithholdingLiab / Cr Bank</code> when remitted. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Expense claims, form standards & digitalisation — best practice</strong><br>Digitalisation recommendations:<br>• Use a fillable PDF or an online form (Microsoft Forms / Power Apps) that enforces mandatory fields and attachments.<br>• Ensure filename convention for attachments includes EventCode and ParticipantID.<br>• PQ should parse these filenames and map them automatically to <code>ControlSheet</code> lines. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Payment controls & bank procedure — expanded operational controls</strong><br>Bank batch detailed controls:<br>• Payment batch contains <code>BatchID</code>, initiated by PaymentsOfficer, approved by ApproverID, executed and recorded with BankAdvicePath and SWIFT refs.<br>• For large payments: require dual signatory and record sign-off evidence in <code>AuditPack/Payments/</code>.<br>• Reconcile bank feeds to payment batches daily during event running period. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>GL mapping, journal rules & narrative examples — extended</strong><br>Enhanced GL mapping table (recommended structure):<br>• <code>CategoryCode | CategoryDesc | DefaultGL | VATGL | CostCenter | Project | NarrationTemplate | DonorAllowed | RiskFlag</code>.<br><br>Journal narration best practice:<br>• Always include <code>EventCode</code>, <code>Supplier</code>, <code>InvoiceNo</code> or <code>ParticipantID</code>, <code>BatchID</code> and an accrual or payment tag for quick traceability.<br>• Example accrual narration: <code>EQUIPSEA202602 — Venue accrual — Period 202602 — INV0001 — VendorName</code>.<br>• Example payment narration: <code>EQUIPSEA202602 — VendorName — INV0001 — Batch BB20260220</code>.<br><br>Journals for split funding (example):<br>• Invoice USD 1,000 split 70/30 between GrantA and GrantB.<br><code>Dr Workshop Expense 700 (GrantA) / Dr Workshop Expense 300 (GrantB) / Cr Accounts Payable 1,000 USD</code> (use project/cost centre split fields). </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Control sheet anatomy & workbook design — extended templates</strong><br>ControlSheet recommended columns (full):<br><code>LineID | SourceType | DocNo | InvoiceDate | DueDate | Supplier / Participant | SupplierID | Currency | Amount | FXRateFormula | LocalAmount | GLCode | Category | EventCode | FundingSource | FundingSplit | BudgetLine | ApprovedBy | ApprovalDate | Status | BatchID | ReconciledDate | ArchivePath | AuditIndex | ValidationErrors | Comments</code>.<br><br>Protection & automation:<br>• Lock formula columns and protect workbook; control edits via user-level permissions or separate prepare/approve sheets.<br>• Use structured table references for PQ ingestion and GLUpload generation (named ranges). </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Accruals timing & examples — further patterns</strong><br>Accrual policy addenda:<br>• Accrue for any event-related service rendered in event period when invoice arrives after date cutoffs and before defined accrual posting date.<br>• Include <code>AccrualJustification</code> field on accrual entries (who authorised accrual, service evidence, expected invoice date).<br><br>Complex accrual scenario:<br>• Catering service 2026-02-04; invoice 2026-03-05; payment 2026-03-20.<br>• At 2026-02 month-end:<br><code>Dr Catering Expense 2,000 USD / Cr Accrued Liabilities 2,000 USD — EQUIPSEA202602 — Catering accrual</code>.<br>• On invoice receipt/payment:<br><code>Dr Accrued Liabilities 2,000 USD / Cr Bank 2,000 USD</code> or adjust for invoice variance as shown earlier. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Reconciliation patterns & automated reconciliations — expanded algorithms</strong><br>Matching logic layers (practical):<br>1. Exact match on Amount and Reference (InvoiceNo or PaymentRef) → Matched.<br>2. Date tolerance (+/- X business days) with exact amount → PartiallyMatched.<br>3. Amount tolerance (± small rounding) with fuzzy supplier name match → Flag for manual review.<br>4. Complex fuzzy matching using tokenised supplier names and identity heuristics (Company No, VAT ID) → assign <code>MatchConfidence</code> score and automated owner.<br><br>Automated outputs & owner workflows:<br>• ReconciliationReport with <code>MatchStatus</code>, <code>MatchConfidence</code>, <code>Owner</code>, <code>ActionRequired</code>, <code>SLA</code>.<br>• Auto-escalation rules for <code>Unmatched</code> > 5 business days to CFD. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Audit pack composition & indexing — deeper practical rules</strong><br>AuditPack recommended structure (expanded):<br>• <code>ControlSheet</code> (master).<br>• Invoices and delivery notes (by IndexNo).<br>• Bank advices and imported bank statements with SWIFT confirmations.<br>• Participant award letters and attendance evidence (signed DD forms).<br>• Per diem logs and per-participant calc sheets.<br>• VAT & withholding remittance proofs with receipts.<br>• GL upload file and journal references. <br>• Approval trail per payment (signed approvals or secure e-sign).<br>• Exceptions register with closure evidence.<br><br>Index rules & crosswalk:<br>• Index must provide direct file path and ControlSheet LineID for each document; auditors should be able to pick any ControlSheet row and find supporting evidence via IndexNo. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Donor compliance matrix & automated checks — extended</strong><br><code>DonorRules</code> full schema (proposed):<br><code>DonorName | AllowedCostCategories[] | DisallowedCostCategories[] | CurrencyPolicy | VATPolicy | WithholdingPolicy | EvidenceRequired[] | RetentionYears | SpecialApprovals | Contact</code>.<br><br>Automated PQ checks:<br>• Join transaction to DonorRules on FundingSource.<br>• If Category in DisallowedCostCategories → set <code>ComplianceFlag = TRUE</code> and route to Donor Compliance Owner.<br>• If <code>Amount</code> exceeds <code>DonorBudgetRemaining</code> → flag as <code>BudgetOverrun</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Reporting & dashboards — richer measures & examples</strong><br>Key additional measures to include:<br>• <code>Budget_vs_Actual_by_Donor</code> — pivoted by DonorName, includes <code>Committed</code>, <code>Accrued</code>, <code>Paid</code> and <code>Remaining</code>.<br>• <code>Advances_Ageing</code> — buckets <code>0-30 | 31-60 | 61-90 | 90+ days with owners</code>.<br>• <code>Days_to_Reconcile</code> — distribution and average per Owner.<br><br>Example pivot behaviors:<br>• Create drill-through from KPI card to invoice list filtered by <code>Top 10 suppliers</code> or <code>Unreconciled Items</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Power Query deep dive — further advanced recipes</strong><br>Additional PQ recipes & transformation patterns:<br>• Use <code>Table.Buffer</code> judiciously to prevent repeated remote queries when merging large tables.<br>• Create incremental refresh-friendly queries by using <code>ChangeLog</code> and <code>MaxDate</code> parameters in PQ queries to only fetch new files.<br>• Use a <code>Staging</code> folder pattern: <code>_raw</code> → <code>_staging</code> → <code>_clean</code> to allow control and staged validation. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Power Query M samples & explanation — extended snippets</strong><br>1) Add EventCode from filename robust (multiple patterns):<br>``<code>m&lt;br&gt;= Table.AddColumn(#&quot;Changed Type&quot;, &quot;EventCode&quot;, each if Text.Contains([Source.Name],&quot;EQUIPSEA&quot;) then &quot;EQUIPSEA202602&quot; else if Text.Contains([Folder Path],&quot;EQUIPSEA202602&quot;) then &quot;EQUIPSEA202602&quot; else null)&lt;br&gt;</code>`<code>&lt;br&gt;2) FX nearest prior rate helper (robust):&lt;br&gt;</code>`<code>m&lt;br&gt;GetNearestRate = (Rates as table, TxnDate as date) =&gt;&lt;br&gt;let&lt;br&gt;  sel = Table.SelectRows(Rates, each [RateDate] &lt;= TxnDate),&lt;br&gt;  sorted = Table.Sort(sel,{{&quot;RateDate&quot;, Order.Descending}}),&lt;br&gt;  result = if Table.IsEmpty(sorted) then error &quot;MissingFX&quot; else Record.Field(Table.First(sorted),&quot;Rate&quot;)&lt;br&gt;in&lt;br&gt;  result&lt;br&gt;</code>`` </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Power Pivot & DAX introduction — more measures & examples</strong><br>Advanced DAX measure examples:<br>• <code>TotalEventSpend = SUM(Invoices_Clean[LocalAmount]) + SUM(Claims_Clean[LocalAmount])</code>.<br>• <code>RemainingBudget = SUM(Budgets[BudgetAmount]) - [TotalEventSpend]</code>.<br>• <code>PctBudgetUsed = DIVIDE([TotalEventSpend], SUM(Budgets[BudgetAmount]), 0)</code>.<br>• <code>AccrualsOutstanding = CALCULATE(SUM(tblAccruals[Amount]), tblAccruals[Status]=&quot;Open&quot;)</code>.<br><br>Complex slicer pattern:<br>• Build <code>FundingSource</code> and <code>Donor</code> slicers with dependent filtering on <code>Category</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Advanced Excel techniques — more recipes</strong><br>Useful advanced patterns:<br>• <code>XLOOKUP</code> fallback pattern for supplier name canonicalisation with approximate match.<br>• <code>LET</code> to build readable nested calculations and reduce repeated evaluation.<br>• Use <code>FILTER</code> and <code>UNIQUE</code> to build dynamic approval lists and evidence trackers. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Automated GL upload & export process — D365 context & expanded</strong><br>GLUpload to ERP systems (general):<br>• GLUpload must match the target ERP template exactly: <code>Date | Account | Debit | Credit | Currency | CostCenter | Project | Narration | Reference | EventCode</code>.<br>• Validation rules before export: balanced totals, mandatory fields populated, VAT accounts mapped, withholding accounted for.<br><br>Special considerations for D365 / Dynamics 365 Finance & Operations (D365 FO) upload (summary and options):<br>• D365 accepts journal imports via multiple routes: Data Management Framework (DMF) / Data Entities (open to CSV or Excel), OData API, Electronic Reporting (ER) for specific formats, General Journal API endpoints, and third-party ETL (SSIS / ADF).<br>• Common D365 GL import entities: <code>GeneralJournalHeadersEntity</code>, <code>GeneralJournalLinesEntity</code> (or equivalent entity names depending on D365 version).<br>• Map your GLUpload template fields to D365 fields: Date → <code>PostingDate</code>, Account → <code>MainAccount</code>, Debit/Credit → <code>DebitAmount</code> / <code>CreditAmount</code>, Currency → <code>CurrencyCode</code>, CostCenter → <code>CostCenter</code>, Project → <code>ProjectId</code> (if Project management module used), Narration → <code>Description</code>, Reference → <code>Voucher</code>, EventCode → custom dimension or ledger dimension (e.g., <code>DimensionAttributeValue</code> for Project/CostCenter or custom <code>EventCode</code> dimension).<br><br>Practical D365 extraction & ingestion patterns (options with operational notes):<br>1. <strong>Data Management Framework (DMF) import (recommended for batch uploads):</strong><br>• Export format: use CSV with DMF mapping job. <br>• Steps: Prepare CSV → Configure Data Entity format mapping in D365 → Upload to Data Management workspace → Validate → Import (test in sandbox first). <br>• Advantages: built-in validation, staging, repeatable templates, logging of import results.<br>• Notes: ensure ledger dimension (EventCode) maps to the correct <code>MainAccountCombination</code> or <code>DefaultDimension</code> in D365.<br><br>2. <strong>OData / REST API (for programmatic real-time loads):</strong><br>• Use D365 OData endpoints or Finance/Operations REST APIs to push <code>GeneralJournal</code> entities. <br>• Steps: Get OAuth token → Build JSON payload mapping to <code>GeneralJournalHeader</code> and <code>GeneralJournalLine</code> entity structure → POST → Confirm import result. <br>• Advantages: automatable via Power Automate, Logic Apps, or custom middleware; good for low-latency or incremental loads.<br>• Notes: requires careful error handling and sufficient privileges; handle currency/ledger dimension mapping in payload. <br><br>3. <strong>Electronic Reporting (ER) or Data Entities with template generation:</strong><br>• Use ER to define a specific CSV/Excel output tailored to D365 requirements to feed upload pipelines. <br>• Advantages: flexible formatting and localisation capabilities. <br><br>4. <strong>Excel Add-in (D365 Excel Add-in / Office Add-in):</strong><br>• Use D365 Excel integration (Office Add-in) to publish journals directly from Excel to D365 when users prefer interactive validation.<br>• Advantages: user-friendly, allows manual review and publish from within Excel; limited for bulk automation. <br><br>5. <strong>ETL tools (SSIS / Azure Data Factory / KingswaySoft / Scribe):</strong><br>• Use ETL to transform <code>Invoices_Clean</code> and <code>ControlSheet</code> into D365 entity loads. <br>• Advantages: robust monitoring, scheduled pipelines, enterprise integration capability. <br><br>6. <strong>Direct SQL or data lake approaches (for extraction only):</strong><br>• Use if you have D365 database access in on-prem or for reporting via Data Lake; for posting, use supported DMF/API routes to avoid bypassing business logic. <br><br>Practical mapping example (GL upload CSV → D365 Journal Lines):<br>• CSV Column → D365 Field mapping example:<br><code>Date</code> → <code>PostingDate</code>.<br><code>Account</code> → <code>MainAccount</code>.<br><code>Debit</code> → <code>DebitAmount</code>.<br><code>Credit</code> → <code>CreditAmount</code>.<br><code>Currency</code> → <code>CurrencyCode</code>.<br><code>CostCenter</code> → <code>FinancialDimensionCostCenter</code>.<br><code>Project</code> → <code>FinancialDimensionProject</code> or <code>ProjectId</code>.<br><code>Narration</code> → <code>Description</code>.<br><code>Reference</code> → <code>Voucher</code>.<br><code>EventCode</code> → <code>FinancialDimensionEventCode</code> (requires a configured dimension in D365).<br><br>Notes about dimensions in D365:<br>• Use <code>LedgerDimension</code> and <code>DimensionCombination</code> constructs to ensure multi-dimensional tagging of transactions.<br>• If <code>EventCode</code> does not exist as a dimension, create a custom financial dimension or use an existing dimension (e.g., <code>Project</code> or <code>Purpose</code>) and reserve a dedicated dimension value for each EventCode. Ensure CFD approves the dimension design and migration strategy. <br><br>Extraction from D365 for reconciliation (practical):<br>• Common extracts needed:<br>• GL Trial Balance extract: use D365 <code>TrialBalance</code> or <code>GeneralLedger</code> data entities to export balances and transactions filtered by <code>EventCode</code> dimension.<br>• Posted journal lines: <code>GeneralJournalEntries</code> or <code>GLTransactions</code> entity for detailed line-level extraction. <br>• Bank transactions: <code>BankAccountTransaction</code> entity for bank reconciliation. <br>• Vendor ledger and payables: <code>VendorTrans</code> entity.<br><br>Automation possibilities:<br>• Build a Power Automate/Logic App that runs after GL import to fetch import results and publish a summary email with successes/failures and a link to import log files.<br>• Use ADF pipelines to orchestrate CSV creation (from PQ output), push to D365 DMF staging area (via API or file share) and trigger D365 DMF import job. <br><br>Testing & sandbox rules:<br>• Always test GL uploads in a D365 sandbox instance; run audit trail and posting checks; confirm balances in Trial Balance; retrieve posted journal voucher numbers and cross-reference to ControlSheet entries. <br><br>Practical controls & validations for D365 import:<br>• Validate dimension values exist (CostCenter, Project, EventCode) in D365 before import.<br>• Pre-import validation: Debits = Credits per JournalHeader, mandatory fields non-null, currencies consistent with ledger rules.<br>• Post-import reconciliation: reconcile imported journal totals to <code>tblControl</code> totals and bank payment batches; log unmatched lines and remediate. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Exception management & escalation matrix — extended with D365 checks</strong><br>Exception register fields extended to include ERP references:<br><code>ExceptionID | SourceRef | LineID | D365JournalID | Category | Owner | ImpactAmount | RootCause | ActionRequired | Status | SLA | FollowUpDate | ClosureEvidence</code>.<br><br>D365-specific exceptions:<br>• Failed imports reported by DMF: capture <code>EntityName</code>, <code>ExecutionId</code>, <code>ErrorMessages</code> and link to <code>ExceptionID</code> for owner to resolve.<br>• Dimension mismatch errors: identify missing dimension value and create a <code>ChangeLog</code> entry to add new <code>EventCode</code> dimension after CFD approval. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Payroll recovery & legal considerations — expanded with country notes</strong><br>Key legal points to document before payroll deduction:<br>• Signed recovery agreement with explicit schedule.<br>• HR confirmation that deduction will not reduce net pay below statutory minimum wages.<br>• Record-of-acceptance saved in <code>_raw/hr/</code> and cross-referenced in <code>AuditPack</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Case studies — NGO-rich set (multiple NGO contexts)</strong><br>Case study A — Small regional NGO (practical):<br>• Context: 1-week training with 20 participants funded by a single donor who prohibits alcohol and entertainment expenses.<br>• Key controls: per diem fixed approach, mandatory EventCode in filename, PQ ingestion with keyword flagging for disallowed items.<br>• Outcome: PQ flagged 2 invoices containing 'wine' — procurement reviewed and vendor replaced; exceptions logged and donor notified. <br><br>Case study B — Large international NGO (multi-donor):<br>• Context: Cross-border speakers (GBP), EU vendors (EUR) and local reimbursements (IDR). Funding split across 3 donors with varying VAT rules.<br>• Complexity: vat reclaim eligibility differs by donor; withholding needed for non-resident speakers; bank payments from central treasury with bank charges allocated to event.<br>• Controls implemented: FundingSplit column in <code>tblControl</code>, DonorRules table automating VAT treatment, Withholding schedule and remittance proof capture. <br><br>Case study C — Humanitarian NGO (rapid response event):<br>• Context: compressed procurement and ad-hoc cash disbursements in remote area; need for two-person custody and immediate reconciliation within 3 days.<br>• Controls: pre-authorised petty cash floats with <code>CashCustodyLog</code>, daily reconciliation to ControlSheet and immediate upload of scanned receipts via mobile app. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Case study D — NGO with D365 finance system (practical GL extraction & upload)</strong><br>• Context: Global NGO using D365 Finance for central ledger; country offices submit ControlSheet CSVs for upload.<br>• Process:<br>1. Local PQ produces <code>GLUpload_EQUIPSEA_YYYYMMDD.csv</code> mapping to D365 entity fields.<br>2. ETL (ADF) moves CSV to D365 DMF staging container and triggers DMF import job to <code>GeneralJournalHeader</code> and <code>GeneralJournalLines</code> entities.<br>3. Post-import: script extracts <code>LedgerJournalTable</code> posted Voucher numbers and returns them to local ControlSheet to populate <code>D365VoucherNo</code> and <code>D365ImportedDate</code> for audit crosswalk.<br>• Exception handling: if DMF import fails for dimension mismatch, create <code>Exception</code> and hold manual posting until CFD resolves dimension. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Missing receipts & audit response — extended playbook</strong><br>Auditor sample response pattern (detailed):<br>1. Locate transaction in ControlSheet and confirm approvals and sign-offs.<br>2. Search bank statement for payment evidence; capture merchant descriptor and append to Exception evidence.<br>3. If vendor cannot supply duplicate invoice: prepare an Exception Memo signed by BudgetHolder with reason and remediation (repayment or reclassification).<br>4. Include all communications in AuditPack and flag as <code>ExceptionResolved</code> once remediation is complete. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Timeline, milestones & recommended deadlines — further operational calendar</strong><br>Detailed recommended schedule (expanded):<br>• T-30 days — confirm participant list and issue awards.<br>• T-21 days — vendor contracting and deposit payments.<br>• T-14 days — finalize EventMaster and configure PQ parameters; test ingest.<br>• T-0 (event start) — record daily spend log and attendance sheets.<br>• T+5 business days — all receipts uploaded and PQ ingestion started.<br>• T+10 business days — reconciling advances and exceptions open for unresolved items.<br>• T+15 business days — accruals posted and GL closed for event; AuditPack compiled and CFD pre-signed. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Training plan & knowledge transfer — extended curriculum</strong><br>Training modules (expanded):<br>• Module 1: EventMaster & ControlSheet operations — hands-on lab.<br>• Module 2: Power Query fundamentals — ingest & transform AP folder (2-hour lab).<br>• Module 3: FX & VAT treatment — country-specific scenarios and tax memo creation.<br>• Module 4: D365 journal upload basics — DMF import and dimension mapping (sandbox exercise).<br>• Module 5: Audit pack assembly and response simulation (table-top). </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Process improvement roadmap — prioritized & measurable</strong><br>Roadmap items with expected impact metrics:<br>• Short term (0–1 month): Standardise templates & parameterise PQ queries — metric: reduce manual transcriptions by 60%.<br>• Medium term (1–3 months): Deploy PQ-driven AP ingestion & GL upload testing — metric: reduce reconciliation time by 30%.<br>• Long term (3–12 months): Integrate bank feed automation & D365 import automation — metric: reduce manual bank reconciliations and accelerate monthly close by 40%. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Quality assurance & change control — expanded operational steps</strong><br>Change control checklist (detailed):<br>1. Submit ChangeRequest with reasoning, rollback plan and test plan.<br>2. Run PQ unit tests and DataModel tests on sample dataset.<br>3. CFD sign-off required for GLMapping or material financial logic changes.<br>4. Update <code>ChangeLog</code> and archive prior template versions. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Common errors, root causes & remedial patterns — expanded</strong><br>Frequent errors with root cause and permanent fix:<br>• Missing EventCode — root cause: manual email attachments without EventCode in filename; fix: enforce naming standard and PQ filename parser; block ingestion otherwise.<br>• FX mismatch — root cause: incorrect date used for FX; fix: use <code>InvoiceDate</code> with nearest-prior logic stored in <code>FXRates</code>.<br>• Duplicate invoices — root cause: vendor re-send; fix: PQ duplicate detection by <code>InvoiceNo + Supplier + Amount</code> and flag for AP. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Practical folder & naming convention policy — enforced standard</strong><br>Strict folder tree and naming tokens (enforced):<br>• <code>/{FinanceRoot}/{EventCode}/_raw/AP/{EventCode}_{Country}_{YYYYMMDD}_{Vendor}_{INVxxx}.pdf</code>.<br>• <code>/{FinanceRoot}/{EventCode}/_clean/{Invoices_Clean.xlsx}</code>.<br>• <code>/{FinanceRoot}/{EventCode}/AuditPack/{IndexNo}_{DocumentType}_{Supplier}.pdf</code>.<br><br>Enforcement: use a pre-ingest script that renames uploaded files into the standard token format and logs any deviations to <code>IngestExceptions</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Sample Excel templates — expanded inventory</strong><br>Templates to keep as master copies (names and purpose):<br>• <code>TravelAward_Form_Master.xlsx</code> — award issuance and acceptance.<br>• <code>ExpenseClaim_Form_Master.pdf</code> (fillable) — claim capture with mandatory attachments.<br>• <code>SupplierOnboarding_Master.xlsx</code> — tax and bank capture.<br>• <code>ControlSheet_Master.xlsx</code> — protected with locked formula columns.<br>• <code>GLUpload_Template_D365.csv</code> — mapped to D365 field names for import. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Sample PQ query parameter list — extended defaults</strong><br>Recommended parameters for portability:<br>• <code>EventCode = &quot;EQUIPSEA202602&quot;</code>.<br>• <code>SourceFolder = &quot;/Finance/EQUIPSEA202602/_raw/&quot;</code>.<br>• <code>FXSource = &quot;/Finance/Shared/FXRates.xlsx&quot;</code>.<br>• <code>CutoffDate = #date(2026,2,16)</code>.<br>• <code>MaterialityThreshold = 500</code>.<br>• <code>D365_StagingFolder = &quot;\\\\D365Staging\\Import\\&quot;</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Security & PII handling — enhanced controls</strong><br>PII policy additions (operational):<br>• PII examples: passport numbers, bank account details, tax IDs and signed award acceptances.<br>• Controls: role-based access to <code>_raw</code> and <code>AuditPack</code>, encryption at rest for <code>AuditPack</code> zip archives, redaction guidelines for external sharing, retention policy enforcement via automated lifecycle scripts. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Escalation & incident handling — extended incident playbook</strong><br>Incident handling steps & owners:<br>1. Contain — payments halted if fraud suspected; owner: PaymentsOfficer.<br>2. Notify — CFD and CD immediately; record notification in <code>IncidentLog</code>.<br>3. Investigate — gather evidence (bank advices, logs, emails) and timeline; owner: Accounting Manager + IT.<br>4. Remediate — reverse payments where possible, recover funds, correct GL entries and update policies.<br>5. Document — produce incident report and lessons learned; update SOPs. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>FAQ — extended curated responses</strong><br>Q: What to do when donor disallows a cost found during audit?<br>A: Document issue, reclassify cost to local funding if permitted, or seek donor approval for exception; update <code>DonorRules</code> to prevent recurrence and include an impact note in AuditPack. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Final pre-audit checklist & sign-off matrix — exhaustive</strong><br>Exhaustive pre-audit checklist:<br>• All receipts indexed and legible.<br>• All advances reconciled, exceptions logged and remediation plans attached.<br>• Accruals posted with justification and authoriser note.<br>• GL reconciled to bank and payment batches with SWIFT advices where applicable.<br>• VAT & withholding evidence compiled and remittance proofs present.<br>• Audit pack indexed and cross-referenced to ControlSheet LineIDs.<br>• Exception register with closure evidence.<br><br>Sign-off matrix (explicit):<br>• Accounting Manager — prepares and signs off ControlSheet.<br>• CFD — approves accruals and signs off AuditPack.<br>• CD — approves policy deviations and material write-offs. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Appendix A — sample journals, copy-ready (expanded)</strong><br>1) Accrual:<br><code>Dr Workshop Expense — Venue 3,000 USD / Cr Accrued Liabilities 3,000 USD — EQUIPSEA202602 — Venue accrual 202602</code>.<br>2) Vendor Payment:<br><code>Dr Accrued Liabilities 3,000 USD / Cr Bank 3,000 USD — EQUIPSEA202602 — VendorName INV0001</code>.<br>3) Participant Reimbursement:<br><code>Dr Travel Expense — Reimbursements 1,200 USD / Cr Bank 1,200 USD — EQUIPSEA202602 — Participant P001</code>.<br>4) Advance Issued:<br><code>Dr Advances to Staff 500 USD / Cr Bank 500 USD — EQUIPSEA202602 — Participant P002 Advance</code>.<br>5) VAT recoverable posting example:<br><code>Dr Workshop Expense 1,080 USD / Dr VAT Recoverable 108 USD / Cr Accounts Payable 1,188 USD</code>.<br>6) Withholding example:<br><code>Dr Speaker Expense 1,000 GBP / Cr Accounts Payable 1,000 GBP</code>.<br><code>Dr Accounts Payable 1,000 GBP / Cr Bank 800 GBP / Cr Withholding Liab 200 GBP</code>.<br>7) D365 import sample header/line CSV snippet (conceptual):<br><code>JournalName,PostingDate,MainAccount,DebitAmount,CreditAmount,CurrencyCode,CostCenter,Project,Description,Voucher,EventCode</code>.<br><code>EQUIPSEA,2026-02-20,400101,3000,0,USD,CC_EQUIP,PRJ_EQPSEA,&quot;Venue accrual INV0001&quot;,&quot;VCHR0001&quot;,&quot;EQUIPSEA202602&quot;</code>.<br><strong>Use DMF mapping to align these CSV columns to D365 entities</strong>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Appendix B — Power Query M useful snippets & explanation (expanded)</strong><br>1) Add EventCode from filename robust snippet — included earlier.<br>2) FX nearest prior rate helper — expanded snippet earlier.<br>3) Unpivot statement columns snippet — included earlier.<br>4) Fuzzy join snippet — included earlier. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Appendix C — DAX examples for dashboard measures (expanded)</strong><br><code>TotalEventSpend = SUM(Invoices_Clean[LocalAmount]) + SUM(Claims_Clean[LocalAmount])</code>.<br><code>RemainingBudget = SUM(Budgets[BudgetAmount]) - [TotalEventSpend]</code>.<br><code>AdvancesOutstanding = CALCULATE(SUM(Advances[Amount]), Advances[Status]=&quot;Outstanding&quot;)</code>.<br><code>AccrualsOpen = CALCULATE(SUM(tblAccruals[Amount]), tblAccruals[Status]=&quot;Open&quot;)</code>.<br><code>DaysToReconcile = AVERAGEX(FILTER(tblControl, tblControl[Status]=&quot;Reconciled&quot;), DATEDIFF(tblControl[InvoiceDate], tblControl[ReconciledDate], DAY))</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Appendix D — sample change log & governance template (expanded)</strong><br><code>Version 1.0 — 2026-01-31 — Author: Accounting Manager — Initial comprehensive guide with PQ &amp; Excel improvements.</code><br><code>Version 1.1 — 2026-02-15 — Author: Accounting Manager — Updates: D365 GL mapping &amp; DMF mapping — Approved by CFD</code>.<br><br>Change request & rollback template fields:<br><code>ChangeID | Date | Requester | Summary | Impact | Tests | Approver | RollbackPlan | ArchiveRef</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Summary learning path & exercises — extended practical labs</strong><br>Week 1:<br>• Set up EventMaster, <code>tblParticipants</code>, <code>tblAwards</code>, manual ControlSheet and run PQ dry-run.<br>Week 2:<br>• Build PQ ingestion for AP and travel claims; implement FXRates merge and validation flags.<br>Week 3:<br>• Create GLUpload and test import to D365 sandbox via DMF; validate dimension mapping and confirm posted vouchers.<br>Week 4:<br>• Build dashboard and run simulated reconciliation; assemble AuditPack and run internal pre-audit. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Final implementation checklist (actionable & detailed)</strong><br>1. Create folders and set permissions per RACI.<br>2. Create EventMaster and parameterise PQ queries.<br>3. Build PQ ingestion for AP and claims and apply FX logic.<br>4. Develop ControlSheet and GLUpload templates mapped to D365 DMF or chosen ERP format.<br>5. Communicate cut-offs and templates to programme team and participants with one-page Quick Reference.<br>6. Run a dry-run reconciliation prior to event to surface issues.<br>7. Assemble audit pack within 10 working days post-event and index all documents.<br>8. Conduct lessons-learned and update templates and PQ queries; update <code>ChangeLog</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Operational annex — quick scripts, queries & checks</strong><br>Useful SQL pseudo-queries and operational checks (for reporting & ingestion verification):<br>• Find missing EventCode:<br><code>SELECT * FROM Invoices_Clean WHERE EventCode IS NULL</code>.<br>• Duplicate invoice detection:<br><code>SELECT Supplier, InvoiceNo, COUNT(*) FROM Invoices_Clean GROUP BY Supplier, InvoiceNo HAVING COUNT(*) &gt; 1</code>.<br>• FX gap detection (missing prior rate):<br><code>SELECT DISTINCT InvoiceDate FROM Invoices_Clean WHERE InvoiceDate NOT IN (SELECT RateDate FROM FXRates WHERE RateDate &lt;= InvoiceDate)</code> — flag for rate fetch.<br><br>Practical PQ preflight rule (pseudocode):<br>• If <code>Invoices_Clean</code> row has <code>ValidationErrors</code> → do not copy to <code>tblControl</code>; log to <code>IngestExceptions</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Operational annex — real-world NGO patterns & donor examples</strong><br>Examples of donor rules that commonly appear across NGOs (illustrative):<br>• Donor A (example: bilateral health fund): prohibits alcoholic beverages and stipulates max per diem limits; requires VAT to be non-recoverable.<br>• Donor B (example: major foundation): allows VAT reclaim if vendor provides VAT invoice; may require explicit prior approval for international consultant rates above threshold.<br>• Donor C (example: multilateral): requires retention of records for 10 years and additional evidence for cross-border payments.<br><br>How NGOs operationalise donor rules:<br>• Use <code>DonorRules</code> to encode allowed/disallowed categories and produce <code>DonorComplianceReport</code> weekly during an event.<br>• Use conditional formatting in <code>ControlSheet</code> to highlight <code>ComplianceFlag = TRUE</code> rows in red and route to <code>DonorComplianceOwner</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Closing operational note</strong><br>The expanded manual above preserves the original structure and content while adding extensive NGO-specific examples, deeper PQ/DAX/GL mapping guidance and a practical set of options for extracting and uploading GL data into Microsoft Dynamics 365 (D365) Finance including DMF, API and ETL options. Use the <code>EventMaster</code> approach and PQ parameterisation to make this manual re-usable across events and country offices. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Additional: EQUIPSEA</strong><br>Validated: schema consistency, EventCode usage, PQ pipelines, FX logic, GL narration conventions, D365 mapping, sample journals, exception flows, file/folder naming. This document is additive — every row is an explicit field/concept expansion with conceptual intent and practical implementation notes. All rules are prescriptive: implement exactly or record a compliance exception. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>How to read this single-cell table</strong><br>• Each row maps a Field/Concept → Conceptual intent → Technical rule / implementation pattern → Validation → Power Query (PQ) / automation note → D365 mapping note (where applicable) → NGO example(s).<br>• Use <code>&lt;br&gt;</code> line breaks for lists. Keep this cell as the canonical operator + developer reference. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Top-level conceptual model (one-paragraph)</strong><br>Events drive a controlled pipeline: EventMaster parameterises policy; incoming documents are ingested into ControlSheet rows by PQ; rows are validated, enriched (FX, GL mapping, funding splits), approved, batched into PaymentBatches and GLUpload lines, then imported into D365 (DMF/API). Audit is the system of record — every transformation emits append-only audit rows with correlation ids and checksums. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>EventMaster.EventCode — Conceptual + Technical</strong><br>Conceptual: canonical event identifier used everywhere for scoping, filtering and reconciliation.<br>Technical:<br>• Format: <code>^[A-Z0-9_-]{4,64}$</code> (Uppercase). Example: <code>EQUIPSEA202602</code>.<br>• PQ: <code>Table.SelectRows(...,[EventCode] &lt;&gt; null)</code>; add <code>ValidationError=&quot;MissingEventCode&quot;</code>.<br>• D365: Financial dimension <code>EventCode</code> → create <code>DimensionAttributeValue</code> if missing; include in JournalLine default dimensions. Example filename rule: <code>EQUIPSEA_VN_YYYYMMDD_&lt;DocType&gt;_&lt;No&gt;.pdf</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>EventMaster.OfficialEventName — Conceptual + Technical</strong><br>Conceptual: human label for dashboards/audit.<br>Technical:<br>• Text ≤ 250 chars; non-empty.<br>• PQ: <code>Table.AddColumn(...,&quot;EventName&quot;, each EventMaster[OfficialEventName])</code> for readable exports.<br>• D365: Optional <code>JournalDescription</code> prefix. Example: <code>EQUIPSEA Workshop — Clinical Research Quality</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>EventMaster.StartDate / EndDate — Conceptual + Technical</strong><br>Conceptual: accrual and eligibility window.<br>Technical:<br>• ISO <code>YYYY-MM-DD</code>. Rule: <code>StartDate &lt;= EndDate</code>.<br>• PQ accrual rule: <code>if InvoiceDate &lt;= EndDate and ServiceDate between StartDate and EndDate then Accrue</code>.<br>• D365: use PostingDate and set <code>AccrualPeriod</code> dimension. Example: catering on 2026-02-04 accrues to Feb. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>EventMaster.CurrencyPrimary & AllowedCurrencies — Conceptual + Technical</strong><br>Conceptual: canonical reporting currency and permissible invoice currencies.<br>Technical:<br>• ISO codes list. PQ preflight rejects currencies outside list. Merge <code>FXRates</code> on <code>InvoiceDate</code> using nearest-prior lookup. D365: ledger allowed currencies must match; include <code>OriginalCurrency</code> as dimension if D365 conversion is offloaded. Example: Primary USD; convert IDR invoices on InvoiceDate. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>EventMaster.PrimaryBankAccount — Conceptual + Technical</strong><br>Conceptual: default clearing account for the event.<br>Technical:<br>• Struct (AccountNo, BankName, SWIFT, Currency). Verify before payment. PQ: propagate into <code>GLUpload.BankAccount</code>. D365: map to <code>BankAccountId</code> or <code>PaymentMethod</code>. Example: <code>OUCRU HCMC Clearing — 123456789 — USD</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>ProjectGrantMappings — Conceptual + Technical (per-transaction)</strong><br>Conceptual: represent multi-grant splits and donor rules.<br>Technical:<br>• Schema: <code>GrantCode | AllocationPercent | DonorRulesRef | GLProjectID</code>.<br>• Validation: allocations sum = 100% (±0.01%). PQ: <code>Table.ExpandRecordColumn(FundingSplit)</code> → multiple GL lines. D365: map <code>ProjectId</code> or composite <code>LedgerDimension</code>. Example: GrantA 70% / LocalFund 30%. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>ControlSheet.LineID — Conceptual + Technical</strong><br>Conceptual: immutable row PK for traceability.<br>Technical:<br>• Format: <code>CTL-000123</code> or GUID. Enforce uniqueness in PQ; flag <code>DuplicateLineID</code>. Write <code>LineID</code> into <code>JournalLine.Description</code> and DMF <code>Voucher</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>ControlSheet.DocType — Conceptual + Technical</strong><br>Conceptual: logical doc category used to route workflow (Invoice, Claim, Advance, etc.).<br>Technical:<br>• Enum validated in PQ; fallback regex map from filename. Use DocType to select journal type in DMF. Example: <code>Claim</code> → participant reimbursements. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>ControlSheet.DocNo/InvoiceNo — Conceptual + Technical</strong><br>Conceptual: vendor reference for duplicate detection and audit.<br>Technical:<br>• PQ: OCR extract then fallback to filename parse; duplicate detection: <code>GroupBy Supplier+InvoiceNo+Amount</code>. Map to D365 <code>InvoiceId</code> or <code>Voucher</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>ControlSheet.InvoiceDate / DocDate — Conceptual + Technical</strong><br>Conceptual: base date for FX and accruals.<br>Technical:<br>• Validate plausible date range (not > today+90d, not < today-2y without justification). PQ: <code>NearestRate = GetNearestRate(FXRates, InvoiceDate)</code>. D365: map to <code>PostingDate</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>ControlSheet.Currency & Amount — Conceptual + Technical</strong><br>Conceptual: original monetary values to preserve audit trail.<br>Technical:<br>• Amount > 0; currency in allowed list. PQ: compute <code>LocalAmount = ROUND(Amount * FXRate,2)</code> and store both <code>Amount</code> and <code>LocalAmount</code>. D365: send original amounts and/or local equivalents per ERP currency setup. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>ControlSheet.FXRate / FXRateLookup — Conceptual + Technical</strong><br>Conceptual: deterministic FX selection and provenance.<br>Technical:<br>• Use nearest prior business day rate if exact date missing. Record <code>FXRateSource</code> (<code>CentralBank|Vendor|Manual</code>). PQ helper <code>GetNearestRate(FXRates, InvoiceDate)</code> stores <code>RateDateUsed</code>. D365: either post originals and let D365 convert or post local equivalents with <code>FXRate</code> metadata. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>ControlSheet.LocalAmount — Conceptual + Technical</strong><br>Conceptual: reporting currency amount used for budgeting and GL.<br>Technical:<br>• Two-decimal rounding. Add <code>RecalcHash</code> to detect tampering. PQ formula: <code>ROUND(Amount*FXRate,2)</code>; store <code>AuditNote</code> with rate provenance. D365: map to ledger currency as required. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>ControlSheet.GLCode / Category mapping — Conceptual + Technical</strong><br>Conceptual: map business category → GL account and VAT behavior.<br>Technical:<br>• Merge <code>GLMapping</code> by Category; if null tag <code>MissingGL</code> and block export. D365: map to <code>MainAccount</code>; ensure <code>MainAccount</code> active. Maintain <code>ApprovalRequired</code> flag for unmapped categories. Example: <code>Venue</code> → 400101. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>ControlSheet.FundingSource & FundingSplit — Conceptual + Technical</strong><br>Conceptual: donor attribution and apportioned posting.<br>Technical:<br>• Validate FundingSplit totals 100%; PQ expand to multiple GL lines with <code>AllocationID</code>. D365: use <code>Project</code> or composite <code>LedgerDimension</code> per allocation. Example: 60% DonorA / 40% LocalFund. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>ControlSheet.ApprovedBy / ApprovalDate / ApprovalEvidence — Conceptual + Technical</strong><br>Conceptual: approval is gating evidence for payment and GL upload.<br>Technical:<br>• Payment blocked unless Approved. PQ: attach <code>ApprovalHash</code> and persist <code>ApprovalTrail</code> table. D365: include <code>ApprovalEvidence</code> reference in <code>JournalLine.Description</code> or as attachment. Evidence: signed PDF path retained in AuditPack. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>ControlSheet.Status (workflow states) — Conceptual + Technical</strong><br>Conceptual: lifecycle control (Draft→Submitted→Approved→Paid→Reconciled→Exception).<br>Technical:<br>• Enforce transitions; block direct jumps without <code>ManualOverride</code> and <code>ChangeLog</code> entry. PQ: filter GLUpload to <code>Status=&quot;Approved&quot;</code>. D365: include <code>BatchID</code> and <code>ApprovalDate</code> in DMF header. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>ControlSheet.BatchID & PaymentBatch mapping — Conceptual + Technical</strong><br>Conceptual: group payments for bank execution and reconciliation.<br>Technical:<br>• Format: <code>BBYYYYMMDD_NNN</code> or GUID. PQ: build <code>PaymentBatch</code> table; generate bank file (CSV/ISO20022) and include <code>BatchTotal</code>. D365: reference BatchID in voucher for crosswalk. Example: <code>BB20260220_001</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>ControlSheet.ReconciledDate / ReconciledBy — Conceptual + Technical</strong><br>Conceptual: evidence that bank = GL.<br>Technical:<br>• Auto-populate when bank feed <code>TransactionRef</code> matches <code>BatchID</code>; flag <code>Unmatched</code> tasks. SLAs: reconcile within 5 business days. D365: use <code>Voucher</code> links for cross-reference. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>ControlSheet.ArchivePath / AuditIndex — Conceptual + Technical</strong><br>Conceptual: reliable pointer to evidence artifacts for auditors.<br>Technical:<br>• PQ: <code>File.Exists</code> preflight; generate <code>AuditIndex</code> mapping <code>LineID→FilePath→IndexNo</code>. Archive path patterns: <code>_raw/AP/...</code>, <code>_raw/Claims/...</code>. D365: <code>AuditIndex</code> included in <code>JournalLine.Description</code> for auditors. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>ControlSheet.ValidationErrors / ExceptionFlag — Conceptual + Technical</strong><br>Conceptual: capture policy/parse errors and block until cleared.<br>Technical:<br>• Build <code>ValidationErrors</code> as concatenated codes (e.g., <code>MissingEventCode|MissingGL</code>). PQ: <code>Table.AddColumn(...,&quot;ValidationErrors&quot;, each Text.Combine(errors,&quot;;&quot;))</code>. Exclude rows with errors from GLUpload. Example: <code>IneligibleCategory</code> for ALCOHOL enforced per donor rules. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>tblParticipants & tblAwards — Conceptual + Technical</strong><br>Conceptual: participant and award masters for claims validation.<br>Technical:<br>• Participants schema: <code>ParticipantID,Name,Country,PIIRef,BankMasked,Awards[],AttendanceConfirmed</code>. Attendance required prior to reimbursement except where prepayment is allowed. Awards schema: MaxAmount, AdvanceAllowed, ExpiryDate. PQ joins: <code>MergeParticipants</code> and <code>LeftJoin(tblAwards)</code> to enforce caps. D365: reimbursements map to <code>OtherPayable</code> or <code>Employee</code> as payroll-recoverable if needed. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>PerDiemRates — Conceptual + Technical</strong><br>Conceptual: deterministic per-country per diem with effective dates and taxability.<br>Technical:<br>• Schema: <code>Country,RateLocal,RateUSD,EffectiveFrom,TaxableFlag</code>. PQ: <code>GetPerDiemRate(ClaimDate)</code> → choose latest <code>EffectiveFrom &lt;= ClaimDate</code>. Map to <code>PerDiem</code> GL; include <code>ParticipantID</code> in description. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>tblAdvances — Conceptual + Technical</strong><br>Conceptual: track advances and settlement logic.<br>Technical:<br>• Schema: <code>AdvanceID,Recipient,Amount,Currency,IssueDate,DueDate,LinkedAwardID,Status,RecoveryPlan,PayrollFlag</code>. PQ: compute <code>OutstandingAdvance = AdvanceAmount - ReceiptsTotal</code>. D365: mark <code>PayrollRecoverable</code> where necessary; recover via payroll or bank refund workflows. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>SupplierMaster — Conceptual + Technical</strong><br>Conceptual: central vendor master for AP and tax handling.<br>Technical:<br>• Schema: <code>SupplierID,CanonicalName,TaxID,Country,BankDetails,VATStatus,WithholdingRate,PaymentTerms,PreferredCurrency</code>. PQ: fuzzy-match to canonical SupplierID; flag missing TaxID above threshold. D365: map to <code>VendorAccount</code> and ensure withholding rates are set. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>GLMapping — Conceptual + Technical</strong><br>Conceptual: controlled map from category → GL & VAT behaviors.<br>Technical:<br>• Schema: <code>CategoryCode,DefaultGL,VATGL,CostCenterDefault,ApprovalRequired</code>. PQ: merge and set <code>MissingGL</code> if null. D365: <code>DefaultGL</code> → <code>MainAccount</code>. New categories require <code>NewCategory</code> record + Accounting Manager mapping. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>FXRates table — Conceptual + Technical</strong><br>Conceptual: authoritative FX table for deterministic conversions.<br>Technical:<br>• Schema: <code>RateDate,FromCurrency,ToCurrency,Rate,Source</code>. PQ join: <code>LeftJoin</code> on <code>RateDate &lt;= InvoiceDate</code> sorted desc → pick first row. Log <code>RateDateUsed</code> & <code>FXRateSource</code>. Optionally upload FX set to D365 for parity. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>ReconciliationRules — Conceptual + Technical</strong><br>Conceptual: deterministic multi-step matching with auditable confidence.<br>Technical:<br>• Priority rules: ExactMatch → Date tolerance → Amount tolerance → Descriptor mapping. Implement sequential matching with <code>MatchStatus</code> and <code>MatchConfidence</code>. Provide <code>ReconciliationTestSet</code> for unit coverage. Use D365 <code>BankAccountTransaction</code> extracts for matching; tie-breaker fields: <code>Voucher</code>, <code>LedgerDimension</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>PaymentBatch.BankFile generation — Conceptual + Technical</strong><br>Conceptual: bank-file assembly per bank format with atomic delivery and archival.<br>Technical:<br>• Fields: <code>BatchID,PaymentRows,BankAccount,Currency,TotalAmount,BankFileName,BankFormatVersion</code>. Validate IBAN/BankCode; atomic write: temp → move. Deliver to SFTP/Bank portal; archive bank file and attach <code>BankAdvice</code>. Post-clearance: create bank-cleared journals in D365 referencing BatchID. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>GLUpload builder — Conceptual + Technical</strong><br>Conceptual: deterministic conversion from approved control rows → ERP journal lines.<br>Technical:<br>• Expand FundingSplit → multiple lines; create accrual + reversal patterns as needed. Emitted fields: <code>PostingDate,MainAccount,Debit,Credit,Currency,CostCenter,Project,Description,Reference,EventCode,SourceFile,LineID</code>. Validation: per-journal Debits == Credits else <code>UploadValidationError</code>. D365 mapping: <code>MainAccount</code>→<code>MainAccountId</code>, <code>CostCenter</code>→<code>FinancialDimension</code>, include <code>LineID</code> in <code>JournalLine.Description</code>. Example: Venue accrual Dr 400101 / Cr 2xxxx. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>D365 DMF import — Conceptual + Technical</strong><br>Conceptual: bulk DMF for staged validation before posting.<br>Technical:<br>• Header fields: <code>JournalName,JournalType,BatchKey</code>. Line fields: <code>PostingDate,MainAccount,DebitAmount,CreditAmount,Currency,CostCenter,Project,Description,EventCode</code>. Process: stage → validate → post. Capture <code>ExecutionId</code>, <code>ImportStatus</code>, import errors to <code>ImportExceptions</code>. Example CSV row given in templates. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>D365 API import — Conceptual + Technical</strong><br>Conceptual: programmatic single/journal posting when DMF unsuitable.<br>Technical:<br>• JSON payload pattern (JournalHeader + JournalLines). Implement OAuth, retry/backoff and idempotency keys; capture <code>JournalId</code> and posted <code>Voucher</code> for crosswalk. Record API errors as <code>ImportExceptions</code> with <code>ExecutionId</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>D365 post-import reconciliation — Conceptual + Technical</strong><br>Conceptual: confirm ERP accepted postings and map vouchers back to ControlSheet.<br>Technical:<br>• Extract <code>GeneralLedgerEntries</code> and join on <code>EventCode,LineID,Amount,Description</code> → populate <code>ControlSheet.D365VoucherNo</code> & <code>D365ImportedDate</code>. Any missing <code>D365VoucherNo</code> becomes an <code>ImportException</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Bank reconciliation from D365 — Conceptual + Technical</strong><br>Conceptual: use D365 bank extracts to match local bank statements for final clearance.<br>Technical:<br>• Extract fields: <code>TransactionDate,Amount,BankAccountId,Reference,StatementLineDescription,LedgerDimension,Voucher</code>. Matching: <code>Reference|Voucher</code> → <code>PaymentBatch.BatchID</code> else fuzzy descriptor + tolerance rules. Produce <code>BankReconciliationReport</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>AuditPack indexing — Conceptual + Technical</strong><br>Conceptual: index evidence for auditor retrieval and retention.<br>Technical:<br>• Index fields: <code>IndexNo,LineID,DocType,Supplier,DocDate,FileName,FilePath,FileHash,Notes</code>. PQ: create <code>AuditIndex</code> map and ensure each ControlSheet row has ≥1 index. Multi-support docs get separate index rows linked to the same <code>LineID</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Exceptions register & SLA — Conceptual + Technical</strong><br>Conceptual: tracked exceptions with owners, SLAs and escalation.<br>Technical:<br>• Fields: <code>ExceptionID,SourceRef,LineID,Category,Impact,Owner,RootCause,ActionRequired,Status,SLA,EscalationTo,ClosureEvidence</code>. Auto-escalate > threshold (e.g., >USD500) to CFD within 2 business days. Link <code>ImportExceptions</code> and <code>ReconciliationException</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>ChangeLog & governance — Conceptual + Technical</strong><br>Conceptual: immutable record of changes affecting mapping, policy or code.<br>Technical:<br>• Fields: <code>ChangeID,Date,Author,AffectedObject,PreSnapshot,PostSnapshot,ApprovalEvidence,RollbackPlan,Version</code>. Require two-person approval for GLMapping/Regulatory-impacting changes. Archive snapshots for rollback. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>DonorRules table — Conceptual + Technical</strong><br>Conceptual: donor-specific cost eligibility and special clauses.<br>Technical:<br>• Schema: <code>DonorName,AllowedCosts,DisallowedCosts,CurrencyRules,VATTreatment,WithholdingPolicy,EvidenceRequired,RetentionYears,SpecialClauses</code>. PQ: <code>LeftJoin</code> via <code>FundingSource</code> and auto-tag <code>DonorException</code> for disallowed costs. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Reporting (DAX) — Conceptual + Technical</strong><br>Conceptual: reconcile reporting totals to GL and measures for event monitoring.<br>Technical:<br>• Key measures: <code>TotalEventSpend</code>, <code>RemainingBudget</code>, <code>AdvancesOutstanding</code>, <code>AccrualsTotal</code>. Include monthly reconciliation to GL trial balance. DAX snippets provided in appendices. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Power Query test harness — Conceptual + Technical</strong><br>Conceptual: deterministic PQ test fixtures and edge-case coverage.<br>Technical:<br>• Include sample files (multi-currency, multi-invoice PDFs), edge cases (missing EventCode, negative credits), and unit assertions (row counts, transformed columns). Log <code>QueryLog</code> with execution time and <code>ValidationErrors</code>. Use CI to run PQ harness on sample sets. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Operational checklists & runbooks — Conceptual + Technical</strong><br>Conceptual: prescriptive operator actions for pre/during/post-event phases.<br>Technical:<br>• Pre-event: create EventMaster, parameterise PQ, set permissions. During: daily <code>_raw</code> upload, nightly PQ runs. Post-event: reconcile advances within 10 business days, post accruals, assemble AuditPack for CFD sign-off. Include evidence checklists at each step. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>NGO deployment scenarios — Conceptual + Technical (examples)</strong><br>Small NGO (manual): shared drive → desktop PQ → ControlSheet → CSV GLUpload → local ledger.<br>Large NGO (D365): local PQ → GLUpload DMF → ADF staging → DMF import → D365 sandbox validation → production. Controls: pre-create EventCode dimension in D365; use ChangeRequest for new dimensions. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Sample ControlSheet lines (concrete examples)</strong><br>1) Venue accrual CTL-000100: Invoice INV0001; InvoiceDate 2026-03-05; Supplier VN-VENUE; Currency USD; Amount 3000; GL 400101; EventCode EQUIPSEA202602; Status Accrued; Archive <code>_raw/AP/...</code>.<br>Journal: <code>Dr 400101 Venue Expense 3,000 / Cr 2xxxx Accrued Liabilities 3,000</code> (include EventCode & LineID).<br>2) Participant claim CTL-000101: Claim CLM0001; Participant P001; InvoiceDate 2026-02-10; Currency IDR; Amount 1,500,000; FXRate 0.000068 → LocalAmount 102 USD; GL 450210; FundingSplit GrantA 100%; Status Approved; Archive <code>_raw/Claims/...</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>D365 exception handling patterns — Conceptual + Technical</strong><br>Common DMF/API errors: missing dimension value, Debits != Credits, invalid MainAccount. Response: create <code>ImportException</code> with <code>ExecutionId</code>, block re-import, create <code>ChangeLog</code> request to provision missing dimension, correct GLUpload and retry. Preserve failed import file and logs in <code>ImportExceptions</code> store. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Reconciliation tasks & ownership — Conceptual + Technical</strong><br>Conceptual: deterministic owner assignment based on amount and status.<br>Technical:<br>• Rules: <code>Unmatched &amp; Amount&gt;500 → CFD/SrAcct</code>, <code>PartiallyMatched → PaymentsOfficer</code>. Escalate unresolved high-priority exceptions per SLA. Track <code>ExceptionID</code> and actions. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Audit & AuditPack — Conceptual + Technical</strong><br>Conceptual: append-only, cryptographically chained audit as system of record.<br>Technical:<br>• Audit row schema: <code>timestamp,correlationId,module,procedure,severity,userId,payloadHash,prevHash,signature,metadata</code>. Sign rotations with release signing key. Run <code>VerifyAuditChain</code> in CI & monitoring. Archive rotated audit packages per retention policy. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Security, PII & key management — Conceptual + Technical</strong><br>Conceptual: protect PII, secrets and audit integrity.<br>Technical:<br>• PII stored encrypted in vault; ControlSheet holds masked values <code>****5678</code> and <code>ArchivePath</code> to encrypted evidence. Use HSM-backed signing for audit rotations; log key rotations and require multi-person approval for key exports. Prohibit secrets in files; KMS rotation events recorded in audit. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Exception & incident runbooks (conceptual + technical evidence)</strong><br>Conceptual: containment, evidence collection, remediation, post-mortem.<br>Technical evidence pack: rotated audit CSVs, bootstrap/runtime logs, config snapshot, registry export, job descriptors, helper binary signatures, correlation ids. Forensic manifest <code>forensic_manifest.json</code> with file list + sha256. Containment: set exports read-only, disable helper execution, export forensic pack to secure share with chain-of-custody. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>CI/CD, tests, golden-files & release manifest — Conceptual + Technical</strong><br>Conceptual: enforce parity, determinism and signed artifacts.<br>Technical:<br>• CI gates: lint, unit, integration, IFRS self-tests (golden-file byte-for-byte), audit chain verification, performance microbenchmarks, signing. Release manifest: <code>buildId,commitHash,artifactList,signingFingerprint,ciSummary,complianceApproval</code>. Artifacts immutable once published; patch releases require explicit patch manifest. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>GL upload preflight & export checks — Conceptual + Technical</strong><br>Conceptual: ensure exported journals are balanced, dimensionally valid and approved.<br>Technical checklist: Debits==Credits per header, only <code>Approved</code> rows included, required dimensions exist in ERP, export preview converted to PDF and signed by Accounting Manager & CFD. Block export on validation failures and log <code>UploadValidationError</code>. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Payment bank-file & reconciliation automation — Conceptual + Technical</strong><br>Conceptual: atomic, auditable bank-file generation and post-payment reconciliation.<br>Technical:<br>• Bank-file generation uses temp → atomic move; validate IBAN/BankCode; upload to SFTP or bank portal; archive bank advice; post bank-cleared journals referencing BatchID; reconcile using D365 bank extracts and local statement descriptors. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Operational KPIs & monitoring — Conceptual + Technical</strong><br>Conceptual: surface health and detect drift early.<br>Technical metrics & thresholds (examples):<br>• <code>StartupTime</code> WARN>12s CRIT>30s<br>• <code>AuditFlushLatency</code> WARN>5s CRIT>30s<br>• <code>JobQueueLength</code> WARN>100 CRIT>1000<br>• <code>ExportErrorRate</code> WARN>0.5% CRIT>2%<br>Map metric → immediate action → escalation in operations runbooks. Dashboards include correlation ids and quick forensic export button. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Run-to-resolution cheat-sheets (operator commands)</strong><br>Conceptual: minimal reproducible steps and evidence to capture.<br>Examples (CLI conceptual):<br>• <code>diagnostics collect --run-id &lt;id&gt; --out &lt;path&gt;</code> → collects logs, audit_tail, config snapshot.<br>• <code>audit flush --immediate --correlation &lt;id&gt;</code> → forces audit flush and returns status.<br>• <code>jobs requeue --job-id &lt;id&gt;</code> → re-run job in isolated runner.<br>Each command MUST append an audit row with operator id and reason. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Templates & appendices (copy-ready references)</strong><br>Include canonical templates: AuditRow CSV/JSON, JobDescriptor JSON, ForensicManifest JSON, MigrationManifest JSON, ReleaseManifest JSON, Sample DMF CSV row, Sample D365 API payload. Keep templates immutable under <code>appendices/templates/</code> and reference golden-file checksums. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Final prescriptive rules (short)</strong><br>1) Audit is authoritative — never modify audit rows without legal/compliance approval.<br>2) EventCode mandatory on all rows/files.<br>3) Funding split must sum to 100% (tolerance 0.01%).<br>4) All regulatory-impacting changes require two-person approval and CI re-run against golden fixtures.<br>5) Exports and bank-files use atomic writes and record checksums. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>Next steps & actionable artefacts</strong><br>• Implementation checklist for developers: implement PQ transforms with test harness; include <code>RecalcHash</code> and <code>AuditNote</code> columns; add <code>LineID</code> to every journal description; ensure idempotency keys for API imports.<br>• Operator quick-start: run PQ test harness against sample set; confirm <code>audit_tail.csv</code> contains expected correlation ids; validate DMF staging import in sandbox before production.<br>• Compliance: maintain <code>GLMapping</code> change log and pre-create EventCode dimension values in D365 before imports. </td></tr><tr><td data-label="EQUIPSEA — Accounting manual"> <strong>End: verification summary</strong><br>This refined single-cell guide presents conceptual intent and explicit technical patterns for each major field/process. Use as canonical developer + operator reference. For immediate export request (PDF/DOCX/XLSX) provide <code>filename</code> + <code>format</code> + minimal metadata (<code>title,author,effectiveDate</code>) and the export will be produced with an appended <code>runbook.audit</code> entry. </td></tr></tbody></table></div><div class="row-count">Rows: 113</div></div><div class="table-caption" id="Table2" data-table="YJKN_0005_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **EQUIPSEA Accounting Manual**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>EQUIPSEA Accounting Manual</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>NOTE (scope of this reply)</strong><br>This response expands the conceptual+technical rows into plain-language narratives and actionable steps so each field/concept is easy to understand and implement. The original content is preserved in full; nothing removed. Because the source contains many rows, the expansion below focuses on every major field/concept from the conceptual+technical guide and converts each into: Purpose → Why it matters → Concrete operator instructions → Validation checks → PQ automation note → D365 mapping note → Short NGO example. Each line uses <code>&lt;br&gt;</code> for list separation so it can be copy/pasted into your single-cell markdown workbook. If you want additional expansion for any <em>specific</em> row beyond what's below, cite the row name and I will expand that exact item further. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>EventMaster.EventCode</strong><br>Purpose: a short, unique ID that ties every document, journal, and report back to one event so nothing gets mixed between events.<br>Why it matters: without a consistent EventCode you cannot reliably filter, reconcile, or produce event-level audit packs; EventCode is the primary partition key for PQ queries, GL uploads and audit indexing.<br>Operator instructions: choose an uppercase alphanumeric code (e.g., <code>EQUIPSEA202602</code>), publish a filename rule (<code>{EventCode}_{Country}_{YYYYMMDD}_{DocType}_{No}.pdf</code>) and enforce it at ingestion. Add the EventCode to forms, award letters and emails to participants.<br>Validation checks: PQ must reject or flag files with missing/invalid EventCode; log <code>ValidationError=MissingEventCode</code> and create an <code>IngestException</code> record. Run a daily query: <code>SELECT COUNT(*) FROM Invoices_Raw WHERE EventCode IS NULL</code> and remediate any hits.<br>PQ note: implement <code>Table.SelectRows(..., [EventCode] &lt;&gt; null)</code> as the first filter; use filename regex fallbacks to auto-extract variations and populate <code>EventCode</code> when possible.<br>D365 mapping: create or map a financial dimension named <code>EventCode</code> (DimensionAttributeValue). Ensure the dimension exists before import; map the EventCode value in each journal line into the DMF <code>LedgerDimension</code> or <code>DefaultDimension</code> fields.<br>NGO example: for a regional training, enforce <code>EQUIPSEA_VN_20260201_INV001.pdf</code>; PQ picks up <code>EQUIPSEA202602</code> and assigns the row to the event ledger. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>EventMaster.OfficialEventName</strong><br>Purpose: human-friendly title used in dashboards, audit packs and email subject lines.<br>Why it matters: readable names avoid confusion between similarly coded events and make audit packs understandable to non-finance reviewers.<br>Operator instructions: maintain <code>OfficialEventName</code> in EventMaster with max 250 characters, use it as a label in ControlSheet exports and in journal description prefixes (e.g., <code>EQUIPSEA Workshop — Clinical Research Quality</code>).<br>Validation checks: ensure <code>OfficialEventName</code> is non-empty; alert if longer than 250 chars; include the name in the AuditPack cover sheet and in the ControlSheet header.<br>PQ note: join EventMaster to any <code>Invoices_Clean</code> output and add a readable <code>EventName</code> column for reporting and audit exports.<br>D365 mapping: optionally add the EventName as the start of <code>JournalLine.Description</code> for human readability in ERP transaction views.<br>NGO example: <code>EQUIPSEA Workshop — Clinical Research Quality</code> appears as the first phrase in all journals and in the AuditPack index, helping auditors quickly identify relevant bundles. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>EventMaster.StartDate / EndDate</strong><br>Purpose: defines the period during which receipts, services and attendance are considered event-related for accruals and eligibility.<br>Why it matters: accrual rules, per-diem eligibility and expense recognition are anchored to this window; incorrect dates cause misstated period expenses.<br>Operator instructions: record ISO dates <code>YYYY-MM-DD</code> in EventMaster; communicate the CutOffCalendar derived from these dates to programme leads; use clear rules for cross-midnight activities and multi-day events.<br>Validation checks: rule <code>StartDate &lt;= EndDate</code>; flag EventMaster records that violate this. Run monthly checks to confirm no transactions are assigned outside StartDate–EndDate without a logged exception.<br>PQ note: implement accrual logic <code>if [InvoiceDate] &lt;= EndDate and [ServiceDate] &gt;= StartDate and [ServiceDate] &lt;= EndDate then Accrue else NormalPost</code> to create accrual rows automatically.<br>D365 mapping: map the posting date to D365 <code>PostingDate</code> and include an <code>AccrualPeriod</code> custom dimension if you want period-level reporting separate from posting date.<br>NGO example: catering on <code>2026-02-04</code> with <code>StartDate=2026-02-01</code> and <code>EndDate=2026-02-05</code> is accrued to February; invoices arriving March require accruals instead of retroactive adjustments. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>EventMaster.CurrencyPrimary & AllowedCurrencies</strong><br>Purpose: defines the canonical reporting currency and the set of currencies events may accept.<br>Why it matters: consistent FX handling, budgeting and GL posting depend on knowing the primary currency and permitted invoice currencies; preventing unsupported currencies avoids conversion errors and reconciliation headaches.<br>Operator instructions: set <code>CurrencyPrimary</code> to the event reporting currency (USD for many NGOs) and list accepted <code>AllowedCurrencies</code> (e.g., USD, EUR, IDR). Communicate allowed currencies to vendors and participants where possible.<br>Validation checks: PQ must reject or flag invoices denominated in currencies outside <code>AllowedCurrencies</code>. Create daily alerts for unexpected currency occurrences and reconcile any prepayments in unsupported currencies manually.<br>PQ note: merge <code>FXRates</code> on <code>InvoiceDate</code> using nearest-prior rate for each <code>FromCurrency→CurrencyPrimary</code> pair; store both original and converted amounts.<br>D365 mapping: ensure ERP ledger is configured to accept the currencies you will post; if D365 will do conversion, include <code>OriginalCurrency</code> and <code>OriginalAmount</code> fields in DMF and let the ERP convert, otherwise post converted amounts and include <code>FXRate</code> metadata.<br>NGO example: primary USD; invoices in IDR are converted on <code>InvoiceDate</code> using the nearest prior FX rate, stored in <code>LocalAmount</code> for budget aggregation. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>EventMaster.PrimaryBankAccount</strong><br>Purpose: default clearing/bank account used for event payments and reconciliation.<br>Why it matters: consistent use of a primary bank account simplifies reconciliation, batch creation and bank-charge allocation; auditors expect a traceable bank account per event.<br>Operator instructions: capture full bank struct (AccountNo, BankName, SWIFT, Currency) in EventMaster. Before payment runs, verify bank details with treasury and supplier master; avoid changing primary account mid-event unless documented in ChangeLog.<br>Validation checks: PQ must propagate <code>PrimaryBankAccount</code> to <code>GLUpload</code> and bank file builder; before bank file generation validate account formats (IBAN/BBAN) and that the account currency matches the batch currency.<br>PQ note: include <code>PrimaryBankAccount</code> in the GLUpload row set so bank-file generators can default payment method and clearing account; use parameterised queries so multiple events can reuse the same pipeline.<br>D365 mapping: map to <code>BankAccountId</code> or a <code>PaymentMethod</code> in the journal header so ERP posting points to the correct bank ledger and facilitates bank reconciliation.<br>NGO example: OUCRU HCMC Clearing — <code>123456789</code> (USD) used for all supplier payments from local office; bank advices and SWIFT refs are attached to batch records for audit. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>ProjectGrantMappings</strong><br>Purpose: describes how a single transaction should be split across grants or projects, including donor rules that apply to each portion.<br>Why it matters: many grants have different eligibility rules — correct mapping prevents donor disallowed costs and ensures financial accountability for each funder.<br>Operator instructions: store <code>GrantCode</code>, <code>AllocationPercent</code>, <code>DonorRulesRef</code>, and <code>GLProjectID</code>. Require that allocations sum to 100% (±0.01%). For each invoice line, apply <code>FundingSplit</code> to create separate GL lines and track allocation IDs for audit.<br>Validation checks: test that <code>SUM(AllocationPercent)</code> = 100% for every <code>FundingSplit</code> entry; if not, block GLUpload and create an exception. Verify <code>DonorRulesRef</code> exists and is active.<br>PQ note: expand the <code>FundingSplit</code> nested field into multiple rows before GLUpload using <code>Table.ExpandRecordColumn</code> and attach <code>AllocationID</code> to each expanded row so you can reconcile by allocation later.<br>D365 mapping: use <code>ProjectId</code> or financial dimension combinations to represent the grant allocation; if D365 uses a composite ledger dimension, build the correct <code>LedgerDimension</code> string per line.<br>NGO example: Invoice $2,142.86 split 70/30 between <code>GrantA</code> and <code>LocalFund</code> generates two GL lines with <code>ProjectId=GRANTA</code> (70%) and <code>ProjectId=LOCAL</code> (30%). </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>ControlSheet.LineID</strong><br>Purpose: immutable, unique primary key for each ControlSheet row — the anchor for audit, index and reconciliation.<br>Why it matters: LineID is the single identifier auditors and automated scripts use to find supporting evidence; it must be immutable to preserve traceability when entries are updated or reprocessed.<br>Operator instructions: generate LineIDs as GUIDs or zero-padded sequential <code>CTL-000123</code>; write the LineID into every derived artifact (journal narration, GLUpload <code>Reference</code>, AuditIndex). Never re-use a LineID; if a row is corrected, create a new LineID and link to the previous via ChangeLog.<br>Validation checks: enforce uniqueness in PQ (<code>if Table.RowCount(Table.Distinct(Table.SelectColumns(#&quot;Table&quot;,&quot;LineID&quot;))) &lt;&gt; Table.RowCount(#&quot;Table&quot;) then flag DuplicateLineID</code>). Periodically run <code>SELECT LineID, COUNT(*) FROM ControlSheet GROUP BY LineID HAVING COUNT(*) &gt; 1</code>.<br>PQ note: ensure <code>LineID</code> generation is deterministic for a given input or explicit GUID that persists through PQ transforms and into GLUpload. Add <code>LineID</code> to all output tables and to the AuditPack index.<br>D365 mapping: include <code>LineID</code> in <code>JournalLine.Description</code> or <code>Voucher</code> field for crosswalk on import; ensure the ERP field can accept the identifier length.<br>NGO example: <code>CTL-000100</code> refers to a venue accrual row; auditors pick the LineID and immediately find all attachments and the posted voucher. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>ControlSheet.DocType</strong><br>Purpose: categorises the document so workflows (approval, posting, recovery) are routed correctly (Invoice, Claim, Advance, BankAdvice, etc.).<br>Why it matters: different DocTypes have different approval rules, GL mapping and treatment (e.g., advances require settlement fields and payroll recovery options).<br>Operator instructions: maintain an enumerated DocType list; use PQ filename regex to infer DocType where missing; route the row to the appropriate workflow queue based on DocType.<br>Validation checks: only allow DocType values from the enum; flag unknown DocTypes for manual review. Ensure DocType-driven controls are implemented (e.g., advances must have <code>AdvanceID</code>).<br>PQ note: use <code>Table.AddColumn(..., &quot;DocType&quot;, each if Text.Contains([Name], &quot;ADV&quot;) then &quot;Advance&quot; else if ...)</code> as fallback logic; produce an <code>InferredDocType</code> column and an <code>InferredConfidence</code> score.<br>D365 mapping: use DocType to set <code>JournalType</code> or <code>Voucher</code> prefixes in DMF so postings are easy to filter (e.g., <code>ADV</code> for advances).<br>NGO example: <code>Claim</code> rows route to participant reimbursement workflow with attendance verification and award caps applied before approval. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>ControlSheet.DocNo / InvoiceNo</strong><br>Purpose: supplier-supplied reference used for duplicate detection, matching and vendor correspondence.<br>Why it matters: duplicate invoice prevention and payment accuracy depend on matching by InvoiceNo + Supplier + Amount; missing or inconsistent invoice numbers cause duplicate payments or payment disputes.<br>Operator instructions: extract InvoiceNo via OCR, then fallback to filename parse. Normalize common variations (leading zeros, dash vs slash). Present detected duplicates to AP via a review queue.<br>Validation checks: implement <code>GroupBy Supplier+InvoiceNo+Amount HAVING COUNT&gt;1</code> to detect duplicates and flag <code>DuplicateInvoice</code> exceptions. Verify invoice number plausibility (length, permitted characters) and require manual sign-off for suspicious cases.<br>PQ note: add multi-step parsing: OCR extraction, regex fallback (e.g., <code>INV\d+</code>), and filename parse; store <code>InvoiceNoSource</code> (<code>OCR|Filename|Manual</code>). Provide confidence score and highlight low-confidence rows for manual verification.<br>D365 mapping: write <code>InvoiceNo</code> into <code>Voucher</code>/<code>Reference</code> or <code>InvoiceId</code> so Payables ledger can trace payment to supplier document.<br>NGO example: vendor re-sends invoice <code>INV-2026-0001</code> in PDF and email — PQ matches on <code>INV-2026-0001</code> + supplier name + amount and flags a potential duplicate for AP review. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>ControlSheet.InvoiceDate / DocDate</strong><br>Purpose: the baseline date for FX conversion, accrual logic and period reporting.<br>Why it matters: posting in the wrong period misstates expenses and can cause donor non-compliance; invoice date also drives nearest-prior FX lookup and tax filing timelines.<br>Operator instructions: capture InvoiceDate from the invoice document; if missing use <code>DocDate</code> or <code>FileDate</code> but record <code>InvoiceDateSource</code> and justification. Reject implausible dates (future beyond +90 days or excessively historical beyond policy).<br>Validation checks: run <code>InvoiceDate &lt;= Today() + 90</code> and <code>InvoiceDate &gt;= Today() - 1095</code> (example 3-year rule) and flag outliers with <code>ValidationError=DateOutOfRange</code> requiring approver justification.<br>PQ note: supply <code>GetNearestRate(FXRates, InvoiceDate)</code> and store <code>RateDateUsed</code>; use <code>InvoiceDate</code> for accrual decisions and to compute <code>LocalAmount</code> consistently.<br>D365 mapping: map to <code>PostingDate</code>; if you post accruals separately, include <code>ServiceDate</code> or <code>AccrualPeriod</code> as custom fields to link accrual reversal logic.<br>NGO example: catering invoice <code>2026-03-05</code> for a <code>2026-02-04</code> service triggers accrual at Feb month-end because <code>ServiceDate</code> falls in February even though invoice arrived March. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>ControlSheet.Currency & Amount</strong><br>Purpose: preserve the vendor's original currency and amount for auditability while enabling consistent reporting in the primary currency.<br>Why it matters: you must retain originals for supplier disputes and tax reclaim; converted local amounts are used for budgets, GL, and donor reporting.<br>Operator instructions: store <code>Currency</code> as ISO code and <code>Amount</code> as provided; validate numeric formats and ensure <code>Amount &gt; 0</code>. Capture the amount source (<code>OCR|PDF|Manual</code>) and confidence level.<br>Validation checks: reject negative or zero amounts; flag non-standard currency codes; if the currency is unsupported, set <code>ValidationError=UnsupportedCurrency</code> and require manual handling.<br>PQ note: compute <code>LocalAmount = ROUND(Amount * FXRate, 2)</code> and store both values plus <code>FXRate</code> provenance columns: <code>RateDateUsed</code>, <code>FXRateSource</code>, <code>RecalcHash</code> for tamper detection.<br>D365 mapping: decide whether to post original amounts and let D365 convert or post converted <code>LocalAmount</code> — be consistent and document which method is used; include <code>OriginalAmount</code>/<code>OriginalCurrency</code> in DMF if posting converted values.<br>NGO example: vendor invoices IDR 1,500,000; PQ extracts <code>Currency=IDR</code>, <code>Amount=1,500,000</code>, merges FX 0.000068 and sets <code>LocalAmount=102.00 USD</code> for budget reporting. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>ControlSheet.FXRate / FXRateLookup</strong><br>Purpose: deterministic, auditable FX selection that explains how a foreign amount became a local amount.<br>Why it matters: auditors and donors require transparency on FX rates used, and incorrect rate selection can materially affect donor reports and tax reclaim values.<br>Operator instructions: maintain an <code>FXRates</code> table with <code>RateDate</code>, <code>FromCurrency</code>, <code>ToCurrency</code>, <code>Rate</code>, and <code>Source</code>. Use nearest prior business day rate if no rate exists for the invoice date. Log <code>FXRateSource</code> (<code>CentralBank|Vendor|Manual</code>) and the <code>RateDateUsed</code> alongside the computed <code>LocalAmount</code>.<br>Validation checks: detect gaps in rates — if no prior rate exists within policy window (e.g., 30 days), create a <code>MissingFX</code> exception and block posting until rate is added or manual override is authorised.<br>PQ note: implement helper <code>GetNearestRate(Rates, TxnDate)</code> returning the first <code>RateDate &lt;= TxnDate</code> sorted descending and store <code>RateDateUsed</code> and <code>LookupMethod</code> in the row.<br>D365 mapping: optionally upload FXRates into D365 currency tables so ERP conversion aligns with reporting; otherwise include <code>FXRate</code> as a metadata column in DMF so posted lines can be audited.<br>NGO example: invoice date <code>2026-02-04</code> and no rate for that date — PQ picks the previous business day <code>2026-02-03</code> and records <code>RateDateUsed=2026-02-03</code> and <code>FXRateSource=CentralBank</code>. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>ControlSheet.LocalAmount</strong><br>Purpose: the event reporting currency value used for budgets, GL uploads and KPI calculations.<br>Why it matters: ControlSheet aggregation, GL postings and donor reports rely on consistent rounding and rate provenance; auditors expect the link between original amounts and local equivalents.<br>Operator instructions: compute <code>LocalAmount = ROUND(Amount * FXRate, 2)</code> and store <code>FXRate</code>, <code>RateDateUsed</code>, <code>FXRateSource</code> and an <code>AuditNote</code> explaining the rate choice. Add a tamper-detection <code>RecalcHash</code> (<code>hash of Amount|Currency|FXRate</code>) to detect manual edits.<br>Validation checks: re-run <code>RecalcHash</code> when ControlSheet is opened or before GLUpload to ensure no silent edits. Flag rows where recomputed LocalAmount differs from stored value beyond a 0.01 tolerance as <code>RecalcMismatch</code> and require remedial review.<br>PQ note: compute <code>RecalcHash = Hash([Amount]&amp;&quot;|&quot;&amp;[Currency]&amp;&quot;|&quot;&amp;[FXRate])</code> in PQ and keep the hash in the output table; use this for automated integrity checks in the pre-upload step.<br>D365 mapping: map LocalAmount into <code>Debit</code>/<code>Credit</code> fields or include both original and local amounts if D365 will perform revaluation; keep FX metadata in <code>JournalLine.Description</code> for traceability.<br>NGO example: invoice 1,500,000 IDR @ 0.000068 → <code>LocalAmount=102.00 USD</code> with <code>RecalcHash</code> saved to detect future changes. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>ControlSheet.GLCode / Category mapping</strong><br>Purpose: converts business categories (Venue, Catering, Travel) into GL accounts so finance postings are consistent and meaningful.<br>Why it matters: correct GL mapping ensures the Trial Balance reflects program spending correctly and supports donor reporting and tax treatment (e.g., VAT recoverable accounts are distinct).<br>Operator instructions: maintain a <code>GLMapping</code> table linking <code>CategoryCode</code> → <code>DefaultGL</code> → <code>VATGL</code> → <code>CostCenterDefault</code> and an <code>ApprovalRequired</code> flag. When PQ cannot map a category, mark <code>MissingGL</code> and prevent export until mapping is added or an approver signs off a temporary mapping documented in ChangeLog.<br>Validation checks: pre-export, run <code>SELECT * FROM tblControl WHERE GLCode IS NULL</code> and block upload. For new categories, require CFD approval and a recorded <code>NewCategory</code> mapping in ChangeLog.<br>PQ note: merge <code>GLMapping</code> into the <code>Invoices_Clean</code> stream early; set <code>ValidationError=MissingGL</code> when no mapping exists. Provide a <code>SuggestedGL</code> column for approvers based on keyword heuristics.<br>D365 mapping: <code>DefaultGL</code> maps to <code>MainAccount</code> in DMF. Ensure <code>MainAccount</code> is active and not blocked for postings in D365 prior to import.<br>NGO example: category <code>Venue</code> maps to <code>400101</code> and to VAT recoverable account <code>210101</code> where VAT applies; GLUpload contains both expense and VAT lines when applicable. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>ControlSheet.FundingSource & FundingSplit</strong><br>Purpose: records which donor or fund pays for the cost and how costs are apportioned across funds when split funding applies.<br>Why it matters: donors require accurate attribution of costs and often have differing policies for VAT, allowable expenses and reporting periods; misallocated costs can lead to disallowed expenditures.<br>Operator instructions: require <code>FundingSource</code> and <code>FundingSplit</code> fields on each ControlSheet row. Enforce that splits add to 100% (±0.01%). For each allocation produce separate GL lines with <code>Project</code> or <code>Dimension</code> tags to ensure per-donor tracing.<br>Validation checks: check <code>SUM(AllocationPercent)</code> for each row equals 100%; alert on rounding discrepancies and require manual sign-off for corrections. Verify <code>DonorRules</code> for each funding source before posting.<br>PQ note: implement <code>Table.ExpandRecordColumn(FundingSplit)</code> to output one line per allocation; attach <code>AllocationID</code> so audit and reversal logic can locate each allocation easily.<br>D365 mapping: map each allocation to <code>ProjectId</code> or to a specific <code>LedgerDimension</code> value; ensure that dimension values exist in D365 for each donor before import.<br>NGO example: a $1,000 invoice split 70/30 results in two GL lines: one charged to <code>Project=GrantA</code> for $700 and another to <code>Project=LocalFund</code> for $300, each carrying the same LineID and AllocationID. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>ControlSheet.ApprovedBy / ApprovalDate / ApprovalEvidence</strong><br>Purpose: captures who approved the row, when, and where the approval evidence is stored — this is the gating control for payment and posting.<br>Why it matters: approvals are the primary control auditors check to verify authority to spend; missing approvals are frequent audit exceptions and can prevent payment or posting.<br>Operator instructions: require approver ID, timestamp and evidence path (signed PDF or e-sign token). Block payment and GLUpload unless <code>ApprovedBy</code> and <code>ApprovalEvidence</code> are present and <code>Status=&quot;Approved&quot;</code>. Keep an <code>ApprovalTrail</code> table for mutable approvals (re-approvals, overrides) and store <code>ApprovalHash</code> for evidence integrity.<br>Validation checks: PQ should mark rows missing approval as <code>Status != Approved</code> and exclude them from GLUpload. Confirm <code>ApprovalEvidence</code> file exists and <code>FileHash</code> matches the indexed value before final export.<br>PQ note: add <code>ApprovalTrail</code> ingestion so approvals captured in forms or workflow systems map to ControlSheet entries automatically; capture <code>ApprovalSource</code> (<code>email|PowerAutomate|manual upload</code>) for audit context.<br>D365 mapping: include <code>ApprovalEvidence</code> reference in the DMF <code>Description</code> or as a linked attachment if D365 supports it; at minimum include the approver name and date in <code>JournalLine.Description</code>.<br>NGO example: Payment blocked because <code>ApprovalEvidence</code> missing for a hospitality invoice; AP contacts the BudgetHolder to secure an email approval which is then attached and <code>ApprovalHash</code> updated. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>ControlSheet.Status (workflow states)</strong><br>Purpose: defines the lifecycle of a ControlSheet row from intake to closure (Draft→Submitted→Approved→Paid→Reconciled→Exception).<br>Why it matters: lifecycle state drives which automated processes may act on the row (e.g., only <code>Approved</code> rows are included in GLUpload). State transitions must be auditable to prevent unauthorized jumps.<br>Operator instructions: implement a finite-state machine that records user, timestamp and reason for each transition. Disallow direct <code>Approved→Reconciled</code> jumps without <code>Paid</code> and <code>BatchID</code> unless a documented manual override is recorded in ChangeLog. Provide UI controls so operators can view state history per LineID.<br>Validation checks: block GLUpload of rows where <code>Status != Approved</code>. Log any <code>ManualOverride</code> with <code>ChangeLog</code> entry and require sign-off from CFD for overrides affecting material amounts.<br>PQ note: filter GLUpload by <code>Status=&quot;Approved&quot;</code> and create a <code>StatusHistory</code> table showing transitions and user IDs for audit export.<br>D365 mapping: include <code>BatchID</code> and <code>ApprovalDate</code> in DMF header to allow reconciliation between ERP postings and control state.<br>NGO example: A claim is <code>Submitted</code> by participant, <code>Approved</code> by BudgetHolder, included in <code>BB20260220_001</code> payment batch and then <code>Paid</code> and <code>Reconciled</code> after bank confirmation. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>ControlSheet.BatchID & PaymentBatch mapping</strong><br>Purpose: groups payments into a single bank-file for execution and ties those payments back to ControlSheet rows for reconciliation.<br>Why it matters: batch grouping reduces bank fees and makes reconciliation straightforward; BatchID is the anchor between bank advices, GL postings and ControlSheet rows.<br>Operator instructions: generate <code>BatchID</code> as <code>BBYYYYMMDD_NNN</code> or GUID; assign all rows scheduled in the same payment run to the BatchID; capture batch metadata (initiator, approver, bank, currency, total). Store bank file name and bank advice path with the batch record.<br>Validation checks: validate <code>BatchTotal = SUM(PaymentRows.Amount)</code> and ensure <code>BatchCurrency</code> matches <code>PrimaryBankAccount.Currency</code>; require dual approval for large batches above threshold. Store <code>BankAdvice</code> (SWIFT/confirmation) once bank confirms execution.<br>PQ note: as part of nightly runs build <code>PaymentBatch</code> table from all <code>Approved</code> payments and output bank file (CSV/ISO20022) ready for upload; log <code>BankFileHash</code> and archive the bank file with a secure filename and index entry.<br>D365 mapping: include <code>BatchID</code> in ERP <code>JournalName</code> or <code>Voucher</code> field so posted payment journals reference the payment batch for later reconciliations. After bank clearance, post bank-cleared journals referencing <code>BatchID</code>.<br>NGO example: <code>BB20260220_001</code> contains 45 payments; the bank returns SWIFT refs which are stored under <code>BankAdvices/BB20260220_001_swift.csv</code> and the ControlSheet lines are updated to <code>Status=Paid</code>, <code>ReconciledDate</code> populated after matching. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>ControlSheet.ReconciledDate / ReconciledBy</strong><br>Purpose: records the date and person who verified bank transactions matched GL and ControlSheet rows — the final clearance step for a payment line.<br>Why it matters: reconciliation proves cash actually left the bank and matches GL entries; it's critical for audit evidence and to close outstanding liabilities.<br>Operator instructions: on bank feed import run matching rules (BatchID, Voucher, Reference, amount). Auto-mark <code>Reconciled</code> when a clear match is found and populate <code>ReconciledDate</code> and <code>ReconciledBy</code>. For manual matches record the steps taken and attach supporting evidence (bank screenshot, correspondence).<br>Validation checks: ensure <code>ReconciledDate</code> is not earlier than <code>PaidDate</code>; SLA: reconcile <code>Paid</code> items within 5 business days. Generate a <code>UnreconciledReport</code> daily and escalate unresolved items >5 business days to CFD.<br>PQ note: create <code>BankMatches</code> output table with <code>MatchStatus</code>, <code>MatchConfidence</code>, <code>BankTransactionRef</code> and link to control <code>LineID</code> for reconciliations and audit export.<br>D365 mapping: use <code>Voucher</code> and <code>LedgerDimension</code> to match D365 bank extract lines (<code>BankAccountTransaction</code>) to ControlSheet BatchIDs; store <code>D365BankReconciledFlag</code> if reconciliation was posted in ERP.<br>NGO example: bank feed finds a transaction matching <code>BB20260220_001</code> and amount 3,000 USD; system auto-populates <code>ReconciledDate=2026-02-25</code> and <code>ReconciledBy=PaymentsOfficer</code>. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>ControlSheet.ArchivePath / AuditIndex</strong><br>Purpose: canonical pointer(s) to supporting evidence (invoice PDFs, approvals, bank advices) for each ControlSheet line so auditors can retrieve documents quickly.<br>Why it matters: auditors must be able to retrieve documents within seconds using LineID/IndexNo; inconsistent filing or missing files cause audit exceptions and slow reviews.<br>Operator instructions: enforce folder and filename conventions and store relative <code>ArchivePath</code> in ControlSheet. Build <code>AuditIndex</code> with <code>LineID→IndexNo→FilePath→FileHash</code>; include multiple index rows per LineID if more than one supporting document exists.<br>Validation checks: PQ preflight must <code>File.Exists</code> for every <code>ArchivePath</code> referenced; report all missing files as <code>IngestException</code>. Compute file hashes at ingest and store them to detect later tampering. Ensure each ControlSheet row has at least one index entry before sign-off.<br>PQ note: implement a small routine that scans <code>_raw</code> and <code>_clean</code> folders, extracts filenames and meta, computes sha256 hashes and writes rows into <code>AuditIndex</code>. Use <code>AuditIndex</code> for GLUpload attachments and for pack zipping.<br>D365 mapping: include <code>AuditIndex</code> references in <code>JournalLine.Description</code> or as attachments if D365 allows linking to external repositories. At minimum include <code>IndexNo</code> so auditors can crosswalk ERP postings to the audit pack.<br>NGO example: <code>ArchivePath=/Finance/EQUIPSEA202602/AuditPack/IDX0001_INV0001.pdf</code> with <code>FileHash=abc123</code> stored in <code>AuditIndex</code>; auditor requests <code>LineID</code>, finds <code>IDX0001</code> and views the invoice. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>ControlSheet.ValidationErrors / ExceptionFlag</strong><br>Purpose: consolidates any parsing, policy or mapping errors preventing a row from being posted; exceptions must be resolved before payment or posting unless a documented exception is approved.<br>Why it matters: automation must be safe—rows with validation errors must not be included in GLUpload; exceptions are the single source of truth for unresolved issues.<br>Operator instructions: build <code>ValidationErrors</code> as pipe-separated codes (<code>MissingEventCode|MissingGL|UnsupportedCurrency</code>) and show error messages in the approver UI. Block GLUpload where <code>ValidationErrors</code> not empty. For donor-sensitive errors, route to <code>DonorComplianceOwner</code> immediately.<br>Validation checks: PQ should fill <code>ValidationErrors</code> on ingestion. Implement SLA rules: auto-escalate exceptions older than 2 business days for amounts > materiality threshold to CFD. Maintain <code>ExceptionID</code> and track progress to closure with evidence attached.<br>PQ note: use <code>Table.AddColumn</code> to compute <code>ValidationErrors</code> as <code>Text.Combine(errors,&quot;;&quot;)</code> and create <code>IngestExceptions</code> output for failed rows to be reviewed by AP.<br>D365 mapping: do not include rows with <code>ValidationErrors</code> in DMF exports; track <code>ImportExceptions</code> and ensure DMF error output maps back to <code>ExceptionID</code> for resolution.<br>NGO example: PQ flags <code>IneligibleCategory</code> on an invoice mentioning “wine” and route the row to DonorCompliance with <code>ValidationErrors=IneligibleCategory</code>. The donor approves reclassification to local funds, evidence attached, and the row is cleared for payment. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>tblParticipants & tblAwards</strong><br>Purpose: maintain authoritative participant and award records used to validate claims and enforce award caps and eligibility.<br>Why it matters: reimbursement and award payments must be matched to valid awards and attendance; paying non-eligible participants wastes donor funds and triggers audit exceptions.<br>Operator instructions: capture <code>ParticipantID,Name,Country,PIIRef,BankMasked,Awards[],AttendanceConfirmed</code>. For awards include <code>MaxAmount,AdvanceAllowed,ExpiryDate</code>. Require attendance proof (signed DD) before final reimbursement unless prepayment was authorised; log attendance confirmation in <code>tblParticipants.AttendanceConfirmed</code>.<br>Validation checks: PQ joins <code>Claims</code> to <code>tblParticipants</code> and flags <code>AttendanceConfirmed = FALSE</code> as an exception. Validate award caps by <code>Sum(Claims) &lt;= Award.MaxAmount</code> and block if exceeded. For advances, ensure <code>AdvanceID</code> references an award where <code>AdvanceAllowed = TRUE</code>.<br>PQ note: implement <code>MergeParticipants</code> to attach participant metadata to claims and create <code>ClaimsWithParticipant</code> output with <code>AwardCompliance</code> column for quick filters.<br>D365 mapping: reimbursements can map to <code>OtherPayable</code> or <code>Employee</code> if payroll recovery is required; include <code>ParticipantID</code> in <code>JournalLine.Description</code> for audit traceability.<br>NGO example: Participant P001 has Award P010 with Max USD 2,000; PQ prevents reimbursements that push cumulative claims over the cap unless BudgetHolder approval is recorded. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>PerDiemRates</strong><br>Purpose: authoritative rates by country and effective date used to compute per-diem entitlements and taxability.<br>Why it matters: per-diem rates and tax rules vary across countries and times — correct rates avoid under/over payments and payroll tax errors.<br>Operator instructions: maintain a table <code>Country|CityCategory|RatePerDay|EffectiveFrom|TaxableFlag</code>. For each claim compute <code>Entitlement = RatePerDay × Nights</code>. If <code>TaxableFlag = TRUE</code> produce payroll or withholding entries as required and store evidence.<br>Validation checks: confirm <code>RatePerDay</code> exists for the claim date; if not, block the claim and generate <code>MissingPerDiemRate</code> exception. Run periodic audits to ensure per-diem rates are updated when host country guidance changes.<br>PQ note: implement <code>GetPerDiemRate(ClaimDate)</code> to select latest <code>EffectiveFrom &lt;= ClaimDate</code> and attach <code>PerDiemRateSource</code> to the claim record for audit purposes.<br>D365 mapping: per-diem payments can be posted to <code>Travel Expense — Per Diem</code> GL and, if taxable, create payroll liabilities or withholding postings in D365 payroll or AP as applicable.<br>NGO example: 3 nights in Indonesia at IDR 500,000 → entitlement = IDR 1,500,000; <code>TaxableFlag</code> checked and payroll/withholding processed if required. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>tblAdvances</strong><br>Purpose: central register of issued advances, outstanding amounts and recovery plans.<br>Why it matters: advances are cash outflows that remain as organisational liabilities until reconciled; poor tracking leads to aged outstanding advances and possible loss.<br>Operator instructions: use <code>AdvanceID,Recipient,Amount,Currency,IssueDate,DueDate,LinkedAwardID,Status,RecoveryPlan,PayrollFlag</code>. On issuance create <code>Dr Advances / Cr Bank</code>. On settlement, create reimbursement journals and record refunds; if refund not received, prepare payroll deduction with signed consent saved in <code>_raw/hr/</code>.<br>Validation checks: compute <code>OutstandingAdvance = AdvanceAmount - ReceiptsTotal</code> and report any <code>OutstandingAdvance &gt; 0</code> for more than SLA (e.g., 30 days). Block further advances to the same recipient if multiple outstanding advances breach policy.<br>PQ note: join Receipts to Advances by <code>AdvanceID</code> and compute <code>Variance</code>. Output <code>Advances_Ageing</code> buckets for management reporting and escalate overdue recoveries.<br>D365 mapping: represent advances as <code>OtherCurrentAsset</code> until settled; mark recoverable amounts for payroll if recovery route is chosen and ensure payroll has the signed recovery agreement reference.<br>NGO example: Advance USD 500 issued to Participant P002; receipts total USD 350 → create <code>Dr Travel Expense 350 / Dr Bank (refund) 150 / Cr Advances 500</code> or use payroll deduction if refund not received. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>SupplierMaster</strong><br>Purpose: authoritative vendor master controlling tax IDs, bank details, withholding rates and vendor status.<br>Why it matters: accurate supplier data prevents payments to wrong beneficiaries, ensures correct withholding and tax treatment, and reduces fraud risk.<br>Operator instructions: capture <code>SupplierID,CanonicalName,TaxID,Country,BankDetails,VATStatus,WithholdingRate,PaymentTerms,PreferredCurrency</code>. Validate bank details before first payment and re-verify on changes (2-person validation). Store masked bank numbers in ControlSheet and full bank data in a secure VendorMaster with restricted access.<br>Validation checks: flag missing TaxID for invoices above materiality threshold; detect multiple bank accounts for the same supplier and require confirmation; maintain a supplier change log and require approvals for high-risk changes.<br>PQ note: implement fuzzy matching to map raw invoice supplier strings to <code>SupplierMaster.CanonicalName</code> and produce <code>MatchConfidence</code>; when confidence is low route to AP for manual canonicalisation.<br>D365 mapping: map to <code>VendorAccount</code> in D365 and set withholding rates in vendor master records so DMF imports can validate with ERP masters before posting.<br>NGO example: a local vendor has no TaxID on file but invoice amount exceeds threshold — PQ marks <code>MissingTaxID</code> and AP halts payment pending supplier onboarding documentation. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>GLMapping</strong><br>Purpose: central mapping from business categories and cost types to GL accounts and VAT behavior to ensure postings are consistent and auditable.<br>Why it matters: incorrect mappings lead to misclassification and poor financial control; mapping changes must be governed and versioned.<br>Operator instructions: maintain <code>CategoryCode,DefaultGL,VATGL,CostCenterDefault,ApprovalRequired</code>. For a new category require a ChangeLog entry and CFD approval before adding to the mapping table. Keep a <code>Version</code> column and archive old maps for audit.<br>Validation checks: pre-import ensure no ControlSheet rows have <code>MissingGL</code> and that <code>DefaultGL</code> exists and is active in D365; block upload if any <code>DefaultGL</code> is invalid.<br>PQ note: merge <code>GLMapping</code> early and add <code>SuggestedGL</code> for unmapped categories using keyword heuristics; surface these suggestions to accounting for quick mapping additions.<br>D365 mapping: <code>DefaultGL</code> maps to <code>MainAccount</code>; ensure the mapping respects the chart of accounts and <code>MainAccount</code> is permitted for the posting type (expense/payment/accrual).<br>NGO example: Category <code>Catering</code> maps to <code>400110</code>; if VAT applies the PQ produces an additional <code>VAT Recoverable</code> line mapped to <code>210101</code>. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>FXRates table</strong><br>Purpose: authoritative source of exchange rates used to convert original currency amounts into the event reporting currency with provenance and repeatability.<br>Why it matters: consistent FX selection avoids random conversion choices and supports auditability; rate changes must be traceable to a source.<br>Operator instructions: maintain <code>RateDate,FromCurrency,ToCurrency,Rate,Source</code>. Prefer publicly verifiable sources (central bank) and capture the <code>Source</code> string (including URL or file path) and the fetch timestamp. Implement a fallback policy for missing rates (nearest prior business day) and a manual override process for special cases with CFD approval.<br>Validation checks: detect rate gaps and report <code>MissingFX</code> events; when a manual override is used record <code>OverrideReason</code> and approver ID. Build a unit test to ensure FX rates are monotonic for the same date/currency pair (no duplicate pairs with different values unless documented).<br>PQ note: implement a <code>GetNearestRate</code> helper that sorts <code>FXRates</code> desc by <code>RateDate</code> and selects the first <code>RateDate &lt;= TxnDate</code>. Store <code>RateDateUsed</code> in the output for each transaction.<br>D365 mapping: optional — upload FXRates into D365 currency tables for ERP parity; otherwise preserve FX metadata in DMF for auditors.<br>NGO example: For EUR→USD conversions use ECB rates; PQ downloads daily rates and stores <code>Source=ECB;Fetched=2026-02-05</code>. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>ReconciliationRules</strong><br>Purpose: defines the deterministic matching algorithm to reconcile bank transactions to ControlSheet rows, with cascaded fallbacks and confidence scoring.<br>Why it matters: robust reconciliation reduces manual effort and identifies mismatches early; a reproducible algorithm with thresholds supports automated closure and predictable escalation.<br>Operator instructions: implement sequential matching steps: ExactMatch on InvoiceNo/Reference; DateTolerance (± X days) + Exact Amount; AmountTolerance (± small rounding) + fuzzy supplier match; Descriptor mapping using tokenization and company IDs. Produce <code>MatchStatus</code>, <code>MatchConfidence</code> and <code>MatchedTo</code> fields and route low confidence results for manual review.<br>Validation checks: monitor <code>AutoMatchRate</code> and set SLAs; escalate <code>Unmatched</code> items older than 5 business days to CFD for investigation. Create a <code>ReconciliationAudit</code> table capturing algorithm inputs and output scores for external review.<br>PQ note: create a separate <code>Reconciliation</code> query that accepts bank extract and ControlSheet extracts, applies matching rules and writes <code>ReconciliationReport</code> with <code>ActionRequired</code> for manual tasks.<br>D365 mapping: use <code>BankAccountTransaction</code> extracts and <code>Voucher</code> to reconcile ERP postings to bank statements; include ERP <code>Voucher</code> in matching heuristics to create closed loops.<br>NGO example: bank statement line <code>-1,070 USD</code> with descriptor <code>PAYVENDOR VN-VENUE</code> matches ControlSheet invoice <code>INV0001</code> exactly; PQ marks <code>Matched</code> and populates <code>ReconciledDate</code>. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>PaymentBatch.BankFile generation</strong><br>Purpose: convert approved payment rows into bank-specific file formats (CSV, ISO20022) for secure submission to the bank.<br>Why it matters: correct bank-file generation prevents payment rejections, wrong beneficiaries and bank errors; atomic file creation prevents partial uploads and lost files.<br>Operator instructions: generate bank-file into a temp location, validate IBAN/BankCode formats, compute <code>BatchTotal</code>, sign or checksum the file, then move atomically to the bank-share or SFTP location. Record <code>BankFileName</code>, <code>BankFormatVersion</code>, <code>BankFileHash</code> and store the file in the batch archive. Require two-person approval for uploads above thresholds and attach proof of approval to the batch.<br>Validation checks: validate <code>BatchCurrency</code> matches <code>PrimaryBankAccount.Currency</code> and <code>Sum(RowAmounts) == BatchTotal</code>. Implement preflight validations and dry-run tests before live submission and always test new bank formats in sandbox.<br>PQ note: generate <code>PaymentFile</code> output as CSV/ISO20022 from the <code>PaymentBatch</code> table and produce a <code>BankFileManifest</code> with file hash, row count and generated timestamp for audit.<br>D365 mapping: include <code>BatchID</code> in journal header/lines for later reconciliation; after bank confirmation post bank-cleared journals referencing the BatchID so ERP and bank records align.<br>NGO example: bank requires ISO20022 for international transfers; system creates <code>BB20260220_001.iso</code> in temp, verifies, then atomically uploads to bank SFTP and stores <code>BankFileHash</code> and SWIFT confirmations under <code>AuditPack/Payments/</code>. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>GLUpload builder</strong><br>Purpose: convert approved ControlSheet rows into the exact column layout required by ERP import (DMF or API), with full dimension tagging and balanced journal headers.<br>Why it matters: ERP imports require strict formats and validations (Debits==Credits, fields non-null); mistakes at this stage cause failed imports and manual rework.<br>Operator instructions: expand funding splits into multiple GL lines, include accrual/reversal logic for post-period invoices, build a <code>JournalHeader</code> with totals and balanced lines, attach <code>LineID</code> and <code>SourceFile</code> to each line, and generate a preflight preview (PDF) signed by Accounting Manager and CFD before pushing to DMF.<br>Validation checks: per-journal <code>Debits == Credits</code>; mandatory dimensions present; GL accounts exist and are active. Output <code>UploadValidationError</code> rows where validation fails and prevent the DMF import until resolved.<br>PQ note: build <code>GLUpload</code> query to output required columns: <code>PostingDate,MainAccount,Debit,Credit,Currency,CostCenter,Project,Description,Reference,EventCode,SourceFile,LineID</code>. Provide sample export templates per D365 entity.<br>D365 mapping: map <code>MainAccount</code> to <code>MainAccountId</code>, <code>CostCenter</code> to <code>FinancialDimensionCostCenter</code>, and <code>Project</code> to <code>ProjectId</code>; ensure the <code>EventCode</code> dimension value exists in D365 or create it via ChangeLog approval prior to import.<br>NGO example: a split invoice with 70/30 allocations produces three rows in GLUpload: two expense lines (Grant splits) and one payable or accrual balancing line; the upload preflight shows balanced totals and is signed before DMF import. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>D365 DMF import</strong><br>Purpose: bulk import mechanism in D365 that allows staged validation and logging before final posting — recommended for batch journal uploads.<br>Why it matters: DMF gives built-in validation and logging; it is safer than direct API posting for large, repeatable imports and produces execution logs that map to <code>ImportExceptions</code>.<br>Operator instructions: prepare CSVs mapped to <code>GeneralJournalHeader</code> and <code>GeneralJournalLines</code> entities, upload to D365 Data Management workspace, run <code>Validate</code> then <code>Import</code>. Test in sandbox first and keep <code>ExecutionId</code> and import logs for audit. Build automation to read DMF execution output and populate <code>ImportExceptions</code> table in your local system.<br>Validation checks: capture DMF validation errors and link them to <code>LineID</code> and <code>ExceptionID</code>. For dimension errors (missing EventCode value), create ChangeLog entries to request dimension creation and block re-import of affected lines until resolved.<br>PQ note: produce DMF-compliant CSV from PQ with columns exactly matching entity fields; include <code>LineID</code> and <code>SourceFile</code> so DMF error logs can be reconciled back to ControlSheet.<br>D365 mapping: be aware entity names may vary by version; confirm entity mapping (<code>GeneralJournalHeadersEntity</code>, <code>GeneralJournalLinesEntity</code>) with your D365 technical team before generating files.<br>NGO example: <code>GLUpload_EQUIPSEA_20260220.csv</code> is uploaded to DMF, validation errors show missing <code>FinancialDimensionEventCode</code> for some lines; the system creates <code>ImportException</code> and stops posting until dimension is created. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>D365 API import</strong><br>Purpose: programmatic option for posting journals via REST when DMF is unsuitable or for real-time requirements.<br>Why it matters: APIs enable automation and low-latency posting, but require careful idempotency and error-handling design to avoid duplicate postings.<br>Operator instructions: build JSON payloads for <code>JournalHeader</code> + <code>JournalLines</code>, implement OAuth authentication, idempotency keys (e.g., <code>LineID</code>), retry/backoff logic and logging of API responses. Capture <code>JournalId</code> and posted <code>Voucher</code> for crosswalk and populate ControlSheet with <code>D365VoucherNo</code>.<br>Validation checks: parse API error messages and store them in <code>ImportExceptions</code> with <code>ExecutionId</code>; block retries for deterministic errors (dimension missing) and create <code>ChangeLog</code> requests when required.<br>PQ note: export an API payload file for debugging and sandbox tests; include <code>LineID</code> and <code>SourceFile</code>. Use a staging queue to ensure idempotency and retry handling are testable.<br>D365 mapping: ensure permissions for the service account are limited to required entities; test thoroughly in a sandbox to confirm field names and behavior across versions.<br>NGO example: small, urgent reimbursements posted via API to avoid DMF processing windows — each payload uses <code>LineID</code> as idempotency key so retries do not create duplicate vouchers. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>D365 post-import reconciliation</strong><br>Purpose: confirm D365 accepted postings and map voucher numbers back to ControlSheet rows to complete the audit crosswalk.<br>Why it matters: ERP posting produces voucher numbers auditors will request; without mapping you cannot show that the ControlSheet row was actually posted in the ledger.<br>Operator instructions: after import extract <code>GeneralLedgerEntries</code> or <code>LedgerJournalTable</code> filtered by <code>JournalName</code> and <code>PostingDate</code>; use <code>LineID</code>, <code>EventCode</code>, <code>Description</code> and <code>Amount</code> to join to ControlSheet and populate <code>ControlSheet.D365VoucherNo</code> and <code>D365ImportedDate</code>. For any unmatched lines create <code>ImportException</code> with details and escalate.<br>Validation checks: verify <code>SUM(UploadedLocalAmounts)</code> = <code>SUM(PostedAmounts)</code> per journal; any variance creates <code>ImportException</code>. Keep the DMF <code>ExecutionId</code> and import logs attached to the batch record for audit.<br>PQ note: automate the extract and join step in nightly routines to close the loop rapidly. Provide a reconciliation report showing <code>Uploaded</code> vs <code>Posted</code> totals and <code>UnmatchedLines</code> as an action list.<br>D365 mapping: ensure exported <code>Posted</code> extracts include <code>Voucher</code>, <code>JournalId</code>, <code>MainAccount</code>, <code>LedgerDimension</code>, <code>Amount</code> and <code>PostingDate</code> to enable robust joins.<br>NGO example: DMF import returns <code>Voucher=VCHR0001</code> for the venue accrual; PQ populates <code>ControlSheet.D365VoucherNo=VCHR0001</code> and auditor finds the voucher in D365 trial balance. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>Bank reconciliation from D365</strong><br>Purpose: use D365 bank transaction extracts to close the loop between bank statements and control records for final cash confirmation.<br>Why it matters: reconciled bank transactions prove cash has left accounts and that GL postings match actual bank movement; this is essential for cash controls and audit.<br>Operator instructions: extract <code>BankAccountTransaction</code> with fields <code>TransactionDate,Amount,BankAccountId,Reference,Description,LedgerDimension,Voucher</code> and run matching to local bank statement lines and ControlSheet batches. Create <code>BankReconciliationReport</code> with <code>Matched</code>, <code>Unmatched</code> and <code>ManualReview</code> lists and update ControlSheet reconciliation flags.<br>Validation checks: ensure bank extracts include all posted clears for the period; reconcile differences in bank fees and exchange rate revaluation amounts; create exceptions where bank fees are present but not allocated.<br>PQ note: build a <code>BankRecon</code> query that accepts local bank CSV and D365 <code>BankAccountTransaction</code> extracts and runs deterministic matching; output a reconciliation status table for upload to dashboards.<br>D365 mapping: use <code>Voucher</code> and <code>LedgerDimension</code> to join to payment batches and ControlSheet rows and mark <code>Reconciled</code> in both systems where matches are found.<br>NGO example: bank statement line with descriptor <code>OUCRU HCMC - VCHR0001</code> matches D365 <code>Voucher=VCHR0001</code> and ControlSheet <code>LineID=CTL-000100</code> and is marked reconciled. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>AuditPack indexing</strong><br>Purpose: structured index allowing audito rs to navigate from ControlSheet rows directly to supporting documents (invoice, approval, bank advice) with file hashes for tamper evidence.<br>Why it matters: a well-indexed audit pack reduces auditor time and demonstrates control quality; file hashes and index entries show documentary integrity.<br>Operator instructions: create <code>AuditIndex</code> entries for every supporting file: <code>IndexNo,LineID,DocType,Supplier,DocDate,FileName,FilePath,FileHash,Notes</code>. Validate that each ControlSheet row has at least one index entry before final sign-off and produce an <code>AuditPack</code> zip containing all referenced files plus an <code>index.csv</code> and a <code>manifest.sha256</code>.<br>Validation checks: for each index row confirm <code>File.Exists</code> and <code>sha256(File) == FileHash</code>. Flag <code>MissingFile</code> or <code>HashMismatch</code> as exceptions. Maintain an <code>AuditPackRetention</code> field per index to automate lifecycle management.<br>PQ note: produce <code>AuditIndex</code> during ingest with automated hash computation and file existence checks; include <code>IndexNo</code> in GLUpload <code>Description</code> for crosswalk.<br>D365 mapping: include <code>IndexNo</code> in <code>JournalLine.Description</code> or as a metadata tag in ERP attachments where supported so auditors can jump from ERP voucher to audit pack.<br>NGO example: auditor requests proof for <code>LineID=CTL-000100</code>; <code>AuditIndex</code> shows <code>IDX0001</code> (invoice PDF) and <code>IDX0002</code> (signed approval) with hashes confirming integrity. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>Exceptions register & SLA</strong><br>Purpose: central log of all issues requiring human resolution, with ownership, impact and escalation rules.<br>Why it matters: exceptions are inevitable; tracking them, assigning owners and SLAs ensures timely resolution and audit trail of remediation actions.<br>Operator instructions: create <code>ExceptionID,SourceRef,LineID,Category,Impact,Owner,RootCause,ActionRequired,Status,SLA,EscalationTo,ClosureEvidence</code>. Automate escalation rules: e.g., <code>Exception.Amount &gt; Materiality AND Age &gt; 2 business days → escalate to CFD</code> and send notifications. Record closure evidence and link it to the <code>AuditIndex</code>.<br>Validation checks: report on aging of open exceptions daily and maintain a management dashboard showing <code>Top Exceptions by Impact</code> and <code>SLA Breaches</code>.<br>PQ note: push all PQ validation failures into <code>IngestExceptions</code> and then synchronize with the master <code>Exceptions</code> registry for tracking and reporting.<br>D365 mapping: map DMF/API import errors into <code>ImportExceptions</code> and link to the master <code>Exceptions</code> register by <code>ExecutionId</code> and <code>LineID</code> for central tracking.<br>NGO example: <code>EXC-00045</code> flagged as <code>MissingTaxID</code> for a $12,000 supplier invoice; owner AP must obtain supporting tax documents within 2 business days or escalate to CFD. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>ChangeLog & governance</strong><br>Purpose: immutable record of changes to mappings, policies and code that affect financial logic or data transformations.<br>Why it matters: auditors and compliance teams require a history of who changed what and why; it enables rollback and forensic investigation when issues appear.<br>Operator instructions: log <code>ChangeID,Date,Author,AffectedObject,PreSnapshot,PostSnapshot,ApprovalEvidence,RollbackPlan,Version</code>. Require two-person approvals for GLMapping, EventCode/Dimension additions or tax-related changes. Archive snapshots of previous mapping files and store them with checksums in the ChangeLog entry.<br>Validation checks: deny production changes unless the ChangeLog entry contains an approver and rollback plan; link CI tests or PQ unit tests results to the ChangeLog entry to demonstrate test coverage.<br>PQ note: produce pre-change and post-change golden-file diffs and attach the diffs to the ChangeLog entry; include unit tests verifying expected transformations.<br>D365 mapping: when a new financial dimension or mapping is introduced, include the <code>ChangeID</code> in both local mapping tables and in the D365 configuration change request for traceability.<br>NGO example: adding <code>EventCode</code> dimension values requires <code>ChangeID=CHG_20260220_01</code>, CFD approval and a rollback plan that sets previous mapping back if import errors occur. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>DonorRules table</strong><br>Purpose: machine-readable encoding of donor-specific cost eligibility, VAT treatment, withholding requirements and evidence needs.<br>Why it matters: donors vary widely — encoding rules prevents accidental disallowed spend and speeds compliance checks.<br>Operator instructions: define <code>DonorName,AllowedCosts,DisallowedCosts,CurrencyRules,VATTreatment,WithholdingPolicy,EvidenceRequired,RetentionYears,SpecialClauses</code>. Use PQ to join ControlSheet rows to DonorRules and auto-tag <code>ComplianceFlag</code> and <code>EvidenceMissing</code> for disallowed or evidence-deficient lines.<br>Validation checks: automatically flag <code>DonorException</code> rows and block payment where donor policy prohibits cost or requires pre-approval. Track <code>DonorBudgetRemaining</code> and flag <code>BudgetOverrun</code> cases in real time.<br>PQ note: join <code>DonorRules</code> to the transaction stream early and enrich rows with <code>DonorRuleID</code> and <code>RuleTriggered</code> columns to make donor-specific reports and exception lists trivial to produce.<br>D365 mapping: include donor project/dimension in GL lines so donor-level reporting is possible in ERP and downsteam BI; ensure the <code>DonorRules</code> logic is reflected in approvals for any donor with special clauses.<br>NGO example: Donor A prohibits alcohol and requires retention for 7 years — PQ flags invoices with the keyword <code>wine</code> and blocks payment until donor-approved justification is uploaded. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>Reporting (DAX)</strong><br>Purpose: define KPIs and measures for operational monitoring and donor reporting, reconciled to GL and ControlSheet.<br>Why it matters: management needs accurate, reconciled measures (budget vs actual, advances outstanding, accruals) to govern events and make decisions.<br>Operator instructions: implement DAX measures such as <code>TotalEventSpend</code>, <code>RemainingBudget</code>, <code>AdvancesOutstanding</code>, <code>AccrualsTotal</code>, and <code>DaysToReconcile</code>. Ensure each measure traces to ControlSheet rows and GL totals; include drill-through to transaction-level details.<br>Validation checks: reconcile DAX totals to GL trial balance monthly; build automated alerts when discrepancies exceed a threshold. Provide sign-off in the monthly pack where DAX reports are validated against ControlSheet and ERP extracts.<br>PQ note: produce clean, model-ready tables (<code>Invoices_Clean</code>, <code>Claims_Clean</code>, <code>Budgets</code>) from PQ so DAX measures are accurate and performant. Keep the model as a star schema for performance.<br>D365 mapping: use D365 extracts (TrialBalance, GeneralLedger) as the source-of-truth for GL-backed measures; cross-validate Power BI measures with ERP extracts.<br>NGO example: <code>Budget_vs_Actual_by_Donor</code> pivot shows Accrued vs Paid per donor with ability to click into top unreconciled invoices for follow-up. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>Power Query test harness</strong><br>Purpose: deterministic test environment to validate PQ transformations against sample/edge-case datasets before they touch production data.<br>Why it matters: PQ changes can silently break mapping, FX or parsing logic; a harness with golden-files prevents regressions and supports CI.<br>Operator instructions: maintain sample file sets (multi-currency, multi-invoice PDFs, malformed files), write unit assertions (row counts, null rates, transformed column expectations), and run the harness in CI on every PQ change. Store logs and <code>QueryLog</code> with execution times and <code>ValidationErrors</code>.<br>Validation checks: gate PQ deployment on zero critical assertions failing; include coverage for edge cases (missing EventCode, negative amounts, unusual date formats). Keep <code>golden-file</code> outputs for byte-for-byte diffs in CI.<br>PQ note: structure queries into small testable functions, parameterise file paths and implement a <code>MaxDate</code> parameter to simulate incremental loads. Use <code>Table.Buffer</code> wisely during tests to prevent flaky behavior.<br>D365 mapping: run end-to-end tests that generate DMF CSV files and validate them against sandbox imports to ensure that PQ transformations match ERP expectations.<br>NGO example: the test harness loads 100 sample AP PDFs and asserts that <code>Invoices_Clean</code> contains 100 rows, zero <code>MissingEventCode</code> and expected <code>LocalAmount</code> sums. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>Operational checklists & runbooks</strong><br>Purpose: prescriptive operational steps for pre-event, during-event and post-event phases so operators know exact actions and owners.<br>Why it matters: checklists reduce human error under pressure; runbooks give step-by-step guidance for incident handling and regular procedures.<br>Operator instructions: create three runbooks: Pre-Event (create EventMaster, parameterise PQ, set permissions), During-Event (daily <code>_raw</code> upload, nightly PQ runs, daily reconciliation of cash floats), Post-Event (reconcile advances within 10 business days, post accruals, assemble AuditPack). Include playbooks for bank-file generation, DMF import and exception escalation.<br>Validation checks: attach a simple sign-off table to each runbook step with owner, timestamp and evidence path. Periodically review and update runbooks after lessons learned.<br>PQ note: schedule automated PQ runs (nightly) and link runbook steps to PQ job outputs; provide runbook links in job notifications for quick operator reference.<br>D365 mapping: include DMF import steps and validation tasks in the runbook with the test plan IDs to run before production import.<br>NGO example: the Post-Event runbook prescribes <code>T+5</code> upload of all receipts, <code>T+10</code> reconciliation and <code>T+15</code> AuditPack sign-off with CFD approval. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>NGO deployment scenarios</strong><br>Purpose: show pragmatic deployment models depending on organisation scale and technical maturity.<br>Why it matters: small NGOs and large NGOs need different trade-offs for automation vs manual control; providing scenarios helps select an appropriate implementation path.<br>Operator instructions: choose the scenario matching capacity: Small NGO (shared drive → desktop PQ → ControlSheet → CSV GLUpload → local ledger); Large NGO (local PQ → GLUpload DMF → ADF staging → DMF import → D365 sandbox validation → production). For each scenario document responsibilities, required accounts, and test plans.<br>Validation checks: for small NGO ensure manual controls and reconciliation tasks have explicit owners; for large NGO ensure test automation, sandbox validation and ChangeLog governance exist.<br>PQ note: parameterise PQ queries so they can be reused in either scenario; use file path parameters and event codes to build reusable pipelines.<br>D365 mapping: large NGO scenario uses full DMF/ADF pipelines and dimension provisioning processes; small NGO may use manual CSV imports and simpler GL mappings.<br>NGO example: small regional office runs PQ on a laptop each evening and prepares a <code>GLUpload_Template.csv</code> for local ledger posting while global HQ uses D365 DMF with automated ADF pipelines. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>Sample ControlSheet lines (expanded narrative)</strong><br>Purpose: concrete examples demonstrate how the conceptual rules appear as rows that feed GLUpload and the AuditPack.<br>Why it matters: examples make rules tangible and train operators how to fill required fields and interpret GL upload outputs.<br>Operator instructions: for each sample row show the source document, extracted fields, PQ transformations and final journal entries. Keep each example annotated: LineID, DocNo, InvoiceDate, Supplier, Currency, Amount, FXRate, LocalAmount, GLCode, EventCode, FundingSplit, Status and ArchivePath.<br>Validation checks: use examples for unit tests: the PQ pipeline should turn the sample input into the expected <code>GLUpload</code> lines and produce the expected journal (accrual or payment). Run sample examples during PQ changes to ensure no regressions.<br>PQ note: store sample rows in <code>TestSamples</code> table and include them in the PQ harness; assert output equality for critical columns (LocalAmount, GLCode, FundingSplit).<br>D365 mapping: use sample rows to validate DMF mapping and mapper transformations in a sandbox prior to production imports.<br>NGO example: Venue accrual <code>CTL-000100</code> becomes an accrual journal <code>Dr 400101 3,000 / Cr 2xxxx 3,000</code> with <code>EventCode=EQUIPSEA202602</code> and <code>D365VoucherNo</code> filled post-import. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>D365 exception handling patterns</strong><br>Purpose: standard responses when DMF/API returns errors so imports can be remediated quickly and auditably.<br>Why it matters: automation without clear error handling leads to untracked failures and manual rework; a consistent pattern speeds recovery and reduces risk of duplicate postings.<br>Operator instructions: capture DMF/API <code>ExecutionId</code>, parse error CSV or JSON, create an <code>ImportException</code> with <code>LineID</code>, <code>ErrorMessage</code>, <code>Owner</code>, and <code>ActionRequired</code>. Typical errors: missing dimension value, Debits != Credits, invalid MainAccount. For missing dimensions create a ChangeLog entry and pause affected lines until the dimension exists. For content errors (unbalanced journal) fix data and re-submit only the corrected lines.<br>Validation checks: monitor <code>ImportErrorRate</code> and alert where error rates exceed thresholds. Keep the failed import file and logs in <code>ImportExceptions</code> store and never re-run the same failed file without resolving root causes.<br>PQ note: include <code>ExecutionId</code> and raw error text in the <code>ImportExceptions</code> table and build automated emails to owners with suggested remediation steps (e.g., missing dimension → create dimension, then re-import lines).<br>D365 mapping: ensure mapping tables include the ERP master lists for validation preflight; pre-validate <code>MainAccount</code> and <code>Dimension</code> existence before calling DMF/API to reduce runtime errors.<br>NGO example: DMF returns <code>LedgerDimension not found</code> for <code>EQUIPSEA202602</code> — an <code>ImportException</code> is created, ChangeLog request logged to create the dimension and import retried once dimension is active. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>Reconciliation tasks & ownership</strong><br>Purpose: deterministic rules to assign ownership of reconciliation items so every unmatched item has a responsible person and SLA.<br>Why it matters: responsibility ensures timely resolution and prevents items from being ignored. Material items must get senior attention quickly.<br>Operator instructions: implement rules: <code>Unmatched &amp; Amount&gt;500 → CFD/SrAcct</code>, <code>PartiallyMatched → PaymentsOfficer</code>, else <code>AP</code>. Track <code>ExceptionID</code>, <code>Owner</code>, actions and closure evidence. Provide daily worklists to owners with aging buckets and quick links to supporting docs.<br>Validation checks: report <code>OwnerWorkload</code> and <code>SLACompliance</code>; escalate automatically when SLA breached and notify CFD/CD for high-impact items.<br>PQ note: output <code>ReconciliationTasks</code> with link to <code>AuditIndex</code> and <code>ControlSheet</code> so owners can quickly access necessary evidence.<br>D365 mapping: where ERP posting exists, link <code>Voucher</code> and <code>LedgerDimension</code> to reconciliation tasks for easier resolution and to leverage ERP bank reconciliation tools.<br>NGO example: <code>Unmatched</code> invoice of $3,500 assigned to <code>CFD</code> because amount exceeds threshold; owner receives alert and a bucket of required evidence to resolve. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>Audit & AuditPack</strong><br>Purpose: preserve an append-only, auditable record of all processing steps, file artifacts and operational decisions for later review and compliance.<br>Why it matters: the AuditPack demonstrates that transactions were processed according to policy and includes evidence auditors will demand; append-only audit chains with hashes provide tamper evidence.<br>Operator instructions: for each event assemble <code>ControlSheet</code>, <code>Invoices</code>, <code>Approvals</code>, <code>BankAdvices</code>, <code>GLUpload</code> and <code>ImportLogs</code> into an <code>AuditPack</code> zip with <code>index.csv</code> and <code>runbook.audit</code> (audit row summary). Compute <code>manifest.sha256</code> and store the archive in encrypted cold storage. Maintain the audit chain: every transformation writes an <code>Audit</code> row containing <code>timestamp,correlationId,module,procedure,payloadHash,prevHash</code>.<br>Validation checks: run <code>VerifyAuditChain</code> periodically to ensure no gaps; ensure all <code>LineID</code> entries have at least one index link and <code>GLUpload</code> references a posted <code>Voucher</code> where applicable.<br>PQ note: write audit rows at key pipeline stages: ingest, normalize, validate, approve, GLUpload, DMF import, post-import reconciliation. Store <code>correlationId</code> to enable full forensic trace of a single LineID.<br>D365 mapping: include <code>runbook.audit</code> and <code>ImportLogs</code> in the AuditPack so auditors can reconcile DMF/API imports to ERP postings.<br>NGO example: the AuditPack for <code>EQUIPSEA202602</code> includes <code>index.csv</code>, <code>GLUpload_EQUIPSEA_20260220.csv</code>, <code>DMFExecutionLog_Exec123.csv</code>, and <code>manifest.sha256</code>. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>Security, PII & key management</strong><br>Purpose: protect personally identifiable information, secrets and ensure integrity of audit signing keys.<br>Why it matters: mishandling PII or keys exposes the NGO to legal risk, privacy violations and undermines audit evidence integrity.<br>Operator instructions: store PII encrypted in a secure vault; in ControlSheet store only masked values (e.g., <code>****5678</code>) with <code>ArchivePath</code> pointing to encrypted evidence. Use HSM-backed signing for audit chain rotations and require multi-person approval for key exports. Prohibit secrets (API keys, credentials) in plain files; log key rotation events and record them in the audit chain.<br>Validation checks: run PII scans for new uploads and enforce redaction rules for external shares. Test key rotation procedure annually and store rotation logs in the audit system.<br>PQ note: implement an automated redaction step for external reports that strips or masks PII fields before production exports.<br>D365 mapping: if PII is required in ERP (e.g., supplier bank account), ensure ERP storage meets local privacy laws and mapping only stores masked references in local audit indices.<br>NGO example: participant bank details are stored encrypted in VendorMaster and masked in ControlSheet; only payroll and payments officers with vault access can decrypt full details for payment. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>Exception & incident runbooks</strong><br>Purpose: prescriptive steps for containment, evidence preservation, remediation and post-mortem for incidents (fraud, data breach, import failure).<br>Why it matters: a practiced runbook reduces response time, preserves evidence chain-of-custody and improves remediation quality.<br>Operator instructions: runbook steps: Contain (halt payments), Notify (CFD, CD, IT), Investigate (collect logs, bank advices, audit tail), Remediate (reverse payments if possible, recovery steps), Document (lessons learned, policy updates). For forensic packs produce <code>forensic_manifest.json</code> with file list + sha256 and store in secure share with chain-of-custody.<br>Validation checks: after an incident run the <code>VerifyAuditChain</code> and confirm no missing or tampered audit rows. Update <code>IncidentLog</code> with closure evidence and automated follow-up tasks.<br>PQ note: include diagnostics exports as part of the runbook (PQ query outputs, last successful transform hashes) to speed troubleshooting.<br>D365 mapping: retrieve DMF execution logs and ERP change history as part of the forensic pack; include them in the incident evidence and link to <code>ExceptionID</code> entries.<br>NGO example: suspected fraud in supplier payments triggers immediate payment halt, forensic manifest creation, and HR/legal involvement; payments reversed where possible and ChangeLog updated with new supplier verification steps. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>CI/CD, tests, golden-files & release manifest</strong><br>Purpose: govern code and mapping changes to PQ, export scripts and automation with signed artifacts and reproducible tests.<br>Why it matters: automated pipelines reduce human error and ensure changes do not break transformations that affect financial reporting.<br>Operator instructions: implement CI pipelines that run lint, unit tests, integration tests (PQ harness), golden-file comparisons, audit chain verification and performance microbenchmarks. Produce a <code>ReleaseManifest</code> (<code>buildId,commitHash,artifactList,signingFingerprint,ciSummary,complianceApproval</code>) and sign artifacts before deployment. Patch releases must contain a <code>patchManifest</code> detailing fixes and approvals.<br>Validation checks: block production deploys unless all critical tests pass and compliance approval recorded in the manifest. Keep golden-files for PQ outputs and DMF CSVs and require byte-for-byte match for regression-sensitive transforms.<br>PQ note: create small, testable PQ modules and include integration tests that produce DMF-ready CSVs; store golden-files in the repo for CI comparison.<br>D365 mapping: include sandbox DMF import in integration tests and assert no import errors for test data sets before production deploy.<br>NGO example: a PQ change to filename parsing is tested in CI against 200 sample filenames including edge cases; golden-file diff ensures no unexpected mapping changes and the release manifest includes CFD sign-off. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>GL upload preflight & export checks</strong><br>Purpose: last-line checks ensuring journals are balanced, approved and ERP-compatible before export to DMF/API.<br>Why it matters: preflight prevents failed imports, duplicate postings or incorrect ledger tagging which are costly to remediate.<br>Operator instructions: preflight checklist: Debits==Credits per journal header; only <code>Approved</code> rows included; all required dimensions exist in ERP master extracts; export preview saved as signed PDF by Accounting Manager & CFD. If preflight fails, create <code>UploadValidationError</code> entries and block exports.<br>Validation checks: run preflight automatically and produce a human-reviewable report with failing rows and suggested fixes; require explicit approval to proceed on material overrides.<br>PQ note: produce a <code>GLUpload_Preview.pdf</code> automatically and attach signatures (electronic) to confirm review. Store preflight logs with <code>UploadValidationError</code> codes for audit.<br>D365 mapping: ensure the export's <code>MainAccount</code> and <code>DimensionCombination</code> format match the ERP expected layout; test import with a small subset in sandbox before full import.<br>NGO example: preflight caught an unmapped <code>MainAccount</code> for a newly added category; export blocked until mapping and CFD approval completed. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>Payment bank-file & reconciliation automation</strong><br>Purpose: automated, auditable bank-file creation and post-payment reconciliation to close payment control loops.<br>Why it matters: automation reduces manual errors in bank uploads and guarantees a clear trail from ControlSheet lines to bank advices and ERP postings.<br>Operator instructions: generate bank file atomic write (temp -> move), sign/checksum, upload to SFTP/bank portal with dual approval for large amounts, archive both bank file and bank advices, then post bank-cleared journals using returned SWIFT refs. Implement automated reconciliation jobs linking bank advices to BatchIDs and ControlSheet lines.<br>Validation checks: validate IBAN/BankCode formats and amounts before upload; after bank confirmation match returned SWIFT refs to <code>BatchID</code> and mark <code>Paid</code> and <code>Reconciled</code> with evidence paths attached.<br>PQ note: generate <code>BankFileManifest</code> and an <code>UploadLog</code> with checksum and row counts; create automated tests to validate new bank formats in staging.<br>D365 mapping: post bank-cleared journals referencing BatchID and update ERP bank reconciliation module so bank statements in D365 reconcile with ControlSheet rows.<br>NGO example: atomic upload of <code>BB20260220_001.iso</code> to bank SFTP succeeded; bank returned SWIFT refs which automatically updated ControlSheet <code>Status=Paid</code> and <code>ReconciledDate</code>. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>Operational KPIs & monitoring</strong><br>Purpose: operational metrics detect drift, performance bottlenecks and quality issues early (AutoMatchRate, UploadErrorRate, AdvancesOutstanding, DaysToReconcile).<br>Why it matters: KPIs guide remediation priorities and show whether automation improvements are achieving intended benefits.<br>Operator instructions: define KPI thresholds (WARN/CRIT), wire metrics into dashboards and alerts, and assign runbook actions when thresholds breach. Examples: <code>ExportErrorRate</code> WARN>0.5% CRIT>2% triggers immediate investigation. Include forensic quick-export functionality on dashboard tiles to collect relevant audit logs rapidly.<br>Validation checks: monitor and chart trends; correlate KPI spikes with PQ changes or release events and schedule hot-fixes where needed.<br>PQ note: log query durations and row counts with <code>QueryLog</code> and expose them to the monitoring system. Include per-event KPIs for event health tracking.<br>D365 mapping: surface ERP import error rates and reconcile them with <code>ImportExceptions</code> to get end-to-end error visibility.<br>NGO example: average <code>DaysToReconcile</code> dropped from 12 to 6 after GLUpload automation and scheduled bank feed integration. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>Run-to-resolution cheat-sheets (operator commands)</strong><br>Purpose: short CLI/command templates and the exact audit action each operator should run to diagnose and remediate common problems quickly.<br>Why it matters: reproducible troubleshooting steps reduce time-to-resolution and ensure evidence is captured for every operator action.<br>Operator instructions: sample commands (conceptual): <code>diagnostics collect --run-id &lt;id&gt; --out &lt;path&gt;</code> collects logs and audit_tail; <code>audit flush --immediate --correlation &lt;id&gt;</code> forces audit writes; <code>jobs requeue --job-id &lt;id&gt;</code> re-runs failing jobs. Each command must append an audit row with operator id and reason.<br>Validation checks: ensure each action appends a corresponding audit entry; provide quick links from the monitoring dashboard to run frequently used commands under appropriate RBAC restrictions.<br>PQ note: implement safe requeue routines that run in isolated runners and respect idempotency; log inputs/outputs for every re-run.<br>D365 mapping: provide safe re-run steps for DMF re-imports (e.g., fix CSV, re-stage only failed lines) and capture <code>ExecutionId</code> in audit entries.<br>NGO example: operator runs <code>diagnostics collect</code> after a failed DMF import and attaches the created diagnostic ZIP to <code>ImportException</code> for CFD review. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>Templates & appendices (copy-ready references)</strong><br>Purpose: canonical templates for audit rows, job descriptors, forensics manifests and DMF CSV rows so teams have copy-ready artifacts that meet audit and ERP format requirements.<br>Why it matters: standard templates speed operations and prevent format drift that causes import failures or audit mismatches.<br>Operator instructions: store templates under <code>appendices/templates/</code> and protect them as golden-files. Examples include <code>AuditRow.json</code>, <code>JobDescriptor.json</code>, <code>ForensicManifest.json</code>, <code>DMF_CSV_Header.csv</code>, and <code>D365_API_Payload.json</code>. Use templates in CI validation and reference them during onboarding.<br>Validation checks: compute checksums for templates and require sign-off for template changes; treat template edits as ChangeLog items that require approvals for production release.<br>PQ note: template-driven exports simplify mapping and reduce hard-coding; paramaterise templates for event-level replacements (EventCode, dates, BatchID).<br>D365 mapping: include DMF CSV templates with header names matching the sandbox entity expectations; test these templates during release validation.<br>NGO example: <code>GLUpload_Template_D365.csv</code> as a golden-file used across offices to ensure consistent imports. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>Final prescriptive rules (plain-language expansion)</strong><br>Purpose: short, non-negotiable rules that govern the entire pipeline and protect control integrity.<br>Why it matters: clear prescriptive rules are easy to audit and reduce discretionary exceptions that cause errors.<br>Rules (implement exactly unless a recorded compliance exception exists):<br>1) Audit is authoritative — append-only; legal/compliance approval is required to alter audit rows.<br>2) EventCode is mandatory on every row and file; PQ must block ingestion without it.<br>3) FundingSplit must sum to 100% within ±0.01% tolerance; auto-block if not met.<br>4) Regulatory-impacting changes (GLMapping, tax logic, dimension additions) require two-person approval and CI re-run against golden fixtures.<br>5) Exports and bank-files must be atomic writes and recorded with checksums; store file hashes in AuditPack. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>Next steps & actionable artefacts (plain-language expansion)</strong><br>Purpose: concrete implementation tasks for developers, operators and compliance to operationalise the guide.<br>Why it matters: an actionable checklist converts policy into delivered capability and helps prioritise automation vs manual controls.<br>Developer tasks:<br>• Implement PQ transforms with test harness and golden-files. Include <code>RecalcHash</code> and <code>AuditNote</code> columns. Add <code>LineID</code> to every output row. Ensure idempotency keys for API imports.<br>Operator quick-start:<br>• Run PQ test harness against sample set, confirm <code>audit_tail.csv</code> contains correlation ids, validate DMF staging import in sandbox before production.<br>Compliance actions:<br>• Maintain <code>GLMapping</code> change log and pre-create EventCode dimension values in D365 before imports. Document retention and PII handling policies.<br>Validation checks: schedule a short review meeting for CFD and CD to sign off the first two events’ AuditPacks and runbooks. </td></tr><tr><td data-label="EQUIPSEA Accounting Manual"> <strong>End: verification summary (plain-language expansion)</strong><br>Purpose: confirm this expanded narrative is the canonical developer/operator reference for implementing the pipeline described earlier.<br>Why it matters: everyone implementing PQ, GLUpload, DMF/API imports and audit packs should refer to this document as the single source of truth and follow the prescriptive rules above.<br>Actionable wrap-up: use the per-row narratives above as copy-ready text in training materials, runbooks and PQ query comments; if you want a PDF/XLSX export, provide <code>filename</code>, <code>format</code> and metadata and I will generate the export with an appended <code>runbook.audit</code> summary. </td></tr></tbody></table></div><div class="row-count">Rows: 58</div></div><div class="table-caption" id="Table3" data-table="YJKN_0005_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Good Financial Grant Practice (GFGP) **"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Good Financial Grant Practice (GFGP) </strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Purpose & objective — expanded, operational intent, success metrics & decision use</strong><br><strong>Narrative:</strong> GFGP establishes a transparent, auditable, and proportionate set of baseline practices for organisations that receive or administer grants. Its objectives are: reduce repetitive funder due-diligence by creating a common evidence standard; raise the consistency and reliability of organisational financial, HR, procurement and governance controls; and create a verifiable pathway to independent certification demonstrating continuous improvement. The Standard emphasises proportionality: expectation and evidence should reflect organisation size, funding complexity, legal environment and operational risk. Evidence must show both the existence of policy and the consistent, historical application of the policy via transactional samples and management oversight. Certification is an outcome of sustained practice — not a one-off documentation exercise.<br><strong>Operational aim & intent:</strong> Convert policies into repeatable processes with named owners, tracked remediation, automation where feasible, and evidence in a central repository mapped to RequirementIDs. Produce: documented controls, searchable evidence, demonstrable implementation, and a continuous improvement loop that reduces time-to-contract with funders. The organisation must demonstrate policy → SOP → transaction sample → remediation trace for each significant control.<br><strong>Success metrics (practical, measurable):</strong><br>• Portal acceptance: funders accept portal pre-certification in lieu of repetitive evidence.<br>• Control performance: internal audit sample findings < 2% control failures across sampled transactions.<br>• Retrieval SLA: evidence retrieval SLA met >95% within 3 working days.<br>• Operational integration: GL narratives include PayrollRun ID on 100% of payroll journals.<br><strong>Decision triggers & policy application examples:</strong><br>• Use GFGP portal tier as procurement criteria for sub-award partners (minimum Bronze for partners managing >USD 250k p.a.).<br>• Use remediation closure rate > 60 days as trigger for escalation to Executive sponsor. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Scope — inclusive boundaries, exclusions, in-scope activities and operational notes</strong><br><strong>Narrative:</strong> Scope covers organisation-level systems, policies and operating practices across four practice areas: Financial Management (budgeting, chart of accounts, GL mapping, bank and cash controls, reconciliations, payroll), Human Resources (contracts, payroll, classification, staff records), Procurement (tendering, evaluation, supplier due-diligence), and Governance (DoA, board oversight, fraud policy, whistleblowing). Cross-cutting requirements include IT security, data protection, records management and continuity planning. GFGP applies to the full grant lifecycle: award set-up, budget allocation, accounting, payments, procurement for grant activities, payroll apportionment, donor reporting, closeout and archiving.<br><strong>Operational boundaries & exclusions:</strong> Explicitly document scope boundaries to prevent audit surprises. State which entities, cost centres and bank accounts are included; list excluded subsidiaries or non-grant commercial units and explain data segregation measures. For multi-country entities, define which country offices are "in-scope" for each certification attempt.<br><strong>In-scope examples:</strong> country offices receiving direct grants or allocating >10% of central payroll cost; central finance functions for grant accounting; outsourced payroll providers performing payroll for in-scope entities.<br><strong>Out-of-scope examples:</strong> wholly-owned commercial subsidiaries with separate audited accounts; non-grant commercial activities that do not affect donor funds.<br><strong>Scoped activities (concrete examples):</strong> award budget coding; salary apportionment and effort reporting; procurement for capital equipment; vendor monthly remittance proofs; inter-company cost reallocations for centrally managed payroll; GL mapping for donor budget lines. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Key definitions & core recognition principle — glossary, metadata & evidence taxonomy</strong><br><strong>Narrative:</strong> Use consistent definitions inside policies and evidence to avoid ambiguity during audits and portal tagging. Maintain a controlled-vocabulary definitional annex in the Evidence Repository. Primary concepts to define and use consistently: Evidence Index (master register mapping documents to RequirementIDs), Pre-certification (portal self-assessment output), Certification Audit (independent audit by licensed body), Compensating Controls, PayrollRun ID (unique identifier for each payroll run), Apportionment Schedule, Sample Transaction, Remediation Item.<br><strong>Metadata requirement for each Evidence Item:</strong> captured_date; owner; sample_period_start; sample_period_end; redaction_flag (Y/N); version; file_hash; evidence_type (Policy/SOP/TransactionSample/SystemLog/Certificate); RequirementIDs (one or more).<br><strong>Recognition principle:</strong> Treatment is judged by application over time; a policy without supporting transactional samples and sign-offs is insufficient. Accrual accounting is mandatory where applicable — expenses recognised when services were rendered rather than when cash flows occur. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Core principles & Key controls (GFGP alignment) — objectives, control activities, acceptance criteria, test plans</strong><br><strong>Narrative:</strong> Controls must be documented, ownership assigned, tested regularly and tracked in an Evidence Index. Controls include policies, segregation of duties & DoA, documented accounting & apportionment rules, monthly reconciliations and variance investigation, payroll control pack standards, supplier due-diligence for procurement, secure system controls and access review, DPIAs, audited backups and restore tests, internal audit cycle. Each control must have objective, control activity, acceptance criteria, and test steps documented in a Control Testing Matrix.<br><strong>Example control: Payroll authorisation</strong><br>• Objective: Ensure payroll amounts are authorised and accurate.<br>• Control activity: Independent reviewer signature and variance analysis on payroll control sheet.<br>• Acceptance criteria: Reviewer signature present; variance within threshold (default 2%) with explanation for anomalies; sample cross-check of 10 employees including top 2 earners.<br>• Test steps: Select 6 recent payroll runs; verify reviewer signature; recalc 10 sample employees; confirm GL narration includes PayrollRun ID; confirm bank advice equals net pay total.<br><strong>Additional examples of key controls in practice:</strong><br>• Procurement: retain evaluation matrices, conflict-of-interest declarations, award approvals and signed contracts in a single procurement file per contract.<br>• Bank reconciliations: monthly reconciliations with sign-off, evidence of review notes and issue tracking. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Governance & responsibilities (RACI mapping, governance packets, escalation traces)</strong><br><strong>Narrative:</strong> RACI clarity prevents evidential gaps. Document named responsible owners and deputies for each RequirementID and maintain ownership records. Governance should include escalation routes for unresolved remediation and policy exceptions. The Board/Executive must receive periodic summaries of GFGP readiness metrics and open remediation items.<br><strong>Detailed RACI (payroll example):</strong><br>• Responsible: Payroll Preparer (name/title).<br>• Accountable: CFO/Head of Finance.<br>• Consulted: HR Lead, IT System Owner.<br>• Informed: Budget Holders, Country Director.<br><strong>Governance artifacts to prepare & link to evidence:</strong> Board minutes approving GFGP programme; quarterly management dashboards showing % requirement coverage; remediation register with owner, due date, status, supporting evidence link; governance packet for major decisions (one-page summary + risk assessment + decision + follow-up tasks).<br><strong>Escalation rules example:</strong> unresolved remediation >30 days escalate to CFO; unresolved >60 days escalate to Executive sponsor with Board notification. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Systems & security (evidence focus, DPA/SOC, step-by-step checklist)</strong><br><strong>Narrative:</strong> Systems are authoritative sources: ERP/GL, HRIS/HROS, payroll system (in-house or outsourced), procurement platforms, document repositories. Evidence should show role-based authorisations, quarterly access recertification, change control logs, backup/restore test results, independent provider attestations (SOC1/SOC2), encryption at rest/in transit, MFA for privileged accounts, logging and periodic log review, DPAs for third-party processors.<br><strong>Minimum systems evidence checklist:</strong> system inventory (owner; hosted location), role matrix & entitlement extract, quarterly access certification evidence signed by owners, backup schedule & last successful restore test report with RTO/RPO evidence, penetration test summary & remediation log, DPAs and SOC reports for SaaS providers, encryption statements and key management evidence, recent configuration change control log.<br><strong>Examples & documentation:</strong> Access review spreadsheet; backup restore test report; DPA and SOC2 for payroll vendor; audit trail samples for user access; MFA enablement evidence for admin accounts. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>GFGP adoption pathway (project governance, sprint model, stepwise plan & deliverables)</strong><br><strong>Narrative & pragmatic steps:</strong><br>1. Acquire/confirm ARS 1651/Standard summary and produce internal mapping to local rules.<br>2. Register organisation on GFGP portal; assign portal owner.<br>3. Run portal self-assessment; export gap report.<br>4. Create Evidence Index; tag existing documents; define metadata standard.<br>5. Prioritise remediation into Immediate / Medium / Long; define acceptance criteria for each remediation.<br>6. Assign owners; allocate resource / FTE estimates.<br>7. Implement quick wins (policies, reconciliations, sample packs).<br>8. Run internal readiness review/mock audit.<br>9. Engage licensed Certification Body; confirm sample sizes & scope.<br>10. Address non-conformances; document closure evidence. Maintain cadence for ongoing self-assessment.<br><strong>Sprint model example (2-week sprint):</strong> Sprint planning: identify N RequirementIDs and owners; Execution: owners collect files, apply naming convention & tag Evidence Index; Review: internal reviewer runs checklist; create remediation tickets for unresolved items; Demo: portal owner shows completed packs & remediation status; Retrospective: feedback loop to improve next sprint. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Portal & pre-certification outputs (what to expect, storage & handling large files)</strong><br><strong>Narrative:</strong> Portal typically returns: quantified coverage % by practice area & RequirementID; ranked gap list; suggested remediation tasks; templates; tier recommendation (Bronze->Platinum). Save portal reports (PDF/CSV) in Evidence Repository with unique filename and evidence entry.<br><strong>Handling large attachments:</strong> For attachments >10MB compress into zipped packs and include manifest (file list + SHA256 hashes + index). Store zipped pack in archive and upload manifest to portal. Keep an unzipped index entry for quick search. Evidence Index should include pointer to zip and manifest.<br><strong>Naming example for portal outputs:</strong> <code>Portal_GapReport_OrgName_YYYYMMDD.pdf</code> → link to Evidence Index row with metadata and owner. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Certification pathway & practicalities (audit engagement checklist & pre-audit prep)</strong><br><strong>Narrative:</strong> Certification requires evidence of consistent practice; may include remote documentation review plus targeted site visits. Select a licensed Certification Body early for scope and fee estimate. Prepare transactional sample sets (3–12 months) per practice area. Anticipate corrective action plans and budget for re-assessment cycles per certification validity.<br><strong>Pre-audit checklist:</strong> confirm audit scope and sample sizes with cert body; pre-assemble audit packs & cross-reference indexes; prepare named auditor liaison and calendar slots; ensure secure shared folder or portal access; have NDA and secure channel for unredacted files.<br><strong>During audit:</strong> Provide daily status notes summarising files provided & open queries. Record all auditor requests and responses in query tracker. Provide a short "how to navigate pack" guide.<br><strong>Post audit:</strong> prepare corrective action plan with owners/due dates; update remediation register and Evidence Index with closure evidence; produce executive summary for Board. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Evidence catalogue — minimum evidence types, mapping rules, sample lists by practice area</strong><br><strong>Narrative:</strong> For each practice area produce a package: signed policy (with version history); SOP & process map; evidence of application (3–12 months representative transactions); reconciliations & variance analysis; authorisation approvals (DoA/email/portal approvals with audit trail); system logs; training records; internal audit results. Tag each document with RequirementID(s) and provide short comment on relevance. For donor-funded activities include donor compliance evidence (timesheets, apportionment schedules).<br><strong>Mapping rules:</strong> one file may map to multiple RequirementIDs — include explanatory note per mapping. For sampled bundles include cover sheet listing which records map to which RequirementID. Use controlled vocabulary for EvidenceType: Policy/SOP/TransactionSample/SystemLog/Certificate/Remediation.<br><strong>Detailed sample evidence lists by practice area:</strong><br>• Finance: chart of accounts mapping; bank reconciliations (3 months); treasury signatory list; petty cash logs; GL upload preview & posted journal with PayrollRun ID; sample invoices + POs + payment approvals.<br>• HR/Payroll: staff contracts; HROS master extract; payroll control pack for last 6 runs; payslips (redacted where necessary); statutory remittance receipts; joiner/leaver checklist; payroll reconciliation and variance analysis.<br>• Procurement: procurement policy; supplier register; 3 sample tender files (advert, evaluation, award approval, contract); conflict-of-interest declarations; supplier due-diligence docs.<br>• Governance: DoA; Board minutes approving key policies; fraud policy + whistleblowing logs; internal audit reports + remediation logs. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Document & evidence management (naming, storage, retention, folder structure & automation)</strong><br><strong>Narrative:</strong> Centralise evidence in an access-controlled repository with version control and searchable index. Maintain master Evidence Index with columns: RequirementID, PracticeArea, DocumentName, FilePath/URL, Owner, DateCollected, SamplePeriodStart, SamplePeriodEnd, Version, RedactionRequired (Y/N), Notes, FileHash. Automate exportable views for auditors (pack per practice area). Implement retention metadata per local law & donor rules. Ensure PDFs are OCR/searchable; for scanned images, include OCR pass and metadata. Provide cross-reference sheet for zipped archives.<br><strong>Strict naming convention (enforce by pre-upload validation):</strong> <code>&lt;GFGP&gt;_&lt;PracticeArea&gt;_&lt;DocType&gt;_&lt;PayrollRunID_or_Period&gt;_&lt;YYYYMMDD&gt;_&lt;ShortID&gt;_&lt;v#&gt;.pdf</code>.<br><strong>Suggested folder structure:</strong> <code>/evidence/{practice_area}/{year}/{doc_type}/</code> e.g., <code>/evidence/payroll/2026/control_packs/</code> with index CSV per folder.<br><strong>Retention matrix (example):</strong> payroll transactions 7 years (or local statute); board minutes permanent; procurement capital files 10 years; system logs 1-3 years depending on policy. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Sample control checklists (detailed), pre-upload validation rules & checklist automation</strong><br><strong>Narrative:</strong> Prepare checklists per practice area that evidence owners must complete before document presentation. Each checklist signed by owner and date-stamped. Use automated validation to catch naming & metadata errors before upload.<br><strong>Payroll control checklist (detailed):</strong><br>1. Master data extract included & reconciled.<br>2. Payroll control sheet with preparer signature (digital or scan) & timestamp.<br>3. Reviewer signature & variance analysis attached.<br>4. Bank batch file & bank confirmations attached.<br>5. GL upload preview & posted journal number recorded.<br>6. Sample payslips (min 5) linked to employment contracts.<br>7. Statutory remittance proofs & payment receipts attached.<br>8. Apportionment schedule for donor staff.<br>9. Exception log with approvals for anomalies > threshold.<br>10. Evidence Index row completed with file_hash & metadata.<br><strong>Procurement checklist (detailed):</strong> procurement policy; DoA verification; requisition & budget approval; tender advert/RFP; bidders list; evaluation matrix signed by panel; conflict declarations; award sign-off; signed contract; delivery/acceptance evidence; invoice & payment evidence; due-diligence documents; evidence index row & manifest.<br><strong>Automated validation rules (examples):</strong> pre-upload filename pattern enforcement; required metadata fields non-empty (owner, date, evidence_type); evidence_type controlled vocabulary; PDF OCR check (min 80% text extractable) or tag for OCR job; zip manifest verification (matching file hashes). Provide a small pseudo-code validator (below).</td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Implementation & remediation project plan (priorities, escalation, Gantt text & sprint backlog examples)</strong><br><strong>Narrative:</strong> Structure as three horizons: Immediate (0–3 months), Medium (3–9 months), Long (9–18 months). Maintain remediation register updated weekly. Use agile sprints (2–4 weeks) for evidence collection with sprint owner and deliverables. Include contingency for external dependencies (vendor SOC reports).<br><strong>Escalation matrix (severity & SLA):</strong><br>• Sev1 — Critical (material financial risk): escalate to Board within 48 hours; emergency remediation plan; daily status until closed.<br>• Sev2 — High (donor impact): escalate to Executive sponsor within 7 days; weekly updates.<br>• Sev3 — Medium/Low: logged in remediation register; standard cadence.<br><strong>Sample sprint backlog items (example 2-week sprint):</strong> gather last 3 payroll packs; upload bank reconciliations for Q4; create evidence index entries + file hashes for 20 files; run OCR on scanned policy docs; finalize DoA updates; fix 10 filename errors flagged by validator.<br><strong>Textual Gantt (summary):</strong> 0–3 months: Portal registration, Evidence Index creation, 3-month sample packs, publish core policies. 3–6 months: Staff training, collect 12 months sample, implement validation rules, internal audits. 6–12 months: Systems integration planning, mock certification audit, remediation closure. 12–18 months: Certification audit, address non-conformances, implement sustained evidence refresh cadence. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Costs & timeline benchmarks (detailed planning, vendor selection & cost estimation guidance)</strong><br><strong>Narrative:</strong> Costs/timelines vary by starting maturity. Budget lines: portal fees, training & consultancy, internal staff time for evidence collation, IT integration, certification audit fees. Provide at least two vendor quotes. Plan for internal FTE allocation and contingency.<br><strong>Indicative planning table (illustrative):</strong><br>• Small NGO (well-prepared): 3–6 months readiness; internal effort 0.1–0.2 FTE for 3 months; consultant optional; audit fees low ($1k-$5k).<br>• Medium research institute: 6–9 months; internal effort 0.2–0.5 FTE; consultant $3k–$12k; audit fees $5k–$15k.<br>• Large org: 9–18 months; internal project team 0.5–2.0 FTE; IT integration higher; audit fees scale with transaction volume.<br><strong>Cost drivers:</strong> audit scope (#entities, transactions), on-site days, manual vs integrated systems, day rates. Always request SOW with deliverables, timelines, remote/on-site split, sample sizes, and hourly/day rates. Retain contingency (10–20%) for unexpected rework. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Common pitfalls & mitigations — practical enforcement & quick pre-audit checklist</strong><br><strong>Narrative:</strong> Common pitfalls: poor indexing, inconsistent naming, incomplete or improperly redacted samples without cross-references, inadequate segregation of duties, insufficient transactional history, underestimation of staff time for evidence collation. Mitigations: strict naming convention, enforcement via pre-upload validator, scheduled sample collection drives, documented compensating controls where segregation not possible, mock audits, executive sponsorship to unblock resources.<br><strong>Concrete mitigations & tools:</strong><br>• Enforce folder templates & pre-upload validation.<br>• Run monthly sample collection drives with owner reminders and measured KPIs.<br>• Use automated scripts to flag missing metadata & name anomalies.<br>• Implement compensating control templates for small offices and include test plans.<br><strong>Quick pre-audit checklist:</strong> Filename consistency; Evidence Index entries complete & owners assigned; Sample bundles include signed approvals; Redaction log present for PII; At least one mock auditor submission completed & peer-reviewed. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Mapping to award management & donor due diligence — donor mapping, template & reuse</strong><br><strong>Narrative:</strong> Create donor-mapping table linking frequent donor evidence requests to RequirementIDs and organisation evidence. Use GFGP certification/pre-certification to negotiate reduced due diligence. Maintain donor-specific appendices for deviations from GFGP.<br><strong>Donor mapping table fields:</strong> <code>DonorName | DonorRequestPhrase | GFGP_ReqID | OrgEvidenceRef | Comments | LastUpdated</code>. Example row: <code>DFID | Last 6 months bank recon | GFGP_REQ_FM_02 | /evidence/bank/recon_202601.pdf | Provided via portal pack | 2026-02-16</code>.<br><strong>Practical use:</strong> Auto-generate donor response packs by filtering Evidence Index by RequirementIDs mapped to donor requests, and produce zipped audit packs with manifest & cross-ref matrix. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Monitoring, re-assessment & sustaining compliance — lifecycle, cadence & owner attestations</strong><br><strong>Narrative:</strong> Maintain an annual compliance cycle: portal self-assessment, internal audit, remediation, management review and Board update. Schedule quarterly owner attestations; maintain rolling evidence refresh schedule (e.g., update sample packs quarterly). Track remediation via live register and escalate long-running items. Use KPIs to monitor progress and business case for resources.<br><strong>Suggested cadence example:</strong> Jan portal self-assessment; Feb internal audit; Mar–May remediation sprints; Jun executive review; Sep update evidence packs; Nov Board update. Quarterly owner attestations for evidence completeness; annual mock audit; evidence refresh sprints each quarter; KPI reporting to Board twice yearly. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>KPIs & management reporting (definitions, calculation, dashboard examples)</strong><br><strong>Narrative:</strong> KPIs should be measurable, time-bound and aligned to governance needs. Use dashboards with trend lines for progress and risk exposure.<br><strong>KPI definitions & targets (examples):</strong><br>• RequirementCoverage (%) = (Count ReqIDs with valid Evidence Items / Total ReqIDs) <em> 100. Target >75% pre-audit; >90% post-certification.<br>• EvidenceRetrievalSLA (%) = (# requests fulfilled within SLA / Total requests) </em> 100. Target >95%.<br>• RemediationClosureTime (median days) Target <45 days.<br>• SampleTestPassRate (%) Target >90%.<br>• CostToCompilePack (USD) = staff_hours * loaded_hourly_rate. Track and benchmark annually.<br><strong>Dashboard layout suggestions:</strong> KPI tickers (current vs target), trend charts (last 12 months), remediation open-by-age, top 10 missing RequirementIDs, evidence retrieval SLAs by owner, sample test pass rate over time. Include drill-down capabilities linking to Evidence Index rows. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Training, roles & change management — curriculum, modules, role-specific materials & completion tracking</strong><br><strong>Narrative:</strong> Training must be role-specific and practical. Evidence owners get tag & redaction training; preparers/reviewers receive procedural training and tabletop mock audits. Document role responsibilities and include GFGP tasks in annual objectives. Change management should include stakeholder comms, training, and quick reference guides.<br><strong>Suggested training plan & micro-modules:</strong> Week 1 portal orientation for leadership; Week 2 evidence index hands-on for owners; Week 3 payroll/HR workshop; Week 6 procurement file walkthrough; Week 12 mock audit exercise. Micro-modules (30–60 mins) include: Evidence Index basics & tagging; Redaction & PII rules; Payroll pack assembly; Procurement file build & evaluation scoring. Include quizzes, hands-on tasks, and store completion certificates in Evidence Index. Track completion in training register with evidence links. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>IT & data protection specific controls — DPA, DPIA, encryption, cross-border & sample clauses</strong><br><strong>Narrative:</strong> Payroll and finance data are highly sensitive. Implement signed DPAs with processors, conduct DPIAs for cross-border transfers, ensure encryption at rest/in transit, maintain retention/destruction policies aligned to local law & donor rules. For cloud providers, obtain SOC2 Type II or equivalent and review scope. Keep access certification logs and evidence of penetration testing for critical systems.<br><strong>Practical DPA checklist items:</strong> Data types processed; lawful basis; sub-processor list; breach notification timelines; encryption & key management obligations; cross-border transfer mechanisms (SCCs or equivalent); delete/return on termination clause.<br><strong>Suggested DPA clause examples (short snippets):</strong><br>• Data controller and processor obligations; permitted processing; data subject rights; security measures (encryption, MFA); sub-processor engagement conditions; breach notification timeline (24–72 hours); deletion/return at termination; audit rights for controller. Store signed DPA in Evidence Repository with metadata. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Sample filenames, journal narratives & evidence tags — templates, enforcement rules & GL mapping</strong><br><strong>Narrative:</strong> Standardise filenames and journal narratives for rapid cross-referencing. Enforce templates at upload and link GL entries to evidence files. Provide auditors with cross-reference index mapping GL entries to file locations.<br><strong>Suggested filename convention:</strong> <code>&lt;GFGP&gt;_&lt;PracticeArea&gt;_&lt;DocType&gt;_&lt;PayrollRunID_or_Period&gt;_&lt;YYYYMMDD&gt;_&lt;ShortID&gt;_&lt;v#&gt;.pdf</code> (e.g. <code>GFGP_Finance_PayrollPack_PR202602_20260215_v1.pdf</code>).<br><strong>Journal narrative template:</strong> <code>Payroll accrual 202602 — PR202602 — Evidence: /evidence/payroll/GFGP_Finance_PayrollPack_PR202602_20260215_v1.pdf</code>.<br><strong>Enforcements & automation:</strong> Implement pre-upload validator script to reject non-matching filenames. Integrate GL narration template into ERP to force PayrollRun ID inclusion on payroll journals. Provide sample SQL for cross-ref: <code>SELECT gl.journal_id, gl.narration, e.file_path FROM gl_journals gl LEFT JOIN evidence_index e ON gl.narration LIKE &#x27;%&#x27; || e.evidence_tag || &#x27;%&#x27; WHERE gl.period = &#x27;2026-02&#x27;;</code> </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Audit expectations & sample audit packs — structure, remote audit tips & pack navigation guide</strong><br><strong>Narrative:</strong> Auditors expect indexed, cross-referenced packs that allow design and operating effectiveness testing. Provide a cover page explaining scope & contacts, a cross-ref matrix mapping RequirementIDs to documents/pages, and be ready with live system screenshots or ad-hoc reports for remote queries. Redact PII where required and provide secure channels for unredacted requests under NDA.<br><strong>Sample payroll audit pack structure:</strong> Cover page (scope & contacts); Cross-reference matrix; Payroll policy; SOP; Payroll control packs (last 6 runs); 10 sample employee files (contract + payslip + timesheet + remittance proof); GL upload previews & posted journals; Bank advices; Reconciliations; Exceptions log. Provide pack manifest (CSV) and hashed zipped pack.<br><strong>Optimisation for remote audits:</strong> Provide a compact "Top Yield Index" pointing auditors to highest-value evidence first (policy, SOP, 3-month sample, reconciliations). Provide a short "How to navigate pack" (1 page) and maintain an auditor query tracker with timestamps and responses. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Templates & starter documents — priority templates, zipped pack structure & CSV headers</strong><br><strong>Narrative:</strong> Provide starter templates to accelerate evidence creation. Templates must be versioned and annotated with guidance on sample sizes, redaction practices and examples. Prioritise high-impact templates to reduce initial friction.<br><strong>Priority templates:</strong> Evidence Index template (spreadsheet with dropdowns for PracticeArea, RequirementCategory, OwnerRole, EvidenceType); Payroll Control Pack template (zipped structure with cover page, control sheet, payslips folder, GL preview); Procurement File template (evaluation scorecard + signed forms); Remediation register (issue tracker CSV).<br><strong>Zipped payroll pack recommended structure:</strong> <code>PR202602.zip</code> containing <code>manifest.csv</code> (filelist + hashes), <code>cover.pdf</code>, <code>control_sheet.pdf</code>, <code>payslips/</code> folder (5 sample payslips), <code>contracts/</code> (matching contracts), <code>bank_advice.pdf</code>, <code>gl_preview.pdf</code>, <code>timesheets/</code> (if donor-funded).<br><strong>Evidence tagging CSV header (for bulk uploads):</strong> <code>RequirementID,PracticeArea,EvidenceType,FileName,FilePath,Owner,DateCollected,SamplePeriodStart,SamplePeriodEnd,RedactionFlag,Version,Notes,FileHash</code>. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Practical checklists (immediate actions) — condensed top 10 and detailed 30-day plan</strong><br><strong>Top 10 immediate actions:</strong> 1) Register on GFGP portal & export gap report. 2) Create Evidence Index & assign owners. 3) Publish DoA + Finance/HR/Procurement policies with exec sign-off. 4) Collect last 3 payroll packs & 3 procurement files. 5) Create standard zipped audit pack structure. 6) Implement naming convention & enforce via IT. 7) Schedule internal/mock audit date. 8) Identify top 5 remediation quick wins & assign owners. 9) Obtain SOC/security reports or DPA for major vendors. 10) Run tabletop mock auditor request to measure retrieval SLA.<br><strong>30-day detailed plan (example):</strong> Week 1: Portal registration & gap dump; Evidence Index skeleton & owner assignment; evidence folder templates created. Week 2: Collect 3 months bank reconciliations; assemble 3 payroll packs; run filename validator on existing evidence. Week 3: Publish DoA + core policies; begin OCR pass on legacy scanned docs; create remediation tickets for missing items. Week 4: Run mock audit pack submission; record SLA metric; produce executive status note. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Sustaining certification & continuous improvement — mechanics, owner attestation & KPI review</strong><br><strong>Narrative:</strong> Certification is a milestone. Sustained compliance requires annual calendar of self-assessment, internal audit, remediation, management review & Board oversight. Embed GFGP tasks into BAU: owner attestations, monthly reconciliations sign-offs, quarterly sample pack refresh. Use certification status in external comms to reduce funder friction and assist partner selection.<br><strong>Sustaining mechanics:</strong> Quarterly owner attestations; Annual mock audit; Evidence refresh sprint each quarter; KPI reporting to Board twice yearly. Maintain remediation SLA targets and escalation process. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Contacts & escalation — contact matrix template, external advisors & SLA rules</strong><br><strong>Narrative:</strong> Maintain defined escalation path: evidence owner → practice area lead → portal owner (CFO) → Executive sponsor → Board audit committee. Keep external advisor list (licensed Certification Bodies, local tax counsel, payroll vendor contacts) and single auditor liaison for query handling. Document SLAs for external responses and include contact register in Evidence Repository.<br><strong>Contact matrix columns:</strong> <code>Role | Name | Email | Phone | Escalation Level | Backup</code>. Example escalation: unresolved remediation >30 days escalates to CFO; >60 days escalates to Executive sponsor & Board. Store signed PDF naming nominated contacts and delegated authority for audit access. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Useful outputs you can request (deliverables) — deliverable list, descriptions & configuration hints</strong><br><strong>Narrative:</strong> Offer templated deliverables to accelerate readiness: Evidence Index spreadsheet prepopulated with common RequirementIDs; Policy Register; Sample Audit Pack with cross-ref matrix; Remediation Project Plan with GANTT & resource estimate; Donor mapping table; Payroll evidence pack template; Procurement file template; DPA/DPIA checklist. Deliverables designed for immediate upload to evidence repository and adapted to chart of accounts & local tax context.<br><strong>Example deliverable detail:</strong> Evidence Index template includes dropdowns: PracticeArea, RequirementCategory, OwnerRole, EvidenceType, Status, URL; sample rows provided for quick population. Remediation Project Plan includes sprint calendar, owners, dependencies and acceptance criteria for each remediation. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex A — Example evidence index (extended sample rows & CSV-ready examples)</strong><br><strong>Sample rows (CSV lines):</strong><br><code>GFGP_REQ_FM_01,Finance,Chart of Accounts mapping,/evidence/finance/coa_mapping_202602.pdf,HeadFinance,2026-02-10,2026-01-01,2026-02-28,v1,N,&quot;Maps project codes to donor budget lines&quot;,sha256:xxxxxxxx</code><br><code>GFGP_REQ_HR_02,HR,Master data extract (HROS),/evidence/hr/master_202602.csv,HRManager,2026-02-12,2026-02-01,2026-02-28,v1,Y,&quot;Redact national IDs for external review&quot;,sha256:yyyyyyyy</code><br><code>GFGP_REQ_PR_01,Procurement,Tender file – Lab Equipment,/evidence/proc/LabTender_202511.pdf,ProcLead,2025-11-30,2025-11-01,2025-11-30,v2,N,&quot;Includes evaluation matrix &amp; contract&quot;,sha256:zzzzzzzz</code><br><strong>Usage:</strong> Copy rows into Evidence Index template and update metadata fields; ensure file_hashes recorded. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex B — Sample remediation sprint (12-week detailed plan with owner tasks)</strong><br><strong>Sprint objective:</strong> raise Finance & HR evidence coverage to 60% by collecting sample packs & publishing core policies. Week 1: Portal gap review & Evidence Index creation; assign owners; create sprint backlog. Week 2: Collect last 3 months bank reconciliations; collect 3 payroll packs; publish DoA & Finance policy draft for Exec sign-off. Week 3–4: Compile procurement sample files; collect supplier contracts; complete master data extracts & redaction plan. Week 5–6: Internal review of packs; prepare audit pack cross-ref; remediate missing approvals. Week 7–8: Run mock auditor queries; complete follow-up evidence; escalate unresolved items. Week 9–12: Finalise packs; Exec review; upload portal evidence; update KPI dashboard; report to Board. Provide daily stand-ups & weekly demo to Exec sponsor. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex C — Payroll pack contents (detailed) + zipped pack manifest example</strong><br><strong>Mandatory contents per run:</strong> Cover page with PayrollRunID & period; Payroll control sheet with preparer & reviewer signatures; GL upload preview & posted journal number; Bank batch file & bank confirmation/SWIFT advices; Sample payslips (minimum 5) with matching contracts; Timesheets/effort reports for donor-funded staff; Remittance receipts for taxes & social security; Apportionment schedule (if applicable); Exception log with approvals; Master data change extract. Upload as single zipped pack and list contents in Evidence Index.<br><strong>Manifest CSV example (header + sample line):</strong><br><code>file_name,file_path,sha256,size_bytes,notes</code><br><code>cover.pdf,/evidence/payroll/PR202602/cover.pdf,sha256:aaa...,34567,&quot;cover page, payroll run PR202602&quot;</code> </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex D — Procurement file checklist (detailed) & sample evaluation scorecard</strong><br><strong>Minimum procurement file contents:</strong> requisition & budget approval; procurement plan reference; tender advert/RFP; bidders list; evaluation matrix signed by panel members; conflict-of-interest declarations; award approval with DoA sign-off; signed contract; supplier due-diligence & KYC; delivery note & acceptance evidence; invoice & payment evidence; performance bonds/guarantees (if any); file index & cross-ref to RequirementID(s).<br><strong>Evaluation scorecard sample (columns):</strong> <code>Supplier | Technical (0–60) | Financial (0–30) | Due diligence (0–10) | Total (0–100) | Rank | Notes | ApprovedBy</code>. Adopt minimum threshold (e.g., 70/100). Attach rationale & sign-offs. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex E — Policy excerpts & policy register sample entries</strong><br><strong>Payroll policy excerpt (adaptable):</strong> "Payroll payments shall be prepared by a Payroll Preparer and independently reviewed & authorised by a Reviewer who is not the preparer. Payroll payments shall be executed via bank transfer unless exceptional circumstances apply and documented with two authorised signatories. Payroll expenses are recognised on an accrual basis for the period services were rendered. All payroll runs require a PayrollRun ID recorded in GL journal narratives and in the payroll control pack." <br><strong>Procurement policy excerpt (adaptable):</strong> "Procurement above the small procurement threshold shall follow competitive procurement with minimum three suppliers invited, documented evaluation and conflict of interest declaration. Delegation of Authority applies to contract award thresholds. Supplier due-diligence shall be retained in procurement files." <br><strong>Policy Register sample row:</strong> <code>PolicyName | PracticeArea | Version | EffectiveDate | Owner | FilePath | Notes</code>. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex F — Example journal entries & annotated numeric illustrations</strong><br><strong>Payroll accrual example (annotated):</strong><br><code>Dr Payroll Expense – Project A USD 30,000</code><br><code>Dr Payroll Expense – Project B USD 20,000</code><br><code>Cr Accrued Payroll Liability USD 50,000</code><br><code>Narration: Payroll accrual Feb 2026 — PR202602 — Evidence: /evidence/payroll/GFGP_Finance_PayrollPack_PR202602_20260215_v1.pdf</code><br><strong>Payment example:</strong><br><code>Dr Accrued Payroll Liability USD 50,000</code><br><code>Cr Bank USD 50,000</code><br><code>Narration: Payroll payment PR202602 — BankBatch BB20260216 — Evidence: BankAdvice_PR202602.pdf</code><br><strong>Notes:</strong> Link each journal to payroll evidence via PayrollRun ID and file path listed in GL narration. Provide reconciliation pack showing mapping of GL lines to evidence files. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex G — Donor mapping examples (extended list)</strong><br><strong>Sample donor mapping rows (extended):</strong><br><code>DonorX | internal controls &amp; 6 months bank recon | GFGP_REQ_FM_02 | /evidence/bank/recon_202605.pdf | include COA cross-ref | 2026-05-16</code><br><code>DonorY | payroll compliance &amp; tax filings | GFGP_REQ_HR_03 | /evidence/payroll/YearEndTax_PR2025.pdf | remittance proofs attached | 2026-01-10</code><br><code>DonorZ | procurement transparency for capital purchases | GFGP_REQ_PR_05 | /evidence/proc/LabTender_202511.pdf | evaluation matrix &amp; COI | 2025-11-30</code><br><code>DonorA | timesheet &amp; apportionment for project B | GFGP_REQ_FM_07 | /evidence/hr/apportionment_ProjectB_202602.pdf | timesheet extracts included | 2026-02-16</code><br><code>DonorB | narrative &amp; budget variance explanation | GFGP_REQ_FM_04 | /evidence/finance/variance_Q1_2026.pdf | variance analysis &amp; management commentary | 2026-04-10</code>. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex H — Compensating controls templates & test plans (detailed)</strong><br><strong>Narrative:</strong> Small offices often cannot fully segregate duties. Compensating controls must be documented, time-limited, tested and produce evidence. Provide a formal compensating control document with test plan & expiry.<br><strong>Template fields:</strong> Control description; Rationale; Mitigation measures (e.g., external monthly review); Test plan (sample size & frequency); Owner; Expiry date; Executive approval signature; Test evidence link.<br><strong>Example compensating control:</strong> "Segregation gap: single finance staff performs payroll prep and bank upload. Compensating control: external regional finance performs monthly independent review of payroll packs and bank advices (100% of high-value employees; 10% random of remainder). Test evidence: independent reviewer signing monthly pack uploaded to evidence index. Expiry: 6 months." </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex I — KPI dashboard layout, definitions, sample visuals & explanation</strong><br><strong>Narrative:</strong> Provide compact KPI dashboard for governance reporting. Each KPI should have definition, target, current value, trend and owner. Use visual charts for trending and remediation aging.<br><strong>Suggested KPIs:</strong> RequirementCoverage (%), RemediationClosureRate (median days), EvidenceRetrievalSLA (% within SLA), SampleTestPassRate (%), CostToCompilePack (USD). Provide examples of formula calculations and sample target thresholds. Include guidance on cadence for KPI refresh (weekly for operational, monthly for Exec, quarterly for Board). </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex J — Redaction guidance, secure channels & redaction metadata</strong><br><strong>Narrative & rules:</strong> When sharing PII with external auditors, balance confidentiality & audit traceability. Redaction rules: redact national ID & bank numbers except last 4 digits; do not redact name, employment dates, gross & net pay needed for reconciliation; maintain unredacted master copy in secure repository accessible only to named auditor contacts under NDA; track original file hash and redaction method in Evidence Index.<br><strong>Redaction metadata fields:</strong> original_file_hash; redacted_file_hash; redaction_method; redacted_fields_list; redaction_date; redaction_owner; unredacted_access_contacts. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex K — Incident response template (payroll errors & fraud), registers & timeline</strong><br><strong>Narrative:</strong> Fast incident response reduces time to contain & remediate payroll incidents. Include steps for containment, investigation, recovery & communication.<br><strong>Incident template fields:</strong> IncidentID; DateDetected; DetectedBy; Description; ImmediateContainmentActions; Impact (amount, staff affected); RecoveryActions (recover funds, reverse journals); NotificationList (CFO, CEO, Legal, Bank, Tax authority); RootCauseAnalysis; CorrectiveActionPlan; ClosureSignOff; EvidenceLinks.<br><strong>Incident timeline example:</strong> Day 0 detect; Day 0–1 containment & initial notify; Day 2–5 investigation; Day 5–10 recovery steps & remedial journals; Day 14 closure & Board notification if material. Log incidents in incident register with severity & remediation tickets. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex L — Vendor due-diligence checklist (payroll provider) & contract clause examples</strong><br><strong>Checklist items:</strong> Company registration & address; Service offering & SLA; References & client list; Financial stability evidence; Technical controls (SOC2/SOC1 reports); Data protection & DPA; Backup & continuity plans; Staff vetting policies; Remittance proof processes; Pricing model; Contract with termination & data return clauses. Store vendor DPA & SOC in Evidence Index. <br><strong>Recommended contract clauses snippets:</strong> Security measures; breach notification timeline (24–72 hours); sub-processor rules; audit rights; data return & deletion upon termination; liability & indemnities; service level targets; exit assistance. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex M — Internal audit test script (payroll) & sample results reporting</strong><br><strong>Test script outline:</strong> Objective: verify payroll runs authorised & reconciled. Sample: last 6 payroll runs; select 5 employees each including top 2 earners. Steps: review control sheet & signatures; verify sample payslip matches contract; confirm bank advice & net pay; review statutory remittance receipts; check apportionment to project codes; confirm remediation for exceptions. Expected result: no unauthorised runs; reconciliations complete & signed; remittances evidenced. Document findings, severity, recommendations & remediation timelines in internal audit report. Provide sample audit result table: test_id, finding, severity, owner, due_date, evidence_link, status. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex N — Quick remediation templates (email & memo) & escalation phrases</strong><br><strong>Email template (evidence request):</strong> Subject: GFGP evidence request — Payroll pack PR202602. Body: Please upload signed payroll control sheet, GL upload preview, remittance proof for PR202602 to /evidence/payroll/ by YYYY-MM-DD. Owner: PayrollPreparer. Escalation: CFO if not received within 3 working days. Keep record of sent/received emails linked to remediation ticket. <br><strong>Escalation email example:</strong> Subject: Escalation – Outstanding evidence for PR202602 (3 days overdue). Body: Owner has missed SLA; request escalation to CFO. Provide remediation ticket link & required deliverables. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex O — Final notes on proportionality, evidence sufficiency & auditor expectations (operational doctrine)</strong><br><strong>Narrative:</strong> GFGP is proportionate. Auditors expect evidence of consistent application suitable to organisational risk. Present a consistent narrative: policy, SOP, transactional samples, reconciliations & remediation logs. When using compensating controls, provide test results proving effectiveness. Executive sponsorship, Evidence Index clarity & small set of well-prepared audit packs reduce friction & accelerate certification. Document rationale for proportionality decisions & include them in Evidence Index. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex P — Risk matrix & residual action thresholds (payroll & procurement focus)</strong><br><strong>Risk scoring matrix example:</strong> Likelihood (1–5) x Impact (1–5) = Risk score. Residual actions: score >=12 require immediate executive mitigation & remediation plan; 8–11 require Exec sponsor & remediation; <8 track in remediation register. Provide sample risk register rows with controls, residual risk & mitigation owners. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex Q — Step-by-step Payroll SOP (run-level annotated, with timings and control points)</strong><br><strong>Pre-run (T-10 to cut-off):</strong> HR sends joiner/leaver/contract changes spreadsheet by cut-off with signed approvals. Payroll preparer pulls master data extract and marks changes. Run payroll in parallel test environment and produce draft control sheet.<br><strong>Run-day (T-2 to T):</strong> Reconcile draft totals to budget & prior month; document variances >2%. Prepare bank batch file & checksum total. Generate GL upload preview & temporary journal for validation.<br><strong>Authorisation (T-1):</strong> Independent reviewer performs sample checks (10 records incl top earners). Reviewer signs control sheet and uploads signature page. Authoriser confirms bank batch & posts journal with PayrollRun ID.<br><strong>Payment & post-run (T+1 to T+7):</strong> Bank executes; payments officer retrieves advices; match net pay totals to bank advice; post GL journal with PayrollRun ID; upload bank advice & GL preview to payroll pack; perform full reconciliation; retain signed pack in repository. Close exceptions & update exception log. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex R — Procurement evaluation scorecard, weighting & scoring guidance (sample)</strong><br><strong>Scorecard columns:</strong> <code>Supplier | Technical (max 60) | Financial (max 30) | Due diligence (max 10) | Total (max 100) | Rank | ApprovedBy | Comments</code>. Weight technical higher for complex services; set minimum threshold (e.g., 70/100). Attach signed evaluation matrix & rationale to procurement file. Record any deviations from policy and escalation approvals. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex S — Evidence tagging CSV header (bulk Upload), sample import process, & data validation rules</strong><br><strong>Header suggestion:</strong> <code>RequirementID,PracticeArea,EvidenceType,FileName,FilePath,Owner,DateCollected,SamplePeriodStart,SamplePeriodEnd,RedactionFlag,Version,Notes,FileHash</code><br><strong>Bulk import process:</strong> Validate CSV headers; check file existence & hashes; reject rows with missing metadata; import into Evidence Index; produce import report with rows imported & errors. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex T — Audit sampling guidance (practical; rule-of-thumb & statistical notes)</strong><br><strong>Rule-of-thumb sample sizes:</strong> Small population (<100) sample 25% or min 10 items. Medium (100–1,000) sample 10–20 items focusing on high-value & random selection. Large (>1,000) sample 30–60 items including top 20 high-value transactions + random sample of 30. Use attribute sampling for control testing; set acceptable error rate (e.g., 2–5%) and refer to statistical sample size tables. Document selection method in audit pack. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex U — Implementation Gantt (textual milestone plan & milestone acceptance criteria)</strong><br><strong>0–3 months:</strong> Portal registration; Evidence Index creation; collect 3-month sample packs; publish core policies. Acceptance: Evidence Index populated with owners for 80% of ReqIDs; 3 payroll packs uploaded. <strong>3–6 months:</strong> Staff training; collect 12 months samples; implement validation rules; internal audit. Acceptance: Training completion 90% of owners; validation rules enforced on upload. <strong>6–12 months:</strong> Systems integration planning; mock certification audit; remediation closure. <strong>12–18 months:</strong> Certification audit; address non-conformances; implement sustained evidence refresh cadence. Provide milestone acceptance criteria in project plan. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex V — Executive one-page for Board (template: content & KPIs to include)</strong><br><strong>Sections & recommended content:</strong> Certification objective; Current portal coverage %; Top 5 remediation risks & owners; Cost to complete (estimate, incl FTE & consultants); Ask (Board approvals/resources). Attach KPI dashboard snapshot & remediation Gantt summary. Keep to one page with annex references. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex W — Quick technical notes for ERP/GL mapping & integration pitfalls</strong><br><strong>Technical notes:</strong> Ensure chart of accounts includes project code fields; make narration fields mandatory (PayrollRun ID); prevent manual journal posting without attached evidence reference (implement ERP validation rules or middleware). Avoid free-text cost centre fields; require dropdowns/mappings. Map payroll export fields to GL code mapping table and maintain a mapping file with version control. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex X — Sample remediation ticket template (issue tracker line & workflow)</strong><br><strong>Ticket fields:</strong> <code>TicketID | Title | PracticeArea | Description | Owner | Priority | DateOpened | TargetClose | EvidenceLink | Status | Notes</code>. <strong>Workflow:</strong> Open → Owner assigned → Owner collects evidence / fixes issue → Owner updates ticket with evidence link → Internal reviewer validates → Close. Include SLA measurement & automated escalation on overdue. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex Y — Evidence-first policy language (short template)</strong><br><strong>Policy clause example:</strong> "All material payments and payroll runs must be supported by an Evidence Pack documenting policy, SOP, preparer & reviewer sign-offs, GL upload preview and bank confirmations. Evidence Packs must be retained according to the retention schedule and tagged in the Evidence Index." Include version control & executive sign-off clause in policy template. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex Z — Minimal viable audit pack checklist (last-minute readiness) & rapid pack builder</strong><br><strong>Minimal pack includes:</strong> Cover page with scope & contacts; Cross-reference matrix to RequirementIDs; Policies & SOPs (signed); 3–6 months sample transactions for core areas (payroll, procurement, bank recon); Reconciliations & GL narratives linking to evidence. <strong>Rapid pack builder tips:</strong> pre-generate manifest & zip; create short "how to navigate" PDF for auditors; include cross-ref CSV linking RequirementIDs to file paths; ensure all files hashed & manifest includes hashes. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex AA — Example SQL queries & scripts for Evidence Index reporting & reconciliation</strong><br><strong>Examples (conceptual):</strong><br><code>-- Find missing evidence for priority ReqIDs SELECT r.reqid, r.title FROM requirement r LEFT JOIN evidence_index e ON e.reqid = r.reqid WHERE e.reqid IS NULL AND r.priority = &#x27;High&#x27;;</code><br><code>-- Evidence retrieval SLA report SELECT owner, COUNT(*) total_requests, SUM(CASE WHEN fulfilled_within_sla THEN 1 ELSE 0 END) fulfilled FROM auditor_requests GROUP BY owner;</code><br>Provide stored procedure templates to generate audit packs by RequirementID list that produce zipped manifest & cross-ref. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex AB — Example GL narrative enforcement & ERP integration notes</strong><br><strong>Enforcement options:</strong> implement ERP pre-validation to reject payroll journal without PayrollRun ID in narration; enforce GL upload template with evidence_tag field; use middleware to inject evidence pointers into GL narration on posting. Provide sample GL narrative policy: "All payroll journals must include <code>PRYYYYMM</code> in narration and evidence link in the format <code>Evidence: /evidence/payroll/{filename}</code>." </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex AC — Sample FAQ for auditors & internal teams (common queries and short answers)</strong><br><strong>Q:</strong> Where is the payroll control pack? <strong>A:</strong> Evidence Index row <code>GFGP_REQ_HR_02</code> points to <code>/evidence/payroll/PR202602.zip</code>. <strong>Q:</strong> How do you map project codes? <strong>A:</strong> See COA mapping file <code>/evidence/finance/coa_mapping_202602.pdf</code> and GL mapping table. <strong>Q:</strong> Where are SOC reports? <strong>A:</strong> Vendor folder <code>/evidence/vendors/{vendor}/soc2/</code>. Maintain FAQ in Evidence Repository for auditor orientation. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex AD — Sample measurable targets & SLA definitions (for internal service levels)</strong><br><strong>SLA examples:</strong> Evidence retrieval SLA = respond to auditor request with required evidence within 3 working days (target 95% achieved). Evidence upload SLA = evidence owner must upload required evidence within 5 working days of request. Remediation SLA = high priority remediation closed within 45 days (target 90% compliance). Include SLA monitoring & automated alerts. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Annex AE — Final operational checklist before requesting certification (pre-cert readiness kit)</strong><br><strong>Pre-cert kit items (final verification):</strong> Evidence Index complete for target ReqIDs; sample transactions uploaded (last 3–12 months); policy & SOP repository signed & versioned; DoA updated & published; vendor DPAs & SOC reports present; internal audit performed & remediation logged; KPI dashboard showing readiness progress; named auditor liaison & secure folder access prepared; one mock audit completed & lessons logged. </td></tr><tr><td data-label="Good Financial Grant Practice (GFGP)"> <strong>Closing operational note (no extra commentary):</strong><br>Implement progressively: begin with Evidence Index, naming convention, and 3-month sample packs to create momentum. Use sprint model to maintain steady progress. Maintain executive sponsorship and ensure the remediation register is updated weekly. Produce concise executive updates for Board with KPI snapshot and top remediation items. </td></tr></tbody></table></div><div class="row-count">Rows: 59</div></div><div class="table-caption" id="Table4" data-table="YJKN_0005_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Quiz**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Quiz</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Quiz"> <strong>Decision quiz (Q1–Q20) — answers with concise rationales</strong><br><strong>Narrative:</strong> Each question is listed with the selected choice letter and a one-line rationale suitable for insertion into guidance documents or training notes.<br>• <strong>Q1. C</strong> — Build a coalition, gather evidence, and propose improvements collectively: influence through shared ownership without formal authority.<br>• <strong>Q2. B</strong> — Share knowledge and learn from peers: sustained influence arises from open knowledge exchange and adaptive learning.<br>• <strong>Q3. C</strong> — Psychological safety to ask questions and raise mistakes without blame enables honest workload discussions.<br>• <strong>Q4. B</strong> — Prioritise strategic fit with organisational strengths over raw grant size. <br>• <strong>Q5. B</strong> — Select opportunities based on funder priorities and institutional capacity; informed targeting increases likelihood of success.<br>• <strong>Q6. A</strong> — Weak linkage between objectives, methods and budget undermines reviewer confidence and credibility.<br>• <strong>Q7. B</strong> — Design activities, timelines and budgets that match actual capacity to ensure feasible delivery.<br>• <strong>Q8. C</strong> — Good financial judgment requires clear, proportionate justification of all costs tied to planned work.<br>• <strong>Q9. B</strong> — Openly address assumptions, constraints and risks early when co-designing shared budgets with partners.<br>• <strong>Q10. B</strong> — Regular financial monitoring detects issues early so plans can be adjusted before small problems escalate.<br>• <strong>Q11. C</strong> — Ongoing reviews that link spending to activities and timelines keep finance aligned with delivery.<br>• <strong>Q12. B</strong> — Seek early institutional or management advice on contractual terms to avoid unintended risks.<br>• <strong>Q13. B</strong> — Tailor messages to the audience and intended outcome for effective communication within projects.<br>• <strong>Q14. B</strong> — Mutual respect, shared decisions and recognition of contributions define sustainable partnerships.<br>• <strong>Q15. B</strong> — Disciplinary language and conceptual differences make interdisciplinary work challenging; explicit alignment is required.<br>• <strong>Q16. C</strong> — Outputs document delivery; outcomes measure meaningful change—both are distinct and necessary.<br>• <strong>Q17. B</strong> — Use indicators that meaningfully reflect progress and change; quality over quantity.<br>• <strong>Q18. B</strong> — Peer learning works when participants actively engage and share real experience and practice.<br>• <strong>Q19. B</strong> — Sustained improvement follows gradual application of concepts and onward sharing within the team.<br>• <strong>Q20. B</strong> — Strong systems, collaboration and continuous learning create sustainable research management success. </td></tr><tr><td data-label="Quiz"> <strong>Q1. C — Engage colleagues who share concerns, gather evidence, and propose improvements collectively.</strong><br><strong>Why:</strong> When you lack formal authority, coalition-building is the most effective lever. By engaging colleagues you create social proof, distribute workload, and reduce individual risk. Collect concrete examples (incidents, timelines, metrics) to shift the conversation from opinion to evidence. <br><strong>How to act:</strong> convene the interested stakeholders, summarise recurring issues with data, propose 1–2 small process changes and a short pilot, and ask management for permission to test the pilot rather than asking for wholesale change.<br><br><strong>Q2. B — Sharing relevant knowledge and learning from how similar organizations operate.</strong><br><strong>Why:</strong> Influence is reinforced by credibility and reciprocity. Sharing useful information builds trust, positions you as a collaborator rather than an adversary, and creates opportunities for others to reciprocate. Learning from peers reduces reinventing-the-wheel and provides tested approaches to propose. <br><strong>How to act:</strong> prepare concise case examples from comparable organisations, offer to run a short lunch-and-learn, and make resources easy to reuse (templates, short slide decks).<br><br><strong>Q3. C — A shared understanding that questions and mistakes can be raised without blame.</strong><br><strong>Why:</strong> Psychological safety is the prerequisite for honest risk identification and realistic planning. Teams that fear blame will hide problems, causing surprises later. <br><strong>How to act:</strong> model non-blaming language, introduce a simple “raise/no-blame” rule in meetings, and record issues as action items with owners rather than assigning fault.<br><br><strong>Q4. B — How closely the opportunity aligns with the organization’s strengths and strategic goals.</strong><br><strong>Why:</strong> Strategic fit determines whether the organisation can deliver impact and sustain funded activities. A large grant misaligned with core capability can burn resources and harm credibility. <br><strong>How to act:</strong> score opportunities against a short checklist (fit, capacity, timeline, donor priorities) and prioritise those with highest composite scores.<br><br><strong>Q5. B — Selecting opportunities based on informed understanding of funder priorities and institutional capacity.</strong><br><strong>Why:</strong> Targeted applications yield higher success rates and better use of scarce proposal-writing capacity. Random wide-net approaches dilute quality and overload teams. <br><strong>How to act:</strong> maintain a funder-priorities matrix, estimate required effort vs. expected benefit, and apply selectively with tailored proposals rather than generic mass applications.<br><br><strong>Q6. A — Reviewers may find the proposal difficult to follow and less credible.</strong><br><strong>Why:</strong> Logical linkage between objectives, methods and budget is the backbone of review assessment: reviewers test feasibility by checking whether methods will produce objectives within the requested resources. Disconnected budgets raise red flags about realism and stewardship. <br><strong>How to act:</strong> map each objective to specific activities, deliverables and budget lines (use a one-page logic table) and ensure every budget line is justified in one sentence.<br><br><strong>Q7. B — Designing activities, timelines, and budgets that match actual capacity.</strong><br><strong>Why:</strong> Feasible plans reduce the risk of missed milestones and budget overruns; feasibility is often weighted by reviewers and management alike. Over-ambition creates brittle projects that fail when routine issues arise. <br><strong>How to act:</strong> create a capacity register (staff time available in FTE days), and stress-test the plan against realistic contingencies (e.g., 20% staff turnover, procurement delays).<br><br><strong>Q8. C — Clearly justifying all costs as necessary and proportionate to the work planned.</strong><br><strong>Why:</strong> Financial prudence is judged by necessity and proportionality, not absolute minimisation. Requesting adequate, well-justified funds preserves delivery quality and reduces audit queries. <br><strong>How to act:</strong> accompany each budget line with a concise justification (one sentence) and highlight value-for-money choices; use unit costs and simple calculations to show how totals arise.<br><br><strong>Q9. B — Addressing constraints, assumptions, and risks openly at an early stage.</strong><br><strong>Why:</strong> Early transparency in partner budgeting surfaces mismatched expectations and avoids last-minute disputes that delay submissions or implementation. Shared risk framing enables mitigation planning (e.g., cost-sharing, contingency lines). <br><strong>How to act:</strong> run a short joint-budget workshop with partners, document assumptions (currency, timelines, overhead rates) and agree escalation rules for unresolved items.<br><br><strong>Q10. B — To detect issues early and adjust plans if needed.</strong><br><strong>Why:</strong> Regular financial monitoring turns reactive fixes into planned adjustments; early detection prevents small deviations from becoming catastrophic. Monitoring also supports confident reporting to funders and governance. <br><strong>How to act:</strong> implement monthly variance reporting (budget vs actual by activity), flag >10% variances, and attach a short remediation action for each flag.<br><br><strong>Q11. C — Ongoing review that links spending with activities and timelines.</strong><br><strong>Why:</strong> Finance separated from operations causes blind spots; linking spending to deliverables makes it possible to assess whether money produced the intended outputs. Regular alignment supports better forecasting and donor reporting. <br><strong>How to act:</strong> adopt a monthly delivery-versus-spend dashboard per project, and require owners to sign off on both activity progress and corresponding spend.<br><br><strong>Q12. B — Seek early advice from institutional support or management.</strong><br><strong>Why:</strong> Contracts contain legal and financial obligations (IP, liability, indemnities, invoicing) that can bind the organisation; early review prevents downstream compliance or reputational risks. <br><strong>How to act:</strong> stop signatory negotiations until Legal/Research Office/Grants Office reviews key clauses; prepare a short note listing unclear clauses and desired redlines to accelerate review.<br><br><strong>Q13. B — Tailoring messages to the audience and intended outcome.</strong><br><strong>Why:</strong> Different stakeholders need different levels of detail: executives want decisions and risks; implementers need tasks and timelines; funders need evidence and impact logic. Generic messages miss the mark. <br><strong>How to act:</strong> for each communication, define the audience, the single decision/outcome you want, and a one-paragraph message plus an optional appendix for detail.<br><br><strong>Q14. B — Mutual respect, shared decision-making, and recognition of contributions.</strong><br><strong>Why:</strong> Partnerships succeed where contributions and risks are acknowledged and decision authority is explicit. Dominance by one partner or opaque decision-making creates resentment and breakdown. <br><strong>How to act:</strong> agree a partnership charter early covering decision rights, IP, resource allocation, and authorship; revisit it at key milestones.<br><br><strong>Q15. B — Different disciplines may interpret the same concepts differently.</strong><br><strong>Why:</strong> Interdisciplinary work fails when collaborators assume shared meaning. Words like “impact,” “validation,” or even “sample” can have discipline-specific interpretations that affect methods and outcomes. <br><strong>How to act:</strong> run an early alignment workshop to define key terms, agree on shared methods or compromises, and produce a short glossary for the project. </td></tr><tr><td data-label="Quiz"> <strong>Q16. C — Outputs show what was delivered, while outcomes reflect meaningful change.</strong><br><strong>Why:</strong> Outputs are project deliverables (reports, datasets); outcomes are the longer-term changes those outputs aim to enable (policy change, behaviour change). Confusing the two leads to over-focus on activity-counting rather than impact. <br><strong>How to act:</strong> for each output, write one or two plausible short-term and medium-term outcomes it supports and attach simple indicators for each. <br><br><strong>Q17. B — Selecting indicators that meaningfully reflect progress and change.</strong><br><strong>Why:</strong> Too many or irrelevant indicators drain resources and produce noise. Good indicators are SMART (specific, measurable, achievable, relevant, time-bound) and tied to outcomes rather than activities. <br><strong>How to act:</strong> choose 3–7 core indicators per project (mix of quantitative and qualitative), define data sources and collection frequency, and assign ownership. <br><br><strong>Q18. B — Active participation and shared experience among participants.</strong><br><strong>Why:</strong> Peer learning works because participants bring real problems and practical solutions; passive listening yields poorer transfer to day-to-day work. <br><strong>How to act:</strong> structure sessions for problem-based sharing, assign small group exercises, and collect short action commitments from participants to apply learning. <br><br><strong>Q19. B — Applying concepts gradually and sharing learning with colleagues.</strong><br><strong>Why:</strong> One-off training fades unless reinforced. Gradual application with peer support embeds skills and spreads practice across teams. <br><strong>How to act:</strong> create a 90-day post-workshop plan with small application tasks, peer check-ins, and short artifact submissions (one-page templates or checklists). <br><br><strong>Q20. B — Strong systems, collaboration, and learning processes enable sustainable success.</strong><br><strong>Why:</strong> Individual expertise matters, but sustainable research performance depends on repeatable systems, clear roles and continuous improvement. Systems reduce reliance on single persons and improve resilience. <br><strong>How to act:</strong> document core processes, assign owners, set KPIs for system performance (evidence retrieval SLA; remediation closure time), and schedule regular reviews to improve tools and practices. </td></tr></tbody></table></div><div class="row-count">Rows: 3</div></div><div class="table-caption" id="Table5" data-table="YJKN_0005_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)"> <strong>Tip A — Prepare: require one-sentence justification & unit-cost math for every budget line (Agresso mapping)</strong><br><strong>Why:</strong> embeds auditable justification into the system at budget creation and prevents rework during approval and audit.<br><strong>How (Agresso):</strong> create project / budget version in the Project module; require the <strong>Description</strong> field for each budget line and standardise it as the “one-sentence justification”; use the line notes or an attached Excel file for unit calculations; enforce required dimensions/account rules so lines cannot be saved without these fields. Unit4 supports account rules, attributes and attachments for project and budget records. </td></tr><tr><td data-label="Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)"> <strong>Tip B — Control: link spending to deliverables with monthly delivery-vs-spend reporting and variance flags (Agresso mapping)</strong><br><strong>Why:</strong> links posted transactions to project deliverables so budget vs actual monitoring is operational and timely.<br><strong>How (Agresso):</strong> use the Project / Time & Project reporting (Budget vs Actual / S13 or equivalent Budget vs Actual report) per project to produce monthly budget vs actual by activity; build a delivery-vs-spend dashboard in Unit4 FP&A or the reporting engine that highlights variances greater than 10 percent; schedule the report and distribute to owners automatically. Record corrective actions as a short note attached to the project line or in the project-action log so audit trail and closure are visible. </td></tr><tr><td data-label="Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)"> <strong>Tip C — Govern: set approval thresholds, contingency governance and role-based workflows (Agresso mapping)</strong><br><strong>Why:</strong> enforces delegated authority, documents contingency drawdowns, and creates an auditable approval trail in the system.<br><strong>How (Agresso):</strong> model tiered approval limits using Agresso Workflow by creating conditional workflow branches by amount or account/project code (for example: under £5k routes to project lead; £5k–£50k routes to programme manager; above £50k routes to director); require a “contingency justification” field on any contingency draw transaction and route it through the same workflow; leverage the native workflow audit log as the approvals log. Use distribution rules and account rules to prevent posting without required approvals. </td></tr><tr><td data-label="Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)"> <strong>Quick implementation checklist (practical steps to hand to IT / Finance Ops)</strong><br>• Create a project budget template that includes: budget line, one-sentence justification, unit quantity, unit cost, total, contingency line. Store as an Excel upload if preferred.<br>• Configure account rules to make justification and required dimensions mandatory for budget records.<br>• Build or schedule the Budget vs Actual (S13 or equivalent) and a simple dashboard that flags variances greater than 10 percent; set distribution to named owners.<br>• Configure workflow steps and conditional approvers by value threshold; enable attachment of the unit-cost worksheet to requisitions and budget changes; ensure approvals are logged centrally.<br>• Pilot on one to two projects for one budget cycle; iterate the template, report filters and workflow rules before full roll-out. </td></tr></tbody></table></div><div class="row-count">Rows: 4</div></div><div class="table-caption" id="Table6" data-table="YJKN_0005_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)"> <strong>Prepare: require one-sentence justification & unit-cost math for every budget line</strong><br><strong>Why:</strong> Embeds auditable justification at budget creation and prevents rework during approval and audit.<br><strong>How (Agresso):</strong> Create project/budget versions in the Project module; require the <strong>Description</strong> field for each budget line and standardise it as the one-sentence justification; use line notes or attached Excel files for unit calculations; enforce mandatory dimensions and account rules so lines cannot be saved without these fields. </td></tr><tr><td data-label="Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)"> <strong>Control: link spending to deliverables with monthly delivery-vs-spend reporting and variance flags</strong><br><strong>Why:</strong> Keeps finance aligned with delivery and enables early intervention before overruns escalate.<br><strong>How (Agresso):</strong> Use Project / Time & Project reporting (Budget vs Actual / S13 or equivalent) to review monthly spend by activity; build a delivery-vs-spend dashboard highlighting variances >10%; schedule automated distribution to owners; record corrective actions as notes against the project or activity line to maintain an audit trail. </td></tr><tr><td data-label="Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)"> <strong>Govern: set approval thresholds, contingency governance, and role-based workflows</strong><br><strong>Why:</strong> Enforces delegated authority, controls contingency use, and creates a clear approval audit trail.<br><strong>How (Agresso):</strong> Configure Agresso Workflow with tiered approval limits by value or project code (e.g. <$5k project lead; $5–50k programme manager; >$50k director); require a contingency-justification field for drawdowns; route through workflow and rely on the native workflow log as the approvals register; use distribution/account rules to block posting without approval. </td></tr><tr><td data-label="Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)"> <strong>Quick implementation checklist (for Finance / IT Ops)</strong><br>• Create a standard project budget template (budget line, justification, unit quantity, unit cost, total, contingency).<br>• Configure account rules to make justification text and dimensions mandatory.<br>• Schedule Budget vs Actual (S13 or equivalent) and a variance-flag dashboard with named owners.<br>• Implement conditional approval workflows and mandatory attachments for budget changes.<br>• Pilot on 1–2 projects for one budget cycle, then refine templates, reports, and workflows before roll-out. </td></tr><tr><td data-label="Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)"> <strong>Expert guidance</strong><br><strong>Prepare — Strict line-level justification & unit-cost math (expert)</strong><br><strong>Principle:</strong> make every budget line self-explanatory, auditable and machine-enforceable before it reaches approval. This prevents late queries, reduces rework and anchors value-for-money at source.<br><strong>How (technical prescription):</strong><br>• Model a budget <em>version</em> per project in the Project module and require a budget-line schema containing: <strong>BudgetLineID, ProjectCode, ActivityCode, Description (one-sentence justification), UnitQty, UnitCost, UnitUOM, LineTotal, ContingencyPct, BudgetVersionID, CreatedBy, ApprovedFlag</strong>.<br>• Implement <strong>Account Rules / Attributes</strong> so <strong>Description, UnitQty, UnitCost and ActivityCode</strong> are mandatory for any record whose BudgetType = ProjectBudget; prevent saving/posting where these fields are empty. (Use Agresso account-rule validations or attributes on the Project/Budget screens.) :contentReference[oaicite:0]{index=0}<br>• Provide a standard Excel budget upload template (matching the schema above) and build an import routine to create a budget version. Keep the import idempotent (reject duplicates) and capture the uploader and timestamp. Use attachments (attach the unit-cost workbook) on the Project record for audit. :contentReference[oaicite:1]{index=1}<br>• Store a one-line justification in the <strong>Description</strong> field and require an attachment or link (unit-cost worksheet) for any line with UnitQty * UnitCost ≠ LineTotal (so reviewers can reproduce the math). </td></tr><tr><td data-label="Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)"> <strong>Control — Delivery-linked monthly budget vs actual with variance workflow (expert)</strong><br><strong>Principle:</strong> monitor posted transactions against deliverables so deviations trigger clear actions early. Combine the system’s Budget vs Actual reporting with a remediation workflow and an auditable action log.<br><strong>How (technical prescription):</strong><br>• Use the Project Manager Budget vs Actual report (S13 or the site-equivalent) to run monthly Budget vs Actual (select PeriodFrom/PeriodTo parameters and include Commitments). Automate scheduling of the report for all active projects and publish to named owners. :contentReference[oaicite:2]{index=2}<br>• Produce a delivery-vs-spend dashboard (Unit4 FP&A / reporting engine or BI fed from Agresso): columns = ProjectCode, ActivityCode, BudgetVersion, Period, Budget, Actual, Commitments, VarianceAmt, VariancePct, %Complete (deliverable progress), Owner, ActionStatus. Highlight rows where VariancePct > 10% and where Actual > Budget. :contentReference[oaicite:3]{index=3}<br>• For each flagged row, create a remediation record: <strong>ActionID, ProjectCode, ActivityCode, VarianceReason (coded), ActionOwner (person), ActionDueDate, ActionTaken, CloseDate, LinkedTransactionIDs</strong>. Store remediation notes on the Project Action log or as comments on the project/activity so the trail is in-system. Automate an email/task to the ActionOwner when a flag is created; escalate after X days. :contentReference[oaicite:4]{index=4}<br>• Reconcile monthly: run the S13, export to BI, reconcile GL/project totals and commitments (M13), and require owner sign-off on delivery progress vs spend before month-end close. </td></tr><tr><td data-label="Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)"> <strong>Govern — Approval thresholds, contingency governance, and enforced workflow (expert)</strong><br><strong>Principle:</strong> enforce delegated authority, auditability and separation of duties within Agresso workflow so spend and contingency draws are controlled and traceable.<br><strong>How (technical prescription):</strong><br>• Design conditional workflows in Agresso Workflow: use amount-based and dimension-based routing rules (e.g., if Amount <= 5,000 → route to ProjectLead; 5,001–50,000 → ProgramManager; >50,000 → Director). Include parallel technical approvals where required (e.g., IT or procurement technical sign-off) and allow substitutes. Configure reminders and escalation rules. :contentReference[oaicite:6]{index=6}<br>• For contingency drawdowns, require an explicit <strong>ContingencyJustification</strong> field and an attachment; route these through the same conditional workflow and block posting unless the workflow reaches final approval. Use workflow’s audit log as the canonical approvals register (it records approver, timestamp, comments). :contentReference[oaicite:7]{index=7}<br>• Enforce segregation of duties by account-rule validations (e.g., the same user cannot be the Requestor and FinalApprover unless auto-approval rules explicitly permit it for small amounts). Enable four-eyes and automatic reminders for overdue approvals. </td></tr><tr><td data-label="Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)"> <strong>Implementation checklist (expert, hand to IT / Finance build team)</strong><br>• <strong>Requirements & design:</strong> map chart-of-accounts, project/activity dimensions and authority matrix; define BudgetLine schema and permitted Account Rules.<br>• <strong>Config:</strong> create Project budget versions, add required attributes (Description, UnitQty, UnitCost), implement account-rule validations, and configure attachments on project/budget records. :contentReference[oaicite:9]{index=9}<br>• <strong>Workflows:</strong> implement conditional workflows by thresholds and project code; enable audit logging, substitutes, reminders and escalation. Test sequential and parallel flows. :contentReference[oaicite:10]{index=10}<br>• <strong>Reporting:</strong> schedule S13 (Budget vs Actual) and M13 (Commitments) jobs; build delivery-vs-spend dashboard in Unit4 FP&A or BI (Power BI/Tableau via extract or OData). :contentReference[oaicite:11]{index=11}<br>• <strong>Integrations / imports:</strong> build secure Excel import or API endpoint for bulk budget uploads; validate on import and write to a staging area for review before committing to the live budget version. :contentReference[oaicite:12]{index=12}<br>• <strong>Testing & pilot:</strong> run end-to-end pilot on 2 projects (one research grant, one operational) for a single budget cycle; capture defects, adjust account rules and workflows, then widen rollout. </td></tr><tr><td data-label="Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)"> <strong>Operational KPIs & control targets (expert)</strong><br>• % of budget lines containing a one-line justification on first submission — target ≥ 98%.<br>• % of flagged variances (>10%) that have a remediation action assigned within 5 business days — target ≥ 95%.<br>• Median time to approval by threshold band (benchmarked per band).<br>• % of contingency drawdowns with documentary justification and final post-hoc reconciliation — target 100%.<br>• Monthly reconciliation pass rate between S13 and GL — target ≥ 99.5%. </td></tr><tr><td data-label="Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)"> <strong>Technical appendix (field names, report parameters & workflow pseudocode)</strong><br><strong>Suggested budget-line fields (type / length):</strong> ProjectCode (string), ActivityCode (string), BudgetVersionID (string), LineSeq (int), Description (text, 240), UnitQty (decimal 12,2), UnitUOM (string 10), UnitCost (decimal 14,2), LineTotal (decimal 14,2), ContingencyPct (decimal 5,2), JustificationAttachmentID (string), CreatedBy (userid), CreatedDate (datetime), ApprovedFlag (bool).<br><strong>S13 parameters:</strong> ProjectCode(s), BudgetVersionID, PeriodFrom (YYYYMM), PeriodTo (YYYYMM), IncludeCommitments (Y/N). :contentReference[oaicite:14]{index=14}<br><strong>Example workflow rule (pseudocode):</strong><br><code>if Amount &lt;= 5000 then approver := ProjectLead; else if Amount &lt;= 50000 then approver := ProgrammeManager; else approver := Director; if Account = &#x27;IT&#x27; then route also to ITTechnicalReviewer; require ContingencyJustification if LineType = &#x27;Contingency&#x27;;</code> :contentReference[oaicite:15]{index=15} </td></tr><tr><td data-label="Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)"> <strong>Controls, audit & training (expert)</strong><br>• Keep the workflow audit log as the primary approvals register; export monthly to the approvals log repository for internal audit. :contentReference[oaicite:16]{index=16}<br>• Document written procedures and run role-based training (system + process) modelled on Unit4 end-user training best practices; create short job-aids for budget upload, S13 run and remediation handling. Pilot training during the project pilot. :contentReference[oaicite:17]{index=17}<br>• Schedule a quarterly health-check: validate account-rule coverage, dashboard thresholds, and a small random sample of budget lines to ensure justifications and unit math are present. </td></tr><tr><td data-label="Accounting / Finance Tips — mapped to Oxford FMS (Unit4/Agresso)"> <strong>If you want, next practical deliverables I can produce now (pick any)</strong><br>• a one-page budget-line Excel template pre-mapped to the schema above; OR<br>• a sample S13 dashboard column layout + conditional formatting rules for Power BI/Tableau; OR<br>• a draft workflow diagram and approval matrix you can hand to your Agresso configurator. </td></tr></tbody></table></div><div class="row-count">Rows: 12</div></div><div class="table-caption" id="Table7" data-table="YJKN_0005_07" style="margin-top:2mm;margin-left:3mm;"><strong>Table 7</strong></div>
<div class="table-wrapper" data-table-id="table-7"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Accounting / Finance — Oxford FMS (Agresso)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Accounting / Finance — Oxford FMS (Agresso)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>Executive summary:</strong> Configure Agresso (Unit4) Project & Workflow modules so every budget line is self-justifying with reproducible unit-cost math at capture; link GL postings to project/activity deliverables; run automated monthly Budget vs Actual (delivery-vs-spend) reporting that flags variances >10% and generates a named remediation action; and govern spend through parameterised approval workflows, contingency controls, and an auditable approvals register. This document is a hand-overable implementation blueprint (policy, configuration, reporting, testing, rollout and operations). </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>Document structure (use to navigate):</strong> Purpose & scope; Design principles; Detailed system configuration (data model, validations, imports); Reporting & dashboard design; Remediation workflow & operational playbook; Approval matrix, workflow logic & contingency rules; Reconciliation, month-end and controls; Technical appendix (fields, report parameters, SQL/pseudocode, DAX examples); Security, retention & audit readiness; Testing, pilot & rollout plan; KPIs & governance; Troubleshooting and known exceptions; Templates & examples. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>Purpose & scope:</strong><br>• Purpose: remove ambiguity in budget submissions, reduce audit queries, speed approvals, and ensure money produces the intended deliverable outcomes.<br>• Scope: Project budgeting and monitoring for Faculty/Department projects, grants and operational projects inside Oxford FMS using Unit4/Agresso Project & Workflow capabilities, plus BI/reporting integrations (Unit4 FP&A, Power BI, Tableau or Excel extracts).<br>• Not in scope (this document): payroll system changes, external supplier portals, or non-project GL postings except where they post to Project codes. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>Design principles (foundation):</strong><br>1. <strong>Authoritative at capture:</strong> make budget lines first-class objects with mandatory justification and arithmetic trace. <br>2. <strong>Deliverable focus:</strong> budgets structured by activity/milestone to enable progress+spend analysis. <br>3. <strong>Automated early detection + one-action remediation:</strong> flag >10% and require one corrective action owner. <br>4. <strong>Clear delegation & SOD:</strong> workflows encode thresholds and parallel validations; prevent requestor = approver. <br>5. <strong>Auditability & retention:</strong> attachments, audit logs and remediation evidence kept with the project. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>A. Data model — budget line & project entities (recommended canonical schema)</strong><br>-- <strong>Project</strong>: ProjectCode (PK), ProjectName, ProjectType (Grant/Operational/Capital), FundSource, ProjectManagerID, Department, StartDate, EndDate, BudgetVersionIDCurrent.<br>-- <strong>BudgetLine</strong>: ProjectCode, BudgetVersionID, LineSeq (PK), ActivityCode, ActivityDesc, Description (one-line justification, varchar 240), LineType (Expenditure/Contingency/Income), UnitQty (decimal), UnitUOM, UnitCost (decimal), LineTotal (decimal), ContingencyPct (decimal), VendorSuggested (optional), JustificationAttachmentID, CreatedBy, CreatedDate, SubmittedFlag, ApprovedFlag.<br>-- <strong>Transaction</strong>: GLTransactionID, ProjectCode, ActivityCode, GLAccount, Amount, Period (YYYYMM), PostedDate, CommitmentFlag, SourceDocID.<br>-- <strong>RemediationAction</strong>: ActionID, ProjectCode, ActivityCode, VariancePct, VarianceAmt, FlagReasonCode, ActionOwnerID, ActionDueDate, ShortRemedy, Status, CreatedDate, CloseDate, LinkedTransactionIDs, EvidenceAttachmentIDs.<br>Implementation note: favour normalized fields and use unique IDs for attachments to allow audit trace and archival. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>B. Capture & validation rules — enforce at UI/import layer</strong><br>1. <strong>Mandatory field rules</strong> (Project budget lines): Description (one-line justification), ActivityCode, UnitQty, UnitCost or LineTotal. If UnitQty & UnitCost present, compute LineTotal; if LineTotal provided but not matching UnitQty×UnitCost, require JustificationAttachment. <br>2. <strong>Arithmetic rule</strong>: if ABS((UnitQty×UnitCost) − LineTotal) > system_tolerance (e.g., 0.50), mark as BadMath and block commit until resolved. <br>3. <strong>Attachment rule</strong>: if LineTotal > attachment_threshold (example £5,000) OR LineType = 'Contingency' then JustificationAttachment mandatory. <br>4. <strong>Dimension rule</strong>: prevent save if ProjectType = Research AND FundSource = External AND ActivityCode missing. <br>5. <strong>SOD rule</strong>: prevent a user from approving lines where they are the CreatedBy unless Amount ≤ small_auto_approve_threshold (e.g., £250) and audit exception is recorded. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>C. Excel import & staging process (practical)</strong><br>• Provide a validated import template with headers matching BudgetLine schema. Fields: ImportID, ProjectCode, BudgetVersionID, LineSeq, ActivityCode, Description, UnitQty, UnitUOM, UnitCost, LineTotal, LineType, ContingencyPct, CreatedByEmail.<br>• Upload flow: upload → staging table → automated validation engine (run all rules above) → produce validation report CSV with error codes (MissingDescription, BadMath, MissingActivity, AttachmentRequired, DuplicateLineSeq) → user fixes offline and re-uploads. Only validated rows move to “Pending Approval” budget version.<br>• Idempotency: enforce ImportID per uploader session; duplicates based on ImportID + LineSeq are rejected. Capture UploadUser and UTC timestamp. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>D. UI considerations / UX guidance</strong><br>• Inline validations (immediate) rather than only post-upload. Show computed LineTotal dynamically as UnitQty×UnitCost. Provide an “Explain disparity” small popup to upload justification when numbers differ.<br>• Provide contextual help tooltips for ActivityCode and example one-line justifications. Offer “suggested justification” snippets for common categories (travel, equipment, consultancy) to speed good submissions.<br>• Bulk-attach for attachments: allow multiple lines to reference a single attachment (e.g., travel breakdown for multiple travel lines). </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>E. Reporting — Budget vs Actual (Delivery-vs-Spend) architecture</strong><br>1. <strong>Canonical source</strong>: GL + Project transactions, commitments (PO encumbrances), budget version table, %Complete (owner-entered) per activity.<br>2. <strong>Core schedule</strong>: Monthly S13 (Budget vs Actual) process, parameters: ProjectCode(s), BudgetVersionID, PeriodFrom, PeriodTo, IncludeCommitments Y/N. The S13 output should include per-activity drill-through to transaction IDs and attachments. <br>3. <strong>Dashboard design</strong> (single row per project-activity-period): <code>ProjectCode | ActivityCode | ActivityDesc | BudgetVersion | Period | Budget | Actual | Commitments | RemainingBudget = Budget − (Actual + Commitments) | VarianceAmt = Actual − Budget | VariancePct = VarianceAmt / Budget (handle Budget=0) | %Complete | Owner | ActionStatus | ActionOwner | LastActionDate</code>. <br>4. <strong>Distribution</strong>: schedule report to run after period close; auto-publish to a shared BI portal and email snapshot to ProjectManager, ProgrammeManager and Finance mailbox. Keep archive of monthly snapshots for 24+ months in BI. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>F. Variance flagging & remediation workflow (detailed operational rules)</strong><br>1. <strong>Flagging criteria</strong> (configurable): primary rule VariancePct <= −10% (underspend) or VariancePct >= +10% (overspend); secondary rules: Actual > Budget OR Commitments > RemainingBudget OR Rapid run rate indicator (e.g., Actual / MonthElapsed > Budget / MonthsTotal × threshold).<br>2. <strong>Auto-create RemediationAction</strong>: When flag detected, system auto-creates Action with recommended FlagReasonCode (derived from heuristics: timing, invoice lag, classification error, genuine overspend); assigns to ProjectManager (or Owner) and sets DueDate = 10 business days. Email & in-app notification sent. <br>3. <strong>Owner responsibilities</strong>: record a one-line cause, pick one corrective step (Reprofile / Seek Contingency / Seek Virement / Stop Spend), and set an expected close date. Attach evidence or approval where required. <br>4. <strong>Escalation</strong>: if Action remains Open past DueDate, escalate to ProgrammeManager; if still unresolved after escalation period, add to Senior Finance exception list and schedule intervention meeting. <br>5. <strong>Audit</strong>: closure requires attaching evidence (email, approval form, vendor invoice) and setting CloseDate; closed actions are immutable except via an audit-logged re-open. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>G. Approval matrix, workflow logic & contingency rules</strong><br><strong>Authority matrix (example):</strong><br>• Band A: ≤ £5,000 — Project Lead (auto-approval possible with exception log).<br>• Band B: >£5,000 and ≤ £50,000 — Programme Manager / Head of Department.<br>• Band C: >£50,000 and ≤ £250,000 — Faculty CFO / Director.<br>• Band D: >£250,000 — Executive sign-off (Dean / Pro-Vice-Chancellor).<br><strong>Dimension-driven branches:</strong> ProjectType = Research → route to Research Office for policy/compliance review (regardless of value). AccountCategory = 'IT' → route to IT Technical reviewer in parallel. FundSource = ExternalAward → route to Grants/Contracts Office. <br><strong>Contingency rules:</strong> Contingency lines must be explicit in budget; contingency drawdowns require ContingencyJustification and route via Workflow identical to spend increases. Default maximum contingency % by project type (Research 10%; Operational 5%; Capital 2%) unless Director-level waiver recorded. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>H. Reconciliation & month-end control checklist (detailed)</strong><br>Monthly reconciliations to run and sign-off before close: <br>1. <strong>S13 vs GL</strong>: total Budget vs Actual S13 amounts reconciled to GL Project postings; tolerance threshold 0.5% or £1,000 min. Investigate reconciling items (> tolerance).<br>2. <strong>Commitments check</strong>: run commitments (PO encumbrances) extract (M13 or equivalent) and ensure commitments appear in dashboard and affect RemainingBudget.<br>3. <strong>Transaction completeness</strong>: check for transactions posted without ProjectCode (report and return to originator).<br>4. <strong>Remediation closure</strong>: all open remediation actions older than 30 days reviewed and escalated. <br>5. <strong>Owner sign-off</strong>: Project Owner acknowledges dashboard (checkbox/signed in-system) confirming accuracy of %Complete and accepted remediation items. <br>6. <strong>Close log</strong>: store a signed monthly close log with timestamped approvals and the distribution list. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>I. KPI definitions & targets (governance)</strong><br>• First-pass budget line acceptance rate (no validation errors) — target ≥98%.<br>• % of flagged variances (>10%) with assigned remediation within 5 business days — target ≥95%.<br>• % of remediation actions closed within agreed DueDate — target ≥90%.<br>• Median approval time by threshold band — target Band A ≤ 2 business days, Band B ≤ 5 business days, Band C ≤ 10 business days. <br>• Monthly reconciliation pass rate S13-to-GL (within tolerance) — target ≥99.5%. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>J. Reports & extracts (operational list)</strong><br>1. S13 Budget vs Actual (per project, per activity) — scheduled monthly.<br>2. Project Commitments report (PO encumbrances) — scheduled weekly.<br>3. Remediation Action register (open/closed) — daily for owners, monthly summary for governance.<br>4. Approvals audit log extract — monthly for internal audit sampling.<br>5. Import staging error report — on each import session. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>K. Security, roles & permissions (recommended mapping)</strong><br>• Roles: ProjectSubmitter (create/edit pending budgets), ProjectOwner (submit & respond to remediation actions), ProgrammeManager (approve Band B), FacultyCFO (approve Band C), ExecutiveApprover (Band D approvals), ResearchOffice/GrantsOfficer (review research projects), ITTechnicalReviewer (parallel reviewer for IT accounts), FinanceOps (run S13, close months), BIViewer (view dashboards).<br>• Permissions: enforce least privilege; restrict budget edit to current BudgetVersion unless rollback permitted; prevent deletion of approved lines; require FinanceOps role for posting finalised journal adjustments. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>L. Audit readiness & retention policy</strong><br>• Keep all budget versions, attachments, approval audit logs and remediation records for the University retention period (commonly 7 years for financial records; confirm institutional policy).<br>• Provide auditors a package: S13 output, approvals audit log, remediation actions, import staging log and attachments for sampled projects. Keep export-friendly formats (CSV/PDF) and ensure redaction/PII respect where required. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>M. BI & analytics implementation notes (Power BI / Unit4 FP&A)</strong><br>• Data flow: Agresso → scheduled extract (OData/CSV) → staging DB → BI dataset. Push daily incremental extracts for active projects and full refresh monthly after close.<br>• Useful DAX measures (sketches):<br>  — VarianceAmt = SUM(Transactions[Actual]) − SUM(Budget[Budget])<br>  — VariancePct = DIVIDE([VarianceAmt], SUM(Budget[Budget]), 0) * 100<br>  — RemainingBudget = SUM(Budget[Budget]) − (SUM(Transactions[Actual]) + SUM(Commitments[CommitmentAmt]))<br>  — RunRateIndicator = DIVIDE(SUM(Transactions[Actual]) / MonthsElapsed, SUM(Budget[Budget]) / TotalMonths, 0)<br>• Conditional formatting: VariancePct >= +10% fill red; VariancePct <= −10% fill amber; RemainingBudget < 0 flag. Add drill-through to transaction-level view and attachments link (URL field pointing to document store). </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>N. Testing plan & acceptance criteria (detailed)</strong><br>Test phases: unit tests (config validation), integration (import → validation → workflow → posting), UAT (finance & project owners), pilot.<br>Key test cases:<br>• Import with bad math → expect validation row with BadMath code and blocked commit.<br>• Attachment requirement triggered on threshold → upload blocked without attachment.<br>• Workflow routing by amount + project type → correct approvers assigned (including parallel technical reviewer).<br>• S13 totals match GL (within tolerance) after posting simulated transactions.<br>• Remediation action auto-created for synthetic variance >10% and escalated if not closed. <br>Acceptance: all critical test cases pass and UAT sign-off by FinanceOps & two project owners. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>O. Pilot & rollout (recommended timeline & activities)</strong><br>Pilot (6–8 weeks): select 2–4 representative projects (one large grant, one operational, one capital if relevant). Run complete process for one budget cycle, collect defects, refine rules.<br>Rollout (4–6 weeks phased): roll to all grants first, then to operational projects, then to small-value/ one-off projects. Provide on-the-day support during first two close cycles. Schedule governance review 6–8 weeks after full rollout. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>P. Training & documentation (required deliverables)</strong><br>• Role-based quick guides (1-page) for: Budget Submitters, Approvers, Project Owners, FinanceOps.<br>• Short videos (3–5min) showing: upload template, correct one-line justification, run S13, respond to remediation action.<br>• Internal wiki page with FAQs, examples of good justifications, contacts for support. <br>• Train-the-trainer sessions for departmental super-users. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>Q. Troubleshooting & common exceptions (with fixes)</strong><br>• Missing ProjectCode on posted transaction → run exception report, notify originator; create reversing journal and repost with correct ProjectCode (FinanceOps action).<br>• Workflow stuck due to absent approver → auto-escalation to substitute after X days; configure substitutes proactively. <br>• Import fails for duplicated ImportID → instruct uploader to increment ImportID or use new session ID. <br>• False positive variance due to timing (invoices late) → record as timing-issue flag and maintain evidence; avoid immediate contingency drawdown until pattern confirmed. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>R. Change control & continuous improvement</strong><br>• Keep configuration changes under change control: request → impact assessment → test → schedule window → communicate to users.<br>• Maintain a short backlog of small improvements (UX tweaks, new validation rules) and deliver in monthly minor releases. Quarterly control review to re-baseline thresholds and KPI targets. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>S. Appendix A — sample one-line justification examples (good vs poor)</strong><br>Good: “Two-week fieldwork subsistence for 3 PhD researchers (6 nights @ £60/night + local travel)”.<br>Poor: “Fieldwork expenses” (insufficient: no quantities, unit costs or purpose).<br>Good: “Purchase of 1x high-speed microplate reader for assay validation; vendor quote ref Q1234 attached; capital code applied.”<br>Poor: “Equipment” (insufficient). </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>T. Appendix B — sample CSV upload header row (exact column order recommended)</strong><br>ImportID,ProjectCode,BudgetVersionID,LineSeq,ActivityCode,Description,UnitQty,UnitUOM,UnitCost,LineTotal,LineType,ContingencyPct,CreatedByEmail,JustificationAttachmentID<br>Implement strict header validation to avoid mapping errors. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>U. Appendix C — sample SQL checks (examples)</strong><br>1. Find transactions without ProjectCode:<br><code>SELECT * FROM GLTransactions WHERE ProjectCode IS NULL AND Period BETWEEN &#x27;202401&#x27; AND &#x27;202412&#x27;;</code><br>2. Detect ledger-project drift (S13 vs GL):<br><code>SELECT p.ProjectCode, SUM(budget.Budget) AS BudgetSum, SUM(t.Actual) AS GLActual FROM BudgetLines budget LEFT JOIN GLTransactions t ON budget.ProjectCode = t.ProjectCode AND budget.ActivityCode = t.ActivityCode GROUP BY p.ProjectCode HAVING ABS(SUM(budget.Budget)-SUM(t.Actual)) &gt; 1000;</code><br>Note: adapt SQL to your schema and indexing for performance. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>V. Appendix D — sample DAX for Power BI (compact)</strong><br><code>VarianceAmt = SUM(Transactions[Actual]) - SUM(Budget[BudgetAmount])</code><br><code>VariancePct = IF(SUM(Budget[BudgetAmount]) = 0, BLANK(), DIVIDE([VarianceAmt], SUM(Budget[BudgetAmount])))</code><br><code>RemainingBudget = SUM(Budget[BudgetAmount]) - ( SUM(Transactions[Actual]) + SUM(Commitments[CommitmentAmt]) )</code><br>Use these measures in table visuals with conditional formatting rules for visual flags. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>W. Appendix E — sample policy text snippets (copyable)</strong><br><strong>Budget Submission Policy (excerpt):</strong> “All Project budget lines must include a one-line justification and either unit quantity & unit cost or an attached unit-cost worksheet. Budget versions failing validation will be rejected and must be corrected before submission. Contingency lines require explicit justification and may not exceed the published contingency cap for the project type without Director approval.”<br><strong>Variance & Remediation Policy (excerpt):</strong> “Any project-activity variance >= ±10% triggers an automatic remediation action assigned to the Project Owner with a 10 business day resolution target. Unresolved actions will be escalated to Programme Manager at 11 business days.” </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>X. Appendix F — governance & meeting cadence (recommended)</strong><br>1. <strong>Daily:</strong> system health checks by FinanceOps (import queue, workflow queue).<br>2. <strong>Weekly:</strong> exception review meeting for projects with critical variances or blocked approvals.<br>3. <strong>Monthly:</strong> Finance review & sign-off of monthly S13 distribution; review of remediation close rates.<br>4. <strong>Quarterly:</strong> controls health-check (account-rule coverage, policy compliance), KPI review and threshold tuning. </td></tr><tr><td data-label="Accounting / Finance — Oxford FMS (Agresso)"> <strong>Y. Final operational checklist for go-live (one page)</strong><br>1. Import template finalised and tested.<br>2. Account rules implemented and tested.<br>3. Workflow configured with thresholds and substitutes.<br>4. S13 scheduled and BI dashboard connected.<br>5. Pilot completed and defects closed.<br>6. Training materials and quick guides published.<br>7. Retention & audit archive confirmed.<br>8. Support SLA published and support rota arranged. </td></tr></tbody></table></div><div class="row-count">Rows: 29</div></div><div class="table-caption" id="Table8" data-table="YJKN_0005_08" style="margin-top:2mm;margin-left:3mm;"><strong>Table 8</strong></div>
<div class="table-wrapper" data-table-id="table-8"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Executive summary:</strong> Configure Agresso (Unit4) Project & Workflow modules so every budget line is self-justifying with reproducible unit-cost math at capture; link GL postings to project/activity deliverables; run automated monthly Budget vs Actual (delivery-vs-spend) reporting that flags variances >10% and generates a named remediation action; and govern spend through parameterised approval workflows, contingency controls, and an auditable approvals register. This document is a hand-overable implementation blueprint (policy, configuration, reporting, testing, rollout and operations). </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Document structure (use to navigate):</strong> Purpose & scope; Design principles; Detailed system configuration (data model, validations, imports); Reporting & dashboard design; Remediation workflow & operational playbook; Approval matrix, workflow logic & contingency rules; Reconciliation, month-end and controls; Technical appendix (fields, report parameters, SQL/pseudocode, DAX examples); Security, retention & audit readiness; Testing, pilot & rollout plan; KPIs & governance; Troubleshooting and known exceptions; Templates & examples; Power BI implementation. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Purpose & scope:</strong><br>• Purpose: remove ambiguity in budget submissions, reduce audit queries, speed approvals, and ensure money produces the intended deliverable outcomes.<br>• Scope: Project budgeting and monitoring for Faculty/Department projects, grants and operational projects inside Oxford FMS using Unit4/Agresso Project & Workflow capabilities, plus BI/reporting integrations (Unit4 FP&A, Power BI, Tableau or Excel extracts).<br>• Not in scope (this document): payroll system changes, external supplier portals, or non-project GL postings except where they post to Project codes. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Design principles (foundation):</strong><br>1. <strong>Authoritative at capture:</strong> make budget lines first-class objects with mandatory justification and arithmetic trace. <br>2. <strong>Deliverable focus:</strong> budgets structured by activity/milestone to enable progress+spend analysis. <br>3. <strong>Automated early detection + one-action remediation:</strong> flag >10% and require one corrective action owner. <br>4. <strong>Clear delegation & SOD:</strong> workflows encode thresholds and parallel validations; prevent requestor = approver. <br>5. <strong>Auditability & retention:</strong> attachments, audit logs and remediation evidence kept with the project. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>1. Data model — budget line & project entities (recommended canonical schema)</strong><br>• <strong>Project</strong>: ProjectCode (PK), ProjectName, ProjectType (Grant/Operational/Capital), FundSource, ProjectManagerID, Department, StartDate, EndDate, BudgetVersionIDCurrent.<br>• <strong>BudgetLine</strong>: ProjectCode, BudgetVersionID, LineSeq (PK), ActivityCode, ActivityDesc, Description (one-line justification, varchar 240), LineType (Expenditure/Contingency/Income), UnitQty (decimal), UnitUOM, UnitCost (decimal), LineTotal (decimal), ContingencyPct (decimal), VendorSuggested (optional), JustificationAttachmentID, CreatedBy, CreatedDate, SubmittedFlag, ApprovedFlag.<br>• <strong>Transaction</strong>: GLTransactionID, ProjectCode, ActivityCode, GLAccount, Amount, Period (YYYYMM), PostedDate, CommitmentFlag, SourceDocID.<br>• <strong>RemediationAction</strong>: ActionID, ProjectCode, ActivityCode, VariancePct, VarianceAmt, FlagReasonCode, ActionOwnerID, ActionDueDate, ShortRemedy, Status, CreatedDate, CloseDate, LinkedTransactionIDs, EvidenceAttachmentIDs.<br>Implementation note: favour normalized fields and use unique IDs for attachments to allow audit trace and archival. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>2. Capture & validation rules — enforce at UI/import layer</strong><br>1. <strong>Mandatory field rules</strong> (Project budget lines): Description (one-line justification), ActivityCode, UnitQty, UnitCost or LineTotal. If UnitQty & UnitCost present, compute LineTotal; if LineTotal provided but not matching UnitQty×UnitCost, require JustificationAttachment. <br>2. <strong>Arithmetic rule</strong>: if ABS((UnitQty×UnitCost) − LineTotal) > system_tolerance (e.g., 0.50), mark as BadMath and block commit until resolved. <br>3. <strong>Attachment rule</strong>: if LineTotal > attachment_threshold (example £5,000) OR LineType = 'Contingency' then JustificationAttachment mandatory. <br>4. <strong>Dimension rule</strong>: prevent save if ProjectType = Research AND FundSource = External AND ActivityCode missing. <br>5. <strong>SOD rule</strong>: prevent a user from approving lines where they are the CreatedBy unless Amount ≤ small_auto_approve_threshold (e.g., £250) and audit exception is recorded. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>3. Excel import & staging process (practical)</strong><br>• Provide a validated import template with headers matching BudgetLine schema. Fields: ImportID, ProjectCode, BudgetVersionID, LineSeq, ActivityCode, Description, UnitQty, UnitUOM, UnitCost, LineTotal, LineType, ContingencyPct, CreatedByEmail.<br>• Upload flow: upload → staging table → automated validation engine (run all rules above) → produce validation report CSV with error codes (MissingDescription, BadMath, MissingActivity, AttachmentRequired, DuplicateLineSeq) → user fixes offline and re-uploads. Only validated rows move to “Pending Approval” budget version.<br>• Idempotency: enforce ImportID per uploader session; duplicates based on ImportID + LineSeq are rejected. Capture UploadUser and UTC timestamp. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>4. UI considerations / UX guidance</strong><br>• Inline validations (immediate) rather than only post-upload. Show computed LineTotal dynamically as UnitQty×UnitCost. Provide an “Explain disparity” small popup to upload justification when numbers differ.<br>• Provide contextual help tooltips for ActivityCode and example one-line justifications. Offer “suggested justification” snippets for common categories (travel, equipment, consultancy) to speed good submissions.<br>• Bulk-attach for attachments: allow multiple lines to reference a single attachment (e.g., travel breakdown for multiple travel lines). </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>5. Reporting — Budget vs Actual (Delivery-vs-Spend) architecture</strong><br>1. <strong>Canonical source</strong>: GL + Project transactions, commitments (PO encumbrances), budget version table, %Complete (owner-entered) per activity.<br>2. <strong>Core schedule</strong>: Monthly S13 (Budget vs Actual) process, parameters: ProjectCode(s), BudgetVersionID, PeriodFrom, PeriodTo, IncludeCommitments Y/N. The S13 output should include per-activity drill-through to transaction IDs and attachments. <br>3. <strong>Dashboard design</strong> (single row per project-activity-period): <code>ProjectCode | ActivityCode | ActivityDesc | BudgetVersion | Period | Budget | Actual | Commitments | RemainingBudget = Budget − (Actual + Commitments) | VarianceAmt = Actual − Budget | VariancePct = VarianceAmt / Budget (handle Budget=0) | %Complete | Owner | ActionStatus | ActionOwner | LastActionDate</code>. <br>4. <strong>Distribution</strong>: schedule report to run after period close; auto-publish to a shared BI portal and email snapshot to ProjectManager, ProgrammeManager and Finance mailbox. Keep archive of monthly snapshots for 24+ months in BI. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>6. Variance flagging & remediation workflow (detailed operational rules)</strong><br>1. <strong>Flagging criteria</strong> (configurable): primary rule VariancePct <= −10% (underspend) or VariancePct >= +10% (overspend); secondary rules: Actual > Budget OR Commitments > RemainingBudget OR Rapid run rate indicator (e.g., Actual / MonthElapsed > Budget / MonthsTotal × threshold).<br>2. <strong>Auto-create RemediationAction</strong>: When flag detected, system auto-creates Action with recommended FlagReasonCode (derived from heuristics: timing, invoice lag, classification error, genuine overspend); assigns to ProjectManager (or Owner) and sets DueDate = 10 business days. Email & in-app notification sent. <br>3. <strong>Owner responsibilities</strong>: record a one-line cause, pick one corrective step (Reprofile / Seek Contingency / Seek Virement / Stop Spend), and set an expected close date. Attach evidence or approval where required. <br>4. <strong>Escalation</strong>: if Action remains Open past DueDate, escalate to ProgrammeManager; if still unresolved after escalation period, add to Senior Finance exception list and schedule intervention meeting. <br>5. <strong>Audit</strong>: closure requires attaching evidence (email, approval form, vendor invoice) and setting CloseDate; closed actions are immutable except via an audit-logged re-open. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>7. Approval matrix, workflow logic & contingency rules</strong><br><strong>Authority matrix (example):</strong><br>• Band A: ≤ £5,000 — Project Lead (auto-approval possible with exception log).<br>• Band B: >£5,000 and ≤ £50,000 — Programme Manager / Head of Department.<br>• Band C: >£50,000 and ≤ £250,000 — Faculty CFO / Director.<br>• Band D: >£250,000 — Executive sign-off (Dean / Pro-Vice-Chancellor).<br><strong>Dimension-driven branches:</strong> ProjectType = Research → route to Research Office for policy/compliance review (regardless of value). AccountCategory = 'IT' → route to IT Technical reviewer in parallel. FundSource = ExternalAward → route to Grants/Contracts Office. <br><strong>Contingency rules:</strong> Contingency lines must be explicit in budget; contingency drawdowns require ContingencyJustification and route via Workflow identical to spend increases. Default maximum contingency % by project type (Research 10%; Operational 5%; Capital 2%) unless Director-level waiver recorded. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>8. Reconciliation & month-end control checklist (detailed)</strong><br>Monthly reconciliations to run and sign-off before close: <br>1. <strong>S13 vs GL</strong>: total Budget vs Actual S13 amounts reconciled to GL Project postings; tolerance threshold 0.5% or £1,000 min. Investigate reconciling items (> tolerance).<br>2. <strong>Commitments check</strong>: run commitments (PO encumbrances) extract (M13 or equivalent) and ensure commitments appear in dashboard and affect RemainingBudget.<br>3. <strong>Transaction completeness</strong>: check for transactions posted without ProjectCode (report and return to originator).<br>4. <strong>Remediation closure</strong>: all open remediation actions older than 30 days reviewed and escalated. <br>5. <strong>Owner sign-off</strong>: Project Owner acknowledges dashboard (checkbox/signed in-system) confirming accuracy of %Complete and accepted remediation items. <br>6. <strong>Close log</strong>: store a signed monthly close log with timestamped approvals and the distribution list. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>9. KPI definitions & targets (governance)</strong><br>• First-pass budget line acceptance rate (no validation errors) — target ≥98%.<br>• % of flagged variances (>10%) with assigned remediation within 5 business days — target ≥95%.<br>• % of remediation actions closed within agreed DueDate — target ≥90%.<br>• Median approval time by threshold band — target Band A ≤ 2 business days, Band B ≤ 5 business days, Band C ≤ 10 business days. <br>• Monthly reconciliation pass rate S13-to-GL (within tolerance) — target ≥99.5%. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>10. Reports & extracts (operational list)</strong><br>1. S13 Budget vs Actual (per project, per activity) — scheduled monthly.<br>2. Project Commitments report (PO encumbrances) — scheduled weekly.<br>3. Remediation Action register (open/closed) — daily for owners, monthly summary for governance.<br>4. Approvals audit log extract — monthly for internal audit sampling.<br>5. Import staging error report — on each import session. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>11. Security, roles & permissions (recommended mapping)</strong><br>• Roles: ProjectSubmitter (create/edit pending budgets), ProjectOwner (submit & respond to remediation actions), ProgrammeManager (approve Band B), FacultyCFO (approve Band C), ExecutiveApprover (Band D approvals), ResearchOffice/GrantsOfficer (review research projects), ITTechnicalReviewer (parallel reviewer for IT accounts), FinanceOps (run S13, close months), BIViewer (view dashboards).<br>• Permissions: enforce least privilege; restrict budget edit to current BudgetVersion unless rollback permitted; prevent deletion of approved lines; require FinanceOps role for posting finalised journal adjustments. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>12. Audit readiness & retention policy</strong><br>• Keep all budget versions, attachments, approval audit logs and remediation records for the University retention period (commonly 7 years for financial records; confirm institutional policy).<br>• Provide auditors a package: S13 output, approvals audit log, remediation actions, import staging log and attachments for sampled projects. Keep export-friendly formats (CSV/PDF) and ensure redaction/PII respect where required. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>13. BI & analytics implementation notes (Power BI / Unit4 FP&A)</strong><br>• Data flow: Agresso → scheduled extract (OData/CSV/ETL) → staging DB → BI dataset. Push daily incremental extracts for active projects and full refresh monthly after close. Unit4 has APIs and FP&A extraction options to support integrations; third-party connectors and ETL adapters exist.<br>• Useful DAX measures (sketches):<br>  — VarianceAmt = SUM(Transactions[Actual]) − SUM(Budget[Budget])<br>  — VariancePct = DIVIDE([VarianceAmt], SUM(Budget[Budget]), 0) * 100<br>  — RemainingBudget = SUM(Budget[Budget]) − (SUM(Transactions[Actual]) + SUM(Commitments[CommitmentAmt]))<br>  — RunRateIndicator = DIVIDE(SUM(Transactions[Actual]) / MonthsElapsed, SUM(Budget[Budget]) / TotalMonths, 0)<br>• Conditional formatting: VariancePct >= +10% fill red; VariancePct <= −10% fill amber; RemainingBudget < 0 flag. Add drill-through to transaction-level view and attachments link (URL field pointing to document store). </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>14. Testing plan & acceptance criteria (detailed)</strong><br>Test phases: unit tests (config validation), integration (import → validation → workflow → posting), UAT (finance & project owners), pilot.<br>Key test cases:<br>• Import with bad math → expect validation row with BadMath code and blocked commit.<br>• Attachment requirement triggered on threshold → upload blocked without attachment.<br>• Workflow routing by amount + project type → correct approvers assigned (including parallel technical reviewer).<br>• S13 totals match GL (within tolerance) after posting simulated transactions.<br>• Remediation action auto-created for synthetic variance >10% and escalated if not closed. <br>Acceptance: all critical test cases pass and UAT sign-off by FinanceOps & two project owners. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>15. Pilot & rollout (recommended timeline & activities)</strong><br>Pilot (6–8 weeks): select 2–4 representative projects (one large grant, one operational, one capital if relevant). Run complete process for one budget cycle, collect defects, refine rules.<br>Rollout (4–6 weeks phased): roll to all grants first, then to operational projects, then to small-value/ one-off projects. Provide on-the-day support during first two close cycles. Schedule governance review 6–8 weeks after full rollout. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>16. Training & documentation (required deliverables)</strong><br>• Role-based quick guides (1-page) for: Budget Submitters, Approvers, Project Owners, FinanceOps.<br>• Short videos (3–5min) showing: upload template, correct one-line justification, run S13, respond to remediation action.<br>• Internal wiki page with FAQs, examples of good justifications, contacts for support. <br>• Train-the-trainer sessions for departmental super-users. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>17. Troubleshooting & common exceptions (with fixes)</strong><br>• Missing ProjectCode on posted transaction → run exception report, notify originator; create reversing journal and repost with correct ProjectCode (FinanceOps action).<br>• Workflow stuck due to absent approver → auto-escalation to substitute after X days; configure substitutes proactively. <br>• Import fails for duplicated ImportID → instruct uploader to increment ImportID or use new session ID. <br>• False positive variance due to timing (invoices late) → record as timing-issue flag and maintain evidence; avoid immediate contingency drawdown until pattern confirmed. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>18. Change control & continuous improvement</strong><br>• Keep configuration changes under change control: request → impact assessment → test → schedule window → communicate to users.<br>• Maintain a short backlog of small improvements (UX tweaks, new validation rules) and deliver in monthly minor releases. Quarterly control review to re-baseline thresholds and KPI targets. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Appendix A — sample one-line justification examples (good vs poor)</strong><br>Good: “Two-week fieldwork subsistence for 3 PhD researchers (6 nights @ £60/night + local travel)”.<br>Poor: “Fieldwork expenses” (insufficient: no quantities, unit costs or purpose).<br>Good: “Purchase of 1x high-speed microplate reader for assay validation; vendor quote ref Q1234 attached; capital code applied.”<br>Poor: “Equipment” (insufficient). </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Appendix B — sample CSV upload header row (exact column order recommended)</strong><br>ImportID,ProjectCode,BudgetVersionID,LineSeq,ActivityCode,Description,UnitQty,UnitUOM,UnitCost,LineTotal,LineType,ContingencyPct,CreatedByEmail,JustificationAttachmentID<br>Implement strict header validation to avoid mapping errors. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Appendix C — sample SQL checks (examples)</strong><br>1. Find transactions without ProjectCode:<br><code>SELECT * FROM GLTransactions WHERE ProjectCode IS NULL AND Period BETWEEN &#x27;202401&#x27; AND &#x27;202412&#x27;;</code><br>2. Detect ledger-project drift (S13 vs GL):<br><code>SELECT p.ProjectCode, SUM(budget.Budget) AS BudgetSum, SUM(t.Actual) AS GLActual FROM BudgetLines budget LEFT JOIN GLTransactions t ON budget.ProjectCode = t.ProjectCode AND budget.ActivityCode = t.ActivityCode GROUP BY p.ProjectCode HAVING ABS(SUM(budget.Budget)-SUM(t.Actual)) &gt; 1000;</code><br>Note: adapt SQL to your schema and indexing for performance. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Appendix D — sample DAX for Power BI (compact)</strong><br><code>VarianceAmt = SUM(Transactions[Actual]) - SUM(Budget[BudgetAmount])</code><br><code>VariancePct = IF(SUM(Budget[BudgetAmount]) = 0, BLANK(), DIVIDE([VarianceAmt], SUM(Budget[BudgetAmount])))</code><br><code>RemainingBudget = SUM(Budget[BudgetAmount]) - ( SUM(Transactions[Actual]) + SUM(Commitments[CommitmentAmt]) )</code><br>Use these measures in table visuals with conditional formatting rules for visual flags. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Appendix E — sample policy text snippets (copyable)</strong><br><strong>Budget Submission Policy (excerpt):</strong> “All Project budget lines must include a one-line justification and either unit quantity & unit cost or an attached unit-cost worksheet. Budget versions failing validation will be rejected and must be corrected before submission. Contingency lines require explicit justification and may not exceed the published contingency cap for the project type without Director approval.”<br><strong>Variance & Remediation Policy (excerpt):</strong> “Any project-activity variance >= ±10% triggers an automatic remediation action assigned to the Project Owner with a 10 business day resolution target. Unresolved actions will be escalated to Programme Manager at 11 business days.” </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Appendix F — governance & meeting cadence (recommended)</strong><br>1. <strong>Daily:</strong> system health checks by FinanceOps (import queue, workflow queue).<br>2. <strong>Weekly:</strong> exception review meeting for projects with critical variances or blocked approvals.<br>3. <strong>Monthly:</strong> Finance review & sign-off of monthly S13 distribution; review of remediation close rates.<br>4. <strong>Quarterly:</strong> controls health-check (account-rule coverage, policy compliance), KPI review and threshold tuning. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Final operational checklist for go-live (one page)</strong><br>1. Import template finalised and tested.<br>2. Account rules implemented and tested.<br>3. Workflow configured with thresholds and substitutes.<br>4. S13 scheduled and BI dashboard connected.<br>5. Pilot completed and defects closed.<br>6. Training materials and quick guides published.<br>7. Retention & audit archive confirmed.<br>8. Support SLA published and support rota arranged. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Power BI Implementation — Real-World Integration with Oxford FMS (Unit4 / Agresso)</strong><br><strong>Overview / realistic options:</strong><br>Integrating Agresso with Power BI in production is most reliably done by extracting cleansed, model-ready data from Unit4 into a managed staging area (data warehouse or data mart) and pointing Power BI to that staging layer. Unit4 provides APIs, FP&A extract capabilities and extension tooling; several specialist connectors/ETL vendors offer prebuilt adapters for Unit4 → Power BI. Direct live-connect to Agresso screens is fragile and usually not recommended for enterprise dashboards. <br><strong>Key design decisions (pick and justify):</strong><br>1. <strong>Extraction method:</strong> use Unit4 REST/OData APIs or FP&A data export to perform scheduled extracts (preferred), or a supported third-party connector/adapter (Arribatec, Alumio, TimeXtender) if you want faster implementation.<br>2. <strong>Staging location:</strong> land extracts in a secure, authoritative staging database (Azure SQL / Synapse / SQL Server / on-prem DB) rather than trying to model directly in Power BI. This allows heavy transformations, joins (BudgetLines + GL + Commitments + Attachments metadata) and incremental loads. <br>3. <strong>Refresh & scale:</strong> for many projects, daily incremental refresh + monthly full refresh after close is sufficient. If you have large transaction volumes, use Power BI Premium or Fabric to enable large model sizes and incremental refresh windows. Community reports note occasional ODBC/OData connection instability; a staging DB + gateway is the stable approach. <br><strong>Detailed implementation steps (real-world):</strong><br>1. <strong>Requirements & mapping</strong><br>• Confirm the required fields (BudgetLine schema, GL transactions, commitments, project metadata, attachment pointers). Map S13 output fields to the data model fields used in BI. (S13 is the canonical Budget vs Actual extract; use it as the authoritative mapping reference).<br>• Define refresh cadence per dataset (daily incremental for posted transactions and commitments; nightly for budget updates; monthly full refresh post-close).<br>2. <strong>Choose extraction technology</strong><br>• Option A — <strong>Unit4 API / OData</strong>: implement scheduled API pulls fetching Project, BudgetLine, GLTransaction and Commitment endpoints; capture attachments metadata (URLs and GUIDs) where possible. Unit4 documents REST endpoints and extension kit capabilities for integration.<br>• Option B — <strong>Unit4 FP&A / native data export</strong>: if you have Unit4 FP&A, use its data integration/export facility to deliver structured extracts (recommended where available). :contentReference[oaicite:6]{index=6}<br>• Option C — <strong>Third-party connector / ETL</strong>: use a vendor adapter (Arribatec, Alumio, TimeXtender, or one on G-Cloud) to accelerate the pipeline and handle incremental change data capture (CDC). :contentReference[oaicite:7]{index=7}<br>3. <strong>Build staging / transform layer</strong><br>• Ingest extracts to staging tables. Keep raw extract logs for audit and reprocessing.<br>• Transform: join BudgetLines (budget version) to GL transactions and commitments by ProjectCode & ActivityCode; compute MonthToDate and YearToDate aggregates; calculate VarianceAmt/VariancePct and run the variance flagging logic in SQL for deterministic results. Materialise RemediationAction rows from flagging rules. <br>• Maintain attachments metadata table: store URL, attachment GUID, content type, uploader, timestamp, retention tag — do <strong>not</strong> store binary blobs in the BI model. Link attachments by AttachmentID. <br>4. <strong>Data model & semantic layer for Power BI</strong><br>• Build a star schema: central FactTransactions (Actuals + Commitments), FactBudget (BudgetLines), DimProject, DimActivity, DimPeriod, DimUser (owners/approvers). Avoid snowflake joins inside Power BI visuals. <br>• Precompute aggregated tables for large volumes (MonthlyActualsByProjectActivity) to improve report performance. <br>• Provide a semantic layer (Power BI dataset) with friendly column names, calculated columns for business-friendly fields (e.g., RemainingBudget), and DAX measures (VarianceAmt, VariancePct, %Complete). Use display folders and measure groups. <br>5. <strong>Power BI dataset & report design</strong><br>• Use Import mode for fast interactive reports (with incremental refresh) and DirectQuery only where near-real-time is necessary and volumes are controlled. For large historic data, consider Power BI Premium per capacity. <br>• Implement incremental refresh with parameters RangeStart/RangeEnd for Fact tables; set appropriate partitioning (monthly/quarterly) and retention policy. <br>• Implement Row-Level Security (RLS) mapped to ProjectOwner/Department to ensure users only see projects they are authorised to view. <br>• Provide drill-through from a Project-level tile to Activity → Transaction detail → attachment links (link opens secure document store). <br>6. <strong>Power BI Service deployment & refresh</strong><br>• Deploy datasets to a dedicated workspace (preferably Premium capacity). Configure the on-premises data gateway if staging DB is on-prem; if using Azure SQL, use service-to-service connections with managed identity/service principal.<br>• Configure scheduled refreshes: incremental refresh nightly; full refresh monthly post-close. Monitor refresh failures via alerts. <br>7. <strong>Operational monitoring & alerting</strong><br>• Monitor dataset refresh latency, failure rate and dataset size. Alert FinanceOps on refresh failures and on clearance thresholds (e.g., if VarianceFlag count > X).<br>• Capture usage metrics to understand who uses which dashboards and tune visuals for most-used flows. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Power BI practical patterns — measures, visuals & UX</strong><br>• <strong>Core measures</strong>:<br>  — Budget = SUM(Budget[LineTotal])<br>  — Actual = SUM(Transactions[Amount])<br>  — Commitments = SUM(Commitments[CommitmentAmt])<br>  — RemainingBudget = [Budget] - ([Actual] + [Commitments])<br>  — VarianceAmt = [Actual] - [Budget]<br>  — VariancePct = DIVIDE([VarianceAmt], [Budget], BLANK())<br>  — Flag = IF(ABS([VariancePct]) >= 0.10, 1, 0)<br>• <strong>Visual suggestions:</strong> project overview KPI cards (Budget/Actual/Remaining/Variance%), activity table with conditional formatting on VariancePct, timeline run-rate chart (cumulative actual vs profile), remediation action grid with status and link to evidence, and a transaction drill-through page. <br>• <strong>Performance tips:</strong> keep visuals simple, avoid too many visuals per page, prefer aggregated precomputed tables, and reduce column cardinality for slicers (use numeric keys + label lookups). </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Security, compliance & attachments handling</strong><br>• Do not import binary attachments into Power BI. Instead store attachments in a secure document repository (SharePoint/OneDrive/Documentum) and store reference URLs + GUIDs in the staging DB. Power BI visuals can open those links (ensure links require authentication and respect document permissions).<br>• Use Azure AD / service principals for secure API authentication; rotate service credentials and restrict scope. For on-prem databases use the On-Premises Data Gateway and Windows/Azure AD credentials as per policy. Where available, prefer OAuth2 for Unit4 API/extension-kit integrations. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Real-world pitfalls & mitigations</strong><br>1. <strong>Direct OData/ODBC to Power BI is brittle at scale.</strong> Mitigation: use a staging database and ETL for resilience and repeatability; schedule incremental extracts and keep raw export logs.<br>2. <strong>High-cardinality visuals slow reports.</strong> Mitigation: pre-aggregate, use numeric keys and filter contexts, minimise slicer cardinality, and prefer aggregated tables for heavy visuals.<br>3. <strong>Auth/scoping problems with Unit4 APIs.</strong> Mitigation: provision a least-privilege service account or service principal, use the Unit4 Extension Kit where appropriate, and test integration in non-production first.<br>4. <strong>Attachment access for auditors.</strong> Mitigation: store attachments in a stable archive, include attachment metadata in audit exports, and avoid relying on expiring links for retention/archive access. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Operational runbook snippets (copy-paste ready)</strong><br>• Daily: Check extraction job status (success/fail); if fail, open ticket and notify FinanceOps.<br>• Weekly: Validate S13 extract sample rows vs Agresso S13 report; confirm no structural changes.<br>• Monthly (pre-close): run full reconciliation S13 vs GL and resolve reconciling items before Power BI full refresh. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Suggested vendor / connector options (practical accelerators)</strong><br>• Arribatec — Unit4 / Power BI connector to accelerate extraction and mapping.<br>• Alumio — integration platform for enterprise orchestration.<br>• TimeXtender — data automation / data warehouse adapters with Unit4 support.<br>Use vendor adapters as accelerators only; validate schema, data quality, incremental-change behaviour and retain raw extracts for audit. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Acceptance & governance for the Power BI solution</strong><br>• UAT acceptance criteria: dashboards reconcile Budget, Actual, Commitments and Variance to S13 within an agreed tolerance (example: 0.5% or £1,000).<br>• Governance: maintain a BI change log, dataset schema versioning, a contact list for emergency changes to Unit4 exports, and schedule quarterly reviews of model logic, DAX measures and thresholds. </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>References & evidence (practical guidance)</strong><br>• Unit4 REST & API documentation (use for secure extracts and supported endpoints).<br>• Unit4 Extension Kit / FP&A extraction guidance (use if available for structured exports).<br>• Vendor connector documentation (Arribatec, Alumio, TimeXtender) — treat as implementation accelerators and verify outputs.<br>• Agresso S13 Budget vs Actual report guidance — use S13 as the authoritative mapping for Budget vs Actual fields.<br>(When implementing, refer to the official Unit4/Agresso documentation and your institution’s IT/security policy.) </td></tr><tr><td data-label="Accounting / Finance Tips — Oxford FMS (Agresso) — Power BI implementation"> <strong>Immediate deliverables I can produce now (pick one)</strong><br>1. Production-grade Power BI dataset design (star schema + table definitions + incremental refresh policy) — CSV/JSON friendly.<br>2. SQL transform script templates to generate FactBudget, FactActuals and FactCommitments from raw Unit4 extracts.<br>3. Power BI report structure (page-by-page visuals, filters, DAX measures) ready for a report developer to implement.<br>4. Exportable CSV sample mapping (S13 → staging) with 6–10 realistic sample rows for validation. </td></tr></tbody></table></div><div class="row-count">Rows: 38</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>