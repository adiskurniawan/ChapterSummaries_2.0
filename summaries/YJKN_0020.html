<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1769960840">
<link rel="stylesheet" href="assets/overrides.css?v=1772215211">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="YJKN_0020_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Staff Cost Allocation — Technical User Guide"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Staff Cost Allocation — Technical User Guide</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Objective & scope — comprehensive</strong><br>Provide a mandatory, auditable, operationally actionable and implementation-focused method to allocate staff labour costs to cost centres, projects and donor budget lines so payroll expense is: (1) recognised on an accrual basis in the period services were rendered; (2) apportioned consistently to funding sources and donor rules; (3) traceable for statutory, internal and donor audit; and (4) controllable through automated validations, role-based approvals and documented exception handling.<br>This guide applies to all payroll-managed workers (local national staff, international staff, expatriates, secondees, interns, apprentices) and covers base salary, allowances, employer costs, benefits-in-kind (BIKs), reimbursements and payroll-related statutory charges. Contractors and vendors paid through Accounts Payable are out of scope unless the contract explicitly treats payments as payroll — such arrangements must be documented and escalated to Tax/Legal.<br>Assumptions: integration or data exchange points exist between HR master system (HROS), time/effort capture, payroll engine and the general ledger (GL). Where integration is not present, equivalent manual controls and increased sampling are mandatory. This guide complements Chapter 9 — Staff Payroll and Benefits and is intended as the operational playbook for finance, HR and programme teams. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Governance & control principles — extended</strong><br>1. Accrual & matching: recognise payroll expense in the period staff provided services; match costs and funding to correct cost objects; ensure salaries, employer taxes and statutory charges are recorded consistently.<br>2. Segregation of duties: prepare, review/authorise, and pay must be distinct roles; enforce separation in system roles and bank authorization; rotate roles periodically to reduce fraud risk.<br>3. Principle of least PII exposure: present only necessary payroll detail to budget-holders; use anonymised dashboards and encrypted payroll packs; restrict access by role and certify periodically; log and review access patterns monthly.<br>4. Defence-in-depth controls: pre-flight validation, independent reviewer sign-off, dual payment sign-off and post-run reconciliation (control sheet ↔ bank ↔ GL); maintain an incident register for control failures.<br>5. Donor precedence and documentation: donor award terms take precedence on allocation and evidence requirements; where donor rules differ, document deviation analysis and approval in payroll pack and notify regional grants/compliance function. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Primary allocation methods — algorithms, formulas, examples & rules</strong><br><strong>Method A — FTE-based allocation</strong><br>Formula: Allocation% = (Assigned FTE to cost code / Employee FTE) × 100.<br>Worked example: 1.0 FTE; 0.6 to Project A, 0.4 to Admin; Gross USD 3,000 → Project A 1,800; Admin 1,200.<br>Rules: record default FTE in HROS; enforce change cut-off; require contract support if FTE changes frequently; reconcile FTE changes monthly to HR records.<br><strong>Method B — Time-based allocation (timesheets / effort reports)</strong><br>Formula: Allocation% = (Hours charged to cost code / Total paid hours) × 100.<br>Worked example: 160 paid hours; 40 hours to Project B → 25% → USD 600 if gross USD 2,400.<br>Rules: require contemporaneous capture, supervisor sign-off, donor templates where applicable, and electronic retention of timestamps; enforce minimum supporting granularity for donors (daily/weekly as specified).<br><strong>Method C — Fixed contractual split</strong><br>Formula: use contract-specified percentages.<br>Worked example: 70/30 split of gross USD 4,000 → HQ 2,800; Project 1,200.<br>Rules: store contract clause in master file and require HR sign-off for new contracts with non-standard splits; record effective dates and version history.<br><strong>Method D — Driver-based allocation</strong><br>Formula: Allocation% = (Driver units for project / Total driver units) × 100.<br>Worked example: beneficiary counts 120 vs 80 -> 60%/40% split. Apply only where driver reliably proxies effort; document driver source and extraction query; retain raw driver data and transformation logic for auditors.<br><strong>Method E — Hybrid</strong><br>Pattern: fixed core allocation + variable remainder (e.g., 50% fixed admin + 50% timesheet). Provide a worked example and include rounding rules and tie-breaker logic for cents; document the hybrid formula for each role where used. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Roles & responsibilities — RACI, signatures & evidence</strong><br><strong>HR:</strong> maintain master data, contracts, FTE and role-mapping; provide joiner/leaver notices by cut-off; maintain change logs and evidence of approvals for master data changes.<br><strong>Payroll preparer:</strong> construct payroll control sheet, apply allocation logic, run pre-flight checks, prepare GL upload preview, compile payroll pack draft and highlight exceptions.<br><strong>Budget-holder:</strong> validate and sign apportionment; provide effort evidence for donor-charged staff; retain evidence in local repository and attach to central payroll pack.<br><strong>Independent reviewer / CFD:</strong> perform arithmetic checks, sample verification, statutory tax check and final sign-off; escalate material exceptions to CD and document reviewer sampling methodology.<br><strong>Payments officer / Treasury:</strong> prepare bank file, enforce DoA dual sign-off, obtain bank confirmations (MT103/SWIFT) and provide files for archiving; validate new payee additions via bank positive-pay where available.<br><strong>Internal Audit / Compliance:</strong> periodic testing, control effectiveness reviews, and follow-up on high-risk exceptions; maintain audit trail of findings and remediation status.<br>Evidence required: electronic approver proof (email/DocSign/portal with timestamp), reviewer sign-off, bank confirmations (MT103/SWIFT), GL upload preview and posted confirmation, timesheets/effort reports, contracts, DPA with payroll providers and exception log entries. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Required inputs & minimum documentation (per employee + per run)</strong><br>Per employee: EmployeeID, PayrollRunID, Contract/ContractID, grade, salary, FTE, tax ID, bank details (stored encrypted), allocation method, allocation % per cost code, employer costs and deduction details, timesheet/evidence (if used), approver evidence (signed or portal), any secondment/seconding agreement.<br>Per run: Payroll control sheet with totals and sign-offs; apportionment schedule (CSV) with validation checksum; GL upload preview; bank batch file and bank confirmations; statutory remittance summary and payment receipts; exception log with owner and status; payroll pack index and file checksums; change log for any post-cut-off amendments. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Apportionment lifecycle — chronological steps & timeframes</strong><br>1. Publish payroll calendar (annual) with cut-offs for HR changes, timesheets and apportionment approvals; include contingency run dates and SLA for approver response.<br>2. HR master data cut-off: lock all substantive HR changes; record emergency change process (CD/CFD approval required) and a separate "emergency changes" appendix to the pack.<br>3. Pre-run: preparer applies allocation rules and generates apportionment schedule; automated pre-flight validations executed and validation report attached.<br>4. Budget-holder approval: delivered via secure portal/email with unique approver ID; approval evidence captured and attached to apportionment row.<br>5. Independent review: sample checks and sign-off recorded with reviewer notes and sampling criteria documented.<br>6. Payment preparation: payments officer compiles bank file, ensures dual sign-off and records bank batch ID; where applicable perform bank positive-pay pre-checks.<br>7. GL posting: upload apportioned journals, store upload preview and posted confirmation, attach system logs showing uploader and time.<br>8. Reconciliation: control sheet totals reconciled to GL and bank; reconcile employer liabilities and statutory remittances; log reconciling items with owners and remedial due dates.<br>9. Archive: save payroll pack indexed by PayrollRunID, tag retention metadata, generate manifest file with checksums and store copies in secure backup. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Apportionment schedule — CSV schema, validation & examples</strong><br><strong>CSV schema (recommended):</strong> payrollrunid, period_yyyymm, employeeid, employeename (redacted in shared pack), contracttype, fte, gross_salary, employer_costs, deduction_total, net_pay, allocation_method, costcode_1, costcode_1_pct, costcode_1_amt, costcode_2, costcode_2_pct, costcode_2_amt, costcode_3, costcode_3_pct, costcode_3_amt, total_apportioned_amount, approver_id, approval_timestamp, donor_flag, donor_id, donor_budget_line, notes, row_checksum.<br><strong>Validation rules:</strong> total_apportioned_amount must equal base (gross_salary or gross+employer_costs as per policy); donor_flag requires donor_id and approver evidence; all cost codes must exist in cost code master; FTE within valid range (e.g., 0.1–2.0 depending on contract); no negative amounts; row_checksum must match file-level manifest.<br><strong>CSV sample row:</strong> PR202602,202602,E0123,Adi Setyadi,Local,1.0,3000.00,450.00,600.00,2850.00,time,PROJ_A,60,1800.00,ADMIN,40,1200.00,,3000.00,BH001,2026-02-18T09:23:00Z,N,,650101,"Timesheet ref TS202602_005",abc123checksum </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Accounting treatment — approaches, worked numeric examples & rounding</strong><br><strong>General principle:</strong> recognise expenses on accrual basis for the period rendered and ensure postings map to cost codes. Include PayrollRunID and period in all narration and filenames; include GL upload ID and bank batch ID as meta in payroll pack.<br><strong>Approach 1 — Aggregate accrual then distribution:</strong> post aggregate gross+employer costs to an accrued liability and then distribute by cost code. Use when GL systems do not permit per-employee coding.<br><strong>Approach 2 — Direct apportioned accruals:</strong> post per-employee apportioned accruals directly to expense cost codes when system supports it; preferred for audit traceability and donor reporting.<br><strong>Numeric example (with clear arithmetic):</strong> Employee gross USD 3,000, employer costs USD 450, employee deductions USD 600, net USD 2,400. Allocation 60% Project A, 40% Admin.<br>Approach A Journals:<br>1) Accrual aggregate: Dr Payroll Expense — Unallocated 3,450 — Cr Accrued Payroll Liability 3,450. Narration: "Accrual PR202602 — E0123 — Gross 3,000 Employer 450 — CountryXYZ".<br>2) Distribution: Dr Project Expense — PROJ_A 2,070 — Cr Accrued Payroll Liability 2,070. Dr Admin Expense 1,380 — Cr Accrued Payroll Liability 1,380. Narrations include PRID and Employee range when batched.<br>3) Payment: Dr Accrued Payroll Liability (net clearing) 2,400 — Cr Bank 2,400. Narration: "Net pay PR202602 — BankBatch BB20260215".<br>4) Statutory remittance: Dr Accrued Taxes 600 — Cr Bank 600. Narration: "PAYE remittance PR202602".<br><strong>Rounding rules:</strong> define rounding to nearest cent for per-employee splits; reconciliation of rounding variances posted to a controlled rounding GL account; include monthly review of rounding GL with threshold to force corrective action if cumulative rounding exceeds set limit. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Journal narration & filename policy — mandatory fields & templates</strong><br>Every journal and filename must include: PayrollRunID (PRYYYYMM), period (YYYYMM), country code, total gross, currency, GLUploadID and bank batch ID where applicable. Use consistent filename patterns and avoid special characters in filenames.<br><strong>Narration examples:</strong> "Accrual PR202602 — Period 202602 — CountryXYZ — Gross USD 125,000 — PR202602 — GLUpload UPL20260203". "Apportionment PR202602 — E0123–E0180 — PROJ_A 60% — ADMIN 40% — USD 34,500 — GLUpload UPL20260203".<br><strong>Filename examples:</strong> Payroll_PR202602_CountryXYZ_202602_ControlPack_PR202602_v1.pdf; Apportionment_PR202602_CountryXYZ_202602_v1.csv; GLUploadPreview_PR202602_CountryXYZ_202602_UPL20260203.xlsx; BankBatch_PR202602_BB20260215.txt. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Donor-funded staff — obligations, templates & audit-ready examples</strong><br><strong>Evidence standards:</strong> contemporaneous signed timesheets or donor-specific effort templates; supervisor and budget-holder approvals; mapping table from donor budget line to GL code; retention of donor guidance clauses in payroll pack and reference to award terms where applicable.<br><strong>Worked example:</strong> Employee E300 gross USD 4,000: Donor A 25% = USD 1,000 (GL 650101), Donor B 25% = USD 1,000 (GL 650205), Admin 50% = USD 2,000 (GL 610001). Retain signed timesheet TS202602_001; budget-holder BH_DonorA approval email 2026-02-18 attached; GL posting with narration referencing PR202602 and donor GL 650101; reconcile donor billing schedules where recharges to donor-managed budgets are required.<br><strong>Donor audit pack:</strong> bundle: mapping table, apportionment rows for requested period, signed timesheets, approver emails/portal evidence, GL lines with PRID, bank confirmations for net payments, statutory remittance receipts where employer costs recharged; include cross-reference index, checksums and short variance explanations for unusual items. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Validation & controls — pre-/post-run checks, sample rates & automated rules</strong><br><strong>Pre-run automated checks (minimum):</strong> mandatory fields present, allocation total check per employee equals chosen base, donor approvals present for donor_flag rows, cost code existence validation, FTE bounds validation, employer_costs presence if employer costs included in base.<br><strong>Sample rates for independent review:</strong> recommend minimum 10% of employee population or top 20 highest salaried employees or all donor-funded staff, whichever yields higher audit coverage. Prioritize new joiners, leavers, employees with advances and allocation changes >20% vs prior month or unusual one-off allocations (bonuses, severance).<br><strong>Automated guardrails:</strong> block GL upload if allocation totals mismatch; flag allocation variance >threshold (e.g., 20% vs prior month) and route to CFD for review; require approver identity hashed and stored with timestamp; implement automated email reminders and escalation if approver not actioned within SLA. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>System design patterns & pre-flight pseudocode</strong><br><strong>Pre-flight logic (pseudocode):</strong><br>for each employee_row in apportionment_csv:<br> &nbsp;&nbsp;&nbsp;&nbsp;if sum(employee_row.costcode_amounts) != base_amount: reject_row("Apportioned totals mismatch")<br> &nbsp;&nbsp;&nbsp;&nbsp;if employee_row.donor_flag == 'Y' and employee_row.approver_id is null: reject_row("Missing donor approver")<br> &nbsp;&nbsp;&nbsp;&nbsp;if percent_change_from_prior_month(employee_row) > threshold: flag_for_cfd_review(employee_id, percent_change)<br> endfor<br>if any(rejection): halt_gl_upload and return validation_report<br><strong>Integration design note:</strong> store pre-flight validation report as JSON with error codes, row level hashes and file checksum; attach report and signed manifest to payroll pack for audit traceability. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Reconciliation strategy — matching rules & SLA</strong><br><strong>Matching rules:</strong> control_sheet.gross_total = sum(apportioned_amounts) (or gross+employer if policy selects that base). GL_posted_total must equal control_sheet.gross_total within defined tolerance. Bank_net_payments must equal GL net pay clearing within tolerance. Statutory remittances recorded and reconciled to accrual balances. Intercompany recharges must reconcile to centre-led postings within monthly SLA.<br><strong>SLA & remediation:</strong> reconciling items should be investigated within 3 business days and closed within 7 business days; items older than SLA escalate to CFD and Internal Audit. Maintain reconciliations with owner, status, and evidence links in the payroll pack manifest. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Common allocation errors — root cause analysis & fixes</strong><br><strong>Error 1 — Missing donor approver:</strong> cause: approver absent or process not enforced. Fix: enforce hard-stop in upload workflow for donor_flag rows; implement approver reminder workflow; assign alternate approver list and escalate to CD after SLA.<br><strong>Error 2 — Wrong period posting:</strong> cause: preparer applied wrong period in GL narration or used incorrect PRID. Fix: require PayrollRunID validation in GL upload script; reject uploads without PRID; add automated check comparing payroll file period to GL posting period.<br><strong>Error 3 — HROS mapping mismatch:</strong> cause: mapping table outdated or role changed without mapping update. Fix: schedule monthly mapping reconciliation and require version-controlled mapping file; include mapping change approvals in HR change log. Record all fixes in exception log and include corrective journals with approvals in payroll pack. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Templates & master files — recommended inventories</strong><br>Maintain centrally and version-control these templates: Payroll Control Sheet (master); Apportionment Schedule CSV (spec and example rows); GL Upload Template / GLACOS mapping; Effort Report / timesheet templates (donor-specific variants); Advance Request & Recovery Form; Payroll Reconciliation Worksheet; Exception Log template; Payroll Pack Index template; Approver escalation contact list; Standard GL narration library. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>KPIs & dashboards — definitions, formulas and monitoring</strong><br><strong>Core KPIs:</strong> Payroll Approval Coverage = (#employees with signed apportionment / total employees) ×100; Apportionment Reconciliation Variance % = SUM(<code>|apportioned_totals - base|</code>) / base_total ×100 (Target: ≤0.01%); Exception Resolution Time = avg(days from logged -> closed) (Target ≤7 days); % payroll via bank/mobile = net_paid_via_bank_or_mobile / total_net_payments ×100 (Target ≥95%).<br><strong>Dashboard views:</strong> run-level view (PRID), budget-holder view (cost centre filter), donor view (donor filter), exception heatmap, top 20 payroll variances, trending of rounding GL, outstanding advances as % of payroll. Alert thresholds should generate tickets automatically for CFD or Payroll Manager and include SLA timers. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Systems & automation opportunities — prioritized projects & acceptance criteria</strong><br><strong>Priority 1 — HROS → Payroll integration</strong> Acceptance: master data sync within 24 hours, default cost code mapping editable, change log with user & timestamp, ability to lock master data at cut-off programmatically.<br><strong>Priority 2 — Timesheet → Apportionment auto-draft</strong> Acceptance: timesheet entries automatically produce apportionment draft 5 business days pre-pay, with approver notification and single-click approval option; approver audit saved as hash.<br><strong>Priority 3 — GL automation with pre-flight validation</strong> Acceptance: generate GL upload file, run validations, produce preview, allow rollback within 8 business hours, attach upload confirmation to payroll pack and generate reconciliation report automatically.<br><strong>Priority 4 — Approval workflow with SSO and signature hash</strong> Acceptance: approver identity validated via SSO, signature hash stored, approval audit accessible for retention period and exportable to auditors. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Implementation checklist — owners, timelines & governance</strong><br><strong>Immediate (0–3 months):</strong> standardise apportionment template (Payroll Manager); publish payroll calendar & cut-offs (CFD & HR); enforce pre-flight validation script (IT/Payroll); require electronic approval trail (HR/IT); distribute revised SOPs and quick-start guides.<br><strong>Short term (3–6 months):</strong> implement donor-flag enforcement and reminder workflows; configure dashboard KPIs; run pilot timesheet imports for one business unit and evaluate exception drivers.<br><strong>Medium (6–12 months):</strong> integrate HROS-timesheet-payroll; automate GL uploads and reconciliations; run payroll health-check and remediate top findings; implement bank positive-pay where available.<br><strong>Governance cadence:</strong> monthly payroll governance meeting with HR, Payroll, CFD, Treasury and Programme leads including a standing agenda for exceptions, system issues, donor risk and audit points; quarterly review of policy and system change requests. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Escalation & exception handling — thresholds, owners & templates</strong><br><strong>Escalation thresholds (example USD):</strong> Minor: <500 — Payroll Manager (log & correct); Medium: 500–5,000 — CFD approval required (document rationale in pack); High: >5,000 or donor-ineligible — CD + CFD + HR + Legal sign-off and donor notification if required. For local currencies convert thresholds using monthly FX reference and record FX used.<br><strong>Exception log sample fields:</strong> ExceptionID, PayrollRunID, EmployeeID, Description, Amount, Severity, Owner, DateLogged, ActionRequired, ResolutionDate, EvidenceLink, Status, SLAExpiry. Track SLA and ageing; produce weekly exception dashboard. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Retention, archival & privacy — policy & retention matrix</strong><br><strong>Retention baseline:</strong> retain payroll packs and supporting evidence per local statute (commonly 6–10 years). For jurisdictions with longer statutory retention, follow local law. If local law restricts PII retention, retain anonymised summary data and delete PII per deletion schedule. Maintain deletion log and certificate.<br><strong>Metadata to store:</strong> PayrollRunID, Country, Period, PreparerID, ReviewerID, DatePosted, GLUploadID, BankBatchID, FileChecksum (SHA256), RetentionEndDate, Location (on-prem/cloud).<br><strong>Data deletion controls:</strong> scheduled purge job with two approvers for irreversible deletion and a retained deletion log for audit; encrypt archived files and rotate encryption keys per security policy. </td></tr></tbody></table></div><div class="row-count">Rows: 20</div></div><div class="table-caption" id="Table2" data-table="YJKN_0020_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Staff Cost Allocation — Technical User Guide"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Staff Cost Allocation — Technical User Guide</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix A — Detailed worked apportionment examples (multi-employee & edge cases)</strong><br><strong>Example A — Three-cost-code split including employer costs</strong><br>Employee E045: Gross 3,200 USD, Employer costs 480 USD, allocate: PROJ_ALPHA 50%, PROJ_BETA 30%, ADMIN 20%. If employer costs included in base: Base = 3,200 + 480 = 3,680. PROJ_ALPHA = 1,840; PROJ_BETA = 1,104; ADMIN = 736. Rounding: apply to two decimals; reconcile rounding variances to Rounding GL. Approver BH_ALPHA 2026-04-18T09:12Z.<br><strong>Example B — Overtime allocation rule</strong><br>Standard rule: overtime hours are charged to the project where overtime worked unless policy states employer covers overtime centrally. Employee E200 gross (base) 2,400; overtime pay 300 (allocated separately). If employee worked overtime 20 hrs on ProjectX (overtime line charge), allocate overtime 100% to ProjectX and base salary according to usual allocation. Document overtime authorisation and timesheet entries in payroll pack. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix B — Expanded journal examples & consolidated country month</strong><br><strong>Consolidated example (country month):</strong> Gross 200,000; Employer costs 32,000; Employee deductions 40,000; Net to bank = Gross - Employee Deductions = 160,000 (note: employer costs are separate accrual).<br><strong>Aggregate accrual:</strong> Dr Payroll Expense Unallocated 232,000 — Cr Accrued Payroll Liability 232,000. Narration: "Accrual PR202604 CountryXYZ Gross 200,000 Employer 32,000".<br><strong>Distribution:</strong> Dr Project 650101 100,000 — Cr Accrued 100,000. Dr Project 650205 40,000 — Cr Accrued 40,000. Dr Admin 610001 92,000 — Cr Accrued 92,000. Narrations include PRID and GLUploadID.<br><strong>Payment:</strong> Dr Accrued NetPay Clearing 160,000 — Cr Bank 160,000. <strong>Statutory payments:</strong> Dr Statutory Liabilities 40,000 — Cr Bank 40,000. Ensure narration includes PRYYYYMM, BankBatch and supporting reference to payroll pack. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix C — Excel formulas, macros & validation scripts (practical)</strong><br><strong>Essential formulas:</strong> Percent check: =IF(ROUND(H2+J2+L2,2)=100,"OK","PCT_MISMATCH") where H2/J2/L2 are percentage columns. Amount check: =IF(ABS(SUM(I2:K2)-BaseAmount)>0.01,"AMT_MISMATCH","OK"). Rounding reconciler: RoundingDiff = BaseAmount - SUM(AllocAmtColumns); if abs(RoundingDiff) <= rounding_tolerance then post to RoundingGL else flag.<br><strong>Macro pseudocode:</strong> iterate rows -> run validations -> create error report sheet -> export approver reminder list -> generate JSON validation file for archive -> compute summary KPIs for dashboard. Provide macro documentation: inputs, outputs, error codes, owner and scheduled run frequency. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix D — SQL query library for control & reporting (extended)</strong><br><strong>Query 1 — Missing approver list:</strong> SELECT payrollrunid, employeeid, gross FROM apport_schedule WHERE approverid IS NULL AND payrollrunid='PR202602';<br><strong>Query 2 — Apportionment mismatch:</strong> SELECT payrollrunid, employeeid, gross, SUM(apportioned_amt) AS apportioned_sum FROM apport_schedule_lines WHERE payrollrunid='PR202602' GROUP BY payrollrunid, employeeid HAVING ROUND(SUM(apportioned_amt)-gross,2)<>0;<br><strong>Query 3 — Donor-funded without timesheet:</strong> SELECT a.employeeid, a.payrollrunid FROM apport_schedule a LEFT JOIN timesheet t ON a.employeeid=t.employeeid AND a.period=t.period WHERE a.donorflag=1 AND t.employeeid IS NULL;<br><strong>Query 4 — Allocation change >20% vs prior month:</strong> SELECT cur.employeeid, cur.payrollrunid, cur.totalapportioned, prev.totalapportioned, ROUND((cur.totalapportioned-prev.totalapportioned)/prev.totalapportioned*100,2) AS pct_change FROM apport_summary cur JOIN apport_summary prev ON cur.employeeid=prev.employeeid AND prev.period=cur.period-1 WHERE ABS((cur.totalapportioned-prev.totalapportioned)/prev.totalapportioned) > 0.2;<br><strong>Query 5 — Outstanding advances by employee:</strong> SELECT employeeid, SUM(advance_balance) FROM advances WHERE status='open' GROUP BY employeeid HAVING SUM(advance_balance) > X;<br><strong>Query 6 — Top donors by payroll charge:</strong> SELECT donor_id, SUM(apportioned_amt) FROM apport_schedule_lines WHERE period BETWEEN '202601' AND '202612' GROUP BY donor_id ORDER BY SUM(apportioned_amt) DESC; </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix E — Control matrix, frequency & sample evidence</strong><br><code>Control | Frequency | Owner | Evidence required&lt;br&gt;Master data change approval | On change | HR | HROS change log entry with approver</code><br><code>Apportionment approval | Per run | Budget-holder | Signed apportionment / portal evidence</code><br><code>Pre-flight validation report | Per run | Payroll/IT | Validation output file attached to pack</code><br><code>Independent review sign-off | Per run | CFD | Signed control sheet with sample list</code><br><code>Bank batch confirmation | Per run | Treasury | Bank MT103/SWIFT confirmation</code><br><code>GL upload confirmation | Per run | Finance | System posted confirmation / upload ID</code><br><code>Periodic access review | Quarterly | IT/HR | Access certification report</code> </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix F — Donor audit scenario & response pack (expanded)</strong><br><strong>Audit request example:</strong> Provide evidence for labour charged to DonorX for FY2025.<br><strong>Deliverable pack:</strong> mapping table DonorX budget → GL codes; list of payroll runs with PRIDs; for each run, apportionment rows that include DonorX; signed timesheets/effort reports; approver emails; GL lines with PRID narration; bank confirmations; variance reconciliation and an index with checksums.<br><strong>Formatting tip:</strong> provide a pivot-ready excel showing period, employee, gross charged to donor, approver, evidence link and GL line number to speed auditor testing; include a short narrative of methodology and top reconciling items. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix G — Special cases & policies (detailed operational rules)</strong><br>Secondment / hosted staff: maintain a written secondment agreement defining financial responsibility; post intercompany clearing journals monthly; reconcile to centre ledger; retain secondment agreement in payroll pack.<br>Expatriates & tax equalisation: determine tax residency, compute tax equalisation adjustments per policy, determine home/host charge share. Obtain tax adviser memo for complex cases and store in pack.<br>Benefits-in-kind (BIK): document valuation method (market rent, taxable fringe formula), include taxable BIK in payroll tax base if required by law, and decide project charging basis (project vs central). Example: housing market rent USD 500/month; taxable BIK included in gross for tax computations and apportioned as per employee allocation rules unless donor or policy requires alternative treatment. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix H — Exception templates, remediation & sample wording</strong><br>Exception log entry example: <code>EX202604_001 | PR202604 | E078 | Overapportioned to PROJ_X by USD 750 due to data-entry error | 750 | Medium | PayrollPreparer | 2026-04-02 | Corrective journal PRJV202604_015 approved by CFD</code>; HROS mapping corrected; <code>payroll pack updated | 2026-04-04 | link-to-evidence.pdf</code><br>Remediation sample narrative: "Corrective journal PRJV202604_015 reverses misposted amount and re-posts to correct cost code PROJ_Y; rationale and CFO approval attached; root cause: mapping error; action: mapping review monthly." </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix I — Training curriculum, delivery & assessments</strong><br>Modules & outcomes: Payroll fundamentals & accruals; Apportionment methods & donor evidence; System procedures: HROS, timesheet, payroll, GL uploads and pre-flight validations; Controls, fraud detection & data protection: red flags, incident reporting and PII handling.<br>Delivery: e-learning + hands-on tabletop payroll run exercises quarterly; role-specific workshops; maintain LMS certification records; include practical assessments with a pass threshold and retention of training evidence. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix J — Risks, mitigation & change control</strong><br>Top risks: integration delays, donor disallowances, data breaches, manual error concentration and weak segregation of duties.<br>Mitigations: prioritise automation, run frequent reconciliations, enforce approval hard-stops, apply MFA and encryption, rotate duties and samples, maintain audit-ready packs and external health-checks. Implement change-control policy: any change to allocation rules, GL mapping or payroll calendar must pass a change committee with documented risk assessment, test plan and rollback plan. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix K — Full checklists (pre-run, run, post-run & archive)</strong><br>Pre-run: HR changes submitted & master data locked; timesheets collected & validated; advances ledger reconciled; apportionment draft produced; approvers notified; automated pre-flight validation passed.<br>During run: reviewer samples executed; bank batch created; dual sign-off obtained; GL upload preview generated and retained.<br>Post-run: control sheet reconciled to bank & GL; statutory remittance schedule updated; payslips distributed securely; payroll pack assembled & indexed; exceptions logged & owners assigned.<br>Archive: payroll pack uploaded to protected repository with retention metadata and checksum; deletion scheduled per policy and audit trail stored. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix L — Version control & change log standards</strong><br>Standards: never overwrite a signed control pack; always save new versions with _v2, _v3 suffixes; maintain change log entry with ChangeID, PayrollRunID, ChangedBy, ChangeDate, Description, ApprovalEvidence, ImpactedFiles, VersionFrom, VersionTo. Ensure each change references a reason and approval; retain prior versions for audit and provide diff summary when changes occur post cut-off. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix M — Expanded FAQs & operational clarifications</strong><br>Q: How to handle payroll for field staff in cash-only locations? A: Only where unavoidable; use pre-numbered envelopes, two-person custody, beneficiary signature, immediate reconciliation, scanned receipts uploaded to payroll pack and CD/CFD retrospective approval for exceptions. Consider mobile-money or agency banking where possible and include enhanced spot-check frequency.<br>Q: How to treat employer cost recharges to donors? A: Only when donor budget allows employer costs; document in mapping table and donor guidance; obtain budget-holder approval and reflect in apportionment schedule and GL mapping. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix N — Repository structure, metadata & access controls</strong><br>Folder template: /PayrollArchive/<Country>/<Year>/<PayrollRunID>/{ControlPack.pdf,Apportionment.csv,GLUploadPreview.xlsx,BankBatch_BBYYYYMMDD.txt,StatutoryReceipts.pdf,ExceptionLog.xlsx,SampleEmployeeFiles/EmployeeID_*.pdf}.<br>Access: role-based, MFA enforced, PII redacted for budget-holders, full access limited to payroll admin and designated finance staff; quarterly access review and certification; maintain access revocation process upon staff exit. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix O — Copy-ready templates, emails & sign-off text</strong><br>Apportionment approval email template (to be stored as evidence): Subject: "Approval — Apportionment PR{PRID} — Cost Centre {CC}" Body: "I confirm I approve the apportionment PR{PRID} for the listed employees and % allocations: [list EmployeeIDs and %]. Approver: [Name], Cost Centre: [CC], DateTime: [ISO timestamp]." Save approver email or portal confirmation as evidence.<br>Reviewer sign-off template (pack): "Reviewer: [Name], Role: [CFD/delegate], PayrollRunID: PR{PRID}, Date: [ISO], Sample checks completed: [list], Exceptions found: [list], Sign-off: [digital signature or typed name]." </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix P — Governance checklist & recommended cadences</strong><br>Monthly: payroll governance meeting; reconcile intercompany & clearing; review exceptions older than SLA; update risk register.<br>Quarterly: payroll health-check, access certification and sampling audit; review training completion rates.<br>Annually: external payroll control review, policy refresh and system security penetration test for hosted payroll systems; update SOPs accordingly. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix Q — Intercompany & central processing patterns</strong><br>Centrally processed payroll (hosted by HQ/centre): country posts clearing entries to record net recharges; maintain SLA with centre for timing, data formats and reconciliation; country remains responsible for statutory compliance and must reconcile centre-led postings monthly. Intercompany journal example: Dr Project Expense (host country) — Cr Intercompany Payable (centre clearing) — centre posts reverse entry when cost recharged. Include PRID and clear description. Reconcile intercompany monthly and escalate differences >threshold. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix R — Integration interfaces & sample JSON payloads</strong><br>HROS → Payroll (employee master) sample JSON: { "employeeId": "E0123", "name": "Adi Setyadi", "contractId": "C123", "fte": 1.0, "defaultCostCodes": [{"code":"ADMIN","pct":40},{"code":"PROJ_A","pct":60}], "taxId":"TAX123", "bankAccount":"XXX-****-1234", "effectiveDate":"2026-02-01" }<br>Apportionment upload payload (sample): { "payrollRunId":"PR202602", "period":"202602", "apportRows":[ { "employeeId":"E0123", "gross":3000.00, "allocations":[ {"costCode":"PROJ_A","pct":60,"amt":1800.00},{"costCode":"ADMIN","pct":40,"amt":1200.00} ], "approverId":"BH001", "approvalTimestamp":"2026-02-18T09:23:00Z", "rowChecksum":"abc123" } ] }<br>Design note: include signature hash, source system ID, user ID, and file checksum; support idempotent uploads with upload UUID. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix S — Audit readiness checklist & sample responses to auditor queries</strong><br>Audit readiness checklist: payroll calendar, master data change log, apportionment schedules, effort reports, approver evidence, GL upload confirmations, bank confirmations, statutory remittance receipts, exception log, rounding policy, retention evidence and sample employee files.<br>Sample auditor response: Q: "Show evidence E0123 charged 60% to PROJ_A in Feb 2026." Provide: timesheet TS202602_005; apportionment CSV line for E0123 PR202602; GL posting line with PR202602 narrative; payslip PR202602_E0123; bank batch confirmation matching net pay; cross-reference index entry and checksums. Bundle as a zip and provide index spreadsheet for auditor navigation. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix T — Sample policy clauses & contract wording (practical text)</strong><br>Contract clause for fixed split: "The employee’s total working time shall be apportioned 70% to Headquarters functions and 30% to Project X. Employer reserves the right to adjust allocation for operational requirements subject to written notice and budget-holder approval." Data processing addendum (DPA) clause for payroll provider: "Provider shall process payroll PII solely on behalf of Controller, apply encryption at rest and transit, implement MFA and role-based access, obtain written sub-processor consent and produce SOC2-type report annually." Store executed DPA in payroll pack for outsourced providers. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix U — Example incidents & remediation case studies</strong><br>Incident 1 — Payroll fraud attempt (new payee): user added new bank account and attempted to change beneficiary. Detection: pre-flight positive-pay check and offline bank validation flagged mismatch. Response: stopped payment, initiated investigation, reversed unauthorized changes, notified bank and Law Enforcement if required; strengthened new payee process to require positive bank confirmation and two independent approvals. Document incident root cause, remediation steps and timeline in incident register.<br>Incident 2 — Donor query on unsupported allocation evidence: donor disputed charges due to missing contemporaneous timesheet. Response: search historical email approvals, reconstruct contemporaneous evidence (where possible) with signed supervisor confirmation, and agree remediation with donor where necessary; enhance policy to require donor-specified template going forward and issue retroactive corrective action plan. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix V — Roadmap for operational improvements (12–24 months)</strong><br>1. Automate identity-verified approver workflow with SSO and signature hash.<br>2. Full HROS-timesheet-payroll-GL integration to remove manual CSV handoffs.<br>3. Implement bank positive-pay service integration to reduce fraud risk and implement payee whitelists.<br>4. Build payroll analytics workspace: exception trends, donor coverage and reconciliation dashboards with drill-through to source evidence.<br>5. Annual external payroll control and statutory compliance review with remediation plan tracked to closure in governance tracker. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix W — Glossary & key definitions</strong><br>PayrollRunID: unique identifier per payroll run (format: PRYYYYMM or PRYYYYMMDD). Apportionment schedule: document specifying how employee gross is split across cost codes. DonorFlag: indicator that allocation lines charge donor-funded budgets; triggers stricter evidence rules. Employer costs: employer-side statutory charges and insurances; may be recharged to projects if allowed. GLACOS: example upload tool for GL posting (use local system equivalent). </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix X — Quick-reference operational cheat-sheet (one page)</strong><br>1. Lock master data at cut-off. 2. Generate apportionment draft from timesheets/FTE/fixed split/driver. 3. Obtain electronic budget-holder sign-off (attach evidence). 4. Independent reviewer executes sample checks and signs control sheet. 5. Post apportioned GL journals with PayrollRunID and reconcile to bank and GL. 6. Archive payroll pack with index and retention metadata. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix Y — Checklist for migrating to automated apportionment</strong><br>1. Review HROS cost code mapping and standardise naming conventions. 2. Define canonical apportionment base (gross only or gross+employer costs) and stick to it. 3. Implement pre-flight validation rules in middleware and raise blocking errors for mismatches. 4. Pilot timesheet auto-drafts in one business unit and measure exception rates. 5. Roll out automation with training, updated SOPs and an incident remediation SLA; measure KPI improvements and reduce manual rework. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix Z — Final governance & escalation matrix (summary)</strong><br>Daily: payments review and exception triage (Payments Officer & Payroll Manager). Weekly: reconciliation catch-up and exception closure (Payroll Manager & Finance). Monthly: payroll governance meeting and sign-off of pack (CFD, HR Head). Quarterly: internal audit sampling and access certification. Annually: external payroll control review and statutory compliance audit; update policies and training. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix AA — Multi-currency payroll & FX treatment</strong><br><strong>Principles:</strong> record payroll in functional currency; track gross/payments in local currency; translate accruals and employer costs at closing rate for month-end; record realised FX on payment date if bank rate differs from accrual translation.<br><strong>Process:</strong> store both local currency and functional currency columns in control sheet (Gross_LC, Gross_FC, FX_rate). Use consistent FX source (e.g., treasury feed, central bank) and record FX date and source in narration.<br><strong>Worked example:</strong> Local gross = IDR 30,000,000; FX rate 0.000064 (USD/IDR) → Gross_FC = USD 1,920. Employer costs calculated in local currency and converted at same rate. If payment executed at different rate, record realised FX gain/loss to FX clearing GL and reconcile monthly. Document FX policy in payroll pack. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix AB — Payroll provider SLA & control checklist (sample)</strong><br><strong>SLA components:</strong> uptime 99.5% for payroll runs, patching schedule, backup frequency (daily), data encryption standards, incident response SLA (4 hours P1), monthly reconciliation reports, quarterly SOC2 or equivalent reports, annual penetration test, data return & deletion on contract termination.<br><strong>Control checklist:</strong> access control logs delivered monthly, confirmation of sub-processor list, evidence of encryption (at rest/in transit), monthly reconciliation reports and signed SLA scorecard. Store SLA and evidence in procurement/policy folder and reference in payroll pack. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix AC — Data Protection Impact Assessment (DPIA) checklist for payroll</strong><br><strong>Checklist items:</strong> purpose of processing, categories of PII, lawful basis, data flows diagram, third-party processors, transfer outside jurisdiction, retention period, security controls, access controls, breach response plan, DPIA sign-off, mitigation actions and review dates. Attach DPIA to payroll pack when starting new vendor or significant process change. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix AD — Sample GL mapping table (copy-ready)</strong><br><code>Cost code | GL account | Description&lt;br&gt;PROJ_A | 650101 | Project A labour costs</code><br><code>PROJ_B | 650205 | Project B labour costs</code><br><code>ADMIN | 610001 | Central admin salaries</code><br><code>EMPCOST | 2140 | Employer social charges / pension accrual</code><br><code>ROUNDING | 999900 | Rounding &amp; misc small items</code>. Maintain a versioned mapping and change approval log. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix AE — Example audit Q&A & suggested evidence checklist</strong><br>Q: "How do you ensure payroll allocations match timesheets?" A: Provide process flow, pre-flight validation report, timesheet extracts linked to apportionment rows, approver evidence and sample reconciliations. Q: "What controls prevent new payee fraud?" A: Provide bank positive-pay policy, two-step payee authorisation records, bank confirmation, and incident log example. Maintain a short one-page evidence index for auditors. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix AF — Sample approver escalation email templates</strong><br>Subject: "Urgent: Approval required — Apportionment PR{PRID} — [Cost centre]" Body: "Dear [Name], Please approve apportionment PR{PRID} for payroll run [Period]. Items pending: [list EmployeeIDs]. Please approve via [portal/email] by [deadline]. Approver: [Automated signature info]." Save sent email and auto-reminder log into payroll pack. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix AG — Automated validation rules & regex examples</strong><br><strong>Rules examples:</strong> Tax ID format: regex '^[A-Z0-9\-]{5,20}$' ; Bank account masking check: '^.{0,4}****.*$' ; Email approver present: approver_email IS NOT NULL. Implement standardized error codes: ERR01 (MISSING_APPROVER), ERR02 (AMOUNT_MISMATCH), ERR03 (INVALID_COST_CODE). Store mapping of error codes to remedial actions in the validation report. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix AH — Implementation Gantt (high level)</strong><br>Month 0–1: Project kick-off, requirement gathering. Month 2–3: Template standardisation, pre-flight script deployment. Month 4–6: Pilot timesheet integration. Month 7–9: GL automation & approval workflow. Month 10–12: Roll-out & training, SLA with providers. Month 13–24: Optimisation, analytics, external health-check and closure report. Attach project RACI and milestone acceptance checklist. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix AI — Extended KPI formulas & dashboard fields</strong><br>Fields: PRID, period, total_gross, total_net, num_employees, num_donorfunded, approval_coverage_pct, apportionment_variance_pct, exceptions_open, avg_resolution_days, rounding_gl_balance. Alerts: apportionment_variance_pct > 0.01% triggers stop-and-review; exceptions_open > threshold triggers governance escalation. Maintain historic trend for 12 months for pattern analysis. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix AJ — Sample corrective journal templates & sign-off matrix</strong><br>Journal template: Date, PRID, From_GL, To_GL, Amount, Currency, Narration, PreparedBy, ReviewedBy, ApprovedBy, ApprovalTimestamp. Sign-off matrix: Minor corrections (<500) — Payroll Manager; Medium (500–5,000) — CFD; Major (>5,000) — CFD + CD + Legal. Attach signed corrective journal to exception entry. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix AK — Example tests for periodic control self-assessment</strong><br>Test 1: Random sample 25 employees — verify apportionment evidence exists and matches GL. Test 2: Run pre-flight validation script on historical file — check zero rejections after corrections. Test 3: Review access log for payroll pack for last month — ensure only authorised accounts accessed files. Record results, action plans and closure evidence. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix AL — Sample change request form for payroll rules</strong><br>Fields: ChangeID, RequestedBy, Date, CurrentRule, ProposedRule, Impact Assessment (Finance/HR/IT/Donor), Risk Rating, Test Plan, Rollback Plan, Approval (Change Committee), Implementation Date. Maintain change register and link to versioned templates. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix AM — Extended examples: severance, retro pay & prior period adjustments</strong><br>Severance: accrue when liability is probable and estimable; post accrual proportionally to cost codes for period worked unless policy requires central charging. Retro pay: document calculation basis, attach approval and post corrective journal with PRID referencing original period and note reason. Prior period adjustments: document and obtain CFO approval; provide narrative for auditors and ensure transparency in year-end packs. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix AN — Sample internal communication plan for payroll changes</strong><br>Audience: HR, Payroll, Budget-holders, Treasury, IT. Channels: email, portal, SOP repository, training webinars. Timeline: pre-announcement (T-30 days), detailed SOP (T-21 days), Q&A webinar (T-14 days), cut-over reminder (T-3 days). Monitor helpdesk tickets first 2 cycles and escalate unresolved items weekly. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix AO — Additional incident scenarios & recommended playbooks</strong><br>Scenario: Mass duplicate payments due to upload error. Playbook: stop uploads, isolate files, contact bank to pause payment processing, identify duplicates, reverse where possible, corrective journals, notify auditors and line managers, update pre-flight to prevent recurrence. Document timeline and root cause analysis. </td></tr><tr><td data-label="Staff Cost Allocation — Technical User Guide"> <strong>Appendix AP — Final operational reminders & governance checklist</strong><br>1. Always apply PayrollRunID in every artefact. 2. Keep a single source of truth for cost codes and mapping. 3. Prioritise donor-funded staff for evidence collection. 4. Use pre-flight automation to avoid manual errors. 5. Maintain exception register and trend analysis. 6. Conduct periodic external health-checks and pen tests for payroll systems. 7. Ensure cross-functional governance meetings are held on schedule and minutes are retained in payroll pack. </td></tr></tbody></table></div><div class="row-count">Rows: 42</div></div><div class="table-caption" id="Table3" data-table="YJKN_0020_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Payroll Officer Runbook"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Payroll Officer Runbook</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Payroll Officer Runbook"> 1. Payroll calendar & cut-offs<br>1.1 Publish payroll calendar with fixed HR, payroll-prep and bank cut-offs.<br>1.2 Lock master data at HR cut-off. </td></tr><tr><td data-label="Payroll Officer Runbook"> 2. Inputs collection (by HR before cut-off)<br>2.1 Master data: contracts, tax/ID, bank details, contract dates, salary/allowances.<br>2.2 Operational inputs: timesheets/effort reports, leave, overtime, advances/loan requests, approved manual payments. </td></tr><tr><td data-label="Payroll Officer Runbook"> 3. Master-data verification<br>3.1 Confirm HROS records match submitted inputs; capture auditable change log.<br>3.2 Flag missing/changed bank accounts or tax IDs for secondary validation. </td></tr><tr><td data-label="Payroll Officer Runbook"> 4. Build payroll run & control sheet (pre-run)<br>4.1 Create PayrollRun ID, period and filename.<br>4.2 Calculate gross earnings per employee (salary + allowances + premiums + overtime).<br>4.3 Apply employee deductions (advances, loan recoveries, garnishments).<br>4.4 Compute employer costs (social security, employer contributions) and benefits-in-kind valuation.<br>4.5 Prepare draft payroll control sheet with totals by cost centre/project. </td></tr><tr><td data-label="Payroll Officer Runbook"> 5. Calculate PPh 21 (monthly withholding) — algorithmic steps<br>5.1 Confirm employee tax residency and PTKP/exemptions.<br>5.2 Annualise taxable base where required (convert monthly gross to annual equivalent if policy/tax method requires).<br>5.3 Apply allowable deductions/exemptions to determine taxable annual income.<br>5.4 Apply progressive tax bands/formula to compute annual tax liability.<br>5.5 Convert annual tax liability to monthly withholding (or apply statutory monthly tables/method).<br>5.6 Withhold PPh 21 on payslip and record in statutory accruals; prepare remittance schedule and plumbing for payment proof. </td></tr><tr><td data-label="Payroll Officer Runbook"> 6. Independent review & authorisation (maker-checker)<br>6.1 Submit draft control sheet to Independent Reviewer (not the preparer).<br>6.2 Reviewer signs off (sample evidence checked) before payment approval. </td></tr><tr><td data-label="Payroll Officer Runbook"> 7. Bank payment preparation & dual sign-off<br>7.1 Prepare transfer file per bank format; validate payee list.<br>7.2 Obtain required dual-authorisation per DoA; store bank confirmations/SWIFT advices. </td></tr><tr><td data-label="Payroll Officer Runbook"> 8. Payslip production & secure distribution<br>8.1 Generate payslips showing gross, itemised deductions, PPh 21, employer costs and net pay.<br>8.2 Distribute via secure channel; log distribution and access. </td></tr><tr><td data-label="Payroll Officer Runbook"> 9. Post-run reconciliations & GL posting<br>9.1 Reconcile payroll control sheet ↔ bank advices ↔ GL.<br>9.2 Post accrual and payment journals; include PayrollRun ID and period in narration.<br>9.3 Retain GL upload preview and reconciliation evidence. </td></tr><tr><td data-label="Payroll Officer Runbook"> 10. Statutory remittances & filings<br>10.1 Schedule and remit PPh 21 and social security contributions on time.<br>10.2 File proofs/receipts in payroll pack; reconcile against accruals. </td></tr><tr><td data-label="Payroll Officer Runbook"> 11. Apportionment & donor evidence<br>11.1 Prepare apportionment schedule (FTE/%, fixed split), obtain budget-holder sign-off.<br>11.2 Retain effort reports/timesheets for donor audit linkage. </td></tr><tr><td data-label="Payroll Officer Runbook"> 12. Reporting, KPIs & continuous improvement<br>12.1 Produce monthly reconciliation and KPI reports (accuracy, SLA, exceptions).<br>12.2 Implement validation automation, remedial training and periodic payroll health-checks. </td></tr><tr><td data-label="Payroll Officer Runbook"> 13. Escalation & governance<br>13.1 Escalate unresolved or high-value issues to CFD/CD per escalation thresholds.<br>13.2 Retain evidence for audit and donor queries; participate in audit sampling. </td></tr><tr><td data-label="Payroll Officer Runbook"> 14. Immediate checklist (run-to-run) — quick actionable items<br>14.1 HR inputs locked at cut-off.<br>14.2 Control sheet prepared and validated.<br>14.3 Reviewer signed.<br>14.4 Bank file dual-signed.<br>14.5 Payslips distributed.<br>14.6 Reconcile bank ↔ GL ↔ control sheet.<br>14.7 Archive payroll pack. </td></tr><tr><td data-label="Payroll Officer Runbook"> 15. Why a Payroll Officer is required<br>15.0 Short answer: the payroll officer is required to run a controlled, auditable payroll process and to be the accountable owner of day-to-day payroll preparation — but not to personally perform every related task. Payroll control depends on clear role separation and shared responsibilities across HR, finance, payments and senior approvers.<br><br>15.1 Why you need a Payroll Officer:<br>- Single accountable owner for accuracy, timeliness and documentation of payroll runs.<br>- Ensures consistent application of tax/statutory rules (e.g., PPh 21), validation checks, payslip production and audit packs.<br>- Maintains the payroll control sheet, reconciliations and traceability (PayrollRun ID, file names, archives).<br>- Drives continuous improvement, training, and first-line incident response for payroll issues.<br><br>15.2 Typical ownership (RACI-style):<br>- HR — Owns master data (contracts, joiner/leaver, tax IDs, approved changes).<br>- Payroll Officer — Prepares payroll run, calculates gross-to-net (including PPh 21 calculation), produces payslips, compiles payroll control sheet and runs reconciliations.<br>- Independent Reviewer / Authoriser (Finance or designated reviewer) — Reviews & authorises control sheet (must not be the preparer).<br>- Country Finance Director (CFD) / Approver — Reviews material adjustments, signs high-value exceptions and owns month-end accounting treatment.<br>- Bank/Payments Officer — Prepares/executes bank transfer files and secures dual sign-off per DoA.<br>- Budget Holders — Approve apportionment and verify project coding.<br>- Treasury/Centre / Outsourced Provider — Handles central processing or intercompany clearing where applicable; country remains ultimately responsible.<br>- IT/Data Protection — Enforces security, access controls, backups and PII handling. </td></tr></tbody></table></div><div class="row-count">Rows: 15</div></div><div class="table-caption" id="Table4" data-table="YJKN_0020_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Complete Guide — BPA1 XML Import Format &amp; Excel Converter"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Complete Guide — BPA1 XML Import Format & Excel Converter</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Complete Guide — BPA1 XML Import Format & Excel Converter (single-column restart, single <code>&lt;br&gt;</code> line breaks)</strong><br><strong>Executive Overview (Purpose, Regulatory Context, Scope, Risk Framing, Intended Audience)</strong><br>This document is the authoritative operational, technical, governance, and audit reference for preparing, validating, converting, and uploading <strong>BPA1 (Bukti Pemotongan A1)</strong> data from XLSX/Converter format into XML compliant with e-Bupot 21 requirements. It is designed for enterprise-grade implementation across Payroll, HR Operations, Tax, Finance, Internal Audit, IT/Integration, and Compliance teams. The guide covers end-to-end processing gates (Export → Validate → Normalize → Calculate → Map → XML → Bundle → Staging → Production); validation framework architecture (schema + business rules + cross-record controls); deterministic calculation engine specification (including gross-up solver); numeric golden-file regression strategy; mapping governance & template change detection; full audit artefact lifecycle management; signoff sequencing & segregation of duties; API/ETL integration contracts; SLA/KPI monitoring and escalation mechanics; audit pack assembly requirements; and edge case regulatory handling. All numeric examples are expressed in IDR and structured to serve as regression test inputs. Primary risks addressed include portal upload blocking errors, inconsistent tax calculations, inadequate audit traceability, mapping drift, unauthorized manual overrides, incomplete previous-employer reconciliation, and rounding inconsistencies causing GL drift. Expected outcomes after implementation: reduction of blocking validation errors before production, deterministic calc_log reproducibility, fully documented signoff chain with SSO evidence, regression protection on mapping updates, production parse failure rate <5% per batch, and critical issue resolution SLA ≤ 3 business days. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Gate A — Controlled Export & Freeze (Deep Control Layer)</strong><br>Objective: establish immutable raw baseline and origin integrity.<br>Steps:<br>1) Export raw from payroll/HCM/Converter portal and save to workspace <code>{staging_root}/{YYYY}/{KPP}/{period}/{operator_ts}/raw/</code> with filename pattern <code>raw_export_{kpp}_{period}_{YYYYMMDD_HHMMSS}.xlsx</code>.<br>2) Compute SHA256 (<code>sha256_raw</code>) and verify after copy.<br>3) Create <code>export_metadata.json</code> including <code>operator_id, system_version, export_ts, source_system, hostname, template_sha256, period, kpp, sha256_raw, reason</code>.<br>4) Freeze controls: set file read-only, deny overwrite, log SSO export event id.<br>Gate A artefacts: <code>raw_export.xlsx</code>, <code>export_metadata.json</code>, <code>export_registry_entry.csv</code>.<br>Blocking condition: hash mismatch or unauthorized operator role.<br>Additional operational details: preserve original file timestamps, capture export query parameters, store a human-readable export summary in <code>export_readme.md</code>, and require operator attestation recorded as <code>attestation_{operator_id}.txt</code> with SSO event id.<br>For large exports (>100k rows) use chunked export with incrementing <code>part</code> suffixes and a manifest linking parts. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Gate B — Validator Engine (Schema + Cross-Field + Cross-Record)</strong><br>Validator layers: schema validation (columns, data types, length), business rules (NPWP length 15 after normalization; months sum ≤ 12; GrossUpFlag requires calc_log; WNA requires passport), cross-record rules (duplicate NPWP, components sum to gross, negative income exceptions).<br>Outputs: <code>validation_report.csv</code>, <code>validation_summary.json</code>, <code>error_heatmap.html</code>.<br>Severity mapping: CRITICAL (block), ERROR (must fix), WARNING (triage), INFO (log).<br>Escalation automation: notify Payroll Lead if > threshold criticals; auto-create tickets for CRITICALS with workspace links.<br>Implementation notes: validator accepts both CSV or XLSX; validator version logged in <code>validation_summary.json</code>.<br>Include optional strict-mode (blocks on any warning) and permissive-mode (warnings allowed with signoff).<br>Provide a CLI and UI wrapper so operator can run validation interactively and export a filtered view per responsible team. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Gate C — Normalization & Remediation Controls</strong><br>Auto-fix rules (logged): strip non-digits (numeric IDs), normalize dates to ISO, trim strings, canonicalize enums, normalize PTKP codes, standardize currency separators.<br>All auto-fixes appended to <code>change_ledger.csv</code> with fields <code>row_id, field, old_value, new_value, change_type, operator, ts, reason, approval_id(optional), ticket_id(optional)</code>.<br>Manual corrections require ticket, evidence (payslip, ID scan), and SSO <code>approval_id</code>.<br>For large anomalies run bulk normalization in dry-run producing <code>normalizer_preview.csv</code>.<br>Integrity controls: append-only ledger, daily digest with HSM signing, quarterly checksum audit.<br>High-risk edits (>3 fields changed) trigger secondary review.<br>Gate C outputs: <code>change_ledger.csv</code>, <code>normalizer_log.csv</code>, <code>remediation_plan_{ticket_id}.md</code>.<br>Operational guidance: provide a reconciliation UI that shows before/after diffs, supports bulk accept/reject of auto-fixes, allows delegation of manual corrections to HR agents with enforced SLA and automatic reassignment on SLA breach. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Gate D — Deterministic Calculation Engine (Full Tax Logic)</strong><br>Core calc steps per-record: aggregate gross income; compute pension deduction; compute prorated job expense (biaya jabatan) with proration and plafon; pesangon (severance) treatment with PMK exemptions; gross-up solver when flagged; FX conversion recording (conversion_rate & source); compute taxable income (PKP) after PTKP; apply progressive Article 17 rates; calculate annual tax; compare with cumulative withheld; compute balance and suggested payroll actions (refund or additional withholding).<br>Save one <code>calc_log</code> JSON per record in <code>calc_logs/</code> with canonicalized schema including <code>record_id, employee_id, inputs, steps[], outputs, calc_version, rounding_rule_id, timestamp, operator_id, sha256</code>.<br>Gross-up solver: deterministic binary search (parameters: tolerance 1 IDR, max_iter e.g., 100) with iteration trace logged (<code>iteration_no, guess_gross, tax_guess, net_after_tax, diff</code>).<br>Numeric stability: maintain internal precision; round only at defined aggregation points; use <code>SafeRound(value, rounding_rule_id)</code> and record <code>rounding_rule_id</code> in calc_log.<br>Run QC sampling: 1% random + top 1% by value; output <code>calc_qc_report.csv</code>.<br>Gate D outputs: <code>calc_logs/{record_id}.json</code>, <code>calc_qc_report.csv</code>, <code>calc_summary.json</code>.<br>Implementation requirements: calc_engine must be deterministic (seeded RNG if needed only for sampling), publish <code>calc_engine_manifest.json</code> with version, commit hash, and unit test coverage report.<br>Provide a dry-run mode that emits <code>calc_diff_report.csv</code> comparing previous calc_version outputs. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Gate E — Mapping & XML Construction (Strict Governance)</strong><br>Mapping format: CSV <code>source_column,xml_node,required,type,transform,notes</code>.<br>Transform pipeline supports normalized functions (e.g., <code>normalize_digits | pad_left(15)</code>), concatenation, conditional mapping.<br>Generate both <code>xml_pretty/{employee_id}.xml</code> and <code>xml_canonical/{employee_id}.xml</code> (canonicalized for sha256).<br>Validate against portal XSD; capture XSD issues to <code>xsd_errors.log</code>.<br>Template change detection: compare <code>template_sha256</code> with portal-provided template; on change produce <code>mapping_diff.csv</code> and block mapping until mapping regression passes.<br>Gate E outputs: <code>xml_canonical/</code>, <code>xsd_errors.log</code>, <code>mapping_applied.csv</code>.<br>Additional controls: enforce mapping review workflow with dual-approval for mapping changes, store prior mapping versions in <code>mapping_archive/</code>, require golden-file regression pass before mapping version promoted to <code>production</code>.<br>Include a mapping simulator UI to preview XML for selected rows and allow samples to be exported for portal test uploads. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Gate F — Acceptance Bundle Assembly & Signoff Governance</strong><br>Bundle composition: XML(s), <code>validation_report.csv</code>, <code>calc_logs.zip</code> or calc_logs folder, <code>change_ledger.csv</code>, <code>manifest.txt</code>/<code>manifest.json</code> (file list with sha256 checksums, descriptions), <code>export_metadata.json</code>, signoff evidence (SSO event ids, PDFs).<br>Compute <code>bundle_sha256</code>; append to <code>upload_log.csv</code> with operator reference.<br>Require signoffs in sequence per RACI (HR_signoff_id → Payroll_signoff_id → Tax_signoff_id) and store signoff metadata in manifest.<br>Bundle must be immutable once signed.<br>Gate F outputs: <code>acceptance_bundle_{kpp}_{period}.zip</code>, <code>bundle_sha256</code>, <code>signoff_receipts/</code>.<br>Enforcement details: apply digital signature to bundle (HSM-signed manifest) and lock bundle folder; maintain <code>bundle_registry.csv</code> with statuses (draft, pending_signoff, signed, uploaded, archived).<br>Include explicit rollback procedure if a signoff must be revoked: create <code>unsigned_amend_{bundle_id}</code> workflow with clear audit trail and new bundle sha256. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Gate G — Staging Upload & Smoke Validation</strong><br>Upload bundle to staging API; poll <code>parse_summary</code>.<br>Validate counts, critical/warning counts, and sample node mapping against manifest.<br>Run smoke tests: parse success, sample record match, calc_log values match expected.<br>Capture portal responses and screenshots.<br>If smoke fails generate <code>staging_failure_report.json</code> and follow remediation workflow.<br>Gate G outputs: <code>staging_parse_summary.json</code>, <code>smoke_test_report.pdf</code>.<br>Operational best-practice: include automated screenshot & HTML capture of portal parse result, persist portal-provided parse id for tracing, and require a minimum sample size for smoke (e.g., 10 records across low/median/high values).<br>If staging returns non-deterministic results, escalate to IT and portal support with attached artefacts. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Gate H — Production Release & Amendment Protocol</strong><br>After signoffs and staging pass, upload to production endpoint using idempotency tokens; store <code>upload_response.json</code> and portal snapshot.<br>Run reconciliation jobs for SSP posting and GL entries and record results.<br>If production returns blocking errors, create <code>amend_bundle</code> with <code>amend_flag=true</code>, explanation, approvals, and track in <code>upload_log.csv</code> with <code>amendment_origin</code> in manifest.<br>Gate H outputs: <code>upload_response.json</code>, <code>production_snapshot_{timestamp}.json</code>.<br>Production controls: employ exponential backoff retries for transient network failures, ensure idempotency by <code>bundle_sha256</code>, maintain <code>production_deployment_log.csv</code> with operator and SSO ids, and require post-production audit checklist including sampling to verify portal calculation vs local calc_logs. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Storage, Security & Data Governance Framework (Detailed Policies)</strong><br>Mandatory artefacts (to store securely): <code>raw_export.xlsx</code>, <code>export_metadata.json</code>, <code>validation_report.csv</code>, <code>change_ledger.csv</code> (append-only WORM), <code>calc_logs/</code> (per-row JSON), <code>mapping_table_v{date}.csv</code>, <code>manifest.txt/manifest.json</code>, <code>acceptance_bundle.zip</code>, <code>upload_log.csv</code>, <code>upload_response.json</code>, <code>signoff_evidence/</code>.<br>Data classification: <code>sensitive</code> (PII: NPWP, NIK, passport scans), <code>confidential</code> (calc_logs, change_ledger), <code>internal</code> (mapping, scripts), <code>public</code> (SOP summaries).<br>Retention & archival: minimum retention 5 years (recommended 10 years for regulated sectors).<br>Move closed bundles older than 2 years to cold storage; keep an indexed manifest for retrieval.<br>Encryption & transport: AES-256 at rest; TLS 1.2+ for transport; use client certificates for server-to-server and HSM for signing manifests.<br>Access control: RBAC model — payroll_team (edit limited fields), hr_leads (edit verification flags), auditors (read-only on repo archives), dev/IT (read/edit mapping & tooling only); approvals must use SSO + MFA and record SSO event id in signoff evidence.<br>Audit & evidence: every manual change requires <code>approval_id</code> (SSO event id), ticket_id, and reason. <code>change_ledger</code> must be immutable and store operator identity; run quarterly ledger integrity checks (recompute checksums).<br>Backup & restore testing: daily incremental backups, monthly immutable snapshot to cold storage, perform a restore test every 6 months and log results in <code>backup_tests/</code>.<br>Maintain DR runbook with RTO/RPO targets (example: RTO 24h, RPO 24h for critical artefacts).<br>Additional governance: maintain data access reviews quarterly, enforce least-privilege, and require secure shredding of unnecessary PII per retention schedule. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Field-by-Field Canonical Spec (Complete with Validation & Excel Helpers)</strong><br>Store canonical field definitions in <code>field_spec.csv</code> (used by validator). Each field record includes validation, normalization rules, example values, owner, and paste-ready Excel helpers.<br>Key field profiles (paste-ready helpers):<br>1) NPWP_Pemotong — type: digits-only string, canonical length 15 after normalization. Normalization: remove dots/hyphens/spaces. Excel helper: <code>=TEXTJOIN(&quot;&quot;,TRUE,IFERROR(MID(A2,ROW(INDIRECT(&quot;1:&quot;&amp;LEN(A2))),1)*1,&quot;&quot;))</code>.<br>2) Validation example: <code>=IF(LEN(npwp_norm)&lt;&gt;15,&quot;ERR001 Invalid NPWP&quot;,&quot;OK&quot;)</code>.<br>3) StatusBukti — Enum: Yes/No.<br>4) PeriodeStart/PeriodeEnd — allowed formats month number (1..12) or ISO date <code>YYYY-MM-DD</code>.<br>5) TahunPajak — 4-digit integer validate range (current or previous year).<br>6) KodeWNIWNA / NoPassport — <code>WNI</code>/<code>Foreign</code> (If <code>Foreign</code>, <code>NoPassport</code> mandatory and passport scan attached).<br>7) NPWP_Penerima / NIK_Penerima — if NPWP missing record portal placeholder code and count placeholders in manifest.<br>8) StatusPTKP — Enum synced with <code>config_ptkp.csv</code>.<br>9) NamaJabatan — max length 50 characters <code>=LEFT(cell,50)</code> and full title stored in attachments if trimmed; flag trims in change_ledger.<br>10) KodeObjekPajak — validate via lookup against <code>tax_object_codes.csv</code>.<br>11) BulanBekerja — integer 1..12 and total months per employee across rows ≤ 12.<br>12) PenghasilanBruto / Component_map — digits-only integer; if monthly source <code>=monthly_gross*months_in_period</code>.<br>13) Component_map must sum to PenghasilanBruto within rounding tolerance: <code>=IF(ABS(PenghasilanBruto - SUM(components))&gt;rounding_tolerance,&quot;ERR_COMP_MISMATCH&quot;,&quot;OK&quot;)</code> with acceptable rounding tolerance 2 IDR.<br>14) GrossUpFlag — Enum Yes/No; if Yes calc_log must include solver trace (iterations, convergence tolerance).<br>15) IuranPensiun — <code>=monthly_pension*months</code> and verify against pension register.<br>16) PreviousNoBukti / PreviousTax / PreviousNetIncome — when non-zero validator requires evidence linkage (scan 1721 A1/A2) and StatusBukti=Yes.<br>17) JumlahTelahDipotong — reconcile to GL/SSP allowing small tolerance for rounding/FX.<br>18) ID_TKU — format NITKU 22 digits, pad branch index if missing.<br>19) TanggalTerbit — ISO <code>YYYY-MM-DD</code> and must not be earlier than last pay date for the period.<br>Field spec maintenance: update <code>field_spec.csv</code> when regulations change; require dual approval for updates and version as <code>field_spec_v{n}.csv</code>.<br>Provide both human-readable field spec export and machine-readable JSON used by validator. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Detailed Validation Rules — Severity, Sample Expressions & Routing</strong><br>Validator outputs rows: <code>{row_id, employee_id, severity, code, field, message, suggested_fix, responsible_team, ticket_link_optional}</code>.<br>Severity mapping: CRITICAL (block conversion), ERROR (must fix pre-bundle), WARNING (triage), INFO (note).<br>Critical checks include missing required fields (npwp_pemotong, employee_id, penghasilanbruto when months>0), NPWP invalid (non-digit or incorrect length) unless placeholder allowed, NIK missing when required, sum of months across employee rows > 12, GrossUpFlag=Yes but no calc_log or solver did not converge, XML XSD validation errors.<br>Warning checks include component value > 3× role median (possible miscoding), job title length > 50 (auto-trim suggested), duplicate NPWP across employee_ids (possible data duplication).<br>Excel sample check: <code>=IF(SUMIFS(months_range,employee_id_range,this_employee_id)&gt;12,&quot;ERR003 MonthsSum&gt;12&quot;,&quot;OK&quot;)</code>.<br>Routing: map each error to responsible_team (HR, Payroll Ops, Finance, IT); validator can auto-open tickets for CRITICALs and attach error rows and workspace links.<br>Escalation automation: auto-escalate criticals older than SLA to managers and send daily digest to owners.<br>Include support for custom rule injection by IT under controlled mapping and require unit tests for each new rule. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Conversion Workflow — Operator Runbook (Expanded Step-by-Step with Artefact Names)</strong><br>Workspace creation: <code>{staging_root}/{YYYY}/{KPP}/{period}/{operator_ts}/</code> with subfolders <code>/raw/</code>, <code>/validation/</code>, <code>/calc_logs/</code>, <code>/bundles/</code>, <code>/archive/</code>.<br>Pre-run checklist (operator must tick):<br>1) copy raw_export to <code>/raw/</code> and set RO; record <code>sha256_raw</code> in <code>export_metadata.json</code>.<br>2) Run validator; save <code>validation_report.csv</code> to <code>/validation/</code>.<br>3) Append auto-fix summary to <code>change_ledger.csv</code> and open tickets for manual items.<br>4) Save <code>normalizer_log.csv</code>.<br>5) Run <code>calc_engine_v{calc_version}</code> and save calc_logs to <code>/calc_logs/</code>.<br>6) Apply mapping; save <code>mapping_applied.csv</code> and <code>xml_generated/</code>.<br>7) Run XSD validation and append results to <code>validation_report.csv</code>.<br>8) Assemble <code>acceptance_bundle_{kpp}_{period}.zip</code> in <code>/bundles/</code> and compute <code>bundle_sha256</code>.<br>9) Obtain signoffs and store SSO ids into <code>signoff_evidence/</code>.<br>10) Upload to staging; run smoke tests and save <code>staging_parse_summary.json</code>.<br>11) After signoffs & staging pass upload production and save <code>upload_response.json</code> in <code>/upload_log/</code>.<br>Operator notes: always run dry-run for header changes; maintain <code>last_successful_export.txt</code> pointer for idempotency checks; capture portal response screenshots and store in signoff evidence.<br>Include a troubleshooting quick reference for common errors and the CLI command examples (in operator doc) for reproducibility. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>calc_logs Structure & Extended Example (Fields, Trace, and Integrity)</strong><br>Store each calc_log as an individual canonical JSON file <code>{record_id}.json</code> inside <code>calc_logs/</code>.<br>Minimal schema: <code>record_id, employee_id, inputs, steps[], outputs, calc_version, rounding_rule_id, timestamp, operator_id, sha256</code>.<br>Design notes: <code>inputs</code> must include raw source values and normalized equivalents (e.g., monthly_gross_raw, monthly_gross_norm). <code>steps</code> is an ordered array with <code>name, formula_description, input_refs, output_value</code>.<br><code>outputs</code> contain canonical values used in XML (pph_annual, total_withheld, balance, component_allocations). <code>sha256</code> is computed over canonicalized JSON (consistent key ordering) to detect tampering.<br>Extended sample (single-line JSON example): <code>{&quot;record_id&quot;:&quot;r200&quot;,&quot;employee_id&quot;:&quot;E2002&quot;,&quot;inputs&quot;:{&quot;gross_A&quot;:90000000,&quot;gross_B&quot;:112000000,&quot;pension_total&quot;:1500000,&quot;prev_tax&quot;:0,&quot;ptkp_status&quot;:&quot;TK/0&quot;,&quot;conversion_rate&quot;:1},&quot;steps&quot;:[{&quot;step&quot;:&quot;cost_of_work_A&quot;,&quot;formula&quot;:&quot;MIN(5%*gross_A,prorata_plafon_A)&quot;,&quot;value&quot;:4500000},{&quot;step&quot;:&quot;cost_of_work_B&quot;,&quot;formula&quot;:&quot;MIN(5%*gross_B,prorata_plafon_B)&quot;,&quot;value&quot;:5600000},{&quot;step&quot;:&quot;total_biaya&quot;,&quot;value&quot;:10100000},{&quot;step&quot;:&quot;net_taxable&quot;,&quot;value&quot;:190400000},{&quot;step&quot;:&quot;apply_progressive&quot;,&quot;value&quot;:[{&quot;tier&quot;:&quot;0-60m&quot;,&quot;tax&quot;:3000000},{&quot;tier&quot;:&quot;60-136.4m&quot;,&quot;tax&quot;:11460000}]}],&quot;outputs&quot;:{&quot;pph_annual&quot;:14460000,&quot;total_withheld&quot;:12620000,&quot;balance&quot;:1840000},&quot;calc_version&quot;:&quot;v2.1&quot;,&quot;rounding_rule&quot;:&quot;rounding_rule_02&quot;,&quot;timestamp&quot;:&quot;2025-06-30T09:12:00&quot;,&quot;operator_id&quot;:&quot;payroll_op_01&quot;,&quot;sha256&quot;:&quot;calcsha256:abcd...&quot;}</code>.<br>Include step-level trace so auditors can reconstruct which formula and inputs produced each intermediate value.<br>Link calc_log entries to change_ledger items for any edited inputs.<br>Best practices: redact PII for public debugging and provide <code>calc_log_index.csv</code> for quick lookup (<code>record_id, employee_id, path, sha256</code>).<br>Provide tooling to re-run a single record with exact inputs and calc_version to reproduce sha256. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Change Ledger Policy and Examples (Auditable Edit Trail)</strong><br>Policy summary: <code>change_ledger</code> must be append-only, WORM-backed, and store <code>row_id, field, old_value, new_value, operator, ts, reason, approval_id, ticket_id(optional)</code>.<br>Automated normalizer entries use operator <code>normalizer_v{v}</code>.<br>Human edits require SSO <code>approval_id</code>.<br>High-risk edits (>3 fields changed) must trigger mandatory review ticket.<br>Example rows: <code>r102,NPWP_Penerima,01.234.567.8-901.234,012345678901234,normalizer_v1,2025-06-30T09:10:00,normalize_npwp,hr_approve_789,ticket_234</code> and <code>r203,NamaJabatan,&quot;Senior Vice President of Sales and Strategy&quot;,&quot;Senior Vice President of Sales and Strategy&quot;,manual,payroll02,2025-06-30T09:11:00,trim_to_50,payroll_mgr_22,ticket_235</code>.<br>Integrity measures: daily digest for <code>change_ledger</code> stored and signed with HSM; auditors verify digest chain.<br>Provide automated ledger exports in CSV and signed compressed archives for auditor ingestion. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Rounding Rules & Numeric Stability Policy (Examples & Implementation)</strong><br>Central policy: use <code>SafeRound(value, rounding_rule_id)</code> with explicit rounding rules in <code>rounding_rules.csv</code>.<br>Keep rounding rules consistent across calc_engine and payroll posting.<br>Example rules: <code>rounding_rule_01</code> — 0 decimals half-up (final tax numbers); <code>rounding_rule_02</code> — 0 decimals bankers rounding (deterministic); <code>rounding_rule_03</code> — 2 decimals half-up (FX conversion intermediate).<br>Guidelines: apply rounding only at defined aggregation points; prefer full internal precision and round only outputs written to XML or posted to GL.<br>Record <code>rounding_rule_id</code> in calc_log.<br>Unit-test edge midpoint cases (e.g., .5).<br>Ensure calc_engine and payroll posting use identical rounding routines to avoid reconciliation drift.<br>Maintain a test suite that covers rounding-rule permutations and report rounding deltas per golden-file run. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Spreadsheet Formulas & Helper Snippets (Paste-ready)</strong><br>Provide a <code>helpers</code> sheet in the template with paste-ready Excel formulas: Normalize NPWP: <code>=TEXTJOIN(&quot;&quot;,TRUE,IFERROR(MID(B2,ROW(INDIRECT(&quot;1:&quot;&amp;LEN(B2))),1)*1,&quot;&quot;))</code>.<br>Prorata cap: <code>=(plafon_tahunan/12)*months_in_period</code>.<br>Cost of work: <code>=MIN(0.05*total_gross, prorata_plafon)</code>.<br>Total gross (from monthly): <code>=monthly_gross*months_in_period + bonus + other_income</code>.<br>Consolidation check: <code>=IF(consol_total_gross=SUMIFS(employer_input[total_gross],employer_input[employee_id],this_employee_id),&quot;ok&quot;,&quot;mismatch&quot;)</code>.<br>NPWP length check: <code>=IF(LEN(npwp_norm)=15,&quot;ok&quot;,&quot;check_npwp&quot;)</code>.<br>Validation dashboard: pivot tables for error_counts per code per operator linked to <code>validation_report.csv</code>.<br>For Google Sheets include ARRAYFORMULA equivalents and an Apps Script export button to produce CSV for the validator.<br>Provide downloadable sample helper workbook and instruct operators to copy helpers into working file before running validator. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Extensive Worked Examples & Golden-File Scenarios (Full Numeric Walkthroughs)</strong><br>Maintain <code>golden_file_regression.xlsx</code> with annotated test cases.<br>Example 1 — Single employer full year: inputs monthly_gross=15,000,000; months=12; monthly_pension=100,000; PTKP TK/0=54,000,000; biaya_jabatan cap example 6,000,000 annual.<br>Steps: total_gross = 180,000,000; total_pension = 1,200,000; biaya_jabatan = MIN(0.05*180,000,000, cap) = 9,000,000; net = 169,800,000; PKP = 115,800,000; Tax layers 0–60m @5% = 3,000,000; remainder 55,800,000 @15% = 8,370,000; PPh annual = 11,370,000.<br>Example 2 — Mid-year mover with previous credits: Company A Jan–Jun monthly 15,000,000 → 90,000,000; Company B Jul–Dec monthly 17,000,000 + Nov bonus 10,000,000 → 112,000,000; total_gross_all = 202,000,000; total_pension = 1,500,000; total_biaya = 10,100,000 → net_taxable = 190,400,000 → PKP = 136,400,000 → PPh annual = 14,460,000.<br>Withholdings example: A withheld 4,500,000; B withheld 6,120,000 + 1,000,000 bonus withholding → total_withheld 11,620,000 → shortage = 2,840,000.<br>Ensure calc_log per record captures previous credits and withheld amounts.<br>Example 3 — Gross-up solver algorithm: find G where G - tax(G) = net_target using binary search with logs.<br>Example 4 — Pesangon partial exemption: pesangon 50,000,000; exemption 15,000,000 → taxable_pesangon 35,000,000; add to gross; recompute prorata biaya_jabatan; record exempt portion in calc_log.<br>Example 5 — Concurrent dual employment: collate incomes from multiple employers and compute annual PKP; final employer aggregates PKP and applies PTKP rules accordingly.<br>For each example attach expected <code>calc_log</code> sha256 and expected XML node values for automated comparison. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Golden-file Set (20+ Regression Scenarios)</strong><br>Maintain canonical scenarios with inputs and expected calc_log sha256 for regression:<br>1) single employer full-year.<br>2) mid-year mover (previous credits).<br>3) multiple moves (>2).<br>4) gross-up net target.<br>5) pesangon with exemptions.<br>6) pesangon installments.<br>7) WNA with treaty.<br>8) foreign currency income with FX variance.<br>9) missing NPWP placeholder.<br>10) long job titles trimmed.<br>11) duplicate NPWP across two employee IDs.<br>12) pesangon legal exemption.<br>13) high bonus causing tax bracket jump.<br>14) zero income with allowances.<br>15) split payments across months.<br>16) corrections after staging parse.<br>17) header template change detection.<br>18) branch NPWP vs headquarter NPWP differences.<br>19) negative corrections (retro refund).<br>20) deceased employee final settlement.<br>21) employer bankruptcy with missing prev-1721.<br>Store golden-file inputs, expected calc_log outputs, and expected XML node snippets for automated comparison.<br>Automate nightly regression runs and publish <code>regression_dashboard.html</code> with pass/fail per scenario. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Extended Validation Report Catalog — Error Codes, Severity & Remediation</strong><br>Provide <code>errors_catalog.csv</code> mapping codes to severity, remediation steps, and owner team.<br>Sample lines:<br><code>ERR001,Invalid NPWP,CRITICAL,normalize_non_digits; if length !=15 open HR ticket,HR Data Team</code>.<br><code>ERR002,Missing NIK,CRITICAL,request KTP upload,HR Admin</code>.<br><code>ERR003,MonthsSum&gt;12,CRITICAL,correct months_in_period &amp; investigate overlaps,Payroll Lead</code>.<br><code>ERR004,GrossUpMissingCalcLog,CRITICAL,rerun gross-up engine &amp; attach calc_log,Payroll Ops</code>.<br><code>ERR005,XSD MissingNode,CRITICAL,update mapping or fill mandatory node,IT/Mapping Owner</code>.<br><code>WARN001,JobTitleTooLong,WARNING,trim to 50 &amp; attach full title,Payroll Ops</code>.<br><code>WARN002,ComponentHighVariance,WARNING,manual review for miscoding,Payroll Manager</code>.<br>Maintenance: update <code>errors_catalog.csv</code> when validator rules change and require owner assignment for each code.<br>Include remediation playbook links per error code and automated ticket templates for each remediation. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>UAT & Regression Plan (Test Matrix & Acceptance Criteria)</strong><br>Test artefacts: <code>test_cases.xlsx</code>, <code>test_results.csv</code>, <code>defect_log.tsv</code>.<br>Representative tests:<br>1) TC001 Single Employer Full Year (run validator → calc_engine → XML → compare calc_log sha256 with golden).<br>2) TC002 Mid-year mover with PreviousNoBukti.<br>3) TC003 Gross-up solver (net target matched within tolerance).<br>4) TC004 WNA passport required.<br>5) TC005 Pesangon exemption annotated in calc_log.<br>6) TC006 Header change detection triggers mapping_diff.<br>7) TC007 Duplicate NPWP detection.<br>8) TC008 FX conversion records conversion_rate.<br>Acceptance criteria: all test cases pass in staging; golden-file calc_log sha256 matches; failures logged as defects with repro steps; priority fixes validated before production.<br>Test automation: integrate with CI/CD to run regression on mapping changes; require signoff before mapping promotion.<br>Maintain <code>uat_runbook.md</code> with step-by-step UAT execution instructions. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Troubleshooting Playbook (Operator Action Lists for Common Incidents)</strong><br>Mass invalid NPWP: run normalizer → re-run validator → export <code>npwp_issue_list.csv</code> for HR batch request (columns: row_id, employee_id, problem_value, required_doc) → open HR ticket SLA 5 business days → log actions in change_ledger.<br>Gross-up mismatch vs payslip: compare calc_version and rounding_rule_id between calc_logs and payroll system; if mismatch re-run calc_engine with matching calc_version and rounding; log delta and reissue bundle if required.<br>Portal ERR_LAYOUT/template mismatch: fetch <code>template_sha256</code> from portal, diff headers with local mapping (<code>mapping_diff.csv</code>), update mapping_version and run regression.<br>GL vs export discrepancy beyond material threshold: reconcile SSP batches, check posting dates, unposted SSP, missing prev employer credits; escalate to Finance Controller with <code>reconciliation_issue_report.csv</code>.<br>Production parse failure after staging pass: collect <code>upload_response.json</code>, <code>staging_parse_summary</code>, sample failing rows; open incident with portal support and prepare <code>amend_bundle</code> including explanation & approvals.<br>Provide a decision tree PDF for operator escalation paths and contact list for portal support. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>API & ETL Integration Recommendations (Contract-Level Details)</strong><br>Recommended endpoints and behavior:<br>1) <code>POST /api/employee/{id}/prev-employer-entry</code> — accepts multipart (file + metadata) → returns <code>{entry_id, checksum, status}</code>.<br>2) <code>POST /api/exports</code> — upload bundle → returns <code>{export_id, parse_summary}</code> and support polling <code>GET /api/exports/{export_id}/status</code>.<br>Idempotency: accept <code>bundle_checksum</code> header and return 409 for duplicates.<br>Security: mutual TLS + API key + JWT for operator_id; log operator_id, calc_version, validator_version in requests.<br>Responses must include parse counts <code>{records_processed, criticals, warnings, parse_errors[]}</code> and sample paths to failing rows.<br>ETL notes: use incremental export jobs with <code>export_metadata.json</code> and <code>bundle_sha256</code> to detect duplicates and enable safe retries.<br>Provide webhooks for parse-complete events to trigger downstream reconciliation.<br>Include example contract clauses for SLA, error handling, and data retention in the API SLA annex. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>RACI, Escalation & Communication Templates (Copy-Ready)</strong><br>RACI examples:<br>1) Request 1721 issuance — Responsible: HR; Accountable: HR Lead; Consulted: Payroll; Informed: Employee.<br>2) Acceptance bundle — Responsible: Payroll; Accountable: Payroll Manager; Consulted: IT/Mapping Owner, Tax; Informed: Finance Controller.<br>Escalation timeline for missing 1721: Day 3 automated reminder; Day 7 escalate to HR Manager; Day 14 escalate to Finance Controller; Day 21 advise employee to claim via SPT and log attempts as evidence.<br>Email templates (copy-ready):<br>Subject: <code>Request for Issuance of PPh 21 Withholding Form (1721-A1) — [Employee Name]</code>.<br>Body: <code>Dear Payroll [Previous Company], I, the undersigned: Name: [Employee Name] NPWP: [NPWP if available] Termination Date: [DD/MM/YYYY] Request issuance and delivery of Form 1721-A1 for the employment period up to termination. Please send softcopy to [new employer payroll email] or upload to internal HR portal. Thank you. Sincerely, [Employee Name]</code>.<br>Employee reconciliation notice (short):<br>Subject: <code>PPh21 Reconciliation Result Year [YYYY] — [Name]</code>.<br>Body: <code>Summary: PKP [PKP], Annual Tax [PPhAnnual], Total Withheld [TotalWithheld], Shortage/(Overpaid) [Balance]. Please confirm within 7 business days.</code>.<br>Provide editable templates in DOCX and plain-text formats in <code>signoff_templates/</code>. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>SLAs, KPIs & Monitoring (Targets & Dashboard Items)</strong><br>Targets: previous employer issuance of 1721 ≤ 7 business days; verification & upload by new employer ≤ 3 business days; critical validation resolution ≤ 3 business days; acceptance bundle signoff cycle ≤ 2 business days.<br>KPI monitoring: % new joiners with 1721 by day-1 (target ≥95%); % XLSX auto-parse success (target ≥90%); UAT pass rate ≥95%; average critical fix time ≤3 days.<br>Dashboard panels include: <code>exports_this_month</code>, <code>criticals_this_month</code>, <code>avg_fix_time_criticals</code>, <code>acceptance_bundles_pending_signoff</code>, <code>staging_parse_failure_rate</code>, <code>golden_file_regression_pass_rate</code>, <code>npwp_unresolved_count</code>, <code>top_10_error_types</code>.<br>Alerts: if critical_count > 0 create incident for payroll_team; if staging_parse_failure_rate > 5% escalate to IT.<br>Provide sample Grafana/PowerBI dashboard specs and SQL queries for each KPI. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Audit Checklist (Per-Employee Audit Package Requirements)</strong><br>For each employee who moved during the year auditors require:<br>1) 1721-A1/A2 + checksum + verifier initials.<br>2) monthly payslip links.<br>3) SSP/transfer proofs.<br>4) cumulative calculation memo + approval signature.<br>5) calc_logs per row + sha256.<br>6) change_ledger extract covering manual edits.<br>7) acceptance bundle + bundle_sha256 + upload_response.<br>Provide per-employee audit package as downloadable ZIP with <code>manifest.txt</code> listing files and checksums.<br>Batch-level audit packs must include the acceptance bundle and upload logs, plus signoff evidence.<br>Provide automated audit-pack generator that produces per-employee and batch packages with encryption and access controls for auditors. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Training, Rollout & 90-Day Implementation Roadmap (Owners & Deliverables)</strong><br>Day 0–30 (Governance & Quick Wins): update onboarding checklist to require 1721 field; create <code>template_reconciliation.xlsx</code> and publish <code>field_spec</code>.<br>Day 31–60 (System & Testing): IT implements mapping fields & upload API; QA prepares golden-file regression and test suite.<br>Day 61–90 (UAT & Rollout): run UAT with 50 scenarios; remediate and finalize SOP; deliver training sessions and publish SOP + quick cards.<br>Deliverables: <code>validators.json</code>, <code>mapping_v1</code>, <code>calc_version registry</code>, golden-file test results, SOP, training slides.<br>Owners: HR Lead, Payroll Lead, IT Lead, QA Lead.<br>Include a training plan (materials, instructors, hands-on labs) and a signoff checklist for go-live readiness. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Advanced Edge Cases & Legal Notes (Operational Guidance)</strong><br>Previous employer bankrupt/closed: record attempt history (emails, phone logs); advise employee to claim via SPT; log escalation in manifest.<br>Non-resident & treaty claims: require residency documents; consult tax counsel; annotate manifest with treaty article and counsel reference.<br>Late NPWP issuance by employee: support retro credit via re-reconciliation; if refund already paid compute reclaim per internal policy; obtain employee written consent.<br>Amended uploads: include <code>amend_flag</code> in XML, explanation, and approvals; coordinate amendments with tax authority guidance.<br>All exceptions must be documented in manifest notes and signed off by Tax Lead.<br>Maintain an exceptions register and require quarterly review by Compliance. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Mapping CSV Sample & Mapping Diff Handling</strong><br>Example mapping CSV rows:<br><code>npwp_pemotong,NPWP_Pemotong,yes,string,normalize_digits,remove punctuation</code>.<br><code>employee_id,EmployeeID,yes,string,none,primary key</code>.<br><code>monthly_gross,PenghasilanBulanan,conditional,number,none,if monthly provided</code>.<br><code>previous_tax,PreviousTax,no,number,none,credit from previous employer</code>.<br>When portal template changes are detected (via <code>template_sha256</code>) generate <code>mapping_diff.csv</code> with <code>column_name,status,action_required</code> and store new mapping in <code>mapping_archive/</code> with versioning.<br>Run full regression against golden-files after mapping change and require signoff before production.<br>Maintain <code>mapping_change_log.csv</code> with author, rationale, and regression results. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Errors Catalog (Detailed) & Owner Contact List</strong><br><code>ERR001 Invalid NPWP</code> — CRITICAL — remediation: normalize → HR request if mismatch remains — owner: HR Data Team.<br><code>ERR002 Missing NIK</code> — CRITICAL — remediation: request KTP — owner: HR Admin.<br><code>ERR003 MonthsSum&gt;12</code> — CRITICAL — remediation: correct months_in_period & investigate overlaps — owner: Payroll Lead.<br><code>ERR004 GrossUpMismatch</code> — CRITICAL — remediation: re-run calc engine with matching calc_version — owner: Payroll.<br><code>WARN001 JobTitleTooLong</code> — WARNING — remediation: trim & attach full title — owner: Payroll Ops.<br><code>WARN002 UnusualComponentHigh</code> — WARNING — remediation: manual review — owner: Payroll Manager.<br>Maintain <code>owners.yml</code> contact directory with names and functional emails for auto-assignment.<br>Include escalation phone numbers and response SLAs in <code>owners.yml</code>. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Practical Operator Checklists (Compact, Printable)</strong><br>Pre-conversion checklist (copy-paste):<br>1) raw_export saved + sha256.<br>2) Run validator → criticals = 0.<br>3) Normalization logged.<br>4) Run calc engine → calc_logs saved.<br>5) Mapping validated.<br>6) XML generated & XSD validated.<br>7) Bundle assembled + bundle_sha256.<br>8) HR/Payroll/Tax signoffs collected.<br>9) Staging upload & parse success.<br>10) Production upload scheduled.<br>Use this checklist as gate control UI so operators must tick boxes and append SSO event ids before next gate opens.<br>Provide printable one-page quick checks and a laminated operator cheat-sheet for shift desks. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Signoff Evidence & Manifest Requirements (What to Capture)</strong><br>Signoff evidence must include SSO audit event id, approver_id, timestamp, rationale, and attached screenshot/digital signature where possible.<br>Example evidence entry: <code>{approval_id: &quot;payroll_456&quot;, approver_name: &quot;Payroll Lead&quot;, ts: &quot;2025-06-30T09:20:00&quot;, evidence: &quot;sso_event_20250630_789&quot;}</code>.<br>Include these IDs in manifest approvals field.<br>Signoff metadata must be part of bundle and indexed in <code>upload_log.csv</code>.<br>Ensure signoff evidence files are tamper-evident and linkable to SSO logs; prefer HSM-signed attestations for high-risk bundles. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Appendices & Artefacts List (Repo File Inventory)</strong><br>Repo files to include and maintain with owners: <code>template_reconciliation.xlsx</code> (Payroll Lead), <code>golden_file_regression.xlsx</code> (QA), <code>validators.json</code> (IT/QA), <code>mapping_v{date}.csv</code> (IT/Mapping Owner), <code>calc_engine_v{version}.md</code> (Payroll Ops), <code>errors_catalog.csv</code> (Payroll Ops), <code>signoff_templates.docx</code> (HR), <code>manifest_template.txt</code> (IT), <code>change_ledger_policy.md</code> (Compliance), <code>calc_log_schema.json</code> (IT), <code>owners.yml</code> (Admin).<br>Keep README with usage, owners, and contact points.<br>Add a <code>release_notes/</code> folder with mapping/calc/validator change records and maintain semantic versioning for calc_engine and validator. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Final Quick-Start Checklist (Operator Copy-Paste)</strong><br>1) Export raw → compute sha256 → store raw copy.<br>2) Run validator → resolve CRITICALs.<br>3) Normalize → log in change_ledger.<br>4) Run calc engine → save calc_logs.<br>5) Map to XML → run XSD check.<br>6) Assemble acceptance bundle → compute bundle_sha256.<br>7) Obtain signoffs: HR, Payroll, Tax (SSO evidence).<br>8) Upload staging → run smoke tests.<br>9) If pass → upload production.<br>10) Archive bundle & update upload_log.<br>Keep one cold-start example in repo for auditors.<br>Provide a minimal runnable checklist file <code>operator_checklist.csv</code> that operators can mark and attach SSO ids. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Offer of Artefacts Delivery (On-Request Deliverables)</strong><br>Available deliverables on request:<br>1) printable pre-upload checklist (PDF);<br>2) anonymized sample XLSX (5–20 rows) with validation flags & corrected output; <br>3) Power Query (M) skeleton for normalization & mapping; <br>4) Python (pandas) validation & export skeleton (normalize → validate → map → export) including unit tests for golden-file scenarios; <br>5) <code>errors_catalog.csv</code> (codes, severity, remediation).<br>Provide <code>KPP</code> code + <code>calc_version</code> to receive tailored artefacts.<br>Include packaged deliverables with README and minimal usage examples. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Contact & Escalation Quick List (Copy-Ready)</strong><br><code>Role | Name | Email | Escalation order</code> — <code>Payroll Lead | [name] | payroll@company.internal | 1</code> — <code>HR Lead | [name] | hr@company.internal | 2</code> — <code>Finance Controller | [name] | finance@company.internal | 3</code>.<br>Keep <code>owners.yml</code> updated and referenced by the validator for auto-assignment.<br>Include a backup on-call rotation calendar and a Slack channel webhook for incident notifications. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Closing Operational Note (Must-Do Before First Production Run)</strong><br>Before the first production upload ensure <code>calc_version</code> & <code>validator_version</code> are registered in the repo, golden-file regression passed, and audit package creation script tested end-to-end (bundle assembly, sha256, upload_log entry).<br>Record one full sample cycle as a cold-start example for auditors including raw_export, validation_report, change_ledger, calc_logs, manifest, signoff evidence and upload_response.<br>Confirm retention & access controls are provisioned, perform a restore test for archive retrieval, and obtain final executive signoff recorded with SSO evidence. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>ADDITIONAL EXAMPLES — Expanded Worked Examples & Samples (NEW)</strong><br>Purpose: provide more concrete, copy-paste ready examples for operators, testers, and auditors. These are additive and do not replace existing examples. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>A. Additional Worked Example — Gross-up Detailed Trace (Full Calc_Log Example)</strong><br>Context: Employee requests net payout IDR 10,000,000 grossed-up. Solver should find gross G such that <code>G - tax(G) = net_target</code>.<br>Inputs (example): <code>net_target: 10000000, months: 1, PTKP: TK/0, conversion_rate:1, calc_version:v3.0, rounding_rule:rounding_rule_01</code>.<br>Iteration trace (example calc_log.steps):<br>1) <code>iteration_no:1, guess_gross:11500000, tax_guess:850000, net_after_tax:10650000, diff:650000</code>.<br>2) <code>iteration_no:2, guess_gross:11250000, tax_guess:800000, net_after_tax:10450000, diff:450000</code>.<br>3) <code>iteration_no:3, guess_gross:11000000, tax_guess:760000, net_after_tax:10240000, diff:240000</code>.<br>4) <code>iteration_no:4, guess_gross:10800000, tax_guess:720000, net_after_tax:10080000, diff:80000</code>.<br>5) <code>iteration_no:5, guess_gross:10720000, tax_guess:704000, net_after_tax:10016000, diff:16000</code>.<br>6) <code>iteration_no:6, guess_gross:10704000, tax_guess:703040, net_after_tax:10000960, diff:960</code>.<br>7) <code>iteration_no:7, guess_gross:10703360, tax_guess:703027, net_after_tax:10000333, diff:333</code>.<br>8) convergence at tolerance 1 IDR → final <code>gross_g = 10,703,327</code> (example), record final <code>outputs</code> including <code>pph_annual</code>, <code>total_withheld</code>, <code>balance</code> and full <code>steps[]</code> with formulas and references.<br>Store calc_log: <code>calc_logs/grossup_r501.json</code> with canonical keys and sha256. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>B. Additional Worked Example — Multi-currency Income with FX Reconciliation</strong><br>Scenario: Employee receives salary in USD for 3 months and IDR for remaining months. Need FX conversion record, variance tolerance, and GL posting instructions.<br>Inputs example: <code>monthly_gross_usd=2,000 USD for 3 months</code>, <code>monthly_gross_idr=15,000,000 for 9 months</code>, <code>fx_rate_snapshot = [2025-01-31: 15000, 2025-02-28:14950, 2025-03-31:15100]</code>.<br>Processing:<br>1) Convert per-month using monthly <code>conversion_rate</code> and record <code>fx_source</code> and <code>fx_ts</code> in calc_log inputs.<br>2) For variance > 0.5% vs nightly treasury average, flag <code>WARN_FX_VARIANCE</code> with <code>suggested_fix: use averaged rate or attach treasury approval</code>.<br>3) Capture <code>fx_gain_loss</code> node in calc_log outputs for GL reconciliation. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>C. Additional Worked Example — Retroactive Correction (Negative Adjustment)</strong><br>Scenario: Employee had retro pay reduction of IDR 2,500,000 applied to previous period; validator must create correction row with <code>Negative</code> flag and maintain link to original row.<br>Processing:<br>1) Create <code>correction_row</code> with <code>original_row_id</code> and negative <code>PenghasilanBruto</code> value.<br>2) Validator classifies as <code>CRITICAL</code> if <code>months_total &gt; 12</code> after correction.<br>3) Calc_engine logs <code>reversal_reference</code> in calc_log and generates <code>reconciliation_instructions.md</code> for Finance. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>D. Sample XML Snippet (Canonical, Pretty and Canonical SHA)</strong><br>Pretty XML (human readable) example for employee <code>E1001</code>:<br><code>&lt;BuktiPemotongan&gt;</code><br>&nbsp;&nbsp;<code>&lt;NPWP_Pemotong&gt;012345678901234&lt;/NPWP_Pemotong&gt;</code><br>&nbsp;&nbsp;<code>&lt;Employee&gt;</code><br>&nbsp;&nbsp;&nbsp;&nbsp;<code>&lt;EmployeeID&gt;E1001&lt;/EmployeeID&gt;</code><br>&nbsp;&nbsp;&nbsp;&nbsp;<code>&lt;Nama&gt;Adi Santoso&lt;/Nama&gt;</code><br>&nbsp;&nbsp;&nbsp;&nbsp;<code>&lt;PenghasilanBruto&gt;15000000&lt;/PenghasilanBruto&gt;</code><br>&nbsp;&nbsp;&nbsp;&nbsp;<code>&lt;PPhTahunan&gt;11370000&lt;/PPhTahunan&gt;</code><br>&nbsp;&nbsp;<code>&lt;/Employee&gt;</code><br><code>&lt;/BuktiPemotongan&gt;</code><br>Canonical XML: remove whitespace and normalize attribute order, then compute <code>sha256</code> of canonical bytes and store in <code>xml_canonical/E1001.xml.sha256</code>. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>E. Sample calc_log Full JSON (Illustrative, redacted PII)</strong><br><code>{ &quot;record_id&quot;:&quot;r501&quot;, &quot;employee_id&quot;:&quot;E1001&quot;, &quot;inputs&quot;:{ &quot;monthly_gross&quot;:15000000, &quot;months&quot;:12, &quot;ptkp&quot;:&quot;TK/0&quot;, &quot;pension_total&quot;:1200000 }, &quot;steps&quot;:[ {&quot;step&quot;:&quot;agg_gross&quot;,&quot;formula&quot;:&quot;monthly_gross*months&quot;,&quot;value&quot;:180000000},{&quot;step&quot;:&quot;pension&quot;,&quot;formula&quot;:&quot;monthly_pension*months&quot;,&quot;value&quot;:1200000},{&quot;step&quot;:&quot;biaya_jabatan&quot;,&quot;formula&quot;:&quot;MIN(0.05*agg_gross, plafon)&quot;,&quot;value&quot;:9000000}, {&quot;step&quot;:&quot;net_taxable&quot;,&quot;formula&quot;:&quot;agg_gross - pension - biaya_jabatan - ptkp&quot;,&quot;value&quot;:115800000} ], &quot;outputs&quot;:{&quot;pph_annual&quot;:11370000,&quot;total_withheld&quot;:11000000,&quot;balance&quot;:370000}, &quot;calc_version&quot;:&quot;v2.1&quot;,&quot;rounding_rule_id&quot;:&quot;rounding_rule_01&quot;,&quot;timestamp&quot;:&quot;2025-06-30T09:12:00&quot;,&quot;operator_id&quot;:&quot;payroll_op_01&quot;,&quot;sha256&quot;:&quot;calcsha256:...&quot; }</code> </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>F. Additional Golden-file Scenarios (Extra 12 Cases to Add to Set)</strong><br>Add these to the canonical regression suite:<br>22) Employee with frequent FX salary adjustments (monthly variable FX) — expects <code>fx_variance</code> warnings.<br>23) Employee with split employment days in month (prorated months fractional handling) — tests month proration rules.<br>24) Employee with multiple small bonuses triggering bracket jump — tests progressive bracket boundary rounding.<br>25) Employee with tax treaty credit and treaty article annotation — tests non-resident flows.<br>26) Employee with late NPWP supplied after production and reclaim flow — tests amend_bundle processes.<br>27) Employee with employer-paid benefits (health) requiring tax treatment discrimination — tests component classification.<br>28) Employee with pesangon paid in installments across months — tests exposé of exemption across installments.<br>29) Employee with negative corrections exceeding threshold — triggers special audit workflow.<br>30) Employee with duplicate NIK across subsidiaries — tests dedup detection and owner routing.<br>31) High-risk manual edit simulation (>5 fields changed) — must produce secondary review flag.<br>32) Header template change mid-run with fallback mapping — tests mapping_diff handling and regression.<br>33) Massive file >1M rows chunked import with manifest parts — tests chunked export and recombination. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>G. Additional Mapping Transform Examples (Function Samples)</strong><br>Provide ready transforms to include in mapping CSV <code>transform</code> column:<br><code>normalize_digits</code> — remove non-digits.<br><code>pad_left(15,&#x27;0&#x27;)</code> — pad numeric string to fixed length.<br><code>concat(field1,&#x27; &#x27;,field2)</code> — concatenation.<br><code>if(empty(field), default(&#x27;UNKNOWN&#x27;), field)</code> — conditional default.<br><code>regex_replace(field,&quot;[^0-9A-Za-z ]&quot;,&quot;&quot;)</code> — safe string normalize.<br><code>currency_to_integer(field, decimals)</code> — parse "15.000.000,00" to integer cents.<br><code>fx_convert(field, rate_field)</code> — conversion using provided rate field and recording conversion metadata. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>H. Additional Spreadsheet Helpers & Excel Snippets</strong><br>Extra paste-ready formulas:<br>1) Extract digits and pad NPWP: <code>=TEXT(TEXTJOIN(&quot;&quot;,TRUE,IFERROR(MID(A2,ROW(INDIRECT(&quot;1:&quot;&amp;LEN(A2))),1)*1,&quot;&quot;)),REPT(&quot;0&quot;,15))</code>.<br>2) Months proration: <code>=ROUND((PERIOD_END - PERIOD_START + 1)/30 * 12, 2)</code> (adjust per business rule).<br>3) Component sum tolerance check: <code>=IF(ABS(PenghasilanBruto - SUM(component_range))&lt;=2,&quot;OK&quot;,&quot;ERR_COMP_MISMATCH&quot;)</code>.<br>4) FX weighted average rate: <code>=SUMPRODUCT(amount_range,rate_range)/SUM(amount_range)</code>.<br>5) Conditional header mapping detect: <code>=IF(COUNTIF(header_row,&quot;NPWP_Pemotong&quot;)=0,&quot;HEADER_MISMATCH&quot;,&quot;OK&quot;)</code>. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>I. Additional Error Codes & Remediation Templates (Expanded)</strong><br><code>ERR006,FXVarianceHigh,WARNING,review_fx_rates; attach treasury_approval,Finance Treasury</code>.<br><code>ERR007,DuplicateNIKAcrossBranches,ERROR,investigate_duplicate_nik &amp; reconcile IDs,HR Data Team</code>.<br><code>ERR008,NegativeCorrectionExceedsThreshold,CRITICAL,open audit ticket &amp; attach approval,Compliance</code>.<br><code>ERR009,TemplateHeaderMismatch,CRITICAL,block mapping &amp; request portal template,IT/Mapping Owner</code>.<br><code>ERR010,CalcEngineVersionMismatch,ERROR,rerun with matching calc_version or set calc_version header,Payroll Ops</code>.<br>Provide automated ticket templates for each (copy-ready) and add playbook links. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>J. Additional API Contract Examples (Full Request/Response Samples)</strong><br>Example <code>POST /api/exports</code> request (multipart):<br>Headers:<br><code>Authorization: Bearer {token}</code><br><code>Content-Type: multipart/form-data; boundary=...</code><br>Body parts:<br>1) <code>file</code> — acceptance_bundle_{kpp}_{period}.zip<br>2) <code>export_metadata</code> — JSON block with operator_id, calc_version, validator_version, bundle_sha256.<br>Response (200):<br><code>{ &quot;export_id&quot;:&quot;exp_20250630_001&quot;,&quot;parse_summary&quot;:{&quot;records_processed&quot;:1200,&quot;criticals&quot;:0,&quot;warnings&quot;:3},&quot;staging_url&quot;:&quot;https://portal.example/parse/exp_20250630_001&quot; }</code>.<br>Response (409 duplicate):<br><code>{ &quot;error&quot;:&quot;duplicate_bundle&quot;,&quot;bundle_sha256&quot;:&quot;...&quot;,&quot;existing_export_id&quot;:&quot;exp_20250531_045&quot; }</code>. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>K. Additional Troubleshooting Scenarios & Operator Action Lists</strong><br>1) Staging parse reports <code>XSD MissingNode</code> only for records with long job titles — Action: run mapping preprocessor to split long title into <code>NamaJabatan</code> + <code>NamaJabatanFullAttachment</code>, regenerate XML sample and re-run XSD.<br>2) Bulk NPWP normalization fails on special characters from a third-party payroll system — Action: run <code>regex_replace</code> transform and re-validate; open ticket to vendor asking for encoding export fix (include sample failing values).<br>3) Portal returns parse success but GL reconciliation mismatch — Action: sample 100 highest-value employees, compare calc_log outputs vs portal calculation nodes, escalate with <code>reconciliation_issue_report.csv</code>. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>L. Sample CLI Commands (Operator Examples)</strong><br>Validate file:<br><code>bpa-validator --input raw_export.xlsx --out /workspace/validation/ --strict</code>.<br>Run calc (dry-run):<br><code>calc-engine --input /workspace/validation/validated.csv --version v3.0 --dry-run --out /workspace/calc_logs/</code>.<br>Generate bundle:<br><code>bundle-maker --xml /workspace/xml_canonical/ --metadata export_metadata.json --out /workspace/bundles/acceptance_bundle_kpp_period.zip</code>.<br>Upload to staging (curl example):<br><code>curl -X POST -H &quot;Authorization: Bearer $TOKEN&quot; -F &quot;file=@acceptance_bundle.zip&quot; -F &quot;export_metadata=@export_metadata.json&quot; https://api.portal.example/api/exports</code>.<br>Compute sha256 in Linux:<br><code>sha256sum acceptance_bundle.zip &gt; acceptance_bundle.zip.sha256</code>. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>M. Additional Email Templates & Communication Snippets (Copy-Ready)</strong><br>1) Signoff request to Tax Lead:<br>Subject: <code>Signoff Request: Acceptance Bundle {kpp} {period}</code><br>Body: <code>Attached acceptance_bundle_{kpp}_{period}.zip (sha256: {bundle_sha256}). Please review calc_summary and validation_report; kindly provide SSO signoff by EOD {date}.</code>.<br>2) Staging failure notice to IT:<br>Subject: <code>URGENT: Staging Parse Failure {export_id}</code><br>Body: <code>Staging returned parse errors: {errors_count}. Attached staging_failure_report.json and sample failing rows. Please triage.</code>. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>N. Additional Audit Example — Per-Employee Package Manifest (Sample)</strong><br><code>manifest.txt</code> sample for employee E1001:<br><code>/calc_logs/r501.json sha256: abc...</code><br><code>/xml_canonical/E1001.xml sha256: def...</code><br><code>/signoff_evidence/payroll_signoff_E1001.pdf sha256: ghi...</code><br><code>/attachments/payslip_2025-01.pdf sha256: jkl...</code>.<br>Audit package produced as encrypted ZIP with manifest and per-file sha256. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>O. Extra Operational Checklists (Shift Handover Copy-Paste)</strong><br>Shift handover quick list:<br>1) Verify <code>last_successful_export.txt</code> timestamp.<br>2) Confirm <code>bundle_registry.csv</code> latest status.<br>3) Review <code>validation_summary.json</code> for new criticals.<br>4) Ensure <code>backup_tests/restore_test_result.txt</code> is green for last 6 months.<br>5) Handover notes: list pending AMEND bundles and owners. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>P. Additional Governance Examples — Signoff Matrix Sample</strong><br>Signoff matrix snippet:<br><code>Step: Assembly</code> — Responsible: Payroll Operator — Accountable: Payroll Manager — Required evidence: manifest + calc_summary.<br><code>Step: Tax Review</code> — Responsible: Tax Analyst — Accountable: Tax Lead — Required evidence: calc_qc_report + sample calc_logs.<br><code>Step: Upload</code> — Responsible: IT Ops — Accountable: IT Manager — Required evidence: staging_parse_summary + upload_response. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Q. Addenda — Tooling & Automation Snippets</strong><br>Suggested automation tasks to add to repo (copy-ready descriptions):<br>1) <code>golden_regression_runner</code> — nightly job that runs golden-file scenarios and emits <code>regression_dashboard.html</code>.<br>2) <code>bundle_auditor</code> — verifies bundle sha256, signs manifest with HSM, and moves to cold storage after retention period.<br>3) <code>validator_rule_tester</code> — small harness to run unit tests for newly added validator rules before merging. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>R. How to Add These New Examples to Repo</strong><br>Recommended file layout additions:<br>1) <code>/examples/grossup_traces/grossup_r501.json</code> — add solver traces.<br>2) <code>/examples/xml_samples/E1001_pretty.xml</code> and <code>/examples/xml_samples/E1001_canonical.xml</code>.<br>3) <code>/examples/cli_samples/README.md</code> — include the CLI commands shown above.<br>4) <code>/examples/golden_extra.xlsx</code> — append scenarios 22–33 with expected calc_log sha256. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>S. Final Notes on Expansion</strong><br>This expansion is additive: nothing in the existing single-column document has been removed or reduced. The new sections labeled A–R provide additional concrete examples, templates, and operational artefacts intended for immediate copy-paste use in test suites, operator runbooks, and audit packs.<br>If you want this written into separate files (examples workbook, JSON examples, or CLI scripts) I can generate them as downloadable artefacts in the current session — specify which artefacts you want first and I will produce them. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>World-Class Enhancements — Elevating the Complete Guide to a Global Standard (additive sections)</strong><br><strong>Executive TL;DR (1-page «what, why, outcomes, metrics»)</strong><br>What: a hardened, auditable, fully automated BPA1 → XML pipeline delivering deterministic tax calculations, full artefact lineage, and auditable signoff for regulatory upload.<br>Why: reduce portal rejects, eliminate manual rework, ensure deterministic reproducibility, and shorten time-to-compliance to SLA ≤ 3 business days for critical issues.<br>Outcomes (measurable): staging parse failure rate <1%, golden-file regression pass ≥99.5%, mean-time-to-fix (critical) ≤ 24 hours, bundle reproducibility (sha256) = 100% across environments. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Governance & Maturity Model (Level 0 → 4)</strong><br>Level 0 — ad hoc: manual exports, no versioning.<br>Level 1 — repeatable: scripted validator, manual signoff logs.<br>Level 2 — defined: standardized artefacts, mapping versioning, automated validation with tickets.<br>Level 3 — managed: automated calc engine, CI regression, RBAC + MFA + HSM signing, SLA monitoring.<br>Level 4 — optimized (world-class): full CI/CD with automated golden-file regression before any mapping/calc change, immutable signed bundles, automated reconciliation to GL, SRE-style runbooks and post-incident reviews, quarterly external audit. Recommend target: achieve Level 3 within 90 days, Level 4 within 6–12 months. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Target Operating Model (People, Process, Platform)</strong><br>People: define RACI per gate; create Roles: Export Operator, Validator Owner, Mapping Owner, Calc Owner, Release Manager, On-call SRE; maintain <code>owners.yml</code> and on-call rota.<br>Process: codify gates as automated pipelines with gate artifacts required to proceed; enforce signoffs via SSO + MFA; automated ticketing for CRITICALs.<br>Platform: containerized validator & calc (Docker), artifact repo (object storage), HSM for signing, CI pipeline (e.g., :contentReference[oaicite:0]{index=0} / :contentReference[oaicite:1]{index=1}), monitoring stack (e.g., :contentReference[oaicite:2]{index=2}, :contentReference[oaicite:3]{index=3}). </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Reference Architecture (Components & Data Flows)</strong><br>Layers: Ingest (SFTP/portal export) → Validation/Normalization → Calc Engine (deterministic) → Mapping/Transformer → XML Builder → Bundle Assembler → Staging/Production Upload. Add Observability bus (event logs) and Audit Store (immutable archive).<br>Key integrations: SSO (for signoffs), Ticketing (creates tickets automatically), Object Storage (versioned buckets), HSM for signing manifests, Portal API (staging & production). </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Security & Compliance Enhancements</strong><br>Controls: AES-256 at rest, TLS 1.2+ (prefer TLS 1.3), mutual TLS for API, client certs for server-to-server, HSM-signed manifests, strict RBAC and time-limited access tokens, centralized secrets (vault).<br>Standards mapping: implement controls aligned to :contentReference[oaicite:4]{index=4} controls (access control, cryptographic controls, change management) and produce an audit trace for each control. Perform annual external penetration test and quarterly vulnerability scans. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Observability, Logging & Integrity Monitoring</strong><br>Implement structured logging (JSON) for all pipeline steps with correlation_id (export_id). Capture Calc Engine events, validation errors, mapping diffs, signoff events (SSO id) and portal responses. Ship logs to central ELK/Opensearch; create indexed <code>calc_log_index</code> for fast audit lookup. Maintain automated integrity monitors: checksum drift alerts, daily ledger digest signed by HSM, alerting on missing artefacts. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Automation & CI/CD (Quality Gates)</strong><br>All mapping, validator rules, calc_engine updates live in Git with PRs and mandatory pipeline checks: unit tests, linting, golden-file regression. PR merge triggers: run full golden-file suite for changed mapping/calc code; block merge on regression. Provide example CI job (YAML) that runs validator, calc engine, mapping, and computes sha256 diffs. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Testing Strategy — Unit, Integration, Golden Regression</strong><br>Unit tests for all transforms and calc modules; integration tests that run sample workspaces end-to-end; nightly golden-file regression covering core + edge cases (including scenarios 1–33). Define acceptance criteria: sha256 calc_log matches expected; XSD validation success; critical_count=0. Record test coverage and require 90%+ coverage for calc logic. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Data Lineage, Provenance & Reproducibility</strong><br>For each artifact store: origin (raw_export sha256), transformation steps (change_ledger entries), calc_version and commit hash, mapping_version, XML canonical sha256. Provide a <code>lineage/{bundle_id}.json</code> that links raw → validation → calc_logs → xml → bundle sha256. Ensure ability to reproduce any calc_log by re-running calc_engine with inputs + calc_version + seed. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>SRE-style Runbooks & Incident Response</strong><br>Provide step-by-step runbooks: Incident Triage (critical parsing failure), Rollback (how to revoke bundle, create amend_bundle), Hotfix (how to promote mapping patch with immediate golden-file run). Record post-incident review template with root cause, corrective action, owner, and timeline. Automate alerting into PagerDuty/Slack (e.g., :contentReference[oaicite:5]{index=5} and :contentReference[oaicite:6]{index=6}) with on-call. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>KPIs, Dashboards & Sample SQL</strong><br>Key metrics: <code>staging_parse_failure_rate</code>, <code>golden_regression_pass_rate</code>, <code>mean_time_to_fix_critical</code>, <code>bundle_repro_success_rate</code>.<br>Sample SQL (Postgres) — daily critical count:<br><code>SELECT date(processed_at) AS day, count(*) FILTER (WHERE severity=&#x27;CRITICAL&#x27;) AS criticals FROM validation_report GROUP BY day ORDER BY day DESC;</code><br>Provide Grafana panels and alert rules (e.g., criticals > 0 → page on-call). </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Audit & Evidence Automation</strong><br>Automate per-employee audit ZIP generation: <code>calc_log</code>, <code>xml_canonical</code>, <code>signoff_evidence</code>, <code>payslip</code> (if allowed). Sign manifests with HSM and store signed manifest in archive. Expose audited manifests via read-only S3 presigned URLs to auditors for limited time. Provide verification script to validate sha256 chain. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Change Management & Template Drift Handling</strong><br>Implement a mapping-change policy: any mapping change must include mapping_diff, golden-file run, UAT signoff, and a planned promotion window. For portal template changes, automatically compare <code>template_sha256</code> and, if changed, create <code>mapping_change_ticket</code> and block production until mapping regression passes. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Operational Playbooks — Example Scenarios</strong><br>Include concise, stepwise playbooks for: mass NPWP remediation, gross-up failure, staging parse regressions, GL reconciliation discrepancies, portal template mismatch—each containing detection, containment, remediation, and post-mortem steps. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Training, Certification & Knowledge Transfer</strong><br>Design a 3-day operator certification: Day 1 — toolchain & validation; Day 2 — calc engine & mapping; Day 3 — incident handling, signoff evidence, compliance. Publish operator cheat-sheets and run quarterly drills. Maintain a public internal wiki and an onboarding checklist. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Implementation Roadmap (90 / 180 / 365 days, concrete milestones)</strong><br>0–30 days: CI/CD baseline, containerize validator & calc, create golden-file baseline, implement HSM PoC.<br>31–90 days: automated golden regression in CI, build monitoring dashboards, RBAC & SSO signoff enforcement, run 2 UAT cycles.<br>91–180 days: full production pipeline, SRE runbooks, incident automation, external audit prep.180–365 days: continuous improvement: reduce staging failures <1%, full Level 4 maturity, annual external audit. Assign owners to each milestone. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Risk Register & Mitigation (Top 10 risks)</strong><br>Examples: portal template change → mapping drift (mitigate: template sha256 detection + regression block), calc_engine bug → systematic miscalc (mitigate: CI golden tests + canary releases), unauthorized edit (mitigate: RBAC + append-only ledger + HSM-signed digests). Provide risk owner, likelihood, impact, and mitigation per risk. </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Deliverables I Will Expand/Produce Now (pick any; I will produce inline)</strong><br>1) Architect diagram (textual ASCII + component list). 2) CI YAML example for golden regression. 3) Sample calc_log JSON canonical schema + validator JSON schema. 4) Sample <code>bundle_auditor</code> verification script (bash + sha256 checks). 5) Sample Postgres metric queries + Grafana panel spec. 6) Operator 1-page quick-start (printable).<br>Which of the above should I generate inline now? (If you prefer several, I will produce the top 3 immediately in this response.) </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Immediate Additions Included Below (generated now)</strong><br>— <strong>Calc_log canonical JSON schema (example)</strong>:<br><code>{ &quot;record_id&quot;:&quot;string&quot;, &quot;employee_id&quot;:&quot;string&quot;, &quot;inputs&quot;:{ &quot;...&quot;: &quot;...&quot; }, &quot;steps&quot;:[{&quot;step&quot;:&quot;string&quot;,&quot;formula&quot;:&quot;string&quot;,&quot;input_refs&quot;:[&quot;...&quot;],&quot;value&quot;:number}], &quot;outputs&quot;:{ &quot;pph_annual&quot;:number,&quot;total_withheld&quot;:number,&quot;balance&quot;:number }, &quot;calc_version&quot;:&quot;string&quot;, &quot;rounding_rule_id&quot;:&quot;string&quot;, &quot;timestamp&quot;:&quot;ISO8601&quot;, &quot;operator_id&quot;:&quot;string&quot;, &quot;sha256&quot;:&quot;hexstring&quot; }</code><br>— <strong>Sample CI job (GitHub Actions) — golden regression skeleton</strong>:<br><code>name: Golden Regression on: [pull_request] jobs: regression: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 - name: Setup Python uses: actions/setup-python@v4 with: { python-version: &#x27;3.11&#x27; } - name: Install deps run: pip install -r requirements.txt - name: Run validator run: ./scripts/run_validator.sh $INPUT_FILE --out /tmp/validated.csv - name: Run calc engine run: ./scripts/run_calc.sh /tmp/validated.csv --version $CALC_VERSION --out /tmp/calc_logs - name: Compare golden sha256 run: ./scripts/compare_golden.sh /tmp/calc_logs /goldens</code><br>— <strong>Sample bundle verification script (bash)</strong>:<br><code>#!/usr/bin/env bash set -euo pipefail bundle=$1 shafile=&quot;${bundle}.sha256&quot; echo &quot;Verifying $bundle&quot; sha256sum -c &quot;$shafile&quot; unzip -q &quot;$bundle&quot; -d /tmp/bundle_check jq -r &#x27;.files[]|.path + &quot; &quot; + .sha256&#x27; /tmp/bundle_check/manifest.json | while read path sha; do echo &quot;$sha  /tmp/bundle_check/$path&quot; | sha256sum -c -; done echo &quot;Bundle OK&quot;</code> </td></tr><tr><td data-label="Complete Guide — BPA1 XML Import Format &amp; Excel Converter"> <strong>Closing operational note (concise)</strong><br>The above additions focus on automation, reproducibility, elevated security, observability, and formal governance — the essential pillars of a world-class guide. I can now (immediately) expand any of the delivered artifacts into full files: architecture diagram, CI pipelines, full calc_log JSON schema with JSON Schema Draft, sample Power Query (M) skeleton, sample Python validator, or a printable operator quick-start PDF. Specify which 3 artifacts you want produced inline now and I will generate them in full. </td></tr></tbody></table></div><div class="row-count">Rows: 77</div></div><div class="table-caption" id="Table5" data-table="YJKN_0020_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Payroll Notice — Action Required"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Payroll Notice — Action Required</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Payroll Notice — Action Required"> Dear all,<br><br>For the <strong>December</strong> payroll we remain stuck at <strong>Step 9 — Post-run reconciliations & GL posting</strong>. I require the <strong>Payroll Officer / Accountant</strong> to complete the items below immediately:<br><br>1. <strong>Complete orange cells in YJKN_Data</strong> — populate all orange-highlighted fields and validate entries.<br><br>2. <strong>Tax & statutory fields (mandatory)</strong>:<br>2.1 <strong>PPh 21</strong> — enter monthly withholding per employee, include calculation link or cell notes, verify tax IDs/residency and PTKP treatment, and record <strong>PayrollRun ID</strong> on each line.<br>2.2 <strong>BPJSTK</strong> — enter employee & employer contributions, confirm rate basis and BPJSTK IDs, and show calculation cells.<br>2.3 <strong>BPJSKES</strong> — enter health contribution amounts, confirm rate basis and BPJSKES IDs, and show calculation cells.<br><br>3. <strong>Validation & reconciliation</strong> — ensure YJKN_Data totals reconcile to the payroll control sheet and to the GL upload preview; include GL account codes and currency. Run formula checks and resolve any mismatches.<br><br>4. <strong>Pending journals</strong> — confirm, authorise and post the pending adjustment journal(s). Each posted journal must include:<br>- approval evidence (who approved and when),<br>- calculation backup,<br>- <strong>PayrollRun ID</strong>, and<br>- a clear narration referencing the payroll period and bank batch where applicable.<br><br>5. <strong>Bank evidence & GL preview</strong> — attach GL upload preview and bank advices / SWIFT confirmations required for reconciliation. Reconcile posted journals to bank advices and note any timing differences.<br><br>6. <strong>Control pack & status update</strong> — update payroll control sheet totals, compile the reconciled control pack, set the YJKN_Data status column to <strong>“Completed”</strong>, and save the control pack with the standard filename convention.<br><br>7. <strong>Reply & attachments</strong> — confirm completion by replying to this thread and attach:<br>- the updated <strong>YJKN_Data</strong> file (highlight changes),<br>- reconciled control pack (PDF),<br>- GL upload preview, and<br>- bank advices / SWIFT confirmations and journal supporting docs.<br><br>Time is critical — please confirm in-reply the expected time of upload and who will perform each item (name & role). </td></tr></tbody></table></div><div class="row-count">Rows: 1</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>