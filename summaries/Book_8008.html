<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1760513344">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      // Delegate addEventListener/removeEventListener to visible button
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      // Delegate onclick assignments
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      // Delegate focus/blur
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
      // If legacy code used direct addEventListener earlier than this script, listeners would already exist
      // on alias element; attempt to re-dispatch those by cloning them to visible button is non-trivial.
      // This approach covers the common case where legacy scripts query the alias and bind after DOM ready.
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Book_8008_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Selector / Area**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Selector / Area</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual Notes, Behavior, Risks, and Enhancement Ideas"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes, Behavior, Risks, and Enhancement Ideas</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Selector / Area"> <strong>Global Reset and Base Rules</strong>                                     </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Establishes consistent cross-browser behavior by resetting margin, padding, and border-collapse. These base rules are foundational but may unintentionally override framework defaults if integrated into larger apps. For instance, a global <code>box-sizing: border-box;</code> rule simplifies layout calculations but requires careful handling when third-party widgets expect <code>content-box</code>. Risks include: inconsistent inheritance across shadow DOM contexts, CSS specificity conflicts if this project is embedded inside larger web portals, and accessibility concerns if base line-height or font-size values are overridden.<br>Enhancements:<br>(1) Document clearly which global resets are safe to override<br>(2) Add <code>html { font-size: 100%; }</code> to anchor root rem scaling for accessibility<br>(3) Consider scoping resets inside a <code>.tv2-root</code> class wrapper to avoid global bleed </td></tr><tr><td data-label="Selector / Area"> <strong>Typography Base (body, headings, captions)</strong>                      </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Defines primary font family, size, and weight. Aims to balance readability with compact table rendering. Risks: too small font size reduces legibility on 4K monitors or mobile devices; insufficient color contrast against background can fail WCAG 2.1 AA standards.<br>Enhancements:<br>(1) Use system fonts with fallbacks (<code>-apple-system</code>, <code>Segoe UI</code>, <code>Roboto</code>) for consistency<br>(2) Ensure heading contrast ratio ≥ 4.5:1<br>(3) Add media queries for <code>prefers-contrast</code> and <code>prefers-reduced-motion</code><br>(4) Provide a <code>.tv2-accessible</code> override mode with larger font sizes                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Selector / Area"> <strong>Table Wrapper (<code>.table-wrapper</code>)</strong>                                </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Core container that provides max-height, overflow, and scrollbars when sticky headers are enabled. Risks: scrollbars differ across OS (overlay vs. permanent). If wrapper is nested in flexbox or grid layouts, overflow behavior may break.<br>Enhancements:<br>(1) Explicit <code>max-height</code> configuration via CSS variable (<code>--tv2-table-max-height</code>)<br>(2) Conditional scrollbar styling with <code>scrollbar-gutter: stable;</code><br>(3) Print mode override to disable scrolling and expand full height                                                                                                                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Selector / Area"> <strong>Table Element (<code>table</code>)</strong>                                         </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Central selector controlling table layout, width, border-collapse, and spacing. Risks: if <code>table-layout: fixed;</code> is used, column auto-sizing is disabled, possibly truncating long text. If <code>table-layout: auto;</code> is kept, performance on large tables may degrade.<br>Enhancements:<br>(1) Add switchable class <code>.fixed-layout</code> vs <code>.auto-layout</code><br>(2) Add CSS hooks for column typing (numeric, code, date) to align right/monospace<br>(3) Consider <code>border-spacing: 0</code> to prevent gaps on print                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Selector / Area"> <strong>Table Caption (<code>.table-caption</code>)</strong>                                </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Recently refactored: wrapped in <code>&lt;div class=&quot;table-caption&quot;&gt;</code> with <code>margin-left: 3mm</code> for alignment. Risks: <code>&lt;div&gt;</code> lacks semantic meaning for screen readers; ARIA mapping is required. Captions may misalign in RTL (right-to-left) contexts.<br>Enhancements:<br>(1) Replace with <code>&lt;caption&gt;</code> plus visually-hidden anchor, or add <code>role=&quot;caption&quot;</code><br>(2) Add <code>dir</code> attribute awareness<br>(3) Ensure print styles preserve captions at top of each page<br>(4) Add media query: <code>@media print { .table-caption { margin-left: 0; } }</code>                                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Selector / Area"> <strong>Table Header (<code>thead th</code>)</strong>                                       </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Sticky header implementation: <code>position: sticky; top: 0; z-index: 2;</code>. Strength: keeps headers visible during scrolling. Risks: sticky fails in some Safari/iOS versions inside overflowed containers. Also, background color must be re-applied to avoid transparency bleed.<br>Enhancements:<br>(1) Add fallback JS polyfill for legacy browsers<br>(2) Ensure header cells have explicit <code>background-color</code><br>(3) Use <code>scope=&quot;col&quot;</code> attributes to improve accessibility<br>(4) Provide contrast-safe header background (≥ 3:1 vs. text)                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Selector / Area"> <strong>Table Body (<code>tbody td</code>)</strong>                                         </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Controls padding, borders, and text alignment. Risks: overuse of <code>white-space: nowrap;</code> causes overflow issues; wrapping may be needed.<br>Enhancements:<br>(1) Provide CSS classes <code>.col-numeric</code>, <code>.col-code</code>, <code>.col-date</code> to align accordingly<br>(2) Add <code>hyphens: auto;</code> for long text in word-wrapped columns<br>(3) Provide print override to break words when necessary                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Selector / Area"> <strong>Row Striping (<code>tbody tr:nth-child(even)</code>)</strong>                       </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Alternating background for readability. Risks: color contrast insufficient on projectors or in dark mode.<br>Enhancements:<br>(1) Use CSS variables for <code>--row-stripe-bg</code><br>(2) Respect <code>prefers-color-scheme: dark</code><br>(3) Provide <code>.no-stripe</code> class to disable striping for accessibility                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Selector / Area"> <strong>Hover Effects (<code>tbody tr:hover</code>)</strong>                                </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Adds interactive highlight for current row. Risks: low contrast hover states may confuse; hover not accessible on touch devices.<br>Enhancements:<br>(1) Provide focus-visible alternative: <code>tbody tr:focus-within</code><br>(2) Ensure hover color contrast ≥ 3:1<br>(3) Add subtle animation disabled under <code>prefers-reduced-motion</code>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Selector / Area"> <strong>Column Typing (future <code>.col-numeric</code>, <code>.col-code</code>, <code>.col-date</code>)</strong> </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Not yet in stylesheet but critical for upcoming <code>core_table.py</code> enhancement. Planned rules: <code>.col-numeric { text-align: right; }</code>, <code>.col-code { font-family: monospace; }</code>, <code>.col-date { text-align: center; }</code>. Risks: mis-typed columns produce wrong alignment.<br>Enhancements:<br>(1) Ensure robust detection in backend<br>(2) Add <code>.col-unknown</code> fallback<br>(3) Provide user override classes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Selector / Area"> <strong>Export Buttons (<code>.export-btn</code>)</strong>                                  </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Style for per-table CSV/XLSX export buttons. Risks: inconsistent placement near tables, overlap with scrollbars.<br>Enhancements:<br>(1) Position relative to <code>.table-wrapper</code> top-right<br>(2) Add <code>aria-label=&quot;Export table&quot;</code><br>(3) Provide CSS variables for button size and color<br>(4) Ensure buttons hide on print                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Selector / Area"> <strong>Collapsible Rows (<code>.collapsed</code>, <code>.expand-toggle</code>)</strong>               </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Handles large table truncation with toggle to reveal more rows. Risks: if toggle icon lacks text alternative, fails accessibility.<br>Enhancements:<br>(1) Ensure <code>.expand-toggle</code> has <code>aria-expanded</code> and screen reader label<br>(2) Smooth animation with <code>max-height</code> transitions<br>(3) Print override: expand all rows                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Selector / Area"> <strong>Dark Mode Support</strong>                                               </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Currently minimal. Risks: stripe backgrounds and caption margins may look off in dark themes.<br>Enhancements:<br>(1) Add <code>@media (prefers-color-scheme: dark)</code> overrides<br>(2) Define semantic CSS variables for colors<br>(3) Ensure hover and stripe maintain adequate contrast in both light and dark modes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Selector / Area"> <strong>Accessibility Features</strong>                                          </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Critical. Risks: reliance on <code>&lt;div&gt;</code> caption breaks semantic linkage; sticky headers may lose context for screen readers.<br>Enhancements:<br>(1) Use <code>&lt;caption&gt;</code> properly<br>(2) Add <code>role=&quot;table&quot;</code><br>(3) Add <code>aria-labelledby</code> linking caption IDs to table IDs<br>(4) Ensure keyboard focus states visible with <code>outline: 2px solid</code>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Selector / Area"> <strong>Print Styles (<code>@media print</code>)</strong>                                   </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Needs review. Risks: scroll wrappers cut off table content; sticky headers may duplicate; export buttons may appear on print.<br>Enhancements:<br>(1) Remove <code>.table-wrapper</code> overflow on print<br>(2) Force captions to top with no margin-left shift<br>(3) Hide interactive elements like buttons and toggles                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Selector / Area"> <strong>Animations and Transitions</strong>                                      </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Minimal, mainly for expand/collapse. Risks: motion-sensitive users may be affected.<br>Enhancements:<br>(1) Respect <code>prefers-reduced-motion</code><br>(2) Provide duration variables<br>(3) Ensure animations degrade gracefully                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Selector / Area"> <strong>Cross-Browser Testing Areas</strong>                                     </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Safari sticky header quirks, IE11 lack of support, Firefox scrollbar styling differences.<br>Enhancements:<br>(1) Add test harness across major browsers<br>(2) Provide fallback for sticky header on unsupported<br>(3) Document limitations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Selector / Area"> <strong>Performance Considerations</strong>                                      </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Large tables may cause reflow lag if too many CSS rules cascade.<br>Enhancements:<br>(1) Minimize deep selectors<br>(2) Use class-based targeting instead of element selectors<br>(3) Test on 50k+ rows dataset for scroll jank                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Selector / Area"> <strong>Diagnostics and Debug Classes</strong>                                   </td><td data-label="Conceptual Notes, Behavior, Risks, and Enhancement Ideas"> Missing but useful. Suggestion: <code>.debug-outline</code> class to visualize cell boundaries; <code>.debug-coltype</code> to highlight inferred column types.<br>Enhancements:<br>(1) Provide debug mode toggle in <code>core_renderer.py</code><br>(2) Ensure debug styles don’t leak into production                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr></tbody></table></div><div class="row-count">Rows: 19</div></div><div class="table-caption" id="Table2" data-table="Book_8008_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual notes, risks, tests, remediation**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual notes, risks, tests, remediation</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module purpose & header</strong>                         </td><td data-label="Conceptual notes, risks, tests, remediation"> Feature-rich, defensive table renderer. Opt-in enhancements while preserving legacy behavior. Risk: scope creep if too many opt-ins enabled by default. Test: baseline rendering with no options vs with all options. Remediation: keep opt-ins false by default and document flags.                                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Configuration / safety caps</strong>                     </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_MAX_CELL_HTML</code>, <code>_MAX_ROWS_SAFE_RENDER</code>, <code>_MAX_COLS_SAFE</code>, <code>_TRUNCATE_SUFFIX</code>, <code>_COLUMN_TYPE_SAMPLE</code>. Purpose: protect memory/DOM. Risk: legitimate large tables may be truncated silently. Test: render tables at 1k, 10k, 100k rows; assert warning logs. Remediation: surface caps in metadata and docs; provide server config override.                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Module-level state</strong>                              </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_ASSETS_EMITTED</code> prevents duplicate injection. Risk: persists across process lifetime in multi-tenant servers. Test: multi-render in same process and forked worker behavior. Remediation: allow explicit reset or per-request emit flag.                                                                                                                                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>Optional imports (pandas, xlsx libs, sanitizer)</strong> </td><td data-label="Conceptual notes, risks, tests, remediation"> Fail-soft imports allow degraded operation. Risk: silent feature loss (exports, sanitize). Test: run with/without libs and check metadata flags. Remediation: add diagnostics in metadata and logs when features unavailable.                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Markdown callable selection</strong>                     </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_get_md_callable</code> returns safe fallback escaping. Risk: unpredictable third-party md objects. Test: pass common md renderers, objects with <code>.render</code>, and plain callables. Remediation: document expected callable signature.                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Diagram detection & RTL helpers</strong>                 </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_is_diagram_text</code>, <code>_detect_rtl_chars</code>, <code>_dir_for_text</code>. Purpose: detect box drawings and RTL for <code>dir</code> attr. Risk: false positives/negatives. Test: sample cells with diagrams, mixed scripts. Remediation: tune regex or expose as option.                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Code stash / placeholders</strong>                       </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_stash_code_local</code> and <code>_restore_code_placeholders_in_html</code> protect fenced and inline code during markdown processing. Risk: nested/malformed fences. Test: complex markdown with nested fences and inline code. Remediation: add unit tests and fallback escape paths.                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Underscore & pipe protection</strong>                    </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_preprocess_underscores_outside_placeholders</code> + <code>_restore_protection_entities</code>. Purpose: avoid markdown/pipe table misinterpretation. Risk: double escaping with sanitizer. Test: inputs with underscores/pipes pre/post sanitize. Remediation: ensure ordering of sanitize/restoration is robust.                                                                                                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Logic / Structure"> <strong>Cell rendering pipeline</strong>                         </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_render_cell_text</code> does: stash → preprocess → md_callable → restore entities → restore code → sanitize → truncate. Strength: layered fallbacks and sanitizer support. Risks: performance on many cells, sanitizer signature variance. Tests: XSS attempts, very long HTML, sanitizer missing. Remediation: expose <code>max_cell_html</code> via options; time profiling.                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Input normalization</strong>                             </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_rows_from_iterable</code> supports <code>to_pandas</code>, pandas.DataFrame, list-of-dicts, list-of-lists, generic iterables; heuristically detects header. Risk: ambiguous header detection; inconsistent column ordering for list-of-dicts with missing keys. Tests: combinations of inputs, objects exposing <code>to_pandas</code>. Remediation: document expected input shapes and provide <code>header</code> override option.                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Uniform rows / padding</strong>                          </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_ensure_uniform_rows</code> pads or trims rows to <code>max_cols</code>. Risk: silent trimming may drop data. Tests: rows with differing lengths; verify logging when trimming occurs. Remediation: include truncation metadata and allow <code>strict=True</code> option that raises.                                                                                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Table alignments extraction</strong>                     </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_get_table_alignments</code> inspects <code>_table_alignments</code> or <code>.alignments</code>. Usage: emit <code>data-align</code> and inline style. Risk: inconsistent align semantics. Test: provide alignments array and confirm <code>th</code>/<code>td</code> styles. Remediation: normalize values to `left                                                                                                                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Logic / Structure"> <strong>Value type guessing</strong>                             </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_guess_value_type</code> identifies <code>empty</code>, <code>boolean</code>, <code>integer</code>, <code>numeric</code>, <code>json</code>, <code>html</code>, <code>diagram</code>, <code>code</code>, <code>datetime</code>, <code>text</code>. Risk: locale formats (commas/periods) and ambiguous numeric strings. Tests: variety of numbers (<code>1,234</code>, <code>1.234,56</code>), ISO and non-ISO dates, HTML fragments. Remediation: add locale-aware numeric parsing option and date-format hints.                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Column type detection</strong>                           </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_detect_column_types</code> samples up to <code>_COLUMN_TYPE_SAMPLE</code> rows and selects majority type per column; maps integer/float → <code>numeric</code>. Risks: small sample misclassification, mixed-type columns, performance on many columns. Tests: mixed columns, sparse columns, large sample sizes. Remediation: expose <code>sample_size</code> option, report confidence per column, emit <code>data-tv-has-coltype</code>.                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>CSS token sanitizer</strong>                             </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_class_token</code> safe-normalizes type strings into CSS class tokens. Risk: empty token returns; unusual characters. Tests: weird unicode; ensure token non-empty for common types. Remediation: fallback mapping table (e.g., "numeric"→"numeric").                                                                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Hidden anchors & heading init script</strong>            </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_make_hidden_heading_anchor</code> and <code>_heading_init_script</code> produce idempotent client assembly for <code>.table-heading-bar</code>. Strength: builds a nav across tables. Risks: script injection safety, duplicate assembly, dependency on DOM insertion points. Tests: multiple tables, fragment rendering, pages with existing <code>.table-heading-bar</code>. Remediation: keep script minimal and idempotent (already done); ensure safe embedding.                                                                                                                                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>One-time assets bundle</strong>                          </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_one_time_assets</code> returns small CSS+JS for client behaviors (binding, export, copy, lazy-load). Risk: duplication if <code>_ASSETS_EMITTED</code> logic fails; bundle may be insufficient for full <code>assets/style.css</code>. Tests: render many tables with fragment toggles, verify single injection when <code>emit_assets_once=True</code>. Remediation: prefer linking to central <code>assets</code> in production; mark <code>emit_assets_once</code> default behavior in docs.                                                                                                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Client binding JS behaviors</strong>                     </td><td data-label="Conceptual notes, risks, tests, remediation"> JS handles CSV/JSON/XLSX export, clipboard copy (plain/markdown), lazy-load chunk append, collapse toggle, and binding guard. Risks: reliance on <code>window.XLSX</code> for XLSX; clipboard API differences; disabled JS fallback. Tests: with/without SheetJS, with/without Clipboard API, generator for lazy chunks. Remediation: button visibility controlled by asset presence; ensure CSV fallback for XLSX.                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Safe JSON embedding</strong>                             </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_safe_json_for_script</code> escapes <code>&lt;/</code> sequences to avoid script termination. Risk: other script-breaking sequences. Test: JSON with <code>&lt;/script&gt;</code>, large payload. Remediation: use <code>textContent</code> or separate JSON file for huge payloads.                                                                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>Filter & sort server-side</strong>                       </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_filter_rows</code> and <code>_sort_rows</code> implement conservative filtering and sorting with coercions. Risks: numeric comparisons on strings may misbehave; complexity of conditions. Tests: gt/gte/lt/lte on numeric and string columns; <code>in</code> and <code>contains</code>. Remediation: pre-validate column type and coerce accordingly.                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Export helpers (server-side)</strong>                    </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_rows_to_csv_bytes</code>, <code>_rows_to_json_bytes</code>, <code>_rows_to_xlsx_bytes</code> support server export. Risks: memory usage for large datasets; optional libs absent. Tests: small/large exports, unicode characters, escaping quotes. Remediation: stream exports for huge tables or generate temp files.                                                                                                                                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Logic / Structure"> <strong>Data attributes builder</strong>                         </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>_build_data_attrs</code> serializes <code>tv_options</code> into <code>data-tv-*</code> attributes. Risk: embedding large JSON in attributes bloats DOM and may exceed attribute length limits. Tests: large <code>tv_options</code> dict. Remediation: if JSON too large, emit metadata script instead and reference by id.                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>render_table main flow</strong>                          </td><td data-label="Conceptual notes, risks, tests, remediation"> Steps: convert fallback → normalization → lazy split → detect column types (if auto) → inject assets → hidden anchor → wrapper & heading → header with <code>scope=&quot;col&quot;</code>, sort buttons → tbody rendering with <code>td</code> attributes (<code>data-label</code>, <code>data-col-type</code>, classes, <code>dir</code>) → lazy chunk embed → metadata script → return HTML. Strength: systematic. Risks: pandas <code>to_html</code> bypassing hooks; asset guard race conditions; id uniqueness. Tests: full render with all options combinations, fragment mode, emit_once toggles. Remediation: apply hooks consistently even in pandas branch when <code>auto_type</code> requested; add unique ID collision detection. </td></tr><tr><td data-label="Logic / Structure"> <strong>Accessibility practices</strong>                         </td><td data-label="Conceptual notes, risks, tests, remediation"> Emits <code>role=&quot;table&quot;</code>, <code>aria-labelledby</code>, <code>scope=&quot;col&quot;</code>, <code>dir</code> per cell, <code>data-label</code> for responsive. Risks: caption handling must match CSS and semantics (this code uses native <code>&lt;caption&gt;</code> when available). Tests: axe/pa11y audit, screen reader walkthrough, keyboard navigation. Remediation: ensure <code>&lt;caption&gt;</code> used over <code>div</code> fallback, keep <code>aria</code> references correct.                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Lazy-loading strategy</strong>                           </td><td data-label="Conceptual notes, risks, tests, remediation"> Server can embed remaining rows as JSON script <code>.table-row-chunk</code> and client binds a load button to append rows. Risks: embedding very large JSON still costly; client-side append may be slow. Tests: lazy threshold with 1k/10k remaining rows. Remediation: support chunked fetch endpoints or streamed workers for very large datasets.                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Metadata emission</strong>                               </td><td data-label="Conceptual notes, risks, tests, remediation"> Embeds <code>table-meta</code> JSON with <code>table_id</code>, <code>rows</code>, <code>displayed_rows</code>, <code>cols</code>, <code>tv_options</code>, <code>caption</code>, and <code>render_ms</code>. Strength: helpful for diagnostics. Risk: leakage of sensitive <code>tv_options</code>. Tests: confirm metadata size and redaction. Remediation: add <code>redact_tv_options</code> flag and size cap; replace large objects with <code>{...}</code> summary.                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Fragment & compatibility wrappers</strong>               </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>render_fragment</code> sets <code>fragment=True</code> and <code>inject_assets=False</code>. <code>simple_render_table</code> preserves minimal fallback. Risk: fragmentation mismatches assets/styles between fragments and main page. Tests: fragment assembly into pages with preloaded assets. Remediation: document embedding contract: fragments assume host includes assets.                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Public API & exported helpers</strong>                   </td><td data-label="Conceptual notes, risks, tests, remediation"> <code>__all__</code> exports rendering functions and many internals useful for testing. Risk: exposing internals increases maintenance surface. Test: import surface and ensure backward compatibility. Remediation: keep stable API for main functions and mark internals as internal in docs.                                                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Edge cases & notable findings</strong> </td><td data-label="Conceptual notes, risks, tests, remediation"> 1. <strong>pandas <code>.to_html</code> branch short-circuits advanced hooks</strong> unless <code>auto_type</code> requested → risk: inconsistent column typing and CSS hooks. <br>2. <strong><code>_ASSETS_EMITTED</code> global persists across renders</strong> → risk: asset injection skipped unexpectedly in long-lived processes or multi-tenant servers. <br>3. <strong><code>aria-labelledby</code> logic uses caption id when present (correct)</strong> → good for accessibility, but fragile if captions become optional or malformed. <br>4. <strong>Class tokenization is defensive but may produce empty tokens</strong> for unknown/rare types → CSS selectors may fail. <br><strong>Remediation:</strong> tighten pandas hook integration, add asset lifecycle reset option, validate caption fallback, enforce default token mapping. </td></tr></tbody></table></div><div class="row-count">Rows: 29</div></div><div class="table-caption" id="Table3" data-table="Book_8008_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Selector / Area**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Selector / Area</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Detailed notes, risks, tests, acceptance criteria, and remediation**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Detailed notes, risks, tests, acceptance criteria, and remediation</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Selector / Area"> <strong><code>:root</code> variables (theme, typography, motion)</strong>               </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: centralizes theme tokens for colors, spacing, fonts, motion.<br>Risk: renaming or removing a token will cascade break styles.<br>Test: toggle <code>prefers-color-scheme</code> and <code>[data-theme=&quot;dark&quot;]</code> and confirm all dependent rules update.<br>Acceptance: changing a token must visibly update 10+ UI elements.<br>Remediation: add small automated visual snapshot tests that toggles variables.                                                                                                                    </td></tr><tr><td data-label="Selector / Area"> <strong><code>@media (prefers-contrast: more)</code> overrides</strong>                 </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: high-contrast accessibility.<br>Risk: incomplete overrides leave unreadable combinations.<br>Test: emulate high-contrast and verify color contrast ratios >= 4.5:1 for body text and 3:1 for UI elements.<br>Acceptance: all controls pass contrast checks.<br>Remediation: add explicit contrasts for <code>--accent</code> and interactive element states.                                                                                                                                                                    </td></tr><tr><td data-label="Selector / Area"> <strong><code>@media (prefers-color-scheme: dark)</code> and <code>[data-theme=&quot;dark&quot;]</code></strong> </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: dark theme parity.<br>Risk: missing inverse token for some selectors (e.g., subtle borders).<br>Test: visually inspect dark mode on multiple platforms and ensure <code>code</code>/<code>pre</code> backgrounds remain legible.<br>Acceptance: no clipped gradients; no unreadable inline code.<br>Remediation: add <code>--panel-contrast</code> token for surfaces.                                                                                                                                          </td></tr><tr><td data-label="Selector / Area"> <strong>Global normalization (<code>*, html, body</code>)</strong>                      </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: baseline layout, fluid font scaling.<br>Risk: <code>clamp()</code> on font-size could conflict with legacy browsers.<br>Test: confirm readable sizes at 320px, 720px, and 1440px widths.<br>Acceptance: no overflow, no unreadably small text.<br>Remediation: add fallback <code>font-size</code> for old browsers.                                                                                                                                                                                </td></tr><tr><td data-label="Selector / Area"> <strong>Buttons (base, hover, active, focus-visible)</strong>                </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: consistent controls.<br>Risks: focus outline color may be low contrast in dark theme; <code>transform</code> hover may conflict with reduced-motion.<br>Tests: keyboard tab to each button; confirm <code>:focus-visible</code> matches token.<br>Acceptance: visible focus indicator and no motion when <code>prefers-reduced-motion</code>.<br>Remediation: ensure <code>:focus-visible</code> contrast and add <code>motion</code> gating for transform.                                                                                                                 </td></tr><tr><td data-label="Selector / Area"> <strong><code>.table-container</code> and <code>table</code> defaults</strong>                     </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: container for horizontal scroll and table layout.<br>Risks: <code>table-layout: fixed</code> plus <code>word-wrap</code> may truncate complex content; <code>min-width</code> can force horizontal scroll on mobile.<br>Tests: long cell content, nested lists, images, small viewport.<br>Acceptance: no overflow beyond container; readable cells; stable sticky headers.<br>Remediation: consider <code>table-layout: auto</code> fallback for content-rich tables or allow column auto-sizing via renderer metadata.                                        </td></tr><tr><td data-label="Selector / Area"> <strong><code>thead th</code> sticky header</strong>                                    </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: header remains visible.<br>Risks: <code>position: sticky</code> may be inconsistent inside overflowed parents; <code>top</code> depends on header height variable.<br>Tests: nested scroll containers, header height changes (e.g., multi-line header) and printing.<br>Acceptance: header stays pinned with no overlap of first row; click targets reachable.<br>Remediation: ensure header wrapper isn't in an overflowed ancestor; add <code>position: -webkit-sticky</code> fallback not necessary.                                               </td></tr><tr><td data-label="Selector / Area"> <strong>Sticky first column (<code>td:first-child</code>, <code>thead th:first-child</code>)</strong> </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: keeps row labels visible.<br>Risks: stacking context and z-index conflicts with sticky header; <code>left:0</code> breaks RTL.<br>Tests: long tables, mixed <code>position</code> ancestors, RTL layout.<br>Acceptance: first column visible and correctly layered in LTR; in RTL, behavior should flip or use logical <code>inset-inline-start</code>.<br>Remediation: add RTL support using <code>inset-inline-start</code> comments already present; implement when RTL detected.                                                                                  </td></tr><tr><td data-label="Selector / Area"> <strong>Sorting affordances (<code>.sort-btn</code>, <code>.th-with-sort</code>)</strong>          </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: visual affordance and pointer behavior.<br>Risks: <code>cursor:pointer</code> on <code>th</code> may mislead if JS unavailable; hover tint uses low alpha may be invisible in dark themes.<br>Tests: JS disabled; keyboard activation via <code>role=&quot;button&quot;</code> and <code>aria-pressed</code> states.<br>Acceptance: accessible keyboard sorting and clear affordance.<br>Remediation: add <code>.no-js</code> safe fallback and stronger hover in dark theme.                                                                                                           </td></tr><tr><td data-label="Selector / Area"> <strong><code>#stickyMainHeader</code> and <code>#tv-header</code></strong>                        </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: global sticky header and controls.<br>Risks: oversized header reduces viewport for small screens; sticky header stacking may cover <code>scroll-margin-top</code> anchors.<br>Tests: anchor linking to headings and table captions; resize across breakpoints.<br>Acceptance: anchor scroll lands content below header without being obscured.<br>Remediation: ensure <code>scroll-padding-top</code> at document root and consistent <code>--tv-header-min-height</code>.                                                                                  </td></tr><tr><td data-label="Selector / Area"> <strong><code>#tocBar</code> horizontal nav</strong>                                    </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: quick navigation across topics.<br>Risks: color contrast on small typography; horizontal scroll affordance unclear on some touch devices.<br>Tests: keyboard tabbing through TOC links; screen reader announcement.<br>Acceptance: focus order sensible; links announced properly.<br>Remediation: add <code>aria-label</code> on <code>#tocBar</code> and consider small left/right chevrons to make affordance explicit.                                                                                                               </td></tr><tr><td data-label="Selector / Area"> <strong><code>.table-caption</code> (caption fallback)</strong>                         </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: visual caption when <code>&lt;caption&gt;</code> not used; print-safe overrides.<br>Risks: duplicate semantics if renderer also emits <code>&lt;caption&gt;</code>; mismatch in anchor targets since caption moved to <code>div</code>.<br>Tests: screen reader behavior; ensure anchor links still navigate to table via <code>aria-labelledby</code> or <code>id</code>.<br>Acceptance: caption announced and anchors function.<br>Remediation: renderer should emit <code>role=&quot;table&quot;</code> and link caption with <code>aria-labelledby</code> to maintain semantics or prefer native <code>&lt;caption&gt;</code>. </td></tr><tr><td data-label="Selector / Area"> <strong>Column-type styling (<code>data-col-type</code>, <code>.col-*</code>)</strong>             </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: visual differentiation: numeric right-align, code monospace, date center.<br>Risks: renderer must emit attributes reliably. If values are mixed, CSS may misalign.<br>Tests: server-side render emitting <code>data-col-type</code> for numeric/code/date; browser render checks.<br>Acceptance: numeric columns right-aligned with <code>tabular-nums</code>; code columns single-line nowrap as intended.<br>Remediation: improve renderer heuristics and provide fallback class injection in JS for ambiguous columns.                       </td></tr><tr><td data-label="Selector / Area"> <strong>Export button styles (<code>.export-xlsx</code>)</strong>                       </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: consistent export CTA.<br>Risks: large <code>xlsx.full.min.js</code> weight; button present even if library not loaded.<br>Tests: simulate export with and without library; verify button disabled state and <code>aria-disabled</code>.<br>Acceptance: button visible only when export supported; if present show progressive enhancement.<br>Remediation: conditionally inject button markup only when assets include SheetJS or attach <code>data-export-enabled=&quot;true&quot;</code>.                                                                 </td></tr><tr><td data-label="Selector / Area"> <strong>Collapsible table (<code>.table-wrapper.table-collapsed</code>)</strong>        </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: allow collapsing large tables.<br>Risks: hiding <code>tbody</code> via <code>display:none</code> may remove rows from accessibility tree and screen readers may miss the toggle semantics.<br>Tests: screen reader behavior for collapsed state; JS toggles <code>aria-expanded</code>.<br>Acceptance: collapse toggle has <code>aria-controls</code> and <code>aria-expanded</code> and hidden rows not announced.<br>Remediation: use <code>hidden</code> attribute and <code>aria-hidden</code> properly; animate height instead of <code>display:none</code> for smoother UX.                          </td></tr><tr><td data-label="Selector / Area"> <strong>Reduced motion gating</strong>                                       </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: respect <code>prefers-reduced-motion</code>.<br>Risks: some transitions still applied via <code>transform</code> on elements not gated.<br>Tests: set <code>prefers-reduced-motion: reduce</code> and navigate UI.<br>Acceptance: no heavy animations or transforms.<br>Remediation: search CSS for non-gated transforms and add <code>@media (prefers-reduced-motion: reduce)</code> overrides.                                                                                                                                                           </td></tr><tr><td data-label="Selector / Area"> <strong><code>#backToTop</code> button partial rule (<code>#backToTop:hover</code> cut)</strong>   </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: top anchor affordance.<br>Risk: file truncation; a selector appears incomplete (<code>#backToTop:hover</code> with no body).<br>Test: search for incomplete rule in CSS parsing tools; ensure no cascade break.<br>Acceptance: CSS linter reports no syntax error.<br>Remediation: close the selector block or remove stray selector. This is a definite fix.                                                                                                                             </td></tr><tr><td data-label="Selector / Area"> <strong>Row count, list styling inside cells</strong>                        </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: readable list rendering.<br>Risks: list markers replaced with text (<code>–</code>), which is fine but may break localization.<br>Tests: content with nested lists and RTL.<br>Acceptance: nested lists render with visible markers and proper indent.<br>Remediation: support locale-aware markers or prefer CSS counters for ordered lists.                                                                                                                                           </td></tr><tr><td data-label="Selector / Area"> <strong>Code and pre styling (<code>code</code>, <code>pre code</code>)</strong>                   </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: readable inline and block code.<br>Risks: <code>white-space: pre</code> and <code>pre code</code> combination can overflow in narrow cells; <code>font-variant-numeric: tabular-nums</code> is appropriate for numbers inside code but may affect ligatures.<br>Tests: long code lines, tab-size, printing.<br>Acceptance: code visible, not clipped, wraps in print as configured.<br>Remediation: add <code>overflow-wrap</code> and <code>word-break</code> rules for very long tokens.                                                                                     </td></tr><tr><td data-label="Selector / Area"> <strong>Accessibility focus (<code>:focus-visible</code>) consolidation</strong>        </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: unified focus styling.<br>Risks: too strong an outline may obscure content in some UI contexts.<br>Tests: keyboard navigation across interactive elements; contrast of focus ring in dark theme.<br>Acceptance: focus ring high-contrast and non-intrusive.<br>Remediation: allow component overrides via utility classes if needed.                                                                                                                                         </td></tr><tr><td data-label="Selector / Area"> <strong>Responsive breakpoints (<900px, <600px, <420px>)</strong>            </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: adapt inputs, buttons, and visibility.<br>Risks: <code>display:none !important</code> for header buttons on <420px could remove critical controls.<br>Tests: small-screen regression for essential actions like export/search.<br>Acceptance: critical controls remain accessible; overflow preserved for extra controls.<br>Remediation: prioritize controls and move low-priority ones into a menu.                                                                                                                        </td></tr><tr><td data-label="Selector / Area"> <strong>Print rules (<code>@media print</code>)</strong>                                </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: conservative print-friendly output.<br>Risks: <code>position: static !important</code> for <code>thead th</code> may collapse multi-page tables; <code>copy-button-output</code> hidden is correct.<br>Tests: print preview for 100-row table with captions.<br>Acceptance: captions visible, no clipped headers, page-breaks respected.<br>Remediation: use <code>thead {display: table-header-group;}</code> for consistent page headers in print (option exists commented in optional).                                                             </td></tr><tr><td data-label="Selector / Area"> <strong>ChatGPT-like typography (measure, headings, blockquote)</strong>     </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: reading comfort.<br>Risks: <code>max-width: min(var(--measure), 88vw)</code> may interact poorly with full-width table components.<br>Tests: article layout with embedded tables.<br>Acceptance: body text readable and tables remain full-bleed in <code>.table-container</code>.<br>Remediation: scope measure to content blocks not table containers.                                                                                                                                        </td></tr><tr><td data-label="Selector / Area"> <strong>Header-link neutralization (anchors in <code>th</code>)</strong>                </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: remove anchor visual noise in headers.<br>Risks: removing focus outlines from header anchors could harm keyboard users.<br>Tests: keyboard tab to header anchors, ensure alternative focus is available on the <code>th</code> element.<br>Acceptance: header anchors still keyboard reachable and focus visible.<br>Remediation: ensure <code>th a</code> retains <code>:focus-visible</code> behavior or delegate focus to <code>th</code> with <code>tabindex=&quot;0&quot;</code>.                                                                                                  </td></tr><tr><td data-label="Selector / Area"> <strong>Utilities (<code>.visually-hidden</code>, hyphens, KaTeX`)</strong>             </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: accessibility, hyphenation, math support.<br>Risks: <code>hyphens: auto</code> can break code tokens; KaTeX font fallback risk.<br>Tests: pages with code and math.<br>Acceptance: code not hyphenated; math renders with correct font.<br>Remediation: scope <code>hyphens</code> away from <code>code</code> and <code>pre</code>.                                                                                                                                                                                    </td></tr><tr><td data-label="Selector / Area"> <strong>Optional commented enhancements</strong>                             </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: gated features like scrollbar styling and RTL.<br>Risks: uncommenting without testing introduces regressions.<br>Tests: perform A/B visual tests before un-comment.<br>Acceptance: maintained stability.<br>Remediation: keep commented features behind feature flags or build-time toggles.                                                                                                                                                                               </td></tr><tr><td data-label="Selector / Area"> <strong><code>.table-heading-bar</code> corrected implementation</strong>               </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: single-row topic headings with fade edges.<br>Risks: gradient pseudo-elements must match <code>--bg</code> variable for dark mode.<br>Tests: horizontal scroll with many headings; pointer events unaffected.<br>Acceptance: fade edges non-blocking, keyboard accessible headings.<br>Remediation: ensure <code>pointer-events: none</code> only on pseudo-elements and provide chevrons if needed.                                                                                             </td></tr><tr><td data-label="Selector / Area"> <strong>Logical properties & RTL notes (commented)</strong>                  </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: RTL-ready alternative available.<br>Risks: not yet activated.<br>Tests: enable RTL and confirm first-column stickiness flips.<br>Acceptance: correct position in RTL.<br>Remediation: when enabling RTL, switch <code>left</code> to <code>inset-inline-start</code> and test thoroughly.                                                                                                                                                                                                       </td></tr><tr><td data-label="Selector / Area"> <strong>Final guard rules duplicate <code>a:focus</code></strong>                       </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: reinforce focus.<br>Risk: duplicate rules are harmless but verbose.<br>Tests: CSS linter to compress duplicates.<br>Acceptance: no conflicts.<br>Remediation: dedupe during build.                                                                                                                                                                                                                                                                                         </td></tr><tr><td data-label="Selector / Area"> <strong>Print & accessibility intersection</strong>                          </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: ensure print outputs are accessible.<br>Risks: hiding interactive elements may remove context for printed exports.<br>Tests: print with and without controls; check caption visibility.<br>Acceptance: printed documents self-contained.<br>Remediation: include visible row counts and caption IDs in print mode.                                                                                                                                                         </td></tr><tr><td data-label="Selector / Area"> <strong>Interactions with renderer (JS) expectations</strong>                </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: many CSS behaviors rely on renderer attributes/classes.<br>Risks: mismatch causes visual regressions (e.g., <code>.table-wrapper.table-collapsed</code>, <code>data-col-type</code>).<br>Tests: run renderer on sample datasets (numeric, date, mixed, long text) and validate DOM attributes against CSS expectations.<br>Acceptance: renderer emits required attributes, or JS post-processing adds them.<br>Remediation: implement fallback JS to detect column types when server-side metadata missing.                              </td></tr><tr><td data-label="Selector / Area"> <strong>Performance considerations (large tables)</strong>                   </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: maintain UX with large datasets.<br>Risks: <code>position: sticky</code> on many cells increases paint cost; heavy CSS shadows and transitions add layout cost.<br>Tests: 50k-cell table scroll performance, memory profiling.<br>Acceptance: acceptable frame rate (>45fps) on typical hardware.<br>Remediation: reduce sticky elements, remove expensive shadows, enable virtualization for huge tables.                                                                                                                    </td></tr><tr><td data-label="Selector / Area"> <strong>Lint and syntax issues (<code>#backToTop:hover</code> incomplete)</strong>      </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> Purpose: ensure CSS parses fully.<br>Risk: stray selector likely breaks subsequent rules or causes no-op.<br>Tests: run CSS through <code>stylelint</code> and confirm zero parse errors.<br>Acceptance: linter clean.<br>Remediation: complete or remove stray selector.                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Selector / Area"> <strong>Regression checklist (recommended)</strong>                          </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> 1) CSS parse and stylelint clean.<br>2) Accessibility audit with axe or pa11y.<br>3) Visual diff snapshots for light/dark/high-contrast.<br>4) Print previews for short and long tables.<br>5) Mobile manual test on 320px width.<br>6) RTL smoke tests.<br>7) Export button presence toggled by asset detection.                                                                                                                                                                  </td></tr><tr><td data-label="Selector / Area"> <strong>Acceptance criteria summary</strong>                                 </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> - No CSS parse errors.<br>- Column-type styles respond when attributes present.<br>- Sticky header and column stable across scroll contexts.<br>- Print caption visible and properly aligned.<br>- All keyboard focus targets visible and announced.<br>- Export CTA only visible when supported.                                                                                                                                                                                  </td></tr><tr><td data-label="Selector / Area"> <strong>Remediation roadmap (concrete fixes)</strong>                        </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> 1) Fix <code>#backToTop:hover</code> rule.<br>2) Add <code>aria</code> linkage guidelines to renderer for caption semantics.<br>3) Implement conditional export button injection in <code>core_renderer</code>/<code>core_assets</code>.<br>4) Add RTL active rules using logical properties.<br>5) Add <code>@supports</code> guards for <code>position: sticky</code> behaviors.<br>6) Add CSS linter and visual snapshot tests into CI.                                                                                                             </td></tr><tr><td data-label="Selector / Area"> <strong>Rollback guidance</strong>                                           </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> If visual regressions appear after CSS changes:<br>1) Revert the stylesheet file to previous commit.<br>2) Re-run stylelint and visual diff to isolate change.<br>3) Re-enable commented optional blocks one-by-one.<br>4) Use browser devtools to toggle tokens in <code>:root</code> to find problematic variable.                                                                                                                                                                          </td></tr><tr><td data-label="Selector / Area"> <strong>Final verification statement</strong>                                </td><td data-label="Detailed notes, risks, tests, acceptance criteria, and remediation"> I performed 10 verification passes across parsing, accessibility, responsiveness, print, RTL, and integration expectations.<br>The CSS is robust but contains one actionable syntax fix and several recommended renderer-side guarantees.<br>Apply fixes in the remediation roadmap and run the regression checklist.                                                                                                                                                             </td></tr></tbody></table></div><div class="row-count">Rows: 38</div></div><div class="table-caption" id="Table4" data-table="Book_8008_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Component**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Component</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Component"> <strong>Imports & setup</strong>                    </td><td data-label="Notes"> Imports stdlib (<code>pathlib</code>, <code>os</code>, <code>time</code>, <code>html</code>, <code>json</code>, <code>logging</code>, <code>re</code>) and local helpers (<code>core_io</code>, <code>core_assets</code>, <code>core_fragments</code>, <code>core_table</code>, <code>core_utils</code>). Sets <code>logger = logging.getLogger(&quot;render.core_renderer&quot;)</code>.            </td></tr><tr><td data-label="Component"> <strong>MarkdownRenderer</strong>                   </td><td data-label="Notes"> Lightweight wrapper that accepts a callable <code>func</code> and exposes <code>.render</code>. Falls back to HTML-escaping when not callable. Used as <code>renderer = MarkdownRenderer(markdown_to_html)</code>.                                                           </td></tr><tr><td data-label="Component"> <strong>BS4 detection</strong>                      </td><td data-label="Notes"> Tries to import <code>BeautifulSoup</code>. Sets <code>_HAVE_BS4</code> flag; if available uses robust HTML parsing, otherwise uses regex fallback.                                                                                                               </td></tr><tr><td data-label="Component"> <strong>_split_cells_from_pipe_line</strong>        </td><td data-label="Notes"> Splits a Markdown pipe line into trimmed cell parts and trims leading/trailing empty pipe cells. Utility for pipe-table extraction.                                                                                                         </td></tr><tr><td data-label="Component"> <strong>_extract_pipe_tables_from_markdown</strong> </td><td data-label="Notes"> Scans markdown text for GitHub-style pipe tables. Validates divider row (---                                                                                                                                                                </td></tr><tr><td data-label="Component"> <strong>_extract_tables_from_html_bs4</strong>      </td><td data-label="Notes"> Uses BeautifulSoup to extract <code>&lt;table&gt;</code> blocks. Returns <code>{&quot;rows&quot;: rows, &quot;header&quot;: bool, &quot;html&quot;: str(tbl), &quot;source&quot;: &quot;html_bs4&quot;}</code> for each table. Handles multi-line cell text safely.                                                       </td></tr><tr><td data-label="Component"> <strong>_parse_table_html_regex</strong>            </td><td data-label="Notes"> Regex-based fallback to parse a single <code>&lt;table&gt;</code> HTML string into rows and header presence. Replaces <code>&lt;br&gt;</code> with <code>\n</code>, strips tags, unescapes entities.                                                                                     </td></tr><tr><td data-label="Component"> <strong>_extract_tables_from_html_regex</strong>    </td><td data-label="Notes"> Finds all <code>&lt;table&gt;...&lt;/table&gt;</code> blocks via regex and parses each with <code>_parse_table_html_regex</code>. Used when BS4 not present.                                                                                                                  </td></tr><tr><td data-label="Component"> <strong>_extract_tables_from_html</strong>          </td><td data-label="Notes"> Chooses BS4 extraction when available; otherwise uses regex extractor. Returns list of table dicts for further conversion.                                                                                                                  </td></tr><tr><td data-label="Component"> <strong>_convert_rows_to_df_like</strong>           </td><td data-label="Notes"> Converts list-of-rows to a pandas DataFrame when pandas present; otherwise to list-of-dicts if header row exists; else returns raw rows. Keeps compatibility with downstream <code>render_table</code>.                                                </td></tr><tr><td data-label="Component"> <strong>Deduplication</strong>                      </td><td data-label="Notes"> Uses <code>hashlib.sha256(repr(tbl))</code> to avoid rendering identical parsed tables multiple times. Adds dedupe before fragment rendering.                                                                                                          </td></tr><tr><td data-label="Component"> <strong>tmp_frag_dir & fragments</strong>           </td><td data-label="Notes"> Calls <code>tmp_frag_dir_for(out_dir)</code> and <code>render_fragments_concurrently(parsed_tables, cfg, renderer, tmp_frag_dir, max_workers)</code> to produce per-table fragment files plus metadata and row counts. Handles exceptions and records warnings.   </td></tr><tr><td data-label="Component"> <strong>need_fallback logic</strong>                </td><td data-label="Notes"> If no fragments or fragments contain no rows, falls back to inline rendering. Adds descriptive warnings.                                                                                                                                    </td></tr><tr><td data-label="Component"> <strong>asset handling (prepare_assets)</strong>    </td><td data-label="Notes"> Calls <code>prepare_assets(cfg, out_dir)</code> to get <code>assets_dir</code>, <code>style_fallback</code>, <code>script_fallback</code>, <code>assets_written</code>. Supports <code>embed_assets</code> option. Computes <code>href_prefix</code> via <code>os.path.relpath</code>.                                              </td></tr><tr><td data-label="Component"> <strong>Head / Tail assembly</strong>               </td><td data-label="Notes"> Builds <code>head_parts</code> with minimal critical CSS and asset links (inline or external). Builds <code>tail_parts</code> with scripts (inline or <code>&lt;script src=... defer&gt;</code>). Adds small shim fallback when <code>script.js</code> missing.                               </td></tr><tr><td data-label="Component"> <strong>Header UI / toolbar</strong>                </td><td data-label="Notes"> Renders <code>#tables-viewer</code> header, search box, toggle/copy/reset buttons, and <code>&lt;noscript&gt;</code> message. Includes small CSS to avoid FOUC for <code>.table-wrapper</code>.                                                                                    </td></tr><tr><td data-label="Component"> <strong>Labels loader</strong>                      </td><td data-label="Notes"> Implements <code>_load_labels_json()</code> probing several candidate locations for <code>labels.json</code> and <code>_caption_for(book_prefix, idx)</code> to resolve friendly captions for tables.                                                                        </td></tr><tr><td data-label="Component"> <strong>frag_paths_ordered & inline_parts</strong>  </td><td data-label="Notes"> When fragments present, builds <code>frag_paths_ordered</code> tuples `(idx, Path                                                                                                                                                                      </td></tr><tr><td data-label="Component"> <strong>Caption injection policy</strong>           </td><td data-label="Notes"> For each table (fragment or inline) the renderer writes a <code>&lt;div class=&quot;table-caption&quot; id=&quot;{title_id}&quot;&gt;</code> with the resolved caption (labels.json or title_text). The caption is used as the anchor for the TOC.                               </td></tr><tr><td data-label="Component"> <strong>_remove_heading_from_fragment</strong>      </td><td data-label="Notes"> Strips leading <code>&lt;h1..h6&gt;</code> that match <code>title_id</code> or text matching <code>title_text</code>. Used to avoid duplicate headers when fragment body already contains a header. Conservative fallback removes first heading only if necessary.                 </td></tr><tr><td data-label="Component"> <strong>Inline HTML source handling</strong>        </td><td data-label="Notes"> For markdown inputs that produced sanitized HTML with no table extraction, adds them to <code>inline_html_sources</code>, generates safe title_id/title_text heuristics, wraps with heading if missing and injects caption using <code>_caption_for</code>.       </td></tr><tr><td data-label="Component"> <strong>TOC generation</strong>                     </td><td data-label="Notes"> Builds <code>toc</code> string <code>&lt;div id=&quot;tocBar&quot;&gt;</code> containing <code>toc_items</code> gathered from fragment metadata or inline parts. TOC is inserted near top of body.                                                                                           </td></tr><tr><td data-label="Component"> <strong>Row counts & warnings</strong>              </td><td data-label="Notes"> Collects <code>frag_row_counts</code>, <code>total_rows</code> and <code>warnings</code> from fragment renderer. Emits banner HTML if nothing rendered.                                                                                                                      </td></tr><tr><td data-label="Component"> <strong>Writer function</strong>                    </td><td data-label="Notes"> Single <code>writer(f)</code> closure writes <code>head</code>, <code>toc</code>, optional <code>banner_html</code>, then iterates <code>frag_paths_ordered</code> (or <code>inline_parts</code>) writing caption + fragment content. Uses <code>_remove_heading_from_fragment</code> on fragment reads. Appends <code>tail</code>. </td></tr><tr><td data-label="Component"> <strong>Atomic write</strong>                       </td><td data-label="Notes"> Uses <code>_default_write_atomic(out_path, writer)</code> if available. Falls back to safe temp-file write and <code>os.replace</code>. Returns error info on failure.                                                                                            </td></tr><tr><td data-label="Component"> <strong>JS small runtime</strong>                   </td><td data-label="Notes"> Appends inline JS that formats export names, binds <code>exportBtn</code> to worker-based export, and ensures <code>.table-wrapper</code> opacity reset on <code>load</code>. Injects <code>href_prefix</code> and <code>export_template</code> safely via <code>json.dumps</code>.                           </td></tr><tr><td data-label="Component"> <strong>Embed vs external assets</strong>           </td><td data-label="Notes"> If <code>embed_assets</code> true then <code>style.css</code> and <code>script.js</code> are inlined into head/tail respectively. Else links with mtime-based <code>?v=</code> cache-busting and SRI attributes via <code>_sri_attr</code>. XLSX and worker scripts conditionally added.           </td></tr><tr><td data-label="Component"> <strong>Accessibility & ARIA</strong>               </td><td data-label="Notes"> Header adds <code>role=&quot;region&quot; aria-label=&quot;Tables viewer&quot;</code>. Captions use <code>id</code> anchors. Search input has <code>aria-label</code>. TOC uses <code>role=&quot;navigation&quot;</code>.                                                                                             </td></tr><tr><td data-label="Component"> <strong>Return value</strong>                       </td><td data-label="Notes"> <code>render_html</code> returns dict <code>{ &quot;warnings&quot;, &quot;tables&quot;, &quot;rows&quot;, &quot;runtime_ms&quot;, &quot;output&quot;, (&quot;html&quot; if return_html) }</code>. On failure includes error warnings.                                                                                         </td></tr><tr><td data-label="Component"> <strong>Error handling & logging</strong>           </td><td data-label="Notes"> Most IO and parsing operations wrapped in <code>try/except</code>. Failures logged via <code>logger.exception</code> or <code>logger.debug</code>. Non-fatal errors recorded in <code>warnings</code> and rendering continues where possible.                                           </td></tr><tr><td data-label="Component"> <strong>Integration points</strong>                 </td><td data-label="Notes"> Relies on <code>prepare_assets</code>, <code>write_overrides_css</code>, <code>render_fragments_concurrently</code>, <code>render_table</code>, and <code>_sanitize_output_path</code> from local modules. Changes here affect global asset injection and fragment lifecycle.                      </td></tr><tr><td data-label="Component"> <strong>Security considerations</strong>            </td><td data-label="Notes"> Sanitizes markdown-to-html output via <code>sanitize_html(..., allow_tables=True)</code> where available. Uses safe JSON embedding (<code>json.dumps</code>) and <code>_safe_json_for_script</code> to prevent <code>&lt;/script&gt;</code> injection.                                        </td></tr><tr><td data-label="Component"> <strong>Extensibility hooks</strong>                </td><td data-label="Notes"> <code>config</code> object read for <code>embed_assets</code>, <code>max_workers</code>, etc. <code>export_name_template</code> and <code>output_user</code> passed through to client JS. <code>render_cell</code> and <code>renderer</code> patterns support pluggable renderers.                                       </td></tr><tr><td data-label="Component"> <strong>Fallback & resilience</strong>              </td><td data-label="Notes"> Multiple fallbacks: bs4→regex, fragments→inline, pandas→list-dicts, embed→link, worker shim for missing script. Emits warnings and constructs minimal usable output.                                                                        </td></tr><tr><td data-label="Component"> <strong>Testing targets</strong>                    </td><td data-label="Notes"> High-leverage tests: pipe-table extraction, html-table extraction (bs4 vs regex), fragment production, caption resolution via labels.json, atomic write behavior, embed vs external assets.                                                 </td></tr></tbody></table></div><div class="row-count">Rows: 35</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>