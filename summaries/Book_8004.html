<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;}</style>
<link rel="stylesheet" href="assets/style.css?v=1758862283">
<link rel="stylesheet" href="assets/overrides.css?v=1758862283">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header"><div><h1>Tables Viewer v2.1</h1></div><div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" type="search" placeholder="Search" aria-label="Search tables" style="min-width:420px; width:44ch;"/>
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllMdBtn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy all tables as markdown">Copy All Tables (Markdown)</button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset all tables">Reset All Tables</button>
</div></div>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#table-1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#table-2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#table-3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#table-4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#table-5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#table-6">Table 6</a></li>
<li class="toc-item"><a class="toc-link" href="#table-7">Table 7</a></li></ul></div></div>
<div class="table-wrapper" data-table-id="table-1"><h3 id="table-1">Table 1</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th style="width:28.57%;" role="button" aria-label="Sort by **Topic**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Topic</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th style="width:71.43%;" role="button" aria-label="Sort by **Details**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Details</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Topic"><p><strong>Purpose</strong></p></td><td data-label="Details"><p>Tiny file-io helpers: read a file, write a file, ensure a directory exists. Designed for simple scripts and local tooling.</p></td></tr><tr><td data-label="Topic"><p><strong>Provided functions</strong></p></td><td data-label="Details"><p>`read<em>file(path: str) -> str` — reads whole file with UTF-8.  <br>`write</em>file(path: str, content: str)` — ensures parent dir then writes content (UTF-8).  <br>`ensure<em>dir(path: str)` — `os.makedirs(path, exist</em>ok=True)`.</p></td></tr><tr><td data-label="Topic"><p><strong>Behavioral notes</strong></p></td><td data-label="Details"><p><ul><li>`write<em>file` uses `os.makedirs(os.path.dirname(path) or ".", exist</em>ok=True)` so paths with no directory write to current directory.  <br></li><li>No error handling is present; exceptions propagate to the caller.  <br></li><li>No atomic-write guarantee. A crash during write may leave a partial file.</li></ul></p></td></tr><tr><td data-label="Topic"><p><strong>Integration with core modules</strong></p></td><td data-label="Details"><p>`core<em>io.py` attempted to import `</em>atomic<em>write`, `</em>atomic<em>stream</em>write`, and `<em>ensure</em>dir` from `io<em>utils`.  <br>- This module does not export those names so those imports will fail and core</em>io will fall back to its built-in defaults.  <br>- If you want `core<em>io` to use optimized implementations, implement and export `</em>atomic<em>write`, `</em>atomic<em>stream</em>write`, and `<em>ensure</em>dir` to match the expected names/signatures.</p></td></tr><tr><td data-label="Topic"><p><strong>Atomicity & safety</strong></p></td><td data-label="Details"><p>Current `write<em>file` is not atomic.  <br>Risk: partial/truncated files if process is interrupted.  <br>Recommendation: provide `</em>atomic<em>write(path, writer</em>or<em>text)` that writes to a temp file in the same directory, fsyncs, then `os.replace` into place.  <br>Also implement `</em>atomic<em>stream</em>write(path, writer&#95;fn)` that accepts a writer callback to stream big outputs.</p></td></tr><tr><td data-label="Topic"><p><strong>Cross-platform considerations</strong></p></td><td data-label="Details"><p>`os.replace` should be used for atomic rename; not present here.  <br>Use `tempfile.NamedTemporaryFile(delete=False, dir=parent)` + `os.replace(tmp, target)` to avoid cross-device issues.  <br>Call `os.fsync()` on file descriptor before close to reduce risk of data loss on power failures.</p></td></tr><tr><td data-label="Topic"><p><strong>Error handling</strong></p></td><td data-label="Details"><p>Currently none.  <br>Consider catching and wrapping IO exceptions for clearer diagnostics, or document that callers must handle exceptions.  <br>For long-running pipelines prefer returning structured error messages rather than letting exceptions bubble untyped.</p></td></tr><tr><td data-label="Topic"><p><strong>API & naming</strong></p></td><td data-label="Details"><p><ul><li>To integrate with existing code, export `<em>ensure</em>dir` (alias to `ensure<em>dir`) and implement `</em>atomic<em>write` and `</em>atomic<em>stream</em>write` with expected signatures.  <br></li><li>Prefer stable function names and document expected writer callback signature for `<em>atomic</em>stream&#95;write`.</li></ul></p></td></tr><tr><td data-label="Topic"><p><strong>Performance</strong></p></td><td data-label="Details"><p>Fine for small files.  <br>For large writes, streaming writer with buffered chunks and atomic swap is recommended.</p></td></tr><tr><td data-label="Topic"><p><strong>Tests to add</strong></p></td><td data-label="Details"><p><ul><li>Read/write roundtrip, including non-existent parent dir.  <br></li><li>Simulated interruption (write to tmp then check rename) for atomic helper.  <br></li><li>Permission error handling and directory creation races.</li></ul></p></td></tr><tr><td data-label="Topic"><p><strong>Immediate, low-risk improvements</strong></p></td><td data-label="Details"><p><ul><li>Implement `<em>atomic</em>write(path, text)` and `<em>atomic</em>stream<em>write(path, writer</em>fn)`.  <br></li><li>Export `<em>ensure</em>dir` name to satisfy `core&#95;io` import.  <br></li><li>Add minimal docstrings and explicit exception handling/logging.</li></ul></p></td></tr><tr><td data-label="Topic"><p><strong>Summary judgement</strong></p></td><td data-label="Details"><p>Correct and minimal for simple use.  <br>Not sufficient as the project's `io<em>utils` expected by `core</em>io` (no atomic write or exported underscore-names).  <br>Implement the atomic helpers and adjust exports to fully integrate with the renderer.</p></td></tr></tbody></table></div><div class='row-count'></div></div><div class="table-wrapper" data-table-id="table-2"><h3 id="table-2">Table 2</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th style="width:28.57%;" role="button" aria-label="Sort by **Topic**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Topic</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th style="width:71.43%;" role="button" aria-label="Sort by **Details**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Details</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Topic"><p><strong>Purpose</strong></p></td><td data-label="Details"><p><strong>Sanitize HTML fragments before publishing.</strong> Provides a sanitizer that prefers `bleach` when present and falls back to a custom HTML-parser based cleaner. Ensures only allowed tags/attributes/protocols survive.</p></td></tr><tr><td data-label="Topic"><p><strong>Allowed surface</strong></p></td><td data-label="Details"><p><strong>Tags/attributes/protocols.</strong> `ALLOWED<em>TAGS` includes common text/structural tags and simple tables/images. `ALLOWED</em>ATTRIBUTES` allows `class`, `title`, `aria-hidden`, `role`, `data-&#42;` globally and `href`, `rel`, `target` for anchors and `src`, `alt`, `width`, `height` for images. `ALLOWED<em>PROTOCOLS` allows `http`, `https`, `mailto`, `data`. `IMG</em>DATA&#95;MIME` restricts `data:` images to common image MIME types in base64 form.</p></td></tr><tr><td data-label="Topic"><p><strong>URL safety</strong></p></td><td data-label="Details"><p><strong>Conservative URL checks.</strong> `<em>is</em>safe&#95;url` parses the URL and accepts empty-relative URLs, http(s), mailto. For `data:` it validates image MIME+base64 via regex. Other schemes are rejected. This prevents `javascript:` and other unsafe schemes in href/src in most normal cases.</p></td></tr><tr><td data-label="Topic"><p><strong>Bleach path</strong></p></td><td data-label="Details"><p><strong>Preferred path uses `bleach`.</strong> `<em>bleach</em>clean` calls `bleach.clean` with configured `tags`, `attributes`, `protocols`, and `strip=True`. It then runs `bleach.linkify` and an additional regex-based attribute sanitization pass to remove `on&#42;` and `style` and to re-validate `href`/`src` with `<em>is</em>safe&#95;url`. This layering increases safety and allows `bleach` to do heavy lifting.</p></td></tr><tr><td data-label="Topic"><p><strong>Fallback path</strong></p></td><td data-label="Details"><p><strong>HTMLParser-based cleaner.</strong> `<em>FallbackCleaner` inherits `HTMLParser`, accepts allowed tags and attrs, rejects `on<em>` and `style` attributes, validates `href`/`src` with `</em>is<em>safe</em>url`, supports `data-</em>` wildcard via `a.endswith('&#42;')` matching, and reconstructs cleaned HTML. Used when `bleach` is unavailable.</p></td></tr><tr><td data-label="Topic"><p><strong>Attribute handling</strong></p></td><td data-label="Details"><p><strong>Restrictive but not fully escaped.</strong> In the bleach path a regex further sanitizes attributes; in fallback the code reconstructs attributes with `name="value"` without explicit escaping. Values are filtered (`on&#42;`, `style`, unsafe `href`/`src` removed) but not always HTML-escaped before reinsertion.</p></td></tr><tr><td data-label="Topic"><p><strong>Script & event handler defense</strong></p></td><td data-label="Details"><p><strong>Multiple layers.</strong> After cleaning the final string replaces `<script`/`</script>` and runs `re.sub` to remove inline `on&#42;=` attributes. Redundant checks help but rely on string patterns; may not catch obfuscated forms.</p></td></tr><tr><td data-label="Topic"><p><strong>Strengths</strong></p></td><td data-label="Details"><p><strong>Robust, defense-in-depth.</strong> Preferred use of `bleach`, explicit allowed lists, data-image whitelist, linkify step, plus fallback HTMLParser gives reasonable safety in minimal environments. Good separation of concerns.</p></td></tr><tr><td data-label="Topic"><p><strong>Weaknesses / Risks</strong></p></td><td data-label="Details"><p><strong>Edge cases and escaping gaps.</strong>  <br>- Regex-based attribute reassembly may reinsert raw attribute values without escaping, which could allow malformed attributes if input is adversarial.  <br>- The `bleach` API/behavior varies by version; the code assumes `bleach.linkify` callback signature and `clean(..., protocols=...)` support.  <br>- `ALLOWED<em>PROTOCOLS` includes `data` so non-image data URIs could slip through if `IMG</em>DATA&#95;MIME` logic is bypassed upstream.  <br>- Final `re.sub` that strips `on\w+=` may miss unquoted attributes or unusual spacing/encoding.</p></td></tr><tr><td data-label="Topic"><p><strong>Performance</strong></p></td><td data-label="Details"><p><strong>Reasonable for cell-level HTML.</strong> `bleach` path is fast and optimized. Fallback parser is lightweight and O(size of input). Regex rounds add cost but are acceptable for typical table-cell lengths.</p></td></tr><tr><td data-label="Topic"><p><strong>Compatibility concerns</strong></p></td><td data-label="Details"><p><strong>Bleach versioning and API changes.</strong> If `bleach` is absent or an incompatible version is used, behavior falls back but differing outputs may occur. Tests should assert both paths.</p></td></tr><tr><td data-label="Topic"><p><strong>Test recommendations</strong></p></td><td data-label="Details"><p><strong>Extensive unit tests.</strong> Cover: `javascript:`/malicious hrefs, `data:` URIs valid and invalid, `onmouseover`/`onerror` attributes, nested tags and attributes, `data-&#42;` attributes acceptance, malformed tags, attribute quoting edge cases, bleach vs fallback parity, and linkify output correctness.</p></td></tr><tr><td data-label="Topic"><p><strong>Immediate improvements</strong></p></td><td data-label="Details"><p><strong>Tighten attribute escaping and link validation.</strong>  <br>- Escape attribute values when reconstructing to prevent quote injection.  <br>- Use `urllib.parse` and stricter checks for URLs and `data:` parsing.  <br>- Make the `bleach` usage defensive (check for features before calling).  <br>- Replace the regex attribute rewriter with a structured parse-and-render step to avoid regex pitfalls.</p></td></tr><tr><td data-label="Topic"><p><strong>Medium-term enhancements</strong></p></td><td data-label="Details"><p><strong>Centralize sanitizer policy and make pluggable.</strong>  <br>- Expose a small config for allowed tags/attrs/protocols.  <br>- Optionally run `bleach` with a controlled set of callbacks that enforce attribute escaping.  <br>- Provide a sanitizer mode that returns diagnostics (which tags/attrs were removed).</p></td></tr><tr><td data-label="Topic"><p><strong>Operational notes</strong></p></td><td data-label="Details"><p><strong>Prefer `bleach` in production.</strong> Fallback is acceptable for offline or limited environments, but production should pin a known `bleach` version and run tests to ensure expected behavior.</p></td></tr><tr><td data-label="Topic"><p><strong>Summary judgement</strong></p></td><td data-label="Details"><p><strong>Well-designed, defense-in-depth sanitizer.</strong> It favors safe defaults, uses `bleach` when available, and has a capable fallback. Hardening attribute escaping and tightening `data:` handling will remove the remaining risk vectors.</p></td></tr></tbody></table></div><div class='row-count'></div></div><div class="table-wrapper" data-table-id="table-3"><h3 id="table-3">Table 3</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th style="width:28.57%;" role="button" aria-label="Sort by **Summary**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Summary</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th style="width:71.43%;" role="button" aria-label="Sort by Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Summary"><p><strong>Introduction to Stable Diffusion</strong></p></td><td data-label="Notes"><p>Stable Diffusion is an open-source text-to-image generation model based on latent diffusion. Produces high-quality images from text prompts and allows fine-grained control over styles, composition, and content. Often run locally for privacy and faster iteration; used for research, art, and prototyping.</p></td></tr><tr><td data-label="Summary"><p><strong>Prompt Engineering for Stable Diffusion</strong></p></td><td data-label="Notes"><p>Effective prompts include: <br>- Content description (objects, characters, scene elements). <br>- Style cues (e.g., “digital painting,” “watercolor,” “photorealistic”). <br>- Lighting/mood/environment (e.g., “sunset,” “cinematic lighting,” “foggy forest”). <br>Example: `"A futuristic cityscape at night, cyberpunk aesthetic, neon lights, ultra-detailed, photorealistic"`</p></td></tr><tr><td data-label="Summary"><p><strong>Control of Image Generation Parameters</strong></p></td><td data-label="Notes"><p>Adjustable parameters: <br>- Steps: number of diffusion iterations (more → more detail). <br>- CFG (classifier-free guidance) scale: balances prompt adherence vs creativity. <br>- Seed: reproducibility. <br>Example: `steps=50, CFG=7.5, seed=12345` for a high-fidelity, reproducible image.</p></td></tr><tr><td data-label="Summary"><p><strong>Latent Space Manipulation</strong></p></td><td data-label="Notes"><p>Techniques: <br>- Interpolation: blend two latent vectors to create hybrids. <br>- Noise injection: control randomness for variations. <br>- Vector arithmetic: e.g., `latentdragon <br>- latentcat + latentwolf` to create novel composites.</p></td></tr><tr><td data-label="Summary"><p><strong>Image-to-Image Generation (img2img)</strong></p></td><td data-label="Notes"><p>Img2img modifies an existing image guided by a prompt: <br>- Upload base image → define prompt → adjust strength (noise control). <br>- Strength: 0 → minor edits; 1 → full regeneration. <br>Example: Transform a rough sketch into a fully rendered digital painting with `strength=0.7`.</p></td></tr><tr><td data-label="Summary"><p><strong>Inpainting Techniques</strong></p></td><td data-label="Notes"><p>Inpainting edits specific regions while keeping the rest intact: <br>- Mask areas to edit → provide prompt for desired change. <br>- Useful for repairs, adding objects, or changing backgrounds. <br>Example: Mask sky → prompt `"sunset with dramatic clouds"` → regenerate sky without affecting foreground.</p></td></tr><tr><td data-label="Summary"><p><strong>Outpainting for Extended Scenes</strong></p></td><td data-label="Notes"><p>Outpainting expands canvas beyond original borders: <br>- Extends scene consistently based on context. <br>- Useful for panoramas or immersive environments. <br>Example: Expand a castle painting left/right → prompt `"surrounding landscape, misty mountains"` → panoramic view.</p></td></tr><tr><td data-label="Summary"><p><strong>Fine-Tuning and Custom Models</strong></p></td><td data-label="Notes"><p>Options to adapt model to specific styles/subjects: <br>- LoRA (Low-Rank Adaptation): add styles/characters without full retrain. <br>- DreamBooth: personalize model for specific subjects. <br>- Custom checkpoints: control style, characters, or domain. <br>Example: Fine-tune on fantasy creatures to generate unique, consistent monsters.</p></td></tr><tr><td data-label="Summary"><p><strong>Prompt Weighting and Advanced Syntax</strong></p></td><td data-label="Notes"><p>Weighting syntax for nuanced control: <br>- Parentheses to increase weight: `(castle)` or `((castle))`. <br>- Square brackets to reduce weight: `[fog]`. <br>- Multi-prompt concatenation for complex scenes. <br>Example: `"((dragon)) flying over castle, [fog], cinematic lighting, photorealistic"` emphasizes dragon and castle, downplays fog.</p></td></tr><tr><td data-label="Summary"><p><strong>Iterative Refinement Practices</strong></p></td><td data-label="Notes"><p>Workflow: <br>1. Start with a broad prompt. <br>2. Generate multiple outputs → pick promising ones. <br>3. Apply img2img / inpainting / outpainting → tweak prompt/params. <br>4. Upscale and finalize. <br>Example: Base prompt → variations → inpaint sky → upscale → final render.</p></td></tr><tr><td data-label="Summary"><p><strong>Upscaling and Super-Resolution</strong></p></td><td data-label="Notes"><p>Techniques to improve final quality: <br>- Use ESRGAN or Real-ESRGAN for detail-preserving upscales. <br>- Combine with inpainting to refine edges/textures. <br>Example: Generate 512×512 → upscale to 2048×2048 → apply inpainting for sharpness.</p></td></tr><tr><td data-label="Summary"><p><strong>Safety and Filtering Controls</strong></p></td><td data-label="Notes"><p>Some builds include NSFW/harmful-content filters: <br>- Ensures responsible generation. <br>- Filters can be adjusted/disabled locally with caution. <br>- Important for research or curated artistic workflows.</p></td></tr><tr><td data-label="Summary"><p><strong>Applications of Stable Diffusion</strong></p></td><td data-label="Notes"><p>Use cases: <br>- Concept art, illustration, visual storytelling. <br>- Game asset generation and prototyping. <br>- Scientific visualization and educational imagery. <br>- Personalized marketing or social media content. <br>Example: Artist generates a fantasy world map → refines characters, landscapes, and lighting for game assets.</p></td></tr><tr><td data-label="Summary"><p><strong>Key Takeaways / Summary</strong></p></td><td data-label="Notes"><p>Stable Diffusion is flexible and powerful for text→image generation. Best practices: <br>- Structured prompt engineering (style + content clarity). <br>- Control generation params (`steps`, `CFG`, `seed`). <br>- Use latent manipulation, img2img, inpainting, outpainting. <br>- Fine-tune with LoRA/DreamBooth for specific styles. <br>- Iterate, upscale, and apply responsible filtering for high-quality, reproducible outputs.</p></td></tr></tbody></table></div><div class='row-count'></div></div><div class="table-wrapper" data-table-id="table-4"><h3 id="table-4">Table 4</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th style="width:28.57%;" role="button" aria-label="Sort by **Topic**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Topic</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th style="width:71.43%;" role="button" aria-label="Sort by **Details**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Details</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Topic"><p><strong>Purpose</strong></p></td><td data-label="Details"><p>Provide the public package surface for `render`.</p></td></tr><tr><td data-label="Topic"><p><strong>Behavior</strong></p></td><td data-label="Details"><p>Re-exports `render<em>html`, `render</em>table`, and `render<em>page` from `core</em>compat`.</p></td></tr><tr><td data-label="Topic"><p><strong>API surface</strong></p></td><td data-label="Details"><p>`<strong>all</strong> = ["render<em>html", "render</em>table", "render&#95;page"]` so `from render import &#42;` yields only those names.</p></td></tr><tr><td data-label="Topic"><p><strong>Design intent</strong></p></td><td data-label="Details"><p>Keep a stable, minimal import entrypoint so callers import `render` without depending on internal modules.</p></td></tr><tr><td data-label="Topic"><p><strong>Simplicity</strong></p></td><td data-label="Details"><p>One-line implementation. Zero runtime logic. Low maintenance burden.</p></td></tr><tr><td data-label="Topic"><p><strong>Stability</strong></p></td><td data-label="Details"><p>Very stable. Changes only needed if core names change.</p></td></tr><tr><td data-label="Topic"><p><strong>Security / Side-effects</strong></p></td><td data-label="Details"><p>None. No I/O or computation. Safe to import.</p></td></tr><tr><td data-label="Topic"><p><strong>Compatibility</strong></p></td><td data-label="Details"><p>Works across import contexts because it defers to `core&#95;compat` which already handles multiple import strategies.</p></td></tr><tr><td data-label="Topic"><p><strong>Recommendation</strong></p></td><td data-label="Details"><p>Keep as-is. Add a short module docstring if you want discoverability in IDEs.</p></td></tr><tr><td data-label="Topic"><p><strong>Summary judgement</strong></p></td><td data-label="Details"><p>Correct minimal compatibility shim. Maintains a clean public API and should remain unchanged unless you intentionally expand the public surface.</p></td></tr></tbody></table></div><div class='row-count'></div></div><div class="table-wrapper" data-table-id="table-5"><h3 id="table-5">Table 5</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th style="width:28.57%;" role="button" aria-label="Sort by **Topic**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Topic</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th style="width:71.43%;" role="button" aria-label="Sort by **Details**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Details</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Topic"><p><strong>Purpose</strong></p></td><td data-label="Details"><p>UI stylesheet for Tables Viewer v2.1. Provides theme variables, layout, table styling, sticky headers/first column, responsive rules, list normalization inside `<td>`, accessibility focus styles, and dark-mode overrides.</p></td></tr><tr><td data-label="Topic"><p><strong>Variables & theming</strong></p></td><td data-label="Details"><p>Uses CSS custom properties (`--bg`, `--text`, `--panel`, etc.). Dark mode toggles via `[data-theme="dark"]`. Variables centralize color and spacing. Good for runtime theming.</p></td></tr><tr><td data-label="Topic"><p><strong>Layout & typography</strong></p></td><td data-label="Details"><p>Global font stack uses Inter + sensible fallbacks. `html,body` base font-size 15px and `line-height:1.45`. `#tables-viewer` and `#mainContent` kept `overflow: visible` to preserve sticky behavior.</p></td></tr><tr><td data-label="Topic"><p><strong>Table mechanics</strong></p></td><td data-label="Details"><p>`table { table-layout: fixed; word-wrap: break-word; min-width:420px }` ensures rows wrap and enables horizontal scrolling when needed. `.table-container` enables touch-friendly horizontal scroll (`-webkit-overflow-scrolling:touch`).</p></td></tr><tr><td data-label="Topic"><p><strong>Sticky elements</strong></p></td><td data-label="Details"><p>`#stickyMainHeader` is sticky at `top:0`. `thead th` sticky at `top:48px`. First column header and data cells are sticky at `left:0` with layered `z-index` (thead header z-index higher than data). This preserves both vertical and horizontal sticky behavior.</p></td></tr><tr><td data-label="Topic"><p><strong>First-column rules</strong></p></td><td data-label="Details"><p>`td:first-child` uses `position:sticky; left:0` and `min-width:140px`, background set to `--panel`, and a subtle shadow. Good UX for key-left labels.</p></td></tr><tr><td data-label="Topic"><p><strong>Header controls & buttons</strong></p></td><td data-label="Details"><p>Compact header controls with accessible touch targets (`min-height:40px`). Search input flex behavior tuned for responsive breakpoints. Buttons share base styling controlled by variables.</p></td></tr><tr><td data-label="Topic"><p><strong>Lists inside cells</strong></p></td><td data-label="Details"><p>Resets list styles inside `td` and implements custom markers via `::before` pseudo-elements: en-dash for top-level lists and bullet for nested lists. Ordered lists use CSS counters. This enforces consistent markers across browsers.</p></td></tr><tr><td data-label="Topic"><p><strong>Code formatting</strong></p></td><td data-label="Details"><p>`td code` styled with monospace, subtle background and padding to improve readability. Dark-theme inheritance handled for list markers.</p></td></tr><tr><td data-label="Topic"><p><strong>Accessibility</strong></p></td><td data-label="Details"><p>Focus outlines are visible (`outline: 3px solid rgba(37,99,235,0.18)`), good keyboard affordance. Contrast depends on variable values; needs verification for WCAG ratios.</p></td></tr><tr><td data-label="Topic"><p><strong>Responsive behavior</strong></p></td><td data-label="Details"><p>Media queries at 900px, 600px, and 420px tighten spacing, collapse header layout and hide less-essential buttons. Search expands to full width on small screens.</p></td></tr><tr><td data-label="Topic"><p><strong>Performance considerations</strong></p></td><td data-label="Details"><p>CSS is modest and efficient. Potential repaint hotspots: `tr:hover td` background change and `box-shadow` on sticky first column when many rows exist. `position: sticky` is widely supported but check older browsers.</p></td></tr><tr><td data-label="Topic"><p><strong>Cross-browser gotchas</strong></p></td><td data-label="Details"><p><ul><li>`position: sticky` requires ancestor overflow not to hide it; the stylesheet sets `overflow: visible` on key ancestors, which is correct. <br></li><li>`-webkit-overflow-scrolling: touch` helps iOS. <br></li><li>Test in Safari, mobile Chrome, and legacy Edge for sticky + z-index interplay.</li></ul></p></td></tr><tr><td data-label="Topic"><p><strong>Potential issues / risks</strong></p></td><td data-label="Details"><p><ul><li>Hard-coded `top:48px` for `thead th` may mismatch the actual sticky header height if header size changes. Prefer using a CSS variable (e.g., `--tv-header-min-height`) for `top`. <br></li><li>Color variables may not meet WCAG contrast in all combinations. Validate with contrast checker. <br></li><li>RTL and language-direction not addressed; pseudo-element markers may need `direction` / `:dir(rtl)` rules. <br></li><li>No print styles; large tables may not print well.</li></ul></p></td></tr><tr><td data-label="Topic"><p><strong>Security / safety</strong></p></td><td data-label="Details"><p>CSS-only file. No direct security risk. Be mindful if user-controlled content injects inline styles or `class` values; sanitization must remain server-side.</p></td></tr><tr><td data-label="Topic"><p><strong>Maintainability & style notes</strong></p></td><td data-label="Details"><p>Well-structured and commented. Variables and component rules make targeted overrides easy (e.g., `overrides.css`). Consider centralizing header-height usage and precompiling commonly reused values.</p></td></tr><tr><td data-label="Topic"><p><strong>Test matrix suggestions</strong></p></td><td data-label="Details"><p><ul><li>Sticky header + first-column behavior across desktop and mobile Safari/Chrome/Firefox. <br></li><li>Large tables (1000+ rows, many columns) for scroll performance and repaint profiling. <br></li><li>Nested lists rendering inside `td` and marker alignment. <br></li><li>Dark theme color contrast and focus ring visibility. <br></li><li>RTL pages and printing.</li></ul></p></td></tr><tr><td data-label="Topic"><p><strong>Small improvements (low risk)</strong></p></td><td data-label="Details"><p><ul><li>Replace `top:48px` with `top: var(--tv-header-min-height,48px)` and ensure sync with JS header height. <br></li><li>Add `print` media rules to hide non-essential chrome and make tables printable. <br></li><li>Add `:dir(rtl)` adjustments for list markers. <br></li><li>Consider disabling `box-shadow` for very large tables to reduce paint cost.</li></ul></p></td></tr><tr><td data-label="Topic"><p><strong>Summary judgement</strong></p></td><td data-label="Details"><p>High-quality, pragmatic stylesheet. Thoughtful details: consistent list markers, responsive header, accessible focus, and dark-mode support. Minor hardening: unify header-height via CSS variable, test WCAG contrast, add RTL and print rules.</p></td></tr></tbody></table></div><div class='row-count'></div></div><div class="table-wrapper" data-table-id="table-6"><h3 id="table-6">Table 6</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th style="width:28.57%;" role="button" aria-label="Sort by **Summary**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Summary</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th style="width:71.43%;" role="button" aria-label="Sort by **Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Summary"><p><strong>Morning Fog Simulation: Operators Under Stress</strong></p></td><td data-label="Notes"><p>The chapter opens with a U.S. Special Forces training simulation near Cape Fear, North Carolina. A bomb detonates while Operators are meeting a guerrilla chieftain, testing their response under uncertainty. Their reactions highlight agility, decisiveness, and imagination.</p></td></tr><tr><td data-label="Summary"><p><strong>Operators’ Uncommon Responses</strong></p></td><td data-label="Notes"><p>Each Operator reacts differently: one persuades the chieftain to lead, another goes solo to solve the bomb situation, another delegates to the chieftain entirely. This variability demonstrates their flexible problem-solving capacity.</p></td></tr><tr><td data-label="Summary"><p><strong>Training as the Key to Imagination</strong></p></td><td data-label="Notes"><p>Operators’ actions stem from rigorous training. Unlike untrained soldiers (or business leaders), they avoid default responses: fright, fight, or dependence. Training cultivates imagination, enabling fast, adaptive decision‐making.</p></td></tr><tr><td data-label="Summary"><p><strong>Defining Imagination</strong></p></td><td data-label="Notes"><p>Imagination is the ability to “see things that the eyes don’t see.” It allows individuals to anticipate future events, envision unseen outcomes, and creatively generate solutions beyond immediate sensory input.</p></td></tr><tr><td data-label="Summary"><p><strong>Why Logic Alone Fails to Explain Imagination</strong></p></td><td data-label="Notes"><p>Logic may attribute imagination to hallucination or faster cognitive processing. Both explanations fail: hallucination cannot account for accuracy, and fast processing requires data—yet Operators had minimal data about the bomb, child, or environment.</p></td></tr><tr><td data-label="Summary"><p><strong>Historical and Linguistic Origins of Imagination</strong></p></td><td data-label="Notes"><p>Imagination entered English in the 14th century, denoting the mind’s capacity to produce images. Mental images are computational, like computer-generated visuals. Yet images themselves are secondary; imagination begins with an intention or “script” guiding those images.</p></td></tr><tr><td data-label="Summary"><p><strong>Story as the Biological Root of Imagination</strong></p></td><td data-label="Notes"><p>Ancient writings (fables, myths, tales) identify story as the primary mechanism for imaginative thought. Story enables humans to simulate scenarios, envision alternative futures, and predict outcomes—both spatially and temporally.</p></td></tr><tr><td data-label="Summary"><p><strong>School vs. Biological Function of Story</strong></p></td><td data-label="Notes"><p>Modern schooling emphasizes story for communication (writing essays, persuasive speech), yet story evolved millions of years before language.</p></td></tr><tr><td data-label="Summary"><p><strong>Story in Ancient Contexts</strong></p></td><td data-label="Notes"><p>Courts in ancient Athens and Rome: lawyers discovered that facts alone failed to persuade juries, leading them to spin narratives (narratio). Cicero codified these methods, linking story with rhetoric, but misrepresenting its primal function: cognition, not communication.</p></td></tr><tr><td data-label="Summary"><p><strong>Storythinking in Children and Animals</strong></p></td><td data-label="Notes"><p>Anna Craft’s research: preschoolers naturally engage in storythinking (“being a dog digging a hole,” “a doctor healing bones”). Later studies show adults, chimpanzees, mice, and crows also engage in story-based reasoning.</p></td></tr><tr><td data-label="Summary"><p><strong>Story vs. Logic</strong></p></td><td data-label="Notes"><p>Logic identifies the probable; story identifies the possible. Probable events rely on historical data; possible events explore scenarios that have never occurred but are consistent with environmental rules. This flexibility promotes initiative, innovation, and resilience.</p></td></tr><tr><td data-label="Summary"><p><strong>Operators’ Storythinking Methods</strong></p></td><td data-label="Notes"><p>Two main types of storythinking:<br>- <br>1. Past (causal “why”) – analyzing previous events and their causes.<br>- <br>2. Future (counterfactual “what if”) – imagining alternative outcomes.<br>These are linked in a feedback loop: diverse “why”s enhance “what if”s and vice versa.</p></td></tr><tr><td data-label="Summary"><p><strong>Mental Narrative Shape</strong></p></td><td data-label="Notes"><p>Operators’ cognition resembles: one integrated past (clarifying purpose) + branching future (exploring multiple tactical possibilities). This structure underlies their ability to act decisively in uncertainty, mirroring improvisation in sports, surgery, or comedy.</p></td></tr><tr><td data-label="Summary"><p><strong>Storythinking in Improvisers</strong></p></td><td data-label="Notes"><p>Effective improvisers share this mental model: athletes, surgeons, and comedians adapt to dynamic situations while maintaining their overarching objectives. Integrated past = stability; branching future = flexibility. Example: a surgeon improvising in the OR without violating biological rules.</p></td></tr><tr><td data-label="Summary"><p><strong>Training Imagination through Planning</strong></p></td><td data-label="Notes"><p>Special Forces instructors explain: “Planning is the main use of imagination.” Imagination enables the creation of sequences of actions (plans) that anticipate multiple contingencies. Story = plot = plan.</p></td></tr><tr><td data-label="Summary"><p><strong>Features of Effective Plans</strong></p></td><td data-label="Notes"><ol><li>Single long-term goal – defines the overarching objective.<br>2. Multiple possible paths – generates tactical flexibility.<br>Example: Operators’ goal “build rapport with chieftain” allows multiple rescue strategies for the child.</li></ol></td></tr><tr><td data-label="Summary"><p><strong>Comparison with Untrained Individuals</strong></p></td><td data-label="Notes"><p>Most people have multiple conflicting goals (e.g., “capture the hill” + “don’t get anyone killed”) and pursue Plan A exclusively. Lack of tactical flexibility leads to indecision and inefficiency. Operators avoid this by defining strategy and multiplying tactics.</p></td></tr><tr><td data-label="Summary"><p><strong>Defined Strategy, Unlimited Tactics</strong></p></td><td data-label="Notes"><p>Strategy = integrated past, clarified “why.” Tactics = branching future, expanded “what if”s. This combination produces adaptive, goal-aligned decision-making, allowing Operators to respond to unforeseen events without losing strategic focus.</p></td></tr><tr><td data-label="Summary"><p><strong>Historical Examples: Effective Planning</strong></p></td><td data-label="Notes"><p>Admiral Horatio Nelson: unified strategy + tactical independence; deployed at Battle of Trafalgar. Despite being outnumbered, his fleet captured two-thirds of enemy ships. Beethoven: classical structure + harmonic innovation in Fifth Symphony; balanced overarching design with spontaneous creativity.</p></td></tr><tr><td data-label="Summary"><p><strong>Life Story as Personal Plan</strong></p></td><td data-label="Notes"><p>Individual life story = personal strategic plan. Integrated past clarifies purpose and values (why). Branching future creates multiple possibilities and pathways (what if). This structure reduces hesitation, accelerates decision-making, and enhances adaptation.</p></td></tr><tr><td data-label="Summary"><p><strong>Emotion as a Cognitive Tool</strong></p></td><td data-label="Notes"><p>Emotion enhances story-based cognition. It integrates past experiences and anticipates future possibilities, making decisions faster, more intuitive, and adaptable. Operators’ rapid response to the bomb exemplifies emotion-guided imagination in action.</p></td></tr><tr><td data-label="Summary"><p><strong>Practical Implications for Everyday Life</strong></p></td><td data-label="Notes"><p>Everyone can train imagination by:<br>- Defining a clear, single objective.<br>- Practicing multiple possible tactical responses.<br>- Observing exceptional information and leveraging intuition.<br>Applications: business, healthcare, education, parenting, athletics.</p></td></tr><tr><td data-label="Summary"><p><strong>Integration of Past and Future for Adaptive Action</strong></p></td><td data-label="Notes"><p>Operators’ integrated past provides momentum and clarity. Branching future enables adaptability to unforeseen challenges. The mental narrative allows efficient real-time decision-making in dynamic environments, whether foggy woods or organizational crises.</p></td></tr><tr><td data-label="Summary"><p><strong>Conclusion: Story as Planning Engine</strong></p></td><td data-label="Notes"><p>Story is not merely a vehicle for entertainment or communication; it evolved as a cognitive mechanism for planning, predicting, and problem-solving. Training imagination through story-thinking enhances resilience, creativity, and effectiveness under uncertainty.</p></td></tr></tbody></table></div><div class='row-count'></div></div><div class="table-wrapper" data-table-id="table-7"><h3 id="table-7">Table 7</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th style="width:28.57%;" role="button" aria-label="Sort by **Component**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Component</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th style="width:71.43%;" role="button" aria-label="Sort by **Explanation &amp; recommendation**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Explanation & recommendation</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Component"><p><strong>Summary (what this `script.js` does)</strong></p></td><td data-label="Explanation &amp; recommendation"><p>The file is a single self-contained IIFE that implements the full client-side UI for the Tables Viewer: configuration, normalization & debounce helpers, clipboard (with legacy fallback), toast/notification system, copy modal, safe DOM helpers, row snapshot + sort state, sorting & toggle controls, row-counts, many export functions (CSV, Markdown, JSON, XLSX, PDF), reset/search/highlight with Unicode-aware normalization, initialization wiring (DOMContentLoaded), delegated click handlers, TOC scrolling, back-to-top behavior and public API exposure on `window`. It is robust and defensive (lots of try/catch), polyfill-like fallbacks, and integrates SheetJS when present.</p></td></tr><tr><td data-label="Component"><p><strong>Main responsibilities (single-file map)</strong></p></td><td data-label="Explanation &amp; recommendation"><ol><li>Config & helpers: normalizeForSearch, debounce.  <br>2) Clipboard & fallback: copyToClipboard, tryLegacyCopy.  <br>3) Notifications/UI: showToast + queue, toast container styling.  <br>4) Copy modal UI: showCopyModal (dialog with copy/download).  <br>5) DOM utilities: getSearchEl, getTableFromButton, safeGetTBody.  <br>6) State: originalTableRows, sortStates.  <br>7) Sorting & toggle functions: sortTableByColumn, toggleTable, toggleAllTables.  <br>8) Row counts: updateRowCounts.  <br>9) Copy/export implementations: copy/csv/md/json/xlsx/pdf/all-tables.  <br>10) Reset, search, highlight: complex Unicode-normalization + mark insertion.  <br>11) Init & event wiring: DOMContentLoaded, delegated click handlers, keybinds, scroll behavior.  <br>12) Public API exposure: assign many functions onto `window`.</li></ol></td></tr><tr><td data-label="Component"><p><strong>Should it be split? (short answer)</strong></p></td><td data-label="Explanation &amp; recommendation"><p><strong>Yes.</strong> The file mixes many orthogonal concerns (UI widgets, clipboard, export formats, search/highlight, DOM wiring). Splitting increases readability, testability, smaller incremental maintenance, and enables lazy-loading heavy features (SheetJS, worker), while keeping a small runtime bootstrap.</p></td></tr><tr><td data-label="Component"><p><strong>Why split? (concrete benefits)</strong></p></td><td data-label="Explanation &amp; recommendation"><p><ul><li>Single responsibility: each module is focused and smaller.  <br></li><li>Easier review and testing: unit-test toast, clipboard, export logic separately.  <br></li><li>Lazy-loading: large or infrequently used code (XLSX export, worker, modal) can be loaded only when needed.  <br></li><li>Reuse: other pages can import the toast/clipboard utilities.  <br></li><li>Security & audit: smaller files are easier to audit for DOM/innerHTML/encoding issues.  <br></li><li>Build optimizations: tree-shaking & bundling/minification become straightforward.</li></ul></p></td></tr><tr><td data-label="Component"><p><strong>Where to split (suggested modules / filenames)</strong></p></td><td data-label="Explanation &amp; recommendation"><ol><li><strong>tv.config.js</strong> — small: config object + setter.  <br>2. <strong>tv.utils.js</strong> — helpers: `normalizeForSearch`, `debounce`, `safeGetTBody`, `getTableFromButton`, `getSearchEl`.  <br>3. <strong>tv.clipboard.js</strong> — `copyToClipboard`, `tryLegacyCopy` + small public wrapper.  <br>4. <strong>tv.toast.js</strong> — toast queue, `<em>ensureToastContainer`, `showToast`, `</em>processToastQueue` (depends on tv.utils only).  <br>5. <strong>tv.copymodal.js</strong> — `showCopyModal` (depends on clipboard + toast).  <br>6. <strong>tv.exports.js</strong> — all export functions (CSV, MD, JSON, XLSX, PDF, exportAll). Heavy: candidate to lazy-load or to split further (`xlsx` submodule).  <br>7. <strong>tv.search.js</strong> — `searchTable`, highlight helpers, `buildNormalizedMapForCell`, `highlightMatches`, `clearHighlights`.  <br>8. <strong>tv.sorting.js</strong> — sorting, header UI updates, row snapshots, resetAllTables.  <br>9. <strong>tv.init.js</strong> — DOMContentLoaded wiring, delegated event listeners, keybindings, expose public API on `window`.  <br>10. <strong>tv.inline&#95;shim.js</strong> (optional) — the legacy inline-shim string for environments without script.js; only injected when needed.</li></ol></td></tr><tr><td data-label="Component"><p><strong>How to split (practical plan, step-by-step)</strong></p></td><td data-label="Explanation &amp; recommendation"><ol><li>Create the modules with the suggested separation, keeping exports as plain functions (no top-level DOM run).  <br>2. Convert shared state (originalTableRows, sortStates) into a small `tvState` object exported from `tv.state.js` or pass as argument to functions.  <br>3. Replace direct `window` writes with an explicit `init` function in `tv.init.js` that accepts an interface object or attaches to `window` at the end for compatibility.  <br>4. Wire modules with ES modules (preferred) or simple concatenation in a build step to preserve older environments.  <br>5. Provide a single build artifact for distribution (bundle + minify) that concatenates modules in correct order — keep an `esm` build and a `umd/iife` build for widest compatibility.  <br>6. Add lazy-loading hooks: export `loadXLSX()` which dynamically imports the xlsx-submodule or loads `assets/xlsx.full.min.js` only when `exportTableXLSX` is first invoked.  <br>7. Add tests for key pure functions (normalizeForSearch, csv generation, markdown serialization, highlight map builder).</li></ol></td></tr><tr><td data-label="Component"><p><strong>Backward-compatibility approach</strong></p></td><td data-label="Explanation &amp; recommendation"><p><ul><li>Keep existing `window.&#42;` public API names by re-exporting wrappers from `tv.init.js`.  <br></li><li>Initially ship both: the refactored module files and a single concatenated `script.js` (build step) so consumers with no bundler continue to work.  <br></li><li>Provide a small migration README that shows how to import modules (ESM) for advanced users.</li></ul></p></td></tr><tr><td data-label="Component"><p><strong>Security, encoding & small gotchas found</strong></p></td><td data-label="Explanation &amp; recommendation"><p><ul><li>Some literal characters look mojibake (e.g. `â†‘`, `âœ•`) — ensure file encoding is UTF-8 without BOM; replace with proper characters (↑, ✓).  <br></li><li>Many `.innerHTML` assignments are used (to inject `mark` icons, inline shim). Those are generally safe here (only using sanitized SVG strings), but review any dynamic content inserted into HTML templates to avoid injection.  <br></li><li>`normalizeForSearch` uses Unicode `\p{L}` with `u` flag in a try/catch — good fallback present.  <br></li><li>`exportTablePDF` opens a new window and writes HTML; browsers will block popups in some environments — fallback messaging is present.  <br></li><li>Consider `rel="noopener noreferrer"` for any created anchor downloads if applicable.  <br></li><li>Worker usage assumes `assets/worker.js` path — after splitting, make sure relative paths are preserved.</li></ul></p></td></tr><tr><td data-label="Component"><p><strong>Performance & UX suggestions</strong></p></td><td data-label="Explanation &amp; recommendation"><p><ul><li>&#42;&#42;Lazy-load&#42;</li><li>SheetJS and heavy code paths only when user requests XLSX export.  <br></li><li>Consider debouncing or chunking `highlightMatches` for extremely large cells; currently it operates per-cell and is heavy for huge documents.  <br></li><li>Use `requestIdleCallback` (when available) to build `originalTableRows` snapshot to avoid jank during initial render.  <br></li><li>For very large tables, integrate or expose a virtualization hook (`window.tableVirtualizer`) — the current code already checks for it.  <br></li><li>Avoid repeatedly setting `innerHTML` on the same cells; where possible use data attributes or precomputed nodes.</li></ul></p></td></tr><tr><td data-label="Component"><p><strong>Testing & maintenance</strong></p></td><td data-label="Explanation &amp; recommendation"><p><ul><li>Add unit tests for: CSV/JSON/MD generation, XLSX fallback generation, normalizeForSearch, buildNormalizedMapForCell matching logic, showToast queue logic.  <br></li><li>Add linting (ESLint) and Prettier config for consistent style (fix the weird encodings).  <br></li><li>Add a small integration test page to exercise the exports and copying in headless browsers (Puppeteer).</li></ul></p></td></tr><tr><td data-label="Component"><p><strong>Recommendation / final call</strong></p></td><td data-label="Explanation &amp; recommendation"><p>Split the file into logical modules as suggested. Start with a minimal split: `tv.utils.js`, `tv.toast.js`, `tv.clipboard.js`, `tv.exports.js`, `tv.init.js` — that yields immediate maintainability wins. Keep a build step that emits a single `script.js` for distribution. Prioritize lazy-loading XLSX/worker and fix encoding characters.</p></td></tr></tbody></table></div><div class='row-count'></div></div><script src="assets/xlsx.full.min.js?v=1758862283" defer></script>
<script src="assets/script.js?v=1758862283" defer></script>
<script src="assets/worker.js?v=1758862283" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
</script>
</div>
</body>
</html>