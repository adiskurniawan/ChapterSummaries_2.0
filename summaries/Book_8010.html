<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1760248567">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      // Delegate addEventListener/removeEventListener to visible button
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      // Delegate onclick assignments
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      // Delegate focus/blur
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
      // If legacy code used direct addEventListener earlier than this script, listeners would already exist
      // on alias element; attempt to re-dispatch those by cloning them to visible button is non-trivial.
      // This approach covers the common case where legacy scripts query the alias and bind after DOM ready.
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Book_8010_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Feature**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Feature</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Tables Viewer v2.1**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Tables Viewer v2.1</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **PasteToTable**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>PasteToTable</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Feature"> <strong>Purpose</strong>                  </td><td data-label="Tables Viewer v2.1"> Browser-based interface for displaying, filtering, and manipulating structured tabular data with real-time updates.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </td><td data-label="PasteToTable"> Browser-based utility that converts raw text (CSV, TSV, or Excel clipboard data) into a clean, interactive HTML table for further manipulation or export.                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Feature"> <strong>Core Components</strong>          </td><td data-label="Tables Viewer v2.1"> - <strong>UI Layer</strong>: HTML table container with virtual scrolling; search and filter controls; column sorting and visibility toggling. <br> - <strong>Data Engine</strong>: Loads JSON, CSV, or API data; supports dynamic data binding; event-driven change propagation. <br> - <strong>Renderer</strong>: Efficient DOM patching; lazy render off-screen rows. <br> - <strong>Persistence</strong>: LocalStorage for user settings; optional cloud sync API.                                                                                                                                                                                                                                                                                                                                      </td><td data-label="PasteToTable"> - <strong>Input Processor</strong>: Parses clipboard text into structured arrays; auto-detects delimiters; trims whitespace; normalizes line endings. <br> - <strong>Table Generator</strong>: Builds <code>&lt;table&gt;</code> dynamically; alternating row styles; optional header detection. <br> - <strong>Editor Tools</strong>: Add/remove rows/columns; inline cell editing with validation; copy/export to CSV or JSON. <br> - <strong>Integration Hooks</strong>: Can send parsed data to Tables Viewer v2.1; extensible via <code>core_compat.py</code>. </td></tr><tr><td data-label="Feature"> <strong>Modules</strong>                  </td><td data-label="Tables Viewer v2.1"> - <code>script.js</code>: Main control layer. <br> - <code>data_handler.js</code>: Parses, validates, and transforms data. <br> - <code>ui_controls.js</code>: Manages user interaction and events. <br> - <code>render_engine.js</code>: Handles DOM rendering and visual updates. <br> - <code>storage.js</code>: Manages persistence and config save/load.                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td><td data-label="PasteToTable"> - <code>paste_parser.js</code>: Main parsing logic. <br> - <code>table_editor.js</code>: Manages editable UI. <br> - <code>export_tools.js</code>: Handles CSV/JSON export. <br> - <code>core_compat.py</code>: Cross-project compatibility layer for data exchange.                                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Feature"> <strong>Performance Targets</strong>      </td><td data-label="Tables Viewer v2.1"> - Render up to 100k rows smoothly. <br> - Sub-50ms updates on user interactions. <br> - Memory footprint <150MB for full dataset in browser.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           </td><td data-label="PasteToTable"> - Handle pasted data up to 10k rows instantly. <br> - <100ms parsing time for 1MB input. <br> - Zero reflows beyond viewport.                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Feature"> <strong>Security</strong>                 </td><td data-label="Tables Viewer v2.1"> - Sanitization of all data before DOM insertion. <br> - No external eval or dynamic script injection. <br> - CSP compliance.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           </td><td data-label="PasteToTable"> - Input sanitization for clipboard content. <br> - No HTML injection from pasted text. <br> - CSP and sandboxed iframe compliance.                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Feature"> <strong>Shared Development Rules</strong> </td><td data-label="Tables Viewer v2.1"> - <strong>Coding Style</strong>: ES6+ for JavaScript modules; Python 3.11+ for compatibility layer; modular, functional design. <br> - <strong>Naming Conventions</strong>: camelCase for JS variables/functions; snake_case for Python; UpperCamelCase for class definitions. <br> - <strong>Versioning</strong>: Semantic versioning (major.minor.patch); each release documented with changelog. <br> - <strong>Documentation</strong>: Inline JSDoc for functions; Markdown-based project docs; diagrams for module relationships. <br> - <strong>Testing</strong>: Unit tests for all parsers, renderers, and data transformers; manual UI regression checklist. <br> - <strong>Extensibility</strong>: Each module exposes a minimal API; shared event bus for cross-module communication; interoperable via <code>core_compat.py</code>. </td><td data-label="PasteToTable"> - Same as Tables Viewer v2.1.                                                                                                                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Feature"> <strong>Goal Alignment</strong>           </td><td data-label="Tables Viewer v2.1"> Focuses on presentation and interaction.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td><td data-label="PasteToTable"> Focuses on data ingestion and transformation. <br> Both converge toward a unified ecosystem for browser-based table management.                                                                                                                                                                                                                                                                                                                                                     </td></tr></tbody></table></div><div class="row-count">Rows: 7</div></div><div class="table-caption" id="Table2" data-table="Book_8010_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Tables Viewer v2.1**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Tables Viewer v2.1</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **PasteToTable**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>PasteToTable</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Tables Viewer v2.1"> <strong>render/core_assets.py</strong> – Handles discovery, validation, and copying of static assets (CSS, JS, worker scripts) into the output directory. Provides atomic operations to avoid partial writes. </td><td data-label="PasteToTable"> <strong>render/assets.py</strong> – Centralizes asset path resolution and caching. Manages static assets with minimal coupling to rendering logic. Serves as lightweight replacement for <code>core_assets.py</code> with streamlined API.                                     </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>render/core_fragments.py</strong> – Renders discrete HTML fragments for tables, rows, and cells. Provides templated partials that <code>core_renderer.py</code> assembles.                                       </td><td data-label="PasteToTable"> <strong>convert.py</strong> – Parsing and table-building logic incorporates fragment rendering implicitly. Fragments are constructed dynamically via Python objects rather than separate HTML templates.                                                            </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>render/core_io.py</strong> – Manages atomic writes, temporary directories, and ensures filesystem safety. Supports cross-platform paths and error recovery.                                           </td><td data-label="PasteToTable"> <strong>io_utils.py</strong> – Reads/writes input and output files with helper functions. Handles temp storage and atomic writes in a simpler, functional style. Replaces <code>core_io.py</code> while maintaining platform safety.                                           </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>render/core_renderer.py</strong> – Orchestrates full HTML rendering pipeline. Calls fragments, assembles page, copies assets, and writes final HTML.                                                  </td><td data-label="PasteToTable"> <strong>core.py</strong> – Full pipeline orchestrator for conversion: reads input, sanitizes, builds tables, and outputs HTML or JSON. Combines rendering, IO, and conversion responsibilities under one module.                                                    </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>render/core_table.py</strong> – Provides <code>render_table()</code> wrapper to render a single table into HTML. Abstracts repetitive fragment calls.                                                            </td><td data-label="PasteToTable"> Integrated into <code>convert.py</code> – Table rendering is embedded in table-building functions. Replaces dedicated wrapper with typed table object handling and flexible output formats.                                                                       </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>render/core_utils.py</strong> – Miscellaneous helpers for streaming output, formatting, and minor logic shared across renderer modules.                                                               </td><td data-label="PasteToTable"> <strong>utils.py</strong> – Reimplemented as environment and directory helpers, plus utility functions for path normalization, JSON handling, and logging.                                                                                                          </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>render/core_compat.py</strong> – Re-exports main rendering functions for external API. Allows scripts to call <code>render_html()</code> and <code>render_table()</code> without knowing internal module structure.         </td><td data-label="PasteToTable"> <strong>core_compat.py</strong> – Compatibility shims for backwards compatibility. Exposes simplified API to higher-level modules while isolating legacy calls.                                                                                                     </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>convert.py</strong> – Not present in this context; conversion logic embedded in fragments and renderer orchestration.                                                                                 </td><td data-label="PasteToTable"> <strong>convert.py</strong> – Central table parsing and builder. Takes input data (CSV, JSON, markdown), sanitizes, builds internal table objects, and prepares them for rendering.                                                                                 </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>markdown.py</strong> – Converts table fragments into Markdown representations. Supports partial exports for documentation or previews.                                                                </td><td data-label="PasteToTable"> <strong>markdown.py</strong> – Markdown export helpers for table objects. Similar purpose but tied to typed <code>Table</code> models rather than ad-hoc HTML fragments.                                                                                                       </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>io_utils.py</strong> – Handles reading/writing of files, streams, and temporary storage. Ensures atomic operations to prevent incomplete outputs.                                                     </td><td data-label="PasteToTable"> See above: <code>io_utils.py</code> functional replacement. Supports reading/writing tables and JSON/CSV inputs safely.                                                                                                                                           </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>sanitize.py</strong> – Cleans table content, escapes HTML, and removes unsafe elements.                                                                                                               </td><td data-label="PasteToTable"> <strong>sanitize.py</strong> – Input sanitization pipeline. Ensures table content is safe for rendering in HTML/Markdown. Streamlined to integrate with typed table models.                                                                                         </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>types.py</strong> – Minimal typing. Mostly runtime validation and simple container classes.                                                                                                           </td><td data-label="PasteToTable"> <strong>types.py</strong> – Strong typed models for tables, rows, and cells. Facilitates static checks and predictable object structures.                                                                                                                           </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>assets.py</strong> – Part of core_assets workflow; manages file copying.                                                                                                                              </td><td data-label="PasteToTable"> See above: <code>assets.py</code> – lightweight path/caching helper.                                                                                                                                                                                              </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>cli.py</strong> – Single CLI entrypoint to render tables from command line. Limited subcommands.                                                                                                      </td><td data-label="PasteToTable"> <strong>cli.py</strong> – Multi-subcommand CLI for conversion, export, and server launch. Modular argument parsing.                                                                                                                                                 </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>**init</strong>.py** – Re-exports main rendering functions for API consumers.                                                                                                                         </td><td data-label="PasteToTable"> <strong>**init</strong>.py** – Minimal, establishes package API boundaries.                                                                                                                                                                                         </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>assets/style.css</strong> – Stylesheet for rendered tables.                                                                                                                                           </td><td data-label="PasteToTable"> <strong>assets/style.css</strong> – Maintains CSS styles, adapted for PasteToTable templates.                                                                                                                                                                       </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>assets/script.js</strong> – Client-side JS for interactivity. Used in rendered tables (sorting, filtering, pagination).                                                                               </td><td data-label="PasteToTable"> <strong>assets/script.js</strong> – Similar functionality, adapted to new table object model and template usage.                                                                                                                                                    </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>assets/worker.js</strong> – Worker thread for heavy client-side processing.                                                                                                                           </td><td data-label="PasteToTable"> <strong>assets/worker.js</strong> – Preserved minimal interactivity support.                                                                                                                                                                                        </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>output_combined/</strong> – Central output directory. Contains compiled HTML, assets, and embedded SheetJS library for XLSX export.                                                                   </td><td data-label="PasteToTable"> <strong>templates/</strong> – Stores <code>index.html</code> template. Output written to <code>saved_tables/</code> instead of combined assets. XLSX export handled differently (likely server-side or via SheetJS separately).                                                           </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>html_renderer.py</strong> – Handles orchestration of rendering, likely via function calls.                                                                                                            </td><td data-label="PasteToTable"> <strong>html_renderer.py</strong> – Flask app factory for web-based rendering of tables. Converts pipeline into a server-accessible interface.                                                                                                                      </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>utils.py</strong> – Helper functions for environment and path management.                                                                                                                             </td><td data-label="PasteToTable"> <strong>utils.py</strong> – Same purpose.                                                                                                                                                                                                                           </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>helpers.py</strong> – Miscellaneous helpers for internal logic.                                                                                                                                       </td><td data-label="PasteToTable"> <strong>server.py</strong> – Optional API server functions.                                                                                                                                                                                                         </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>main.py</strong> – Entry point script to run render pipeline.                                                                                                                                         </td><td data-label="PasteToTable"> <strong>main.py</strong> – CLI and/or server entry point.                                                                                                                                                                                                           </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>output_combined/assets/xlsx.full.min.js</strong> – 930 KB SheetJS library included for client-side XLSX export.                                                                                       </td><td data-label="PasteToTable"> Not included; XLSX export may be handled differently, potentially server-side or dynamically loaded.                                                                                                                                                   </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>Structural notes</strong> – Modular renderer separates assets, fragments, tables, and IO for clear layering. Heavy reliance on procedural orchestration with minimal type enforcement.                </td><td data-label="PasteToTable"> <strong>Structural notes</strong> – More unified, typed, and modern architecture. Combines parsing, sanitization, and rendering with strong type guarantees. Uses Flask for interactive rendering. CLI and server modes more explicit. Asset management simplified. </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>Design philosophy</strong> – Focused on batch HTML table rendering with client-side interactivity. Emphasizes atomic writes, safe file operations, and modular HTML fragment assembly.                </td><td data-label="PasteToTable"> <strong>Design philosophy</strong> – Focused on reusable pipeline for parsing, building, sanitizing, and rendering tables. Supports web server deployment, typed table models, and flexible output formats.                                                         </td></tr></tbody></table></div><div class="row-count">Rows: 26</div></div><div class="table-caption" id="Table3" data-table="Book_8010_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Aspect**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Aspect</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Insight / Comparison**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Insight / Comparison</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> <strong>Pipeline evolution</strong>    </td><td data-label="Insight / Comparison"> Tables Viewer v2.1 separates renderer responsibilities across <code>core_fragments</code>, <code>core_renderer</code>, <code>core_table</code>, <code>core_utils</code>. PasteToTable consolidates orchestration into <code>core.py</code> and <code>convert.py</code> and uses typed objects instead of loose fragments. </td></tr><tr><td data-label="Aspect"> <strong>Typing & safety</strong>       </td><td data-label="Insight / Comparison"> PasteToTable enforces structured <code>types.py</code> models, reducing runtime errors relative to Tables Viewer v2.1's looser fragment-based approach.                                                                                                            </td></tr><tr><td data-label="Aspect"> <strong>Assets & client logic</strong> </td><td data-label="Insight / Comparison"> Both keep <code>style.css</code> and <code>script.js</code>. Tables Viewer v2.1 ships heavier XLSX client-side logic. PasteToTable favors server- or template-driven exports.                                                                                                 </td></tr><tr><td data-label="Aspect"> <strong>Execution environment</strong> </td><td data-label="Insight / Comparison"> Tables Viewer v2.1 is file-driven CLI. PasteToTable adds a Flask web server for dynamic rendering and API endpoints.                                                                                                                                    </td></tr><tr><td data-label="Aspect"> <strong>CLI & automation</strong>      </td><td data-label="Insight / Comparison"> PasteToTable offers multiple CLI subcommands for automation and server control. Tables Viewer v2.1 provides a simpler batch HTML generator CLI.                                                                                                         </td></tr><tr><td data-label="Aspect"> <strong>Maintainability</strong>       </td><td data-label="Insight / Comparison"> PasteToTable’s consolidation, typing, and templates ease feature expansion and deployment. Tables Viewer’s modular fragments give granular control but increase orchestration complexity.                                                               </td></tr></tbody></table></div><div class="row-count">Rows: 6</div></div><div class="table-caption" id="Table4" data-table="Book_8010_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Aspect"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Aspect</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Tables Viewer v2.1"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Tables Viewer v2.1</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by PasteToTable"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">PasteToTable</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> Core orchestration  </td><td data-label="Tables Viewer v2.1"> <code>core_renderer.py</code> drives HTML rendering    </td><td data-label="PasteToTable"> <code>core.py</code> orchestrates full conversion pipeline </td></tr><tr><td data-label="Aspect"> Compatibility layer </td><td data-label="Tables Viewer v2.1"> <code>core_compat.py</code> re-exports rendering funcs </td><td data-label="PasteToTable"> <code>core_compat.py</code> provides backward shims        </td></tr><tr><td data-label="Aspect"> Fragment management </td><td data-label="Tables Viewer v2.1"> <code>core_fragments.py</code> handles HTML segments   </td><td data-label="PasteToTable"> Integrated into <code>convert.py</code> and templates      </td></tr><tr><td data-label="Aspect"> Output handling     </td><td data-label="Tables Viewer v2.1"> Writes to <code>/output_combined/</code>               </td><td data-label="PasteToTable"> Writes to <code>/saved_tables/</code>, uses templates      </td></tr><tr><td data-label="Aspect"> CLI entry           </td><td data-label="Tables Viewer v2.1"> <code>cli.py</code> single use                         </td><td data-label="PasteToTable"> <code>cli.py</code> exposes multiple subcommands           </td></tr><tr><td data-label="Aspect"> Assets              </td><td data-label="Tables Viewer v2.1"> includes <code>worker.js</code> and <code>xlsx.full.min.js</code> </td><td data-label="PasteToTable"> minimal client assets, same CSS/JS naming       </td></tr><tr><td data-label="Aspect"> HTML rendering      </td><td data-label="Tables Viewer v2.1"> Python-driven via <code>render_html</code>             </td><td data-label="PasteToTable"> Flask app factory (<code>html_renderer.py</code>)          </td></tr><tr><td data-label="Aspect"> Static typing       </td><td data-label="Tables Viewer v2.1"> minimal                                     </td><td data-label="PasteToTable"> strong use of <code>types.py</code> models                 </td></tr><tr><td data-label="Aspect"> Goal                </td><td data-label="Tables Viewer v2.1"> batch HTML viewer for tables                </td><td data-label="PasteToTable"> web-enabled table converter and viewer          </td></tr></tbody></table></div><div class="row-count">Rows: 9</div></div><div class="table-caption" id="Table5" data-table="Book_8010_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Feature / Need"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Feature / Need</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Prompt_05 Module"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Prompt_05 Module</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Integration Type"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Integration Type</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Notes / Safety"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Notes / Safety</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Feature / Need"> Table rendering & virtual scrolling </td><td data-label="Prompt_05 Module"> <code>render/core.py</code>, <code>render/core_compat.py</code>    </td><td data-label="Integration Type"> Backend / preprocessing                  </td><td data-label="Notes / Safety"> Generates table skeletons, ensures <code>table.data-table</code> classes; frontend script.js interacts as-is. </td></tr><tr><td data-label="Feature / Need"> Paste processing                    </td><td data-label="Prompt_05 Module"> <code>render/convert.py</code>, <code>render/core_compat.py</code> </td><td data-label="Integration Type"> Server-side / form POST <code>/api/render</code>    </td><td data-label="Notes / Safety"> <code>render-form</code> posts directly to <code>/api/render</code>; textarea ID <code>paste</code> preserved.                      </td></tr><tr><td data-label="Feature / Need"> Markdown export                     </td><td data-label="Prompt_05 Module"> <code>render/markdown.py</code>                         </td><td data-label="Integration Type"> Optional / server-side                   </td><td data-label="Notes / Safety"> Frontend can request export via buttons; no code changes needed.                                   </td></tr><tr><td data-label="Feature / Need"> Asset embedding & fingerprinting    </td><td data-label="Prompt_05 Module"> <code>render/assets.py</code>                           </td><td data-label="Integration Type"> Build-time dynamic <code>&lt;link&gt;</code> / <code>&lt;script&gt;</code> </td><td data-label="Notes / Safety"> Version placeholders <code>?v=%%ASSET_HASH%%</code> match your build pipeline.                                </td></tr><tr><td data-label="Feature / Need"> CLI pre-rendering                   </td><td data-label="Prompt_05 Module"> <code>render/cli.py</code>                              </td><td data-label="Integration Type"> Optional                                 </td><td data-label="Notes / Safety"> Generates fully rendered HTML in <code>output_combined/</code>; index.html structure fully compatible.        </td></tr><tr><td data-label="Feature / Need"> JS logic & interactivity            </td><td data-label="Prompt_05 Module"> <code>assets/script.js</code>                           </td><td data-label="Integration Type"> Frontend                                 </td><td data-label="Notes / Safety"> All existing functionality preserved; enhanced with optional sorting and normalization only.       </td></tr><tr><td data-label="Feature / Need"> CSS styling                         </td><td data-label="Prompt_05 Module"> <code>assets/style.css</code>, <code>assets/overrides.css</code>   </td><td data-label="Integration Type"> Frontend                                 </td><td data-label="Notes / Safety"> Baseline style preserved; overrides allow future enhancement without breaking layout.              </td></tr></tbody></table></div><div class="row-count">Rows: 7</div></div><div class="table-caption" id="Table6" data-table="Book_8010_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Aspect"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Aspect</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by PasteToTable (Current)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">PasteToTable (Current)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Tables Viewer v2.1 (Sample)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Tables Viewer v2.1 (Sample)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Observations / Key Differences"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Observations / Key Differences</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> <strong>Purpose / Goal</strong>               </td><td data-label="PasteToTable (Current)"> Converts pasted markdown or CSV/TSV clipboard data into clean, interactive HTML tables for export.                                                   </td><td data-label="Tables Viewer v2.1 (Sample)"> Browser-based interface for viewing, filtering, and manipulating large tabular datasets with virtual scrolling.                                       </td><td data-label="Observations / Key Differences"> PasteToTable focuses on raw text ingestion + table generation; Tables Viewer focuses on large dataset display and interactivity. </td></tr><tr><td data-label="Aspect"> <strong>Header / Sticky Bar</strong>          </td><td data-label="PasteToTable (Current)"> <code>&lt;div id=&quot;stickyMainHeader&quot;&gt;</code> contains title, buttons, search, and paste toggle. Fully accessible, preserves your current layout.                    </td><td data-label="Tables Viewer v2.1 (Sample)"> <code>&lt;div id=&quot;stickyMainHeader&quot;&gt;&lt;div id=&quot;tv-header&quot;&gt;…&lt;/div&gt;&lt;/div&gt;</code> contains search, theme toggle, and table action buttons; less complex UI, minimal DOM. </td><td data-label="Observations / Key Differences"> Both use sticky headers; your PasteToTable header is more complex and already approved. No change should be made here.           </td></tr><tr><td data-label="Aspect"> <strong>Search</strong>                       </td><td data-label="PasteToTable (Current)"> <code>&lt;input id=&quot;search&quot;&gt;</code> within header row, integrated with script.js.                                                                                  </td><td data-label="Tables Viewer v2.1 (Sample)"> <code>&lt;input id=&quot;searchBox&quot; class=&quot;tv-search&quot;&gt;</code> in header.                                                                                                 </td><td data-label="Observations / Key Differences"> Functionally similar; your current input supports PasteToTable workflow.                                                         </td></tr><tr><td data-label="Aspect"> <strong>Buttons / Controls</strong>           </td><td data-label="PasteToTable (Current)"> Export, Clear, Toggle Paste, Convert, Render, Save HTML — linked to <code>script.js</code>.                                                                     </td><td data-label="Tables Viewer v2.1 (Sample)"> Copy, Export CSV/JSON/XLSX/PDF/Markdown, Collapse, Theme Toggle — inline JS.                                                                          </td><td data-label="Observations / Key Differences"> Your setup uses script.js for all actions; Tables Viewer has inline per-table buttons. Delegation handled differently.           </td></tr><tr><td data-label="Aspect"> <strong>Paste Panel</strong>                  </td><td data-label="PasteToTable (Current)"> <code>&lt;div id=&quot;paste-panel&quot;&gt;</code> with form and <code>&lt;textarea&gt;</code> for input; toggleable visibility.                                                                </td><td data-label="Tables Viewer v2.1 (Sample)"> Not present (Tables Viewer expects data already loaded).                                                                                              </td><td data-label="Observations / Key Differences"> Your page supports progressive enhancement and non-JS fallback; TV v2.1 is JS-only.                                              </td></tr><tr><td data-label="Aspect"> <strong>Tables / Rendering</strong>           </td><td data-label="PasteToTable (Current)"> <code>&lt;section id=&quot;tables&quot; class=&quot;table-container&quot;&gt;</code> dynamically populated; normalizes tables, adds <code>two-col</code> where needed.                               </td><td data-label="Tables Viewer v2.1 (Sample)"> <code>&lt;div class=&quot;table-wrapper&quot;&gt;</code> for each table with <code>.table-header-wrapper</code> + copy/export buttons; includes table sorting <code>&lt;button class=&quot;sort-btn&quot;&gt;</code>.  </td><td data-label="Observations / Key Differences"> PasteToTable currently does not implement per-column sorting in HTML; TV v2.1 has explicit sortable headers with icons.          </td></tr><tr><td data-label="Aspect"> <strong>Scripts</strong>                      </td><td data-label="PasteToTable (Current)"> script.js deferred; optional paste_handler.js/table_manager.js; mutation observers for toggles; table normalization helper; service worker optional. </td><td data-label="Tables Viewer v2.1 (Sample)"> Inline scripts for event delegation; opacity fade-in; DOMContentLoaded for delegation; all tables immediately rendered.                               </td><td data-label="Observations / Key Differences"> TV v2.1 has more granular per-table buttons and sorting; your script.js handles global table actions.                            </td></tr><tr><td data-label="Aspect"> <strong>Virtualization / Performance</strong> </td><td data-label="PasteToTable (Current)"> Targets up to 10k pasted rows; normalizes DOM; avoids reflows outside viewport.                                                                      </td><td data-label="Tables Viewer v2.1 (Sample)"> Targets 100k rows; uses opacity transitions + lazy render; per-table DOM virtualization.                                                              </td><td data-label="Observations / Key Differences"> TV v2.1 optimized for large datasets; PasteToTable optimized for moderate clipboard inputs.                                      </td></tr><tr><td data-label="Aspect"> <strong>Accessibility / ARIA</strong>         </td><td data-label="PasteToTable (Current)"> Roles defined: banner, toolbar, main, contentinfo, aria-live, aria-controls.                                                                         </td><td data-label="Tables Viewer v2.1 (Sample)"> Minimal ARIA; uses role="region" for tables viewer, label for TOC.                                                                                    </td><td data-label="Observations / Key Differences"> Your page is stronger on accessibility; TV v2.1 is functional but minimal.                                                       </td></tr><tr><td data-label="Aspect"> <strong>Export / Clipboard</strong>           </td><td data-label="PasteToTable (Current)"> Global Export All; Save HTML; clipboard integration via script.js.                                                                                   </td><td data-label="Tables Viewer v2.1 (Sample)"> Per-table copy/export buttons; delegation logic for hidden buttons.                                                                                   </td><td data-label="Observations / Key Differences"> TV v2.1 handles multiple export formats per table; PasteToTable has simpler global approach.                                     </td></tr><tr><td data-label="Aspect"> <strong>TOC</strong>                          </td><td data-label="PasteToTable (Current)"> <code>&lt;nav id=&quot;toc&quot;&gt;&lt;ul id=&quot;tocList&quot;&gt;…&lt;/ul&gt;&lt;/nav&gt;</code>                                                                                                        </td><td data-label="Tables Viewer v2.1 (Sample)"> <code>&lt;div id=&quot;tocBar&quot;&gt;&lt;ul&gt;…&lt;/ul&gt;&lt;/div&gt;</code>                                                                                                                   </td><td data-label="Observations / Key Differences"> Functionally equivalent; slightly different naming.                                                                              </td></tr><tr><td data-label="Aspect"> <strong>Service Worker</strong>               </td><td data-label="PasteToTable (Current)"> Optional registration included, deferred, robust.                                                                                                    </td><td data-label="Tables Viewer v2.1 (Sample)"> None.                                                                                                                                                 </td><td data-label="Observations / Key Differences"> Advantage for offline support.                                                                                                   </td></tr></tbody></table></div><div class="row-count">Rows: 12</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>