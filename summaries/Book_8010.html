<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1760513344">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      // Delegate addEventListener/removeEventListener to visible button
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      // Delegate onclick assignments
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      // Delegate focus/blur
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
      // If legacy code used direct addEventListener earlier than this script, listeners would already exist
      // on alias element; attempt to re-dispatch those by cloning them to visible button is non-trivial.
      // This approach covers the common case where legacy scripts query the alias and bind after DOM ready.
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li>
<li class="toc-item"><a class="toc-link" href="#Table7">Table 7</a></li>
<li class="toc-item"><a class="toc-link" href="#Table8">Table 8</a></li>
<li class="toc-item"><a class="toc-link" href="#Table9">Table 9</a></li>
<li class="toc-item"><a class="toc-link" href="#Table10">Table 10</a></li>
<li class="toc-item"><a class="toc-link" href="#Table11">Table 11</a></li>
<li class="toc-item"><a class="toc-link" href="#Table12">Table 12</a></li>
<li class="toc-item"><a class="toc-link" href="#Table13">Table 13</a></li>
<li class="toc-item"><a class="toc-link" href="#Table14">Table 14</a></li>
<li class="toc-item"><a class="toc-link" href="#Table15">Table 15</a></li>
<li class="toc-item"><a class="toc-link" href="#Table16">Table 16</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Book_8010_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Feature**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Feature</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Tables Viewer v2.1**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Tables Viewer v2.1</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **PasteToTable**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>PasteToTable</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Feature"> <strong>Purpose</strong>                  </td><td data-label="Tables Viewer v2.1"> Browser-based interface for displaying, filtering, and manipulating structured tabular data with real-time updates.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </td><td data-label="PasteToTable"> Browser-based utility that converts raw text (CSV, TSV, or Excel clipboard data) into a clean, interactive HTML table for further manipulation or export.                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Feature"> <strong>Core Components</strong>          </td><td data-label="Tables Viewer v2.1"> - <strong>UI Layer</strong>: HTML table container with virtual scrolling; search and filter controls; column sorting and visibility toggling. <br> - <strong>Data Engine</strong>: Loads JSON, CSV, or API data; supports dynamic data binding; event-driven change propagation. <br> - <strong>Renderer</strong>: Efficient DOM patching; lazy render off-screen rows. <br> - <strong>Persistence</strong>: LocalStorage for user settings; optional cloud sync API.                                                                                                                                                                                                                                                                                                                                      </td><td data-label="PasteToTable"> - <strong>Input Processor</strong>: Parses clipboard text into structured arrays; auto-detects delimiters; trims whitespace; normalizes line endings. <br> - <strong>Table Generator</strong>: Builds <code>&lt;table&gt;</code> dynamically; alternating row styles; optional header detection. <br> - <strong>Editor Tools</strong>: Add/remove rows/columns; inline cell editing with validation; copy/export to CSV or JSON. <br> - <strong>Integration Hooks</strong>: Can send parsed data to Tables Viewer v2.1; extensible via <code>core_compat.py</code>. </td></tr><tr><td data-label="Feature"> <strong>Modules</strong>                  </td><td data-label="Tables Viewer v2.1"> - <code>script.js</code>: Main control layer. <br> - <code>data_handler.js</code>: Parses, validates, and transforms data. <br> - <code>ui_controls.js</code>: Manages user interaction and events. <br> - <code>render_engine.js</code>: Handles DOM rendering and visual updates. <br> - <code>storage.js</code>: Manages persistence and config save/load.                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td><td data-label="PasteToTable"> - <code>paste_parser.js</code>: Main parsing logic. <br> - <code>table_editor.js</code>: Manages editable UI. <br> - <code>export_tools.js</code>: Handles CSV/JSON export. <br> - <code>core_compat.py</code>: Cross-project compatibility layer for data exchange.                                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Feature"> <strong>Performance Targets</strong>      </td><td data-label="Tables Viewer v2.1"> - Render up to 100k rows smoothly. <br> - Sub-50ms updates on user interactions. <br> - Memory footprint <150MB for full dataset in browser.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           </td><td data-label="PasteToTable"> - Handle pasted data up to 10k rows instantly. <br> - <100ms parsing time for 1MB input. <br> - Zero reflows beyond viewport.                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Feature"> <strong>Security</strong>                 </td><td data-label="Tables Viewer v2.1"> - Sanitization of all data before DOM insertion. <br> - No external eval or dynamic script injection. <br> - CSP compliance.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           </td><td data-label="PasteToTable"> - Input sanitization for clipboard content. <br> - No HTML injection from pasted text. <br> - CSP and sandboxed iframe compliance.                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Feature"> <strong>Shared Development Rules</strong> </td><td data-label="Tables Viewer v2.1"> - <strong>Coding Style</strong>: ES6+ for JavaScript modules; Python 3.11+ for compatibility layer; modular, functional design. <br> - <strong>Naming Conventions</strong>: camelCase for JS variables/functions; snake_case for Python; UpperCamelCase for class definitions. <br> - <strong>Versioning</strong>: Semantic versioning (major.minor.patch); each release documented with changelog. <br> - <strong>Documentation</strong>: Inline JSDoc for functions; Markdown-based project docs; diagrams for module relationships. <br> - <strong>Testing</strong>: Unit tests for all parsers, renderers, and data transformers; manual UI regression checklist. <br> - <strong>Extensibility</strong>: Each module exposes a minimal API; shared event bus for cross-module communication; interoperable via <code>core_compat.py</code>. </td><td data-label="PasteToTable"> - Same as Tables Viewer v2.1.                                                                                                                                                                                                                                                                                                                                                                                                                                                       </td></tr><tr><td data-label="Feature"> <strong>Goal Alignment</strong>           </td><td data-label="Tables Viewer v2.1"> Focuses on presentation and interaction.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td><td data-label="PasteToTable"> Focuses on data ingestion and transformation. <br> Both converge toward a unified ecosystem for browser-based table management.                                                                                                                                                                                                                                                                                                                                                     </td></tr></tbody></table></div><div class="row-count">Rows: 7</div></div><div class="table-caption" id="Table2" data-table="Book_8010_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Tables Viewer v2.1**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Tables Viewer v2.1</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **PasteToTable**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>PasteToTable</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Tables Viewer v2.1"> <strong>render/core_assets.py</strong> – Handles discovery, validation, and copying of static assets (CSS, JS, worker scripts) into the output directory. Provides atomic operations to avoid partial writes. </td><td data-label="PasteToTable"> <strong>render/assets.py</strong> – Centralizes asset path resolution and caching. Manages static assets with minimal coupling to rendering logic. Serves as lightweight replacement for <code>core_assets.py</code> with streamlined API.                                     </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>render/core_fragments.py</strong> – Renders discrete HTML fragments for tables, rows, and cells. Provides templated partials that <code>core_renderer.py</code> assembles.                                       </td><td data-label="PasteToTable"> <strong>convert.py</strong> – Parsing and table-building logic incorporates fragment rendering implicitly. Fragments are constructed dynamically via Python objects rather than separate HTML templates.                                                            </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>render/core_io.py</strong> – Manages atomic writes, temporary directories, and ensures filesystem safety. Supports cross-platform paths and error recovery.                                           </td><td data-label="PasteToTable"> <strong>io_utils.py</strong> – Reads/writes input and output files with helper functions. Handles temp storage and atomic writes in a simpler, functional style. Replaces <code>core_io.py</code> while maintaining platform safety.                                           </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>render/core_renderer.py</strong> – Orchestrates full HTML rendering pipeline. Calls fragments, assembles page, copies assets, and writes final HTML.                                                  </td><td data-label="PasteToTable"> <strong>core.py</strong> – Full pipeline orchestrator for conversion: reads input, sanitizes, builds tables, and outputs HTML or JSON. Combines rendering, IO, and conversion responsibilities under one module.                                                    </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>render/core_table.py</strong> – Provides <code>render_table()</code> wrapper to render a single table into HTML. Abstracts repetitive fragment calls.                                                            </td><td data-label="PasteToTable"> Integrated into <code>convert.py</code> – Table rendering is embedded in table-building functions. Replaces dedicated wrapper with typed table object handling and flexible output formats.                                                                       </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>render/core_utils.py</strong> – Miscellaneous helpers for streaming output, formatting, and minor logic shared across renderer modules.                                                               </td><td data-label="PasteToTable"> <strong>utils.py</strong> – Reimplemented as environment and directory helpers, plus utility functions for path normalization, JSON handling, and logging.                                                                                                          </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>render/core_compat.py</strong> – Re-exports main rendering functions for external API. Allows scripts to call <code>render_html()</code> and <code>render_table()</code> without knowing internal module structure.         </td><td data-label="PasteToTable"> <strong>core_compat.py</strong> – Compatibility shims for backwards compatibility. Exposes simplified API to higher-level modules while isolating legacy calls.                                                                                                     </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>convert.py</strong> – Not present in this context; conversion logic embedded in fragments and renderer orchestration.                                                                                 </td><td data-label="PasteToTable"> <strong>convert.py</strong> – Central table parsing and builder. Takes input data (CSV, JSON, markdown), sanitizes, builds internal table objects, and prepares them for rendering.                                                                                 </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>markdown.py</strong> – Converts table fragments into Markdown representations. Supports partial exports for documentation or previews.                                                                </td><td data-label="PasteToTable"> <strong>markdown.py</strong> – Markdown export helpers for table objects. Similar purpose but tied to typed <code>Table</code> models rather than ad-hoc HTML fragments.                                                                                                       </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>io_utils.py</strong> – Handles reading/writing of files, streams, and temporary storage. Ensures atomic operations to prevent incomplete outputs.                                                     </td><td data-label="PasteToTable"> See above: <code>io_utils.py</code> functional replacement. Supports reading/writing tables and JSON/CSV inputs safely.                                                                                                                                           </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>sanitize.py</strong> – Cleans table content, escapes HTML, and removes unsafe elements.                                                                                                               </td><td data-label="PasteToTable"> <strong>sanitize.py</strong> – Input sanitization pipeline. Ensures table content is safe for rendering in HTML/Markdown. Streamlined to integrate with typed table models.                                                                                         </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>types.py</strong> – Minimal typing. Mostly runtime validation and simple container classes.                                                                                                           </td><td data-label="PasteToTable"> <strong>types.py</strong> – Strong typed models for tables, rows, and cells. Facilitates static checks and predictable object structures.                                                                                                                           </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>assets.py</strong> – Part of core_assets workflow; manages file copying.                                                                                                                              </td><td data-label="PasteToTable"> See above: <code>assets.py</code> – lightweight path/caching helper.                                                                                                                                                                                              </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>cli.py</strong> – Single CLI entrypoint to render tables from command line. Limited subcommands.                                                                                                      </td><td data-label="PasteToTable"> <strong>cli.py</strong> – Multi-subcommand CLI for conversion, export, and server launch. Modular argument parsing.                                                                                                                                                 </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>**init</strong>.py** – Re-exports main rendering functions for API consumers.                                                                                                                         </td><td data-label="PasteToTable"> <strong>**init</strong>.py** – Minimal, establishes package API boundaries.                                                                                                                                                                                         </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>assets/style.css</strong> – Stylesheet for rendered tables.                                                                                                                                           </td><td data-label="PasteToTable"> <strong>assets/style.css</strong> – Maintains CSS styles, adapted for PasteToTable templates.                                                                                                                                                                       </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>assets/script.js</strong> – Client-side JS for interactivity. Used in rendered tables (sorting, filtering, pagination).                                                                               </td><td data-label="PasteToTable"> <strong>assets/script.js</strong> – Similar functionality, adapted to new table object model and template usage.                                                                                                                                                    </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>assets/worker.js</strong> – Worker thread for heavy client-side processing.                                                                                                                           </td><td data-label="PasteToTable"> <strong>assets/worker.js</strong> – Preserved minimal interactivity support.                                                                                                                                                                                        </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>output_combined/</strong> – Central output directory. Contains compiled HTML, assets, and embedded SheetJS library for XLSX export.                                                                   </td><td data-label="PasteToTable"> <strong>templates/</strong> – Stores <code>index.html</code> template. Output written to <code>saved_tables/</code> instead of combined assets. XLSX export handled differently (likely server-side or via SheetJS separately).                                                           </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>html_renderer.py</strong> – Handles orchestration of rendering, likely via function calls.                                                                                                            </td><td data-label="PasteToTable"> <strong>html_renderer.py</strong> – Flask app factory for web-based rendering of tables. Converts pipeline into a server-accessible interface.                                                                                                                      </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>utils.py</strong> – Helper functions for environment and path management.                                                                                                                             </td><td data-label="PasteToTable"> <strong>utils.py</strong> – Same purpose.                                                                                                                                                                                                                           </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>helpers.py</strong> – Miscellaneous helpers for internal logic.                                                                                                                                       </td><td data-label="PasteToTable"> <strong>server.py</strong> – Optional API server functions.                                                                                                                                                                                                         </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>main.py</strong> – Entry point script to run render pipeline.                                                                                                                                         </td><td data-label="PasteToTable"> <strong>main.py</strong> – CLI and/or server entry point.                                                                                                                                                                                                           </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>output_combined/assets/xlsx.full.min.js</strong> – 930 KB SheetJS library included for client-side XLSX export.                                                                                       </td><td data-label="PasteToTable"> Not included; XLSX export may be handled differently, potentially server-side or dynamically loaded.                                                                                                                                                   </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>Structural notes</strong> – Modular renderer separates assets, fragments, tables, and IO for clear layering. Heavy reliance on procedural orchestration with minimal type enforcement.                </td><td data-label="PasteToTable"> <strong>Structural notes</strong> – More unified, typed, and modern architecture. Combines parsing, sanitization, and rendering with strong type guarantees. Uses Flask for interactive rendering. CLI and server modes more explicit. Asset management simplified. </td></tr><tr><td data-label="Tables Viewer v2.1"> <strong>Design philosophy</strong> – Focused on batch HTML table rendering with client-side interactivity. Emphasizes atomic writes, safe file operations, and modular HTML fragment assembly.                </td><td data-label="PasteToTable"> <strong>Design philosophy</strong> – Focused on reusable pipeline for parsing, building, sanitizing, and rendering tables. Supports web server deployment, typed table models, and flexible output formats.                                                         </td></tr></tbody></table></div><div class="row-count">Rows: 26</div></div><div class="table-caption" id="Table3" data-table="Book_8010_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Aspect**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Aspect</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Insight / Comparison**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Insight / Comparison</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> <strong>Pipeline evolution</strong>    </td><td data-label="Insight / Comparison"> Tables Viewer v2.1 separates renderer responsibilities across <code>core_fragments</code>, <code>core_renderer</code>, <code>core_table</code>, <code>core_utils</code>. PasteToTable consolidates orchestration into <code>core.py</code> and <code>convert.py</code> and uses typed objects instead of loose fragments. </td></tr><tr><td data-label="Aspect"> <strong>Typing & safety</strong>       </td><td data-label="Insight / Comparison"> PasteToTable enforces structured <code>types.py</code> models, reducing runtime errors relative to Tables Viewer v2.1's looser fragment-based approach.                                                                                                            </td></tr><tr><td data-label="Aspect"> <strong>Assets & client logic</strong> </td><td data-label="Insight / Comparison"> Both keep <code>style.css</code> and <code>script.js</code>. Tables Viewer v2.1 ships heavier XLSX client-side logic. PasteToTable favors server- or template-driven exports.                                                                                                 </td></tr><tr><td data-label="Aspect"> <strong>Execution environment</strong> </td><td data-label="Insight / Comparison"> Tables Viewer v2.1 is file-driven CLI. PasteToTable adds a Flask web server for dynamic rendering and API endpoints.                                                                                                                                    </td></tr><tr><td data-label="Aspect"> <strong>CLI & automation</strong>      </td><td data-label="Insight / Comparison"> PasteToTable offers multiple CLI subcommands for automation and server control. Tables Viewer v2.1 provides a simpler batch HTML generator CLI.                                                                                                         </td></tr><tr><td data-label="Aspect"> <strong>Maintainability</strong>       </td><td data-label="Insight / Comparison"> PasteToTable’s consolidation, typing, and templates ease feature expansion and deployment. Tables Viewer’s modular fragments give granular control but increase orchestration complexity.                                                               </td></tr></tbody></table></div><div class="row-count">Rows: 6</div></div><div class="table-caption" id="Table4" data-table="Book_8010_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Aspect"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Aspect</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Tables Viewer v2.1"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Tables Viewer v2.1</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by PasteToTable"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">PasteToTable</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> Core orchestration  </td><td data-label="Tables Viewer v2.1"> <code>core_renderer.py</code> drives HTML rendering    </td><td data-label="PasteToTable"> <code>core.py</code> orchestrates full conversion pipeline </td></tr><tr><td data-label="Aspect"> Compatibility layer </td><td data-label="Tables Viewer v2.1"> <code>core_compat.py</code> re-exports rendering funcs </td><td data-label="PasteToTable"> <code>core_compat.py</code> provides backward shims        </td></tr><tr><td data-label="Aspect"> Fragment management </td><td data-label="Tables Viewer v2.1"> <code>core_fragments.py</code> handles HTML segments   </td><td data-label="PasteToTable"> Integrated into <code>convert.py</code> and templates      </td></tr><tr><td data-label="Aspect"> Output handling     </td><td data-label="Tables Viewer v2.1"> Writes to <code>/output_combined/</code>               </td><td data-label="PasteToTable"> Writes to <code>/saved_tables/</code>, uses templates      </td></tr><tr><td data-label="Aspect"> CLI entry           </td><td data-label="Tables Viewer v2.1"> <code>cli.py</code> single use                         </td><td data-label="PasteToTable"> <code>cli.py</code> exposes multiple subcommands           </td></tr><tr><td data-label="Aspect"> Assets              </td><td data-label="Tables Viewer v2.1"> includes <code>worker.js</code> and <code>xlsx.full.min.js</code> </td><td data-label="PasteToTable"> minimal client assets, same CSS/JS naming       </td></tr><tr><td data-label="Aspect"> HTML rendering      </td><td data-label="Tables Viewer v2.1"> Python-driven via <code>render_html</code>             </td><td data-label="PasteToTable"> Flask app factory (<code>html_renderer.py</code>)          </td></tr><tr><td data-label="Aspect"> Static typing       </td><td data-label="Tables Viewer v2.1"> minimal                                     </td><td data-label="PasteToTable"> strong use of <code>types.py</code> models                 </td></tr><tr><td data-label="Aspect"> Goal                </td><td data-label="Tables Viewer v2.1"> batch HTML viewer for tables                </td><td data-label="PasteToTable"> web-enabled table converter and viewer          </td></tr></tbody></table></div><div class="row-count">Rows: 9</div></div><div class="table-caption" id="Table5" data-table="Book_8010_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Feature / Need"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Feature / Need</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Prompt_05 Module"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Prompt_05 Module</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Integration Type"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Integration Type</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Notes / Safety"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Notes / Safety</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Feature / Need"> Table rendering & virtual scrolling </td><td data-label="Prompt_05 Module"> <code>render/core.py</code>, <code>render/core_compat.py</code>    </td><td data-label="Integration Type"> Backend / preprocessing                  </td><td data-label="Notes / Safety"> Generates table skeletons, ensures <code>table.data-table</code> classes; frontend script.js interacts as-is. </td></tr><tr><td data-label="Feature / Need"> Paste processing                    </td><td data-label="Prompt_05 Module"> <code>render/convert.py</code>, <code>render/core_compat.py</code> </td><td data-label="Integration Type"> Server-side / form POST <code>/api/render</code>    </td><td data-label="Notes / Safety"> <code>render-form</code> posts directly to <code>/api/render</code>; textarea ID <code>paste</code> preserved.                      </td></tr><tr><td data-label="Feature / Need"> Markdown export                     </td><td data-label="Prompt_05 Module"> <code>render/markdown.py</code>                         </td><td data-label="Integration Type"> Optional / server-side                   </td><td data-label="Notes / Safety"> Frontend can request export via buttons; no code changes needed.                                   </td></tr><tr><td data-label="Feature / Need"> Asset embedding & fingerprinting    </td><td data-label="Prompt_05 Module"> <code>render/assets.py</code>                           </td><td data-label="Integration Type"> Build-time dynamic <code>&lt;link&gt;</code> / <code>&lt;script&gt;</code> </td><td data-label="Notes / Safety"> Version placeholders <code>?v=%%ASSET_HASH%%</code> match your build pipeline.                                </td></tr><tr><td data-label="Feature / Need"> CLI pre-rendering                   </td><td data-label="Prompt_05 Module"> <code>render/cli.py</code>                              </td><td data-label="Integration Type"> Optional                                 </td><td data-label="Notes / Safety"> Generates fully rendered HTML in <code>output_combined/</code>; index.html structure fully compatible.        </td></tr><tr><td data-label="Feature / Need"> JS logic & interactivity            </td><td data-label="Prompt_05 Module"> <code>assets/script.js</code>                           </td><td data-label="Integration Type"> Frontend                                 </td><td data-label="Notes / Safety"> All existing functionality preserved; enhanced with optional sorting and normalization only.       </td></tr><tr><td data-label="Feature / Need"> CSS styling                         </td><td data-label="Prompt_05 Module"> <code>assets/style.css</code>, <code>assets/overrides.css</code>   </td><td data-label="Integration Type"> Frontend                                 </td><td data-label="Notes / Safety"> Baseline style preserved; overrides allow future enhancement without breaking layout.              </td></tr></tbody></table></div><div class="row-count">Rows: 7</div></div><div class="table-caption" id="Table6" data-table="Book_8010_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Aspect"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Aspect</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by PasteToTable (Current)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">PasteToTable (Current)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Tables Viewer v2.1 (Sample)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Tables Viewer v2.1 (Sample)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Observations / Key Differences"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Observations / Key Differences</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> <strong>Purpose / Goal</strong>               </td><td data-label="PasteToTable (Current)"> Converts pasted markdown or CSV/TSV clipboard data into clean, interactive HTML tables for export.                                                   </td><td data-label="Tables Viewer v2.1 (Sample)"> Browser-based interface for viewing, filtering, and manipulating large tabular datasets with virtual scrolling.                                       </td><td data-label="Observations / Key Differences"> PasteToTable focuses on raw text ingestion + table generation; Tables Viewer focuses on large dataset display and interactivity. </td></tr><tr><td data-label="Aspect"> <strong>Header / Sticky Bar</strong>          </td><td data-label="PasteToTable (Current)"> <code>&lt;div id=&quot;stickyMainHeader&quot;&gt;</code> contains title, buttons, search, and paste toggle. Fully accessible, preserves your current layout.                    </td><td data-label="Tables Viewer v2.1 (Sample)"> <code>&lt;div id=&quot;stickyMainHeader&quot;&gt;&lt;div id=&quot;tv-header&quot;&gt;…&lt;/div&gt;&lt;/div&gt;</code> contains search, theme toggle, and table action buttons; less complex UI, minimal DOM. </td><td data-label="Observations / Key Differences"> Both use sticky headers; your PasteToTable header is more complex and already approved. No change should be made here.           </td></tr><tr><td data-label="Aspect"> <strong>Search</strong>                       </td><td data-label="PasteToTable (Current)"> <code>&lt;input id=&quot;search&quot;&gt;</code> within header row, integrated with script.js.                                                                                  </td><td data-label="Tables Viewer v2.1 (Sample)"> <code>&lt;input id=&quot;searchBox&quot; class=&quot;tv-search&quot;&gt;</code> in header.                                                                                                 </td><td data-label="Observations / Key Differences"> Functionally similar; your current input supports PasteToTable workflow.                                                         </td></tr><tr><td data-label="Aspect"> <strong>Buttons / Controls</strong>           </td><td data-label="PasteToTable (Current)"> Export, Clear, Toggle Paste, Convert, Render, Save HTML — linked to <code>script.js</code>.                                                                     </td><td data-label="Tables Viewer v2.1 (Sample)"> Copy, Export CSV/JSON/XLSX/PDF/Markdown, Collapse, Theme Toggle — inline JS.                                                                          </td><td data-label="Observations / Key Differences"> Your setup uses script.js for all actions; Tables Viewer has inline per-table buttons. Delegation handled differently.           </td></tr><tr><td data-label="Aspect"> <strong>Paste Panel</strong>                  </td><td data-label="PasteToTable (Current)"> <code>&lt;div id=&quot;paste-panel&quot;&gt;</code> with form and <code>&lt;textarea&gt;</code> for input; toggleable visibility.                                                                </td><td data-label="Tables Viewer v2.1 (Sample)"> Not present (Tables Viewer expects data already loaded).                                                                                              </td><td data-label="Observations / Key Differences"> Your page supports progressive enhancement and non-JS fallback; TV v2.1 is JS-only.                                              </td></tr><tr><td data-label="Aspect"> <strong>Tables / Rendering</strong>           </td><td data-label="PasteToTable (Current)"> <code>&lt;section id=&quot;tables&quot; class=&quot;table-container&quot;&gt;</code> dynamically populated; normalizes tables, adds <code>two-col</code> where needed.                               </td><td data-label="Tables Viewer v2.1 (Sample)"> <code>&lt;div class=&quot;table-wrapper&quot;&gt;</code> for each table with <code>.table-header-wrapper</code> + copy/export buttons; includes table sorting <code>&lt;button class=&quot;sort-btn&quot;&gt;</code>.  </td><td data-label="Observations / Key Differences"> PasteToTable currently does not implement per-column sorting in HTML; TV v2.1 has explicit sortable headers with icons.          </td></tr><tr><td data-label="Aspect"> <strong>Scripts</strong>                      </td><td data-label="PasteToTable (Current)"> script.js deferred; optional paste_handler.js/table_manager.js; mutation observers for toggles; table normalization helper; service worker optional. </td><td data-label="Tables Viewer v2.1 (Sample)"> Inline scripts for event delegation; opacity fade-in; DOMContentLoaded for delegation; all tables immediately rendered.                               </td><td data-label="Observations / Key Differences"> TV v2.1 has more granular per-table buttons and sorting; your script.js handles global table actions.                            </td></tr><tr><td data-label="Aspect"> <strong>Virtualization / Performance</strong> </td><td data-label="PasteToTable (Current)"> Targets up to 10k pasted rows; normalizes DOM; avoids reflows outside viewport.                                                                      </td><td data-label="Tables Viewer v2.1 (Sample)"> Targets 100k rows; uses opacity transitions + lazy render; per-table DOM virtualization.                                                              </td><td data-label="Observations / Key Differences"> TV v2.1 optimized for large datasets; PasteToTable optimized for moderate clipboard inputs.                                      </td></tr><tr><td data-label="Aspect"> <strong>Accessibility / ARIA</strong>         </td><td data-label="PasteToTable (Current)"> Roles defined: banner, toolbar, main, contentinfo, aria-live, aria-controls.                                                                         </td><td data-label="Tables Viewer v2.1 (Sample)"> Minimal ARIA; uses role="region" for tables viewer, label for TOC.                                                                                    </td><td data-label="Observations / Key Differences"> Your page is stronger on accessibility; TV v2.1 is functional but minimal.                                                       </td></tr><tr><td data-label="Aspect"> <strong>Export / Clipboard</strong>           </td><td data-label="PasteToTable (Current)"> Global Export All; Save HTML; clipboard integration via script.js.                                                                                   </td><td data-label="Tables Viewer v2.1 (Sample)"> Per-table copy/export buttons; delegation logic for hidden buttons.                                                                                   </td><td data-label="Observations / Key Differences"> TV v2.1 handles multiple export formats per table; PasteToTable has simpler global approach.                                     </td></tr><tr><td data-label="Aspect"> <strong>TOC</strong>                          </td><td data-label="PasteToTable (Current)"> <code>&lt;nav id=&quot;toc&quot;&gt;&lt;ul id=&quot;tocList&quot;&gt;…&lt;/ul&gt;&lt;/nav&gt;</code>                                                                                                        </td><td data-label="Tables Viewer v2.1 (Sample)"> <code>&lt;div id=&quot;tocBar&quot;&gt;&lt;ul&gt;…&lt;/ul&gt;&lt;/div&gt;</code>                                                                                                                   </td><td data-label="Observations / Key Differences"> Functionally equivalent; slightly different naming.                                                                              </td></tr><tr><td data-label="Aspect"> <strong>Service Worker</strong>               </td><td data-label="PasteToTable (Current)"> Optional registration included, deferred, robust.                                                                                                    </td><td data-label="Tables Viewer v2.1 (Sample)"> None.                                                                                                                                                 </td><td data-label="Observations / Key Differences"> Advantage for offline support.                                                                                                   </td></tr></tbody></table></div><div class="row-count">Rows: 12</div></div><div class="table-caption" id="Table7" data-table="Book_8010_07" style="margin-top:2mm;margin-left:3mm;"><strong>Table 7</strong></div>
<div class="table-wrapper" data-table-id="table-7"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Legacy File/Folder"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Legacy File/Folder</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by New Equivalent"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">New Equivalent</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Function"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Function</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Legacy File/Folder"> <code>main.py</code>               </td><td data-label="New Equivalent"> <code>main.py</code>                  </td><td data-label="Function"> Entry point, same name and likely similar logic.              </td></tr><tr><td data-label="Legacy File/Folder"> <code>server.py</code>             </td><td data-label="New Equivalent"> <code>helpers.py</code>               </td><td data-label="Function"> Backend helpers now extracted from server logic.              </td></tr><tr><td data-label="Legacy File/Folder"> <code>html_renderer.py</code>      </td><td data-label="New Equivalent"> <code>html_renderer.py</code>         </td><td data-label="Function"> Unchanged; likely refactored internally.                      </td></tr><tr><td data-label="Legacy File/Folder"> <code>utils.py</code>              </td><td data-label="New Equivalent"> <code>utils.py</code>                 </td><td data-label="Function"> Unchanged core utilities.                                     </td></tr><tr><td data-label="Legacy File/Folder"> <code>render/</code>               </td><td data-label="New Equivalent"> <code>render/</code>                  </td><td data-label="Function"> Core rendering engine.                                        </td></tr><tr><td data-label="Legacy File/Folder"> <code>render/core.py</code>        </td><td data-label="New Equivalent"> <code>render/core_assets.py</code>    </td><td data-label="Function"> Handles static asset discovery and embedding.                 </td></tr><tr><td data-label="Legacy File/Folder"> <code>render/core_compat.py</code> </td><td data-label="New Equivalent"> <code>render/core_fragments.py</code> </td><td data-label="Function"> Manages fragment rendering and async handling.                </td></tr><tr><td data-label="Legacy File/Folder"> <code>render/convert.py</code>     </td><td data-label="New Equivalent"> <code>render/core_io.py</code>        </td><td data-label="Function"> Centralized I/O and safe file writes.                         </td></tr><tr><td data-label="Legacy File/Folder"> <code>render/markdown.py</code>    </td><td data-label="New Equivalent"> <code>render/core_renderer.py</code>  </td><td data-label="Function"> HTML/Markdown rendering orchestrator.                         </td></tr><tr><td data-label="Legacy File/Folder"> <code>render/sanitize.py</code>    </td><td data-label="New Equivalent"> <code>render/core_table.py</code>     </td><td data-label="Function"> Handles sanitization and table rendering logic.               </td></tr><tr><td data-label="Legacy File/Folder"> <code>render/io_utils.py</code>    </td><td data-label="New Equivalent"> <code>render/core_utils.py</code>     </td><td data-label="Function"> Low-level streaming and sanitization utilities.               </td></tr><tr><td data-label="Legacy File/Folder"> <code>render/assets.py</code>      </td><td data-label="New Equivalent"> <code>render/core_compat.py</code>    </td><td data-label="Function"> Re-exports main render entrypoints for compatibility.         </td></tr><tr><td data-label="Legacy File/Folder"> <code>render/cli.py</code>         </td><td data-label="New Equivalent"> <code>render/convert.py</code>        </td><td data-label="Function"> CLI functions refactored into I/O conversion logic.           </td></tr><tr><td data-label="Legacy File/Folder"> <code>render/types.py</code>       </td><td data-label="New Equivalent"> <code>render/markdown.py</code>       </td><td data-label="Function"> Type definitions likely moved to markdown handling.           </td></tr><tr><td data-label="Legacy File/Folder"> —                       </td><td data-label="New Equivalent"> <code>render/io_utils.py</code>       </td><td data-label="Function"> New file for modular utility extraction.                      </td></tr><tr><td data-label="Legacy File/Folder"> —                       </td><td data-label="New Equivalent"> <code>render/sanitize.py</code>       </td><td data-label="Function"> Added for finer control of content safety.                    </td></tr><tr><td data-label="Legacy File/Folder"> —                       </td><td data-label="New Equivalent"> <code>render/types.py</code>          </td><td data-label="Function"> Added back as dedicated type structure.                       </td></tr><tr><td data-label="Legacy File/Folder"> —                       </td><td data-label="New Equivalent"> <code>render/assets.py</code>         </td><td data-label="Function"> Asset pipeline consolidation.                                 </td></tr><tr><td data-label="Legacy File/Folder"> —                       </td><td data-label="New Equivalent"> <code>render/cli.py</code>            </td><td data-label="Function"> Command-line entry restoration.                               </td></tr><tr><td data-label="Legacy File/Folder"> <code>assets/</code>               </td><td data-label="New Equivalent"> <code>assets/</code>                  </td><td data-label="Function"> Static frontend assets; same location.                        </td></tr><tr><td data-label="Legacy File/Folder"> <code>templates/</code>            </td><td data-label="New Equivalent"> <code>output_combined/</code>         </td><td data-label="Function"> Output folder for compiled HTML and assets.                   </td></tr><tr><td data-label="Legacy File/Folder"> —                       </td><td data-label="New Equivalent"> <code>output_combined/assets/</code>  </td><td data-label="Function"> Includes style/script bundles and extra libraries.            </td></tr><tr><td data-label="Legacy File/Folder"> <code>saved_tables/</code>         </td><td data-label="New Equivalent"> —                          </td><td data-label="Function"> Possibly deprecated or moved inside project output directory. </td></tr></tbody></table></div><div class="row-count">Rows: 23</div></div><div class="table-caption" id="Table8" data-table="Book_8010_08" style="margin-top:2mm;margin-left:3mm;"><strong>Table 8</strong></div>
<div class="table-wrapper" data-table-id="table-8"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Area"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Area</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Current Behavior"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Current Behavior</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Issue / Limitation"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Issue / Limitation</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Area"> HTML structure                     </td><td data-label="Current Behavior"> Strictly minimal single-page app with inline CSS </td><td data-label="Issue / Limitation"> Not modular; hard to update and re-theme                     </td></tr><tr><td data-label="Area"> CSS                                </td><td data-label="Current Behavior"> Inline and external (<code>assets/style.css</code>)         </td><td data-label="Issue / Limitation"> Inline styles duplicate core CSS; poor maintainability       </td></tr><tr><td data-label="Area"> Accessibility                      </td><td data-label="Current Behavior"> ARIA attributes and labels mostly correct        </td><td data-label="Issue / Limitation"> Missing skip link, no focus restoration after toggle         </td></tr><tr><td data-label="Area"> Paste + render                     </td><td data-label="Current Behavior"> Controlled by <code>script.js</code> and <code>/api/render</code>      </td><td data-label="Issue / Limitation"> No fallback offline renderer                                 </td></tr><tr><td data-label="Area"> Toolbar                            </td><td data-label="Current Behavior"> Manually injected by JS                          </td><td data-label="Issue / Limitation"> Lacks per-table state persistence                            </td></tr><tr><td data-label="Area"> Table sorting                      </td><td data-label="Current Behavior"> Works in-memory only                             </td><td data-label="Issue / Limitation"> No stable index, no numeric locale compare                   </td></tr><tr><td data-label="Area"> Service Worker                     </td><td data-label="Current Behavior"> Hardcoded <code>/assets/worker.js</code>                    </td><td data-label="Issue / Limitation"> Wrong scope in offline copies (should use relative path)     </td></tr><tr><td data-label="Area"> Asset hash placeholder             </td><td data-label="Current Behavior"> <code>%%ASSET_HASH%%</code>                                 </td><td data-label="Issue / Limitation"> Requires build pipeline to replace; static preview will fail </td></tr><tr><td data-label="Area"> Responsiveness                     </td><td data-label="Current Behavior"> Works at ≤720px                                  </td><td data-label="Issue / Limitation"> Missing meta-scale for large data tables                     </td></tr><tr><td data-label="Area"> SEO / discoverability              </td><td data-label="Current Behavior"> Description minimal                              </td><td data-label="Issue / Limitation"> Should include OpenGraph and canonical metadata              </td></tr><tr><td data-label="Area"> Integration with Tables Viewer 2.1 </td><td data-label="Current Behavior"> None                                             </td><td data-label="Issue / Limitation"> No dynamic content loader or combined viewer section         </td></tr><tr><td data-label="Area"> Progressive enhancement            </td><td data-label="Current Behavior"> JS-only                                          </td><td data-label="Issue / Limitation"> Should gracefully degrade to server-rendered output          </td></tr></tbody></table></div><div class="row-count">Rows: 12</div></div><div class="table-caption" id="Table9" data-table="Book_8010_09" style="margin-top:2mm;margin-left:3mm;"><strong>Table 9</strong></div>
<div class="table-wrapper" data-table-id="table-9"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Category"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Category</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Action"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Action</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Category"> <strong>Modular architecture</strong>      </td><td data-label="Action"> Move all inline CSS and JS into <code>assets/style.css</code> and <code>assets/extra.js</code>. Keep <code>index.html</code> purely declarative.                     </td></tr><tr><td data-label="Category"> <strong>Service worker</strong>            </td><td data-label="Action"> Register using relative path (<code>./assets/worker.js</code>) and add manifest shortcuts.                                                     </td></tr><tr><td data-label="Category"> <strong>Unified viewer</strong>            </td><td data-label="Action"> Add <code>div id=&quot;viewer-root&quot;</code> placeholder for cross-project embed (for Tables Viewer 2.1 compatibility).                               </td></tr><tr><td data-label="Category"> <strong>Offline cache</strong>             </td><td data-label="Action"> Include pre-cache list for <code>/assets/style.css</code>, <code>/assets/script.js</code>, and <code>/assets/xlsx.full.min.js</code>.                                </td></tr><tr><td data-label="Category"> <strong>Search + TOC</strong>              </td><td data-label="Action"> Use persistent JSON index built in <code>/output_combined/</code>. Include <code>&lt;link rel=&quot;search&quot; type=&quot;application/opensearchdescription+xml&quot;&gt;</code>. </td></tr><tr><td data-label="Category"> <strong>Enhanced export</strong>           </td><td data-label="Action"> Merge export buttons with Tables Viewer 2.1’s <code>core_assets.py</code> logic (detect asset embedding).                                      </td></tr><tr><td data-label="Category"> <strong>Accessibility + usability</strong> </td><td data-label="Action"> Add skip-link, consistent ARIA <code>aria-current</code>, keyboard toggling, and focus restoration after converting tables.                    </td></tr><tr><td data-label="Category"> <strong>Analytics (optional)</strong>      </td><td data-label="Action"> Lightweight, privacy-safe event logger (localStorage, no remote).                                                                   </td></tr><tr><td data-label="Category"> <strong>Theme switching</strong>           </td><td data-label="Action"> Add dark mode via <code>data-theme</code> and CSS media query, with persistent preference.                                                     </td></tr><tr><td data-label="Category"> <strong>HTML metadata</strong>             </td><td data-label="Action"> Add <code>og:title</code>, <code>og:description</code>, <code>og:url</code>, and canonical tag.                                                                      </td></tr><tr><td data-label="Category"> <strong>Security</strong>                  </td><td data-label="Action"> Sanitize inline event handlers, disable <code>javascript:</code> URLs, and ensure CSP in meta headers.                                         </td></tr></tbody></table></div><div class="row-count">Rows: 11</div></div><div class="table-caption" id="Table10" data-table="Book_8010_10" style="margin-top:2mm;margin-left:3mm;"><strong>Table 10</strong></div>
<div class="table-wrapper" data-table-id="table-10"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by File"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">File</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Function"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Function</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="File"> <code>assets/style.css</code>     </td><td data-label="Function"> Move all <code>&lt;style&gt;</code> rules there. Add variables for light/dark themes.                                    </td></tr><tr><td data-label="File"> <code>assets/extra.js</code>      </td><td data-label="Function"> Contain normalization, toolbar, and sorting code. Should expose single global <code>ptt.enhance()</code>.          </td></tr><tr><td data-label="File"> <code>assets/script.js</code>     </td><td data-label="Function"> Core logic (convert, render, save). Minimal overlap.                                                    </td></tr><tr><td data-label="File"> <code>assets/worker.js</code>     </td><td data-label="Function"> Updated scope-aware SW, supports caching dynamic <code>/api/render</code> results for offline replay.              </td></tr><tr><td data-label="File"> <code>render/core.py</code>       </td><td data-label="Function"> Add HTML assembly for both PasteToTable and Tables Viewer 2.1 pages.                                    </td></tr><tr><td data-label="File"> <code>templates/index.html</code> </td><td data-label="Function"> Clean Jinja template version (no inline code). The <code>index.html</code> you pasted becomes its rendered output. </td></tr></tbody></table></div><div class="row-count">Rows: 6</div></div><div class="table-caption" id="Table11" data-table="Book_8010_11" style="margin-top:2mm;margin-left:3mm;"><strong>Table 11</strong></div>
<div class="table-wrapper" data-table-id="table-11"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Issue"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Issue</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Risk / Problem"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Risk / Problem</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Suggested Fix"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Suggested Fix</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Issue"> <strong>Control duplication</strong>              </td><td data-label="Risk / Problem"> Global header and per-table controls may confuse or conflict                  </td><td data-label="Suggested Fix"> Unify common functionality; disable global copy when no tables            </td></tr><tr><td data-label="Issue"> <strong>JS fallback / latency</strong>            </td><td data-label="Risk / Problem"> On slow JS load, table controls may flicker or be missing                     </td><td data-label="Suggested Fix"> Use class hooks or skeleton UI until script hydrates                      </td></tr><tr><td data-label="Issue"> <strong>TOC usability</strong>                    </td><td data-label="Risk / Problem"> TOC shows only “Table 1” etc. No descriptive labels                           </td><td data-label="Suggested Fix"> Use table captions or headers for TOC text rather than indices            </td></tr><tr><td data-label="Issue"> <strong>Accessibility gaps</strong>               </td><td data-label="Risk / Problem"> Controls may lack ARIA roles, keyboard focus order                            </td><td data-label="Suggested Fix"> Add <code>aria-label</code>, <code>role=&quot;button&quot;</code>, <code>tabindex</code>, and visible focus styles   </td></tr><tr><td data-label="Issue"> <strong>Theming</strong>                          </td><td data-label="Risk / Problem"> Only a “Theme” control but unclear whether dark mode fully supported          </td><td data-label="Suggested Fix"> Ensure CSS supports <code>data-theme=&quot;dark&quot;</code> and persist in <code>localStorage</code>     </td></tr><tr><td data-label="Issue"> <strong>Clipboard operations</strong>             </td><td data-label="Risk / Problem"> Copy may fail in older browsers or when permissions blocked                   </td><td data-label="Suggested Fix"> Fallback to showing text to copy if <code>navigator.clipboard</code> fails           </td></tr><tr><td data-label="Issue"> <strong>Performance on very large tables</strong> </td><td data-label="Risk / Problem"> Virtualization only works if JS fully loaded                                  </td><td data-label="Suggested Fix"> Consider progressive rendering / paging for extremely large data sets     </td></tr><tr><td data-label="Issue"> <strong>State persistence</strong>                </td><td data-label="Risk / Problem"> Collapse state, theme state, scroll position not preserved across reload      </td><td data-label="Suggested Fix"> Store in URL hash or <code>sessionStorage</code> / <code>localStorage</code>                    </td></tr><tr><td data-label="Issue"> <strong>Inline script coupling</strong>           </td><td data-label="Risk / Problem"> HTML and scripts tightly coupled; changes in DOM structure break script logic </td><td data-label="Suggested Fix"> Use clear data-action attributes and avoid tightly brittle selectors      </td></tr><tr><td data-label="Issue"> <strong>CSS / style entanglement</strong>         </td><td data-label="Risk / Problem"> Some styles might not adapt well if theme or layout changes                   </td><td data-label="Suggested Fix"> Leverage CSS variables and modular stylesheet instead of many fixed rules </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table12" data-table="Book_8010_12" style="margin-top:2mm;margin-left:3mm;"><strong>Table 12</strong></div>
<div class="table-wrapper" data-table-id="table-12"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Area"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Area</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Change"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Change</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Purpose"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Purpose</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Area"> Footer        </td><td data-label="Change"> Added <code>&lt;span id=&quot;resultCount&quot;&gt;</code>                                       </td><td data-label="Purpose"> Enables <code>updateResultCount()</code> from <code>script.js</code> without touching header </td></tr><tr><td data-label="Area"> Inline JS     </td><td data-label="Change"> Added lightweight normalization (<code>normalizeTables</code>, <code>enhanceAllSafe</code>) </td><td data-label="Purpose"> Ensures consistent table wrapping, safe reinit after dynamic render    </td></tr><tr><td data-label="Area"> Inline JS     </td><td data-label="Change"> Added safe <code>updateResultCount</code> fallback                               </td><td data-label="Purpose"> Prevents JS errors when counting rows/matches                          </td></tr><tr><td data-label="Area"> Inline JS     </td><td data-label="Change"> Added service worker registration (<code>./assets/worker.js</code>)              </td><td data-label="Purpose"> Enables offline cache if asset present                                 </td></tr><tr><td data-label="Area"> <code>&lt;head&gt;</code>      </td><td data-label="Change"> Included favicon + manifest + versioned stylesheet                    </td><td data-label="Purpose"> Matches <code>assets/</code> structure and cache-safe hashing                     </td></tr><tr><td data-label="Area"> CSS           </td><td data-label="Change"> Added styles for <code>#resultCount</code>, table wrapping, toolbar              </td><td data-label="Purpose"> Visual polish without touching layout                                  </td></tr><tr><td data-label="Area"> Accessibility </td><td data-label="Change"> Ensured all header buttons have <code>aria-*</code> attributes                   </td><td data-label="Purpose"> Passes accessibility validation                                        </td></tr><tr><td data-label="Area"> Header        </td><td data-label="Change"> <strong>Unchanged</strong>                                                         </td><td data-label="Purpose"> Complied with your directive: “do not change anything at header area.” </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table13" data-table="Book_8010_13" style="margin-top:2mm;margin-left:3mm;"><strong>Table 13</strong></div>
<div class="table-wrapper" data-table-id="table-13"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Function / Section"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Function / Section</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Purpose"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Purpose</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Function / Section"> <strong>Boot sequence (<code>DOMContentLoaded</code>)</strong> </td><td data-label="Purpose"> Initializes global <code>PasteToTable</code> namespace, caches DOM refs, attaches event listeners.        </td><td data-label="Notes"> Loads once on DOM ready. Safe if loaded with <code>defer</code>.                           </td></tr><tr><td data-label="Function / Section"> <strong>Paste & Render pipeline</strong>            </td><td data-label="Purpose"> Reads <code>#paste</code> text → sends to <code>/api/render</code> → inserts HTML into <code>#tables</code>.                    </td><td data-label="Notes"> Core flow. Form submission, convert, and render buttons reuse same handler.     </td></tr><tr><td data-label="Function / Section"> <strong>Save / Export handlers</strong>             </td><td data-label="Purpose"> <code>#saveBtn</code> exports current output as <code>.html</code>; <code>#exportAllBtn</code> uses SheetJS to produce <code>.xlsx</code>. </td><td data-label="Notes"> Uses <code>FileSaver</code> and <code>xlsx.full.min.js</code> when available.                         </td></tr><tr><td data-label="Function / Section"> <strong>Toggle Paste Panel</strong>                 </td><td data-label="Purpose"> Toggles visibility of <code>#paste-panel</code> and updates button label (<code>Hide/Show Paste Box</code>).         </td><td data-label="Notes"> Controlled via <code>data-action=&quot;toggle-paste&quot;</code>. Works correctly with <code>index.html</code>. </td></tr><tr><td data-label="Function / Section"> <strong>Search filtering</strong>                   </td><td data-label="Purpose"> <code>#search</code> filters visible tables, updates <code>updateResultCount()</code>.                               </td><td data-label="Notes"> The added <code>#resultCount</code> element now allows count display.                      </td></tr><tr><td data-label="Function / Section"> <strong>TOC building</strong>                       </td><td data-label="Purpose"> Generates table of contents links inside <code>#tocList</code>.                                           </td><td data-label="Notes"> Matches current markup.                                                         </td></tr><tr><td data-label="Function / Section"> <strong>Error handling</strong>                     </td><td data-label="Purpose"> Catches render errors, injects <code>.render-error</code> in <code>#tables</code>.                                   </td><td data-label="Notes"> Graceful, no script halt.                                                       </td></tr><tr><td data-label="Function / Section"> <strong>State management</strong>                   </td><td data-label="Purpose"> Uses <code>localStorage</code> (<code>ptt.pasteHidden</code>, <code>ptt.lastText</code>).                                       </td><td data-label="Notes"> The small inline script clearing <code>ptt.pasteHidden</code> ensures clean startup.       </td></tr><tr><td data-label="Function / Section"> <strong>Copy functions (per-table)</strong>         </td><td data-label="Purpose"> Dynamic buttons created per rendered table.                                                    </td><td data-label="Notes"> Global header copy buttons were optional, so no missing IDs break logic.        </td></tr><tr><td data-label="Function / Section"> <strong>Theme / Mode management</strong>            </td><td data-label="Purpose"> Passive (disabled if <code>#modeBtn</code> not found).                                                    </td><td data-label="Notes"> Correctly dormant.                                                              </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table14" data-table="Book_8010_14" style="margin-top:2mm;margin-left:3mm;"><strong>Table 14</strong></div>
<div class="table-wrapper" data-table-id="table-14"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Category"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Category</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Status"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Status</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Comment"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Comment</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Category"> Element binding       </td><td data-label="Status"> ✅ all required selectors found </td><td data-label="Comment"> All critical IDs exist in <code>index.html</code>.                                         </td></tr><tr><td data-label="Category"> Fallbacks             </td><td data-label="Status"> ✅ functional                   </td><td data-label="Comment"> Missing optional elements handled gracefully.                                   </td></tr><tr><td data-label="Category"> External dependencies </td><td data-label="Status"> ⚠ optional                     </td><td data-label="Comment"> SheetJS (<code>xlsx.full.min.js</code>) must exist in <code>assets/</code>. Confirm at deploy.        </td></tr><tr><td data-label="Category"> Inline eval           </td><td data-label="Status"> none                           </td><td data-label="Comment"> Secure. No <code>eval</code> or unsafe <code>innerHTML</code> injection except trusted render output. </td></tr><tr><td data-label="Category"> Network calls         </td><td data-label="Status"> <code>/api/render</code> only             </td><td data-label="Comment"> No CORS, uses relative path, safe.                                              </td></tr><tr><td data-label="Category"> Error tolerance       </td><td data-label="Status"> ✅ robust                       </td><td data-label="Comment"> <code>try/catch</code> wrappers prevent total failure.                                     </td></tr><tr><td data-label="Category"> Accessibility         </td><td data-label="Status"> ✅                              </td><td data-label="Comment"> Buttons include <code>aria</code> attributes now, matching script logic.                   </td></tr></tbody></table></div><div class="row-count">Rows: 7</div></div><div class="table-caption" id="Table15" data-table="Book_8010_15" style="margin-top:2mm;margin-left:3mm;"><strong>Table 15</strong></div>
<div class="table-wrapper" data-table-id="table-15"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Selector / Action"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Selector / Action</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Found in index.html"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Found in index.html</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Required"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Required</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Comment"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Comment</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Selector / Action"> <code>#paste</code>, <code>#paste-panel</code>, <code>#render-form</code>                 </td><td data-label="Found in index.html"> ✅                   </td><td data-label="Required"> Yes                                       </td><td data-label="Comment"> Core submission flow.          </td></tr><tr><td data-label="Selector / Action"> <code>#renderBtn</code>, <code>#convertBtn</code>, <code>#saveBtn</code>, <code>#exportAllBtn</code> </td><td data-label="Found in index.html"> ✅                   </td><td data-label="Required"> Yes                                       </td><td data-label="Comment"> Button bindings intact.        </td></tr><tr><td data-label="Selector / Action"> <code>#togglePasteBtn</code>                                        </td><td data-label="Found in index.html"> ✅                   </td><td data-label="Required"> Yes                                       </td><td data-label="Comment"> Toggle logic verified.         </td></tr><tr><td data-label="Selector / Action"> <code>#search</code>                                                </td><td data-label="Found in index.html"> ✅                   </td><td data-label="Required"> Yes                                       </td><td data-label="Comment"> Filter logic functional.       </td></tr><tr><td data-label="Selector / Action"> <code>#tables</code>, <code>#toc</code>, <code>#tocList</code>                            </td><td data-label="Found in index.html"> ✅                   </td><td data-label="Required"> Yes                                       </td><td data-label="Comment"> Render and navigation targets. </td></tr><tr><td data-label="Selector / Action"> <code>#resultCount</code>                                           </td><td data-label="Found in index.html"> ✅                   </td><td data-label="Required"> Optional                                  </td><td data-label="Comment"> Now exists and functional.     </td></tr><tr><td data-label="Selector / Action"> <code>#copyBtn</code>, <code>#copyPlainBtn</code>, <code>#copyMdBtn</code>                </td><td data-label="Found in index.html"> ⚠ No                </td><td data-label="Required"> Optional; replaced by per-table toolbars. </td><td data-label="Comment">                                </td></tr><tr><td data-label="Selector / Action"> <code>#inlineAssets</code>, <code>#modeBtn</code>, <code>#toggleAllBtn</code>             </td><td data-label="Found in index.html"> ⚠ No                </td><td data-label="Required"> Optional; code skips if absent.           </td><td data-label="Comment">                                </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table16" data-table="Book_8010_16" style="margin-top:2mm;margin-left:3mm;"><strong>Table 16</strong></div>
<div class="table-wrapper" data-table-id="table-16"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Logic / Structure"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Imports & Logger Setup</strong>                                      </td><td data-label="Conceptual Notes"> Defensive imports for Flask, CORS, Limiter, and optional renderer modules. Creates <code>_make_basic_logger</code> fallback if <code>utils.make_logger</code> unavailable. </td></tr><tr><td data-label="Logic / Structure"> <strong>Renderer Discovery</strong>                                          </td><td data-label="Conceptual Notes"> Sequentially tries to import <code>render_from_text</code> from various modules under <code>render/</code> and root.                                                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Helper Functions</strong>                                            </td><td data-label="Conceptual Notes"> <code>_coerce_int</code>, <code>_safe_filename</code>, <code>_try_import_callable</code>.                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>create_app() Factory</strong>                                        </td><td data-label="Conceptual Notes"> Builds a full Flask instance with static, templates, and config defaults.                                                                            </td></tr><tr><td data-label="Logic / Structure"> <strong>Feature Flags</strong>                                               </td><td data-label="Conceptual Notes"> Optional enablement of CORS and Limiter based on availability and config.                                                                            </td></tr><tr><td data-label="Logic / Structure"> <strong>Request Guard (<code>before_request</code>)</strong>                            </td><td data-label="Conceptual Notes"> Rejects oversized requests (>2× <code>MAX_PASTE_SIZE</code>).                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>Routes – <code>/</code>, <code>/health</code>, <code>/manifest.json</code>, <code>/assets/&lt;file&gt;</code></strong> </td><td data-label="Conceptual Notes"> Basic server endpoints for UI, health check, manifest, and asset retrieval.                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Renderer Wrapper <code>_render_text_with_fallbacks()</code></strong>            </td><td data-label="Conceptual Notes"> Attempts rendering text → HTML with prioritized fallbacks. Returns <code>(html, meta)</code> tuple.                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>POST <code>/convert</code> & <code>/api/render</code></strong>                             </td><td data-label="Conceptual Notes"> Accepts text or JSON, validates size, renders via <code>_render_text_with_fallbacks</code>.                                                                     </td></tr><tr><td data-label="Logic / Structure"> <strong>POST <code>/save</code></strong>                                                </td><td data-label="Conceptual Notes"> Saves rendered HTML under <code>saved_tables/</code>. Tries atomic write or <code>save_html_atomic</code>.                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>GET <code>/saved/&lt;file_id&gt;</code></strong>                                      </td><td data-label="Conceptual Notes"> Returns previously saved HTML safely from storage path.                                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>API Aliases</strong>                                                 </td><td data-label="Conceptual Notes"> <code>/api/convert</code>, <code>/api/render</code>, <code>/api/health</code> map to main endpoints.                                                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>Standalone Entry (<code>__main__</code>)</strong>                               </td><td data-label="Conceptual Notes"> Reads host, port, debug flags from environment. Runs development server.                                                                             </td></tr></tbody></table></div><div class="row-count">Rows: 13</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>