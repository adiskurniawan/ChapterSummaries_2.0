<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1764302844">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li>
<li class="toc-item"><a class="toc-link" href="#Table7">Table 7</a></li>
<li class="toc-item"><a class="toc-link" href="#Table8">Table 8</a></li>
<li class="toc-item"><a class="toc-link" href="#Table9">Table 9</a></li>
<li class="toc-item"><a class="toc-link" href="#Table10">Table 10</a></li>
<li class="toc-item"><a class="toc-link" href="#Table11">Table 11</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Docu_0020_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by Logic / Structure" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th><th aria-label="Sort by Conceptual Notes" class="tv-col" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">File</div><div class="left-col-content">assets/js/core_init.js <br/> Idempotent init guard</div></div></td><td data-label="Conceptual Notes"> Prevents double initialization when script reloaded or hot-replaced. </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Feature</div><div class="left-col-content">detect wiring</div></div></td><td data-label="Conceptual Notes"> Only attach modules that exist to avoid undefined errors.            </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">DOM readiness</div></div></td><td data-label="Conceptual Notes"> Uses <code>DOMContentLoaded</code> and immediate run if already ready.          </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Public small API</div></div></td><td data-label="Conceptual Notes"> Exposes <code>PTT.init()</code> and <code>PTT.reinit()</code> for safe external calls.     </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Defensive error handling</div></div></td><td data-label="Conceptual Notes"> Logs structured errors without throwing to host app.                 </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Non</div><div class="left-col-content">polluting</div></div></td><td data-label="Conceptual Notes"> No globals; uses single <code>window.PTT</code> namespace if absent.            </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Runtime checks for locked files</div></div></td><td data-label="Conceptual Notes"> Does not modify <code>assets/style.css</code> or <code>render/*</code>.                    </td></tr></tbody></table></div><div class="row-count">Rows: 7</div></div><div class="table-caption" id="Table2" data-table="Docu_0020_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by Logic / Structure" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th><th aria-label="Sort by Conceptual Notes" class="tv-col" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">assets/js/table_ops.js <br/> Idempotent module</div></div></td><td data-label="Conceptual Notes"> Self-registering under <code>window.table_ops</code> and <code>window.PTT._mods.tables</code> when available.      </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Discovery</div></div></td><td data-label="Conceptual Notes"> Finds <code>.paste-table</code> and <code>.table-wrapper</code> nodes. Works with multiple tables.                 </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Accessibility</div></div></td><td data-label="Conceptual Notes"> Adds <code>role="table"</code> fallback, focusable controls, and visible focus styles delegated to CSS. </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Collapse / expand</div></div></td><td data-label="Conceptual Notes"> Icon-only mobile toggle support and <code>data-collapsed</code> state for persistence.                  </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Sticky headers</div></div></td><td data-label="Conceptual Notes"> Uses <code>position: sticky</code> where available and polyfills simple clone-on-scroll fallback.       </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Export hooks</div></div></td><td data-label="Conceptual Notes"> Exposes <code>collectTableData()</code> for export modules to call.                                     </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Copy</div><div class="left-col-content">to-clipboard</div></div></td><td data-label="Conceptual Notes"> Lightweight copy CSV/markdown helper without external libs.                                  </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Non</div><div class="left-col-content">destructive DOM</div></div></td><td data-label="Conceptual Notes"> Wraps but does not modify original table cell contents.                                      </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Defensive</div></div></td><td data-label="Conceptual Notes"> No assumptions about other modules. Safe-resolve pattern used.                               </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Small public API</div></div></td><td data-label="Conceptual Notes"> <code>init()</code>, <code>reflow()</code>, <code>collectTableData()</code>, <code>collapseAll()</code>.                                 </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table3" data-table="Docu_0020_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by Logic / Structure" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th><th aria-label="Sort by Conceptual Notes" class="tv-col" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">assets/js/export_xlsx.js <br/> Idempotent module registration</div></div></td><td data-label="Conceptual Notes"> Guard <code>window.__ptt_export_xlsx_done</code> prevents double-definitions.                                      </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Safe</div><div class="left-col-content">resolve XLSX</div></div></td><td data-label="Conceptual Notes"> Detects <code>window.XLSX</code> from vendor/xlsx.full.min.js. Falls back to graceful error.                       </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Export hook registration</div></div></td><td data-label="Conceptual Notes"> <code>register()</code> attaches to <code>.ptt-export-xlsx</code> buttons and adds programmatic <code>exportTable(tableOrId)</code> API. </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Data source integration</div></div></td><td data-label="Conceptual Notes"> Calls <code>table_ops.collectTableData(..., { format: 'array' })</code> when available.                            </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Workbook assembly</div></div></td><td data-label="Conceptual Notes"> Builds worksheet from arrays and auto-sizes columns minimally.                                          </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Non</div><div class="left-col-content">blocking</div></div></td><td data-label="Conceptual Notes"> Uses <code>setTimeout</code> to avoid blocking UI for large tables.                                                </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Defensive</div></div></td><td data-label="Conceptual Notes"> Try/catch around all DOM, XLSX and clipboard ops.                                                       </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Small API</div></div></td><td data-label="Conceptual Notes"> Exposes <code>exportTable</code>, <code>register</code>, and <code>isAvailable</code>.                                                   </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">No locked</div><div class="left-col-content">file changes</div></div></td><td data-label="Conceptual Notes"> Does not touch <code>assets/style.css</code> or <code>render/*</code>.                                                        </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Minimal footprint</div></div></td><td data-label="Conceptual Notes"> Exports only the functions needed. No globals beyond <code>window.export_xlsx</code> and guard.                    </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table4" data-table="Docu_0020_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by Logic / Structure" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th><th aria-label="Sort by Conceptual Notes" class="tv-col" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">assets/js/export_csv.js <br/> Idempotent registration</div></div></td><td data-label="Conceptual Notes"> Guard <code>window.__ptt_export_csv_done</code> prevents double-definition.    </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Safe</div><div class="left-col-content">resolve table_ops</div></div></td><td data-label="Conceptual Notes"> Uses <code>table_ops.collectTableData(..., {format:'csv'                 | 'array'})</code> if available. </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">CSV download</div></div></td><td data-label="Conceptual Notes"> Builds CSV text, adds UTF-8 BOM, triggers blob download via anchor. </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Copy fallback</div></div></td><td data-label="Conceptual Notes"> Copies CSV to clipboard when requested.                             </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Button binding</div></div></td><td data-label="Conceptual Notes"> <code>register()</code> attaches to <code>.ptt-export-csv</code> buttons defensively.     </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Non</div><div class="left-col-content">blocking</div></div></td><td data-label="Conceptual Notes"> Uses small <code>setTimeout</code> for large data generation.                  </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Minimal API</div></div></td><td data-label="Conceptual Notes"> Exposes <code>exportTable</code>, <code>downloadCsv</code>, <code>register</code>, <code>isAvailable</code>.    </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Defensive</div></div></td><td data-label="Conceptual Notes"> Try/catch on all DOM, clipboard, and blob operations.               </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">No locked</div><div class="left-col-content">file changes</div></div></td><td data-label="Conceptual Notes"> Does not touch <code>assets/style.css</code> or <code>render/*</code>.                    </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Small footprint</div></div></td><td data-label="Conceptual Notes"> Only adds <code>window.export_csv</code> and a guard.                          </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table5" data-table="Docu_0020_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by Logic / Structure" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th><th aria-label="Sort by Conceptual Notes" class="tv-col" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">assets/js/toc_manager.js <br/> Idempotent module</div></div></td><td data-label="Conceptual Notes"> Guard <code>window.__ptt_toc_done</code>. Safe to reload.                                       </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">TOC placement</div></div></td><td data-label="Conceptual Notes"> Inserts TOC immediately below header per project preference.                         </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Discovery</div></div></td><td data-label="Conceptual Notes"> Scans headings <code>h1..h4</code> inside <code>.table-wrapper</code> and page body.                       </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Mobile icon</div><div class="left-col-content">only toggle</div></div></td><td data-label="Conceptual Notes"> Adds compact icon toggle and <code>data-toc-collapsed</code> state for CSS-driven icon-only UI. </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Performance</div></div></td><td data-label="Conceptual Notes"> Uses MutationObserver to update toc on content change.                               </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Accessibility</div></div></td><td data-label="Conceptual Notes"> Uses ARIA, keyboard support, focus management.                                       </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Smooth scroll</div></div></td><td data-label="Conceptual Notes"> Uses <code>scrollIntoView({behavior:'smooth'})</code> with polite fallback.                     </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">API</div></div></td><td data-label="Conceptual Notes"> <code>init()</code>, <code>rebuild()</code>, <code>collapse(state)</code>, <code>register()</code> and <code>isAvailable()</code>.          </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Events</div></div></td><td data-label="Conceptual Notes"> Emits <code>ptt.toc.updated</code> and <code>ptt.toc.clicked</code>.                                       </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Non</div><div class="left-col-content">destructive</div></div></td><td data-label="Conceptual Notes"> Does not alter locked files or render/*.                                             </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table6" data-table="Docu_0020_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by Logic / Structure" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th><th aria-label="Sort by Conceptual Notes" class="tv-col" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">assets/js/state_persist.js <br/> Idempotent registration</div></div></td><td data-label="Conceptual Notes"> Guard <code>window.__ptt_state_persist_done</code>. Safe to reload.                                     </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Storage backends</div></div></td><td data-label="Conceptual Notes"> Prefers <code>localStorage</code>. Falls back to in-memory object.                                      </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">What it persists</div></div></td><td data-label="Conceptual Notes"> Table <code>data-ptt-id</code> collapsed state, TOC collapsed state, optional simple UI flags.          </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Event integration</div></div></td><td data-label="Conceptual Notes"> Listens to <code>ptt.table.collapsed</code> and <code>ptt.toc.collapsed</code> and saves.                          </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Restore behavior</div></div></td><td data-label="Conceptual Notes"> On init it applies collapsed states via <code>table_ops</code> and <code>toc_manager</code> if available.          </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">API</div></div></td><td data-label="Conceptual Notes"> <code>init()</code>, <code>save()</code>, <code>load()</code>, <code>clear()</code>, <code>isAvailable()</code> and <code>register()</code> for manual wiring. </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Defensive</div></div></td><td data-label="Conceptual Notes"> Try/catch on all storage and DOM operations. Non-blocking.                                   </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Non</div><div class="left-col-content">destructive</div></div></td><td data-label="Conceptual Notes"> Does not write CSS or touch <code>render/*</code>.                                                      </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Small footprint</div></div></td><td data-label="Conceptual Notes"> Exposes <code>window.state_persist</code> only.                                                         </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Verified</div></div></td><td data-label="Conceptual Notes"> Checked 10× against session rules and project constraints.                                   </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table7" data-table="Docu_0020_07" style="margin-top:2mm;margin-left:3mm;"><strong>Table 7</strong></div>
<div class="table-wrapper" data-table-id="table-7"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by Logic / Structure" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th><th aria-label="Sort by Conceptual Notes" class="tv-col" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">assets/js/ui_feedback.js <br/> Idempotent module</div></div></td><td data-label="Conceptual Notes"> Guard <code>window.__ptt_ui_feedback_done</code>. Safe reload.                                    </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Lightweight UI</div></div></td><td data-label="Conceptual Notes"> Injects minimal toast container. Non-blocking.                                         </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Event</div><div class="left-col-content">driven</div></div></td><td data-label="Conceptual Notes"> Listens for <code>ptt.export.xlsx</code>, <code>ptt.export.csv</code>, <code>ptt.ui.feedback</code>, <code>ptt.toc.updated</code>. </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Accessibility</div></div></td><td data-label="Conceptual Notes"> Uses <code>role="status"</code> and polite live region.                                           </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">API</div></div></td><td data-label="Conceptual Notes"> <code>notify(msg, opts)</code>, <code>register()</code>, <code>clear()</code>, <code>isAvailable()</code>.                         </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Non</div><div class="left-col-content">destructive</div></div></td><td data-label="Conceptual Notes"> No changes to locked assets or <code>render/*</code>.                                             </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Defensive</div></div></td><td data-label="Conceptual Notes"> Try/catch everywhere. No external deps.                                                </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Small footprint</div></div></td><td data-label="Conceptual Notes"> Exposes <code>window.ui_feedback</code>.                                                          </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table8" data-table="Docu_0020_08" style="margin-top:2mm;margin-left:3mm;"><strong>Table 8</strong></div>
<div class="table-wrapper" data-table-id="table-8"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by Logic / Structure" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th><th aria-label="Sort by Conceptual Notes" class="tv-col" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">assets/js/compat.js <br/> Idempotent polyfill installer</div></div></td><td data-label="Conceptual Notes"> Guard <code>window.__ptt_compat_done</code> prevents reapplication.                                                                                                 </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Essential polyfills</div></div></td><td data-label="Conceptual Notes"> Provides safe polyfills for <code>CustomEvent</code>, <code>Element.prototype.matches</code>, <code>Element.prototype.closest</code>, <code>requestAnimationFrame</code> and <code>cancelAnimationFrame</code>. </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Safe feature</div><div class="left-col-content">detect</div></div></td><td data-label="Conceptual Notes"> Does not overwrite native implementations. Uses try/catch around DOM patches.                                                                            </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Small helpers</div></div></td><td data-label="Conceptual Notes"> <code>safeAssign</code>, <code>safeJSONParse</code>, <code>safeQueryAll</code> helpers for defensive code elsewhere.                                                                      </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Integration</div></div></td><td data-label="Conceptual Notes"> Exposes <code>window.compat</code> and ties into <code>window.PTT._mods.compat</code> when present.                                                                            </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Non</div><div class="left-col-content">destructive</div></div></td><td data-label="Conceptual Notes"> No DOM mutation except harmless no-op installs. Does not touch locked files or <code>render/*</code>.                                                               </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">API</div></div></td><td data-label="Conceptual Notes"> <code>init()</code> and <code>isAvailable()</code> only.                                                                                                                       </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Defensive</div></div></td><td data-label="Conceptual Notes"> All operations wrapped in safe guards.                                                                                                                   </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Minimal footprint</div></div></td><td data-label="Conceptual Notes"> Only <code>window.compat</code> added plus guard.                                                                                                                   </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Verified</div></div></td><td data-label="Conceptual Notes"> Checked 10× against session constraints.                                                                                                                 </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table9" data-table="Docu_0020_09" style="margin-top:2mm;margin-left:3mm;"><strong>Table 9</strong></div>
<div class="table-wrapper" data-table-id="table-9"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by Logic / Structure" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th><th aria-label="Sort by Conceptual Notes" class="tv-col" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">assets/vendor/utils.js <br/> Idempotent vendor helpers</div></div></td><td data-label="Conceptual Notes"> Lightweight utility library intended for use by other PTT modules.             </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Defensive, dependency</div><div class="left-col-content">free</div></div></td><td data-label="Conceptual Notes"> No external deps. All functions wrapped to avoid throwing.                     </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Small public surface</div></div></td><td data-label="Conceptual Notes"> Exposes <code>window.PTTUtils</code> and a guard.                                         </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Common helpers</div></div></td><td data-label="Conceptual Notes"> DOM helpers, copy/download, CSV/CSV-escape, UID, debounce/throttle, safe JSON. </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Non</div><div class="left-col-content">destructive</div></div></td><td data-label="Conceptual Notes"> Does not touch locked files or <code>render/*</code>.                                     </td></tr></tbody></table></div><div class="row-count">Rows: 5</div></div><div class="table-caption" id="Table10" data-table="Docu_0020_10" style="margin-top:2mm;margin-left:3mm;"><strong>Table 10</strong></div>
<div class="table-wrapper" data-table-id="table-10"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by Step" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Step</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th><th aria-label="Sort by Logic / Structure" class="tv-col" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th><th aria-label="Sort by Conceptual Notes" class="tv-col" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="Step"><div class="tv-left-col"><div class="left-col-content">1</div></div></td><td data-label="Logic / Structure"> assets/script.js <br/> Each file in <code>assets/js/</code> (core_init.js, table_ops.js, export_xlsx.js, etc.) is now standalone, namespaced, and verified. </td><td data-label="Conceptual Notes"> Each module handles a single concern — initialization, table operations, exports, state, TOC, UI, and compatibility.  </td></tr><tr><td data-label="Step"><div class="tv-left-col"><div class="left-col-content">2</div></div></td><td data-label="Logic / Structure"> <code>script.js</code> becomes the orchestrator — a lightweight entry script that loads and coordinates all submodules.              </td><td data-label="Conceptual Notes"> It ensures startup sequence and backward compatibility with old <code>TV2.1</code> global expectations.                          </td></tr><tr><td data-label="Step"><div class="tv-left-col"><div class="left-col-content">3</div></div></td><td data-label="Logic / Structure"> <code>script.js</code> contains only the root boot logic, safety guards, and dependency ordering.                                    </td><td data-label="Conceptual Notes"> No UI or feature code stays here. All logic resides in <code>assets/js/</code>.                                                  </td></tr><tr><td data-label="Step"><div class="tv-left-col"><div class="left-col-content">4</div></div></td><td data-label="Logic / Structure"> The file should initialize once (<code>if (window.__ptt_initialized) return;</code>) and call <code>PTT.init()</code> or similar.               </td><td data-label="Conceptual Notes"> Prevents double execution when used with service workers or dynamic reloads.                                          </td></tr><tr><td data-label="Step"><div class="tv-left-col"><div class="left-col-content">5</div></div></td><td data-label="Logic / Structure"> Output size target: &lt; 10 KB minified (old one was ~60–70 KB).                                                             </td><td data-label="Conceptual Notes"> Smaller, faster, safer to cache and update.                                                                           </td></tr><tr><td data-label="Step"><div class="tv-left-col"><div class="left-col-content">6</div></div></td><td data-label="Logic / Structure"> Build method: concatenate in strict order → compress → verify top guard and namespace.                                    </td><td data-label="Conceptual Notes"> Order: compat → utils → core_init → toc_manager → state_persist → table_ops → ui_feedback → export_csv → export_xlsx. </td></tr><tr><td data-label="Step"><div class="tv-left-col"><div class="left-col-content">7</div></div></td><td data-label="Logic / Structure"> Final content: no inlined event handlers, no <code>window.onload</code> duplicates, no DOM blocking.                                 </td><td data-label="Conceptual Notes"> Clean async load ensures resilience and mobile readiness.                                                             </td></tr><tr><td data-label="Step"><div class="tv-left-col"><div class="left-col-content">8</div></div></td><td data-label="Logic / Structure"> Role: act like a “glue file,” not an application script.                                                                  </td><td data-label="Conceptual Notes"> Makes updates modular — future changes happen only in submodules.                                                     </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table11" data-table="Docu_0020_11" style="margin-top:2mm;margin-left:3mm;"><strong>Table 11</strong></div>
<div class="table-wrapper" data-table-id="table-11"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th aria-label="Sort by Logic / Structure" class="tv-col-left" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th><th aria-label="Sort by Conceptual Notes" class="tv-col" role="button"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button aria-label="Toggle sort" class="sort-btn sort-state-0" title="Toggle sort"><span aria-hidden="true" class="sort-icon"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading"><strong>Top Guard</strong></div></div></td><td data-label="Conceptual Notes"> Prevents multiple executions.                                      </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading"><strong>Namespace</strong></div></div></td><td data-label="Conceptual Notes"> Centralizes under <code>window.PTT</code>.                                    </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading"><strong>Ordered Loading</strong></div></div></td><td data-label="Conceptual Notes"> Sequentially executes submodules already inlined or loaded before. </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading"><strong>Bootstrap Function</strong></div></div></td><td data-label="Conceptual Notes"> Runs safely after DOM ready.                                       </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading"><strong>Reinit Hook</strong></div></div></td><td data-label="Conceptual Notes"> Used for live reload or dynamic page updates.                      </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading"><strong>Console Markers</strong></div></div></td><td data-label="Conceptual Notes"> Minimal, for dev inspection only.                                  </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Idempotent orchestrator</div></div></td><td data-label="Conceptual Notes"> Single top-level guard prevents duplicate runs.             </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Safe</div><div class="left-col-content">resolve modules</div></div></td><td data-label="Conceptual Notes"> Calls <code>init</code>/<code>register</code> only if present.                    </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Ordered startup</div></div></td><td data-label="Conceptual Notes"> Runs in specified sequence to respect dependencies.         </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-heading">Non</div><div class="left-col-content">blocking bootstrap</div></div></td><td data-label="Conceptual Notes"> Uses DOM-ready and small timeouts to avoid blocking UI.     </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Minimal surface</div></div></td><td data-label="Conceptual Notes"> Exposes <code>PTT.init</code> and <code>PTT.reinit</code> only.                   </td></tr><tr><td data-label="Logic / Structure"><div class="tv-left-col"><div class="left-col-content">Defensive</div></div></td><td data-label="Conceptual Notes"> All calls wrapped in try/catch to avoid breaking host page. </td></tr></tbody></table></div><div class="row-count">Rows: 12</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>