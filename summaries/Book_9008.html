<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;}</style>
<link rel="stylesheet" href="assets/style.css?v=1759376935">
<link rel="stylesheet" href="assets/overrides.css?v=1759376935">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header"><div><h1>Tables Viewer v2.1</h1></div><div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" type="search" placeholder="Search" aria-label="Search tables" style="min-width:420px; width:44ch;"/>
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllMdBtn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy all tables as markdown">Copy All Tables (Markdown)</button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset all tables">Reset All Tables</button>
</div></div>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#table-1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#table-2">Table 2</a></li></ul></div></div>
<div class="table-wrapper" data-table-id="table-1"><h3 id="table-1">Table 1</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th style="width:28.57%;" role="button" aria-label="Sort by **Before**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Before</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th style="width:71.43%;" role="button" aria-label="Sort by **After (assistant enhancement)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>After (assistant enhancement)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th style="width:71.43%;" role="button" aria-label="Sort by **Further enhancement (proposal)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Further enhancement (proposal)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Before"><strong>Variables & theming</strong><br>- Many CSS custom properties already present (`--bg`, `--text`, `--panel`, `--border`, `--accent`, etc.).<br>- Dark-theme via `@media (prefers-color-scheme: dark)` and `[data-theme="dark"]` duplicates. </td><td data-label="After (assistant enhancement)"><strong>Small, safe additions</strong><br>- Added `color-scheme: light dark` and explicit `--tv-header-min-height` usage.<br>- Kept user's variables intact. Consolidated a few defaults and ensured fallbacks. </td><td data-label="Further enhancement (proposal)"><strong>Make theming more flexible</strong><br>- Expose `--z-sticky`, `--focus-ring-opacity`, `--surface-elevation` tokens.<br>- Centralize contrast variables: `--text-on-panel`, `--text-on-bg` for automated contrast checks.<br>- Provide `:root[data-theme="auto"]` hook and `prefers-contrast: more` overrides.           </td></tr><tr><td data-label="Before"><strong>Global normalization & box model</strong><br>- No global `box-sizing` reset originally. Some images and elements not constrained.                                                                                                         </td><td data-label="After (assistant enhancement)"><strong>Added normalization</strong><br>- `<em>, </em>::before, *::after { box-sizing: border-box; }` and image constraints to avoid layout breakage.<br>- Added subtle transitions for color/background.              </td><td data-label="Further enhancement (proposal)"><strong>Progressive normalization</strong><br>- Add `contain: layout style size` to heavy containers (e.g. `.table-wrapper`) to limit repaint scope.<br>- Add `isolation:isolate` for header to avoid z-index bleed on complex pages.                                                                                           </td></tr><tr><td data-label="Before"><strong>Typography & rhythm</strong><br>- Good variable set (`--measure`, `--font-sans`, `--font-mono`). Headings sizes present. Line-height varied.                                                                                              </td><td data-label="After (assistant enhancement)"><strong>Rhythm tweaks</strong><br>- Set explicit `font-weight:400` base and increased `line-height` to `1.5` for ChatGPT-like cadence.<br>- Added `scroll-margin-top` on headings to account for sticky header. </td><td data-label="Further enhancement (proposal)"><strong>Refine typographic scale</strong><br>- Add modular scale variables: `--type-ratio: 1.2` and compute `--h1`, `--h2` etc.<br>- Load/declare optional system font stacks via `font-display: swap` @font-face for consistent weights.                                                                                       </td></tr><tr><td data-label="Before"><strong>Header & sticky behavior</strong><br>- `#stickyMainHeader` sticky, header height hard-coded 48px in some selectors (top:48px).<br>- Headings could be hidden under sticky header without scroll-margin safety.                            </td><td data-label="After (assistant enhancement)"><strong>Safer sticky</strong><br>- Replace hard-coded `48px` with `var(--tv-header-min-height)` and use `scroll-margin-top` for anchors.<br>- Improved header transitions.                                      </td><td data-label="Further enhancement (proposal)"><strong>Further robustness</strong><br>- Use `top: env(safe-area-inset-top, 0px)` for mobiles with notches.<br>- Add `.has-sticky-header` class toggled by JS to set `--tv-header-min-height` dynamically when header content changes.                                                                                          </td></tr><tr><td data-label="Before"><strong>Table layout & performance</strong><br>- `table-layout: fixed` and fixed padding. Min-width applied. Good zebra rows and hover.<br>- Many border and box-shadow uses could cause repaints on hover.                                       </td><td data-label="After (assistant enhancement)"><strong>Conservative performance fixes</strong><br>- Kept `table-layout: fixed`, preserved zebra and hover styles.<br>- Suggested `background` transitions are subtle to reduce repeaints.                      </td><td data-label="Further enhancement (proposal)"><strong>Performance optimizations</strong><br>- Replace expensive `tr:hover td` background with `tr:hover { background-color: var(--row-hover); }` and use `td { background-clip: padding-box; }` to avoid repaint over borders.<br>- Use `will-change: transform` only where necessary (avoid `will-change` on many elements). </td></tr><tr><td data-label="Before"><strong>Sticky first column</strong><br>- `thead th:first-child` and `td:first-child` sticky with `left:0` and `box-shadow`. Works but may cause rendering jank on large tables.                                                                  </td><td data-label="After (assistant enhancement)"><strong>No breaking change</strong><br>- Kept sticky-first-col, added consistent `z-index` and ensured sticky top offsets use variables.                                                                        </td><td data-label="Further enhancement (proposal)"><strong>Improve sticky performance</strong><br>- Add `transform: translateZ(0)` on sticky elements sparingly to force composite layer and reduce repaint jank for large tables.<br>- Consider using CSS `position: sticky` only for first column header, and a JS-driven virtualization for rows when tables exceed N rows.     </td></tr><tr><td data-label="Before"><strong>Lists & markers</strong><br>- Custom list markers implemented with pseudo-elements. Uses `content: "– "` and `content: "• "` for nested lists. Fine but pseudo-elements used heavily.                                                     </td><td data-label="After (assistant enhancement)"><strong>Conservative retention</strong><br>- Left list marker rules intact; made them resilient to heavy CSS via `!important` fallbacks in a small debug block.                                                 </td><td data-label="Further enhancement (proposal)"><strong>Modern list markers & semantics</strong><br>- Prefer `::marker` where supported (simpler and more semantic). Fallback to pseudo-elements for older browsers.<br>- Example: `td ul li::marker { content: "– "; color: var(--text); }`                                                                                    </td></tr><tr><td data-label="Before"><strong>Code & pre blocks</strong><br>- Good pre/code styles, separate `--code-bg` vars. Mono stack provided.                                                                                                                                     </td><td data-label="After (assistant enhancement)"><strong>Small improvements</strong><br>- Added `font-variant-numeric: tabular-nums` for `code` to aid numeric columns.<br>- Explicit tab-size and `white-space` normalization maintained.                       </td><td data-label="Further enhancement (proposal)"><strong>Further readability</strong><br>- Use `line-height: 1.6` for large `pre` blocks to improve scanability.<br>- Optionally include a subtle `box-shadow` and `border-left` accent for `pre` to mimic ChatGPT code block emphasis.                                                                                          </td></tr><tr><td data-label="Before"><strong>Accessibility & focus</strong><br>- Focus outlines present in several places. `:focus` used inconsistently.                                                                                                                               </td><td data-label="After (assistant enhancement)"><strong>Stronger focus rules</strong><br>- Added `:focus-visible` rules and made outlines consistent with `--focus-ring` and `outline-offset`.<br>- Added `color-scheme` to hint UA for form controls.          </td><td data-label="Further enhancement (proposal)"><strong>A11y refinements</strong><br>- Add `prefers-reduced-motion` already present; also add `prefers-contrast: more` rules to increase contrast for critical UI elements.<br>- Add `:focus:not(:focus-visible) { outline: none; }` to avoid double outlines.                                                                  </td></tr><tr><td data-label="Before"><strong>Responsive & mobile</strong><br>- Media queries present for ≤900px, ≤600px, ≤420px. Header collapses buttons correctly.                                                                                                                   </td><td data-label="After (assistant enhancement)"><strong>No regressions</strong><br>- Maintained responsive rules; adjusted header variable usage and input sizing.<br>- Ensured sticky top uses variable for mobile top offset.                                 </td><td data-label="Further enhancement (proposal)"><strong>Mobile UX improvements</strong><br>- Use `touch-action: manipulation` on clickable elements to reduce 300ms delay on older browsers.<br>- Provide `max-height` + `overflow:auto` for `.table-container` on narrow screens to improve scrollable snapping.                                                               </td></tr><tr><td data-label="Before"><strong>Print & reduced motion</strong><br>- Print rules exist and reduce sticky headers. Reduced-motion query present.                                                                                                                           </td><td data-label="After (assistant enhancement)"><strong>Kept and consistent</strong><br>- No functional change. Kept `prefers-reduced-motion` guard.                                                                                                            </td><td data-label="Further enhancement (proposal)"><strong>Print polish</strong><br>- Set `@page` rules for margins and ensure headers/footers suppressed. Add `break-inside: avoid` to table containers for better pagination.                                                                                                                                                    </td></tr><tr><td data-label="Before"><strong>Assets & placeholders</strong><br>- CSS references expect `assets/style.css`, `script.js`, `worker.js` to exist; overrides file used.                                                                                                     </td><td data-label="After (assistant enhancement)"><strong>Compatibility</strong><br>- No change in asset paths. Added safe defaults and ensured CSS uses variables if assets are missing.                                                                         </td><td data-label="Further enhancement (proposal)"><strong>Build-time improvements</strong><br>- Recommend generating a small `assets-manifest.json` that includes integrity hashes and sizes; allow `--embed-assets` to inline critical CSS for single-file deploy.                                                                                                               </td></tr><tr><td data-label="Before"><strong>Sanity & maintainability</strong><br>- Original CSS is already large and mixed (layout, theme, component styles).                                                                                                                         </td><td data-label="After (assistant enhancement)"><strong>Minor structural edits</strong><br>- Added comments and guard rules, consolidated repeated values into variables to aid maintainability.                                                                </td><td data-label="Further enhancement (proposal)"><strong>Structural improvements</strong><br>- Split CSS into logical modules (base, layout, components, utilities, themes) and generate final `style.css` via a simple build step (PostCSS).<br>- Add a small CSS linter config (`stylelint`) and document a `CONTRIBUTING` snippet for variable usage.                         </td></tr></tbody></table></div><div class='row-count'></div></div><div class="table-wrapper" data-table-id="table-2"><h3 id="table-2">Table 2</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th style="width:28.57%;" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th style="width:71.43%;" role="button" aria-label="Sort by **Conceptual notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"><strong>Top-level imports and sanitizer fallback</strong> </td><td data-label="Conceptual notes">Imports core_io, core_assets, core_fragments, core_table, core_utils. Tries project `sanitize_html` then falls back to `html.escape`. That fallback changes allowed markup semantics and is critical for XSS posture.                                                       </td></tr><tr><td data-label="Logic / Structure"><strong>MarkdownRenderer</strong>                         </td><td data-label="Conceptual notes">Thin wrapper that accepts a render function or falls back to escaping. Used for converting input strings to HTML prior to table extraction.                                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"><strong>Table extraction pipeline</strong>                </td><td data-label="Conceptual notes">Detects pipe-markdown tables, converts to DF-like structures. Extracts HTML tables via BeautifulSoup if available, otherwise regex fallback. Converts rows into pandas DataFrame when pandas present; otherwise returns lists/dicts.                                        </td></tr><tr><td data-label="Logic / Structure"><strong>Fragment rendering / fallback</strong>            </td><td data-label="Conceptual notes">Calls `render_fragments_concurrently(...)`. If fragments absent or contain no rows, falls back to inline `render_table` output. Fragments are expected sanitized upstream.                                                                                                  </td></tr><tr><td data-label="Logic / Structure"><strong>Asset discovery and inclusion</strong>            </td><td data-label="Conceptual notes">Uses `prepare_assets` to obtain `assets_dir`, fallback texts, and booleans. Supports two modes: embed assets inline (style/script) or link to files with cache-busting timestamps and optional SRI via Calls `write_overrides_css` when available. </td></tr><tr><td data-label="Logic / Structure"><strong>Head / body assembly</strong>                     </td><td data-label="Conceptual notes">Builds head_parts and tail_parts arrays. Writes header UI markup (ids: `tables-viewer`, `stickyMainHeader`, `tv-header`, inputs and buttons). Inserts small inline `:root` var (`--main-header-height`). Adds TOC and banner on empty output.                               </td></tr><tr><td data-label="Logic / Structure"><strong>JS injection</strong>                             </td><td data-label="Conceptual notes">Builds a small export-worker shim and an inline script that wires an `exportBtn` to a Worker using `hrefPrefix + '/worker.js'`. Also defers included script files.                                                                                                          </td></tr><tr><td data-label="Logic / Structure"><strong>Writer and final write</strong>                   </td><td data-label="Conceptual notes">Writes assembled HTML by streaming fragments (raw) or inline_parts. Uses `_default_write_atomic` or tmp replace fallback. Returns warnings/tables/rows and optional html content.                                                                                           </td></tr><tr><td data-label="Logic / Structure"><strong>Failure, logging and warnings</strong>            </td><td data-label="Conceptual notes">Extensive try/excepts. Appends warnings on fragment failures and includes diagnostic messages in banner.                                                                                                                                                                    </td></tr></tbody></table></div><div class='row-count'></div></div><script src="assets/xlsx.full.min.js?v=1759376935" defer></script>
<script src="assets/script.js?v=1759376935" defer></script>
<script src="assets/worker.js?v=1759376935" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
</script>
</div>
</body>
</html>