<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;}</style>
<link rel="stylesheet" href="assets/style.css?v=1758538518">
<link rel="stylesheet" href="assets/overrides.css?v=1758538518">
</head>
<body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader"><div id="tv-header"><div><h1>Tables Viewer v2.1</h1></div><div style="display:flex;gap:8px;align-items:center;"><input id="searchBox" type="search" placeholder="Search" aria-label="Search tables" style="min-width:420px; width:44ch;"/><button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button><button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button><button id="copyAllPlainBtn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button><button id="copyAllMdBtn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy all tables as markdown">Copy All Tables (Markdown)</button><button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset all tables">Reset All Tables</button></div></div></div>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1-title">Table 1</a></li></ul></div>

<div class="table-wrapper" id="Table1"><h3 id="Table1-title">Table 1</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button onclick="copyTablePlain(this)">Copy Plain Table</button><button onclick="copyTableMarkdown(this)">Copy Markdown Table</button></div><div style="display:flex; align-items:center;"><button class="toggle-table-btn" onclick="toggleTable(this)">Collapse Table</button></div></div><table><thead><tr>
        <th style="width:28.57%;" onclick="sortTableByColumn(0,0)" role="button" aria-label="Sort by **Area**">
          <div class="th-with-sort">
            <div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Area</strong></div>
            <button class="sort-btn sort-state-0" onclick="event.stopPropagation(); headerSortButtonClicked(0,0, this)" title="Toggle sort" aria-label="Toggle sort">
              <span class="sort-icon" aria-hidden="true"></span>
            </button>
          </div>
        </th>
        <th style="width:71.43%;" onclick="sortTableByColumn(0,1)" role="button" aria-label="Sort by **Analysis &amp; Findings**">
          <div class="th-with-sort">
            <div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Analysis & Findings</strong></div>
            <button class="sort-btn sort-state-0" onclick="event.stopPropagation(); headerSortButtonClicked(0,1, this)" title="Toggle sort" aria-label="Toggle sort">
              <span class="sort-icon" aria-hidden="true"></span>
            </button>
          </div>
        </th></tr></thead><tbody><tr><td data-label="Area"><p><strong>General Safety & Structure</strong></p></td><td data-label="Analysis &amp; Findings"><p>Script is wrapped in an IIFE with `'use strict'.`<br>No globals leaked except a small controlled API (`window.headerSortButtonClicked`, `toggleTable`, etc.).<br>Good encapsulation.</p></td></tr>
<tr><td data-label="Area"><p><strong>Helpers</strong></p></td><td data-label="Analysis &amp; Findings"><p>`normalizeForSearch` trims/normalizes whitespace and lowercases → robust for search.<br>`debounce` is clean and memory-safe.<br>`copyToClipboard` has two fallbacks: modern API and `execCommand`, with cleanup.<br>No memory leaks.</p></td></tr>
<tr><td data-label="Area"><p><strong>Toast Notifications</strong></p></td><td data-label="Analysis &amp; Findings"><p>`&#95;ensureToastContainer` creates a fixed container with safe styles.<br>`showToast` handles errors, supports `success` and `warn` colors, auto-removes with fade-out, click-to-dismiss.<br>Fallback to `alert` if DOM fails → very robust.</p></td></tr>
<tr><td data-label="Area"><p><strong>DOM Safety</strong></p></td><td data-label="Analysis &amp; Findings"><p>Many guards: `safeGetTBody`, null checks, silent try/catch.<br>This prevents runtime crashes if tables/search box are missing.</p></td></tr>
<tr><td data-label="Area"><p><strong>Sorting</strong></p></td><td data-label="Analysis &amp; Findings"><p>Maintains `originalTableRows` snapshots for reset.<br>Sort order cycles: unsorted → ascending → descending → reset.<br>Numeric detection: removes commas, tries `parseFloat`, falls back to locale compare.<br>`updateHeaderSortUI` updates ARIA attributes + SVG icons.<br>Edge cases handled: empty cells, missing rows, tbody guard.</p></td></tr>
<tr><td data-label="Area"><p><strong>Table Toggling</strong></p></td><td data-label="Analysis &amp; Findings"><p>`toggleTable` and `toggleAllTables` switch wrapper class `.table-collapsed`.<br>Update button labels and sync “Collapse All” button.<br>Row counts updated afterward.<br>No risk of desync.</p></td></tr>
<tr><td data-label="Area"><p><strong>Row Counts</strong></p></td><td data-label="Analysis &amp; Findings"><p>Displays correct “Showing N rows” or “Showing X of Y rows” with search applied.<br>Handles missing tbody (shows <br>0).</p></td></tr>
<tr><td data-label="Area"><p><strong>Copy & Export</strong></p></td><td data-label="Analysis &amp; Findings"><p>Single table copy in plain text or Markdown.<br>All tables copy in plain text or Markdown.<br>Titles included (from \`\`).<br>Uses `\t` for plain and proper Markdown formatting.<br>Fallback to `prompt` if clipboard fails.</p></td></tr>
<tr><td data-label="Area"><p><strong>Reset Function</strong></p></td><td data-label="Analysis &amp; Findings"><p>Restores all rows from `originalTableRows`.<br>Resets sorting states.<br>Expands all tables.<br>Clears search box.<br>Triggers fresh search + row count update.<br>Shows success toast. Very complete.</p></td></tr>
<tr><td data-label="Area"><p><strong>Search Functionality</strong></p></td><td data-label="Analysis &amp; Findings"><p>Normalized search (trim, lower, collapse spaces).<br>Per-row matching, hides non-matching rows.<br>Highlights matched cells with `.highlight`.<br>Clears placeholders left by virtualizer.<br>Scrolls smoothly to first match (adjusts for sticky header).<br>Refreshes `tableVirtualizer` if present.<br>Updates row counts.</p></td></tr>
<tr><td data-label="Area"><p><strong>Keyboard Shortcuts</strong></p></td><td data-label="Analysis &amp; Findings"><p>`/` focuses search (unless typing in input/textarea/contentEditable).<br>`Escape` triggers `backToTop`.</p></td></tr>
<tr><td data-label="Area"><p><strong>TOC & Scroll</strong></p></td><td data-label="Analysis &amp; Findings"><p>TOC links smoothly scroll to table wrapper offset (minus header height).<br>Updates URL fragment with `history.replaceState`.</p></td></tr>
<tr><td data-label="Area"><p><strong>Back to Top</strong></p></td><td data-label="Analysis &amp; Findings"><p>Auto-created if missing.<br>Smooth scroll.<br>Visibility toggled on `scroll` (appears after 200px).</p></td></tr>
<tr><td data-label="Area"><p><strong>Dark Mode Toggle</strong></p></td><td data-label="Analysis &amp; Findings"><p>Persists theme in `localStorage` as `uiMode`.<br>Updates button label.<br>Adds/removes `data-theme="dark"`.</p></td></tr>
<tr><td data-label="Area"><p><strong>Performance & Resilience</strong></p></td><td data-label="Analysis &amp; Findings"><p>Uses `debounce` for search (120ms).<br>Minimal DOM writes: batch updates via `tbody.innerHTML = ""` then append.<br>`try/catch` shields from runtime errors everywhere.<br>No infinite loops, no leaks.</p></td></tr>
<tr><td data-label="Area"><p><strong>Accessibility</strong></p></td><td data-label="Analysis &amp; Findings"><p>Sort headers update `aria-sort` attribute properly.<br>Search is keyboard accessible (`/` shortcut, Enter triggers).<br>Toasts dismiss on click.<br>Needs ARIA live region for toasts if targeting screen readers (optional).</p></td></tr>
</tbody></table></div>
  <div class='row-count'></div>
</div>

</div>
<script src="assets/script.js?v=1758538518" defer></script>
<script src="assets/worker.js?v=1758538518" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  function formatName(tableName){
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', "");
  }
  const btn = document.getElementById('exportBtn');
  if(btn){
    btn.addEventListener('click', async function(){
      try{
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000){ alert('Export refused: html too large'); return; }
        if(window.Worker){
          const worker = new Worker((function(){ try{ return 'assets/worker.js'; }catch(e){ return null; } })());
          if(worker){
            worker.postMessage({html:html, format:'pdf'});
            worker.onmessage = function(e){ console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err){ console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
</script>
</body>
</html>
