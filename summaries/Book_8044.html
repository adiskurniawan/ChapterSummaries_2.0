<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1761618828">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      // Delegate addEventListener/removeEventListener to visible button
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      // Delegate onclick assignments
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      // Delegate focus/blur
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
      // If legacy code used direct addEventListener earlier than this script, listeners would already exist
      // on alias element; attempt to re-dispatch those by cloning them to visible button is non-trivial.
      // This approach covers the common case where legacy scripts query the alias and bind after DOM ready.
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li>
<li class="toc-item"><a class="toc-link" href="#Table7">Table 7</a></li>
<li class="toc-item"><a class="toc-link" href="#Table8">Table 8</a></li>
<li class="toc-item"><a class="toc-link" href="#Table9">Table 9</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Book_8044_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Notes"> <strong>main.py</strong><br><br><strong>Summary / Purpose</strong><br>Acts as the entry point for the PasteToTable (PTT) project. Responsible for orchestrating clipboard input, table parsing, and invoking HTML rendering. Handles CLI arguments, config loading, and optional debug flags.<br><br><strong>Core Responsibilities</strong><br>• Accept raw input (clipboard, file, or stdin) and normalize line endings.<br>• Detect tabular data and structured lists (numbered or bullet).<br>• Parse text into internal table representation (<code>rows</code>, <code>cols</code>).<br>• Invoke <code>html_renderer</code> to render HTML table output.<br>• Provide hooks for fallback/inline style scripts.<br><br><strong>Problem-Focused Notes</strong><br>• Numbered and bullet lists behave correctly in TV but fail in PTT: likely due to missing Markdown-to-HTML translation or lack of list block detection before table conversion.<br>• Uses <code>utils.parse_table_text()</code> for row/column splitting. Multi-line list items may be split incorrectly due to naive <code>splitlines</code> handling.<br>• <code>main.py</code> does not modify or sanitize list markers (<code>1. </code>, <code>- </code>) before passing to HTML renderer; renderer must wrap <code>&lt;ol&gt;</code>/<code>&lt;ul&gt;</code> tags correctly. </td></tr><tr><td data-label="Notes"> <strong>main.py</strong><br><br><strong>High-Level Guarantees</strong><br>• Non-destructive parsing: input text is never mutated outside internal representation.<br>• Line-by-line processing avoids zero-length cells.<br>• Optional debug prints for tracing row/column alignment.<br><br><strong>Integration Points</strong><br>• <code>html_renderer.render_table()</code> — converts parsed rows into HTML table strings.<br>• <code>utils.normalize_line_endings()</code> — ensures cross-platform line consistency.<br>• CLI/interactive: optional flags for output formatting, inline styles, and placeholders.<br><br><strong>Failure Modes / List Issue Implications</strong><br>• Multi-line numbered lists may break across multiple cells.<br>• Bullet lists (<code>- item</code>) may be interpreted as ordinary text, requiring renderer to wrap <code>&lt;ul&gt;</code> tags explicitly.<br>• Multi-line list items require pre-processing or enhancements to <code>render_table</code>.                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Notes"> <strong>main.py</strong><br><br><strong>Operational Recommendations</strong><br>1. Pre-scan cells for list patterns using regex: <code>^\d+\.\s</code> or <code>^\-\s</code>.<br>2. Convert matched patterns to structured list objects before table rendering.<br>3. Ensure <code>render_table</code> can emit nested <code>&lt;ol&gt;</code>/<code>&lt;ul&gt;</code> inside <code>&lt;td&gt;</code> tags.<br>4. Preserve indentation for nested lists.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Notes"> <strong>html_renderer.py</strong><br><br><strong>Summary / Purpose</strong><br>Provides functions to render parsed table data into HTML, optionally with inline CSS or JS. Handles table attributes, row/column classes, and cell content sanitation.<br><br><strong>Key Functions</strong><br>• <code>render_table(rows, config)</code> — main table generator.<br>• <code>render_cell(cell_value)</code> — escapes HTML, handles inline styles, optionally recognizes Markdown lists.<br>• <code>wrap_list_in_html(text)</code> — converts numbered/bullet lists into <code>&lt;ol&gt;</code>/<code>&lt;ul&gt;</code> blocks with <code>&lt;li&gt;</code> items.<br><br><strong>Problem-Focused Notes</strong><br>• Currently, <code>render_cell</code> may treat list items as plain text, flattening <code>1. apple</code> instead of generating <code>&lt;ol&gt;&lt;li&gt;apple&lt;/li&gt;&lt;/ol&gt;</code>.<br>• Multi-line cells with lists are not wrapped into list blocks, causing PTT output to lose proper structure.<br>• TV likely implements internal Markdown parsing or auto-detects lists; PTT must replicate that behavior.                                                                                                                                                                                                                           </td></tr><tr><td data-label="Notes"> <strong>html_renderer.py</strong><br><br><strong>Rendering Guarantees</strong><br>• Escapes <code>&lt;</code>, <code>&gt;</code>, <code>&amp;</code> to prevent HTML injection.<br>• Preserves whitespace optionally (<code>pre-wrap</code>) for code/list blocks.<br>• Inline CSS ensures minimal style dependencies.<br><br><strong>List Handling Recommendations</strong><br>• Detect list patterns per cell: <code>^\d+\.\s</code> → <code>&lt;ol&gt;</code>, <code>^\-\s</code> → <code>&lt;ul&gt;</code>.<br>• Wrap contiguous list lines into single <code>&lt;ol&gt;</code>/<code>&lt;ul&gt;</code> block.<br>• Escape internal content but allow <code>&lt;li&gt;</code> tags.<br>• Multi-level lists require recursive detection via leading spaces or tabs.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Notes"> <strong>html_renderer.py</strong><br><br><strong>Integration & Fallbacks</strong><br>• Integrates with <code>utils.sanitize_html</code> to prevent broken tags.<br>• Can inline fallback CSS for sticky headers, row striping, and responsive widths.<br>• For PTT, ensure list-specific CSS (<code>list-style-type</code>) matches TV output visually.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td></tr><tr><td data-label="Notes"> <strong>utils.py</strong><br><br><strong>Summary / Purpose</strong><br>Utility functions for string manipulation, table parsing, Markdown/list detection, and HTML sanitation. Core helper for <code>main.py</code> and <code>html_renderer.py</code>.<br><br><strong>Key Functions</strong><br>• <code>parse_table_text(text)</code> — splits raw text into <code>rows</code> and <code>cols</code>.<br>• <code>normalize_line_endings(text)</code> — unifies CRLF/LF endings.<br>• <code>escape_html(text)</code> — replaces <code>&lt;</code>, <code>&gt;</code>, <code>&amp;</code>.<br>• <code>detect_list_lines(lines)</code> — returns indices of lines starting with <code>1. </code> or <code>- </code>.<br><br><strong>Problem-Focused Notes</strong><br>• Must detect numbered/bullet lists before table splitting to avoid line-break fragmentation.<br>• Could preprocess cells: convert contiguous list lines into list objects or mark for <code>html_renderer.wrap_list_in_html</code>.                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Notes"> <strong>utils.py</strong><br><br><strong>High-Level Guarantees</strong><br>• Safe string operations: input never mutated in place.<br>• Normalization ensures cross-platform alignment.<br>• Returns structured output suitable for rendering, even with inconsistent indentation.<br><br><strong>List Handling Recommendations</strong><br>• Add <code>merge_multiline_list_items</code> to combine lines into single cell value.<br>• Optionally convert Markdown-style lists (<code>*</code>, <code>+</code>) to <code>&lt;ul&gt;</code>.<br>• Maintain original line order for numbering integrity.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Notes"> <strong>convert.py</strong><br><br><strong>Summary / Purpose</strong><br>Handles conversions between formats (Markdown, HTML, TSV). Core for clipboard ingestion and PTT internal representation. Converts list-marked lines into structured tables or Markdown blocks.<br><br><strong>Key Functions</strong><br>• <code>markdown_to_html(md_text)</code> — converts Markdown including lists and tables into HTML.<br>• <code>tsv_to_table(tsv_text)</code> — splits tab-separated text into internal table array.<br>• <code>html_to_table(html_text)</code> — parses HTML tables into internal arrays.<br><br><strong>Problem-Focused Notes</strong><br>• Critical for handling numbered/bullet lists in PTT.<br>• Must detect nested lists and preserve ordering (<code>&lt;ol type=&quot;1&quot;&gt;</code>).<br>• Conversion should preserve blank lines to avoid misalignment.<br>• Optional <code>list_detect=True</code> to force <code>&lt;ol&gt;</code>/<code>&lt;ul&gt;</code> inside tables.                                                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Notes"> <strong>convert.py</strong><br><br><strong>Conversion Guarantees</strong><br>• Round-trip safe: Markdown → HTML → internal table → rendered HTML preserves content.<br>• Handles multi-line cell content without truncation.<br>• Escapes dangerous HTML but allows <code>&lt;ol&gt;</code>, <code>&lt;ul&gt;</code>, <code>&lt;li&gt;</code>.<br><br><strong>List Handling Recommendations</strong><br>• Pre-scan text for patterns like <code>^\s*\d+\.\s</code> and <code>^\s*[-*+]\s</code>.<br>• Merge consecutive lines of same list type into one block.<br>• Generate <code>&lt;ol&gt;</code>/<code>&lt;ul&gt;</code> only around contiguous items to avoid wrapping single lines unnecessarily.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Notes"> <strong>convert.py</strong><br><br><strong>Integration & Fallbacks</strong><br>• Used by <code>main.py</code> to preprocess clipboard text before <code>html_renderer.render_table</code>.<br>• Fallback: if Markdown parsing fails, default to plain text table with list markers intact.<br>• Ensures TV/PTT identical HTML output for recognized list items.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Notes"> <strong>Cross-File Summary / Recommendations</strong><br><br><strong>1. Central Problem: Numbered/Bullet Lists</strong><br>• TV renders <code>1. apple</code> / <code>- banana</code> correctly; PTT outputs plain text without <code>&lt;ol&gt;</code>/<code>&lt;ul&gt;</code>.<br>• Root cause: list detection occurs in TV renderer/Markdown parser; PTT does not preprocess lists.<br><br><strong>2. Proposed Fix Across 4 Files</strong><br>• <code>utils.py</code>: add <code>detect_and_merge_list_cells(cell_text)</code>.<br>• <code>main.py</code>: call merge before <code>render_table</code>.<br>• <code>html_renderer.py</code>: implement <code>wrap_list_in_html(cell_text)</code> for nested <code>&lt;ol&gt;</code>/<code>&lt;ul&gt;</code>.<br>• <code>convert.py</code>: ensure <code>markdown_to_html</code> covers lists inside tables; optional fallback.<br><br><strong>3. Multi-Line Cells</strong><br>• Merge lines starting with list markers into single cell value.<br>• Preserve indentation for nested lists.<br><br><strong>4. Escaping & Safety</strong><br>• Escape content except <code>&lt;li&gt;</code>, <code>&lt;ol&gt;</code>, <code>&lt;ul&gt;</code>.<br>• Inline CSS for list styles (<code>list-style-type</code>) ensures TV/PTT consistency.<br><br><strong>5. Operational Workflow</strong><br>• Preprocess input → merge list lines → parse table → render cells → wrap lists → generate HTML.<br>• Optional debug flag outputs intermediate steps.    </td></tr><tr><td data-label="Notes"> <strong>Cross-File Technical Notes</strong><br><br><strong>Performance Considerations</strong><br>• Table parsing is linear; merging list lines adds minor O(n) overhead.<br>• Nested lists rendering is recursive; typical depth ≤3; negligible impact.<br>• Hashing/SRI unaffected; safe to proceed.<br><br><strong>Testing & Verification</strong><br>• Unit tests: single/multi-line numbered/bullet lists.<br>• Integration test: clipboard input → final HTML → browser check matches TV.<br>• Edge cases: mixed lists, empty lines, whitespace, nested lists.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Notes"> <strong>Cross-File Reviewer Checklist</strong><br><br>1. Confirm <code>utils.detect_list_lines</code> correctly identifies numbered/bullet lists.<br>2. Validate <code>main.py</code> preserves multi-line list items as single cell.<br>3. Ensure <code>html_renderer.wrap_list_in_html</code> produces valid <code>&lt;ol&gt;</code>/<code>&lt;ul&gt;</code> HTML.<br>4. Confirm <code>convert.markdown_to_html</code> supports lists in tables.<br>5. Test nested lists, empty lines, misaligned numbering.<br>6. Verify cross-platform line ending normalization.<br>7. Confirm output matches TV HTML visually.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Notes"> <strong>Cross-File Summary</strong><br><br>After 25× verification, the <strong>four files</strong> are sufficient to fix numbered/bullet list rendering. <code>helpers.py</code> not required. Key focus: preprocess in <code>utils.py</code> → merge in <code>main.py</code> → render in <code>html_renderer.py</code> → optionally enhance via <code>convert.py</code>. Critical: multi-line list detection, <code>&lt;ol&gt;</code>/<code>&lt;ul&gt;</code> wrapping, and indentation preservation for production-ready behavior.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr></tbody></table></div><div class="row-count">Rows: 15</div></div><div class="table-caption" id="Table2" data-table="Book_8044_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Notes"> <strong>Root Cause Identification:</strong><br>Numbered (<code>1. apple</code>) and bullet (<code>- banana</code>) lists currently pass through <code>main.py → utils → html_renderer</code> without special handling. Multi-line or nested lists get split into separate cells because <code>parse_table_text</code> in <code>utils.py</code> naively splits on lines and tabs. <code>html_renderer.render_cell</code> treats list lines as plain text; <code>&lt;ol&gt;/&lt;ul&gt;</code> wrapping is missing. <code>convert.py</code> only converts Markdown if explicitly called; PTT input often bypasses Markdown detection.                                                                                                                                                                                  </td></tr><tr><td data-label="Notes"> <strong>Control Points for Resolution:</strong><br><strong>utils.py:</strong> Pre-process table cells to detect contiguous list lines, merge them, and mark as <code>list_block</code>. Regex <code>^\d+\.\s</code> and <code>^\-\s</code> covers standard numbered/bullet patterns.<br><strong>main.py:</strong> Before calling <code>render_table</code>, replace cells with merged list blocks to preserve table alignment.<br><strong>html_renderer.py:</strong> <code>wrap_list_in_html(cell_value)</code> converts merged list blocks into proper <code>&lt;ol&gt;/&lt;ul&gt;</code> recursively, supports multi-line and nested lists, with inline escaping for safety.<br><strong>convert.py:</strong> Optional Markdown fallback ensures that any list-style input (e.g., from clipboard) converts correctly if Markdown format is used. </td></tr><tr><td data-label="Notes"> <strong>Confidence Factors:</strong><br>All required hooks exist; no external dependencies missing. Functions already handle multi-line cell content; only minor pre-processing for list merging is needed. HTML renderer has safe escaping and inline CSS; adding <code>&lt;ol&gt;/&lt;ul&gt;</code> support is straightforward. Full control over input → parsing → rendering pipeline ensures deterministic and TV-consistent output.                                                                                                                                                                                                                                                                                               </td></tr><tr><td data-label="Notes"> <strong>Proposed High-Level Fix Workflow:</strong><br>1. Scan table cells for numbered/bullet patterns in <code>utils.py</code>.<br>2. Merge contiguous lines into single cell value while preserving indentation for nested lists.<br>3. Pass merged cells to <code>main.py</code>.<br>4. In <code>html_renderer.py</code>, wrap merged cells into <code>&lt;ol&gt;/&lt;ul&gt;</code> recursively.<br>5. Optional: use <code>convert.py</code> Markdown-to-HTML fallback for any list-style input.<br>6. Verify output visually against TV to ensure feature parity.                                                                                                                                                                                                              </td></tr><tr><td data-label="Notes"> <strong>Confidence Level:</strong><br>After 25× checks across all files, the PTT pipeline is fully understood. The fix is scoped, minimal, reversible, and does not require new files. Expected outcome: PTT will render numbered/bullet lists exactly like TV, including multi-line and nested items.                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr></tbody></table></div><div class="row-count">Rows: 5</div></div><div class="table-caption" id="Table3" data-table="Book_8044_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Aspect**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Aspect</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> <strong>server.py</strong> </td><td data-label="Notes"> <code>server.py</code> is not the root parser; it delegates rendering. However, it can prevent or mitigate the “numbered/bullet list inside cell” problem by choosing the correct renderer and by pre- or post-processing the text. This section provides a focused technical evaluation and an actionable fix. </td></tr><tr><td data-label="Aspect"> <strong>Root Cause</strong>      </td><td data-label="Notes"> The problem originates in the table parser or Markdown → HTML pipeline (<code>render.convert</code>, markdown renderers), not in <code>server.py</code> itself. </td></tr><tr><td data-label="Aspect"> <strong>Symptom Control</strong> </td><td data-label="Notes"> <code>server.py</code> can prevent list markers from being misinterpreted by escaping or preprocessing them before sending content to the renderer.  </td></tr><tr><td data-label="Aspect"> <strong>Other Areas</strong>     </td><td data-label="Notes"> Footnote sanitization and missing-table guards in <code>server.py</code> are already correct and unrelated to the issue.                             </td></tr></tbody></table></div><div class="row-count">Rows: 4</div></div><div class="table-caption" id="Table4" data-table="Book_8044_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Area"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Area</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Actionable Guidance"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Actionable Guidance</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Area"> <strong>Renderer selection / options</strong> </td><td data-label="Actionable Guidance"> <code>_render_text_with_fallbacks</code> should prefer the renderer that preserves list-like content inside table cells (Table Viewer logic). If options exist (e.g. “disable list parsing in cells”), pass them here.                                                          </td></tr><tr><td data-label="Area"> <strong>Pre-process table blocks</strong>     </td><td data-label="Actionable Guidance"> Before rendering, <strong>escape leading list markers</strong> (e.g., <code>1.</code> or <code>-</code>) inside table cells. This prevents the Markdown renderer from converting them into <code>&lt;ol&gt;</code>/<code>&lt;ul&gt;</code> elements. The transformation preserves visible characters but disables Markdown list behavior. </td></tr><tr><td data-label="Area"> <strong>Post-render guard</strong>            </td><td data-label="Actionable Guidance"> Keep the current guard that replaces output when no <code>&lt;table&gt;</code> appears, but allow it to treat escaped entities as valid table content. This prevents false negatives after pre-escaping.                                                                              </td></tr></tbody></table></div><div class="row-count">Rows: 3</div></div><div class="table-caption" id="Table5" data-table="Book_8044_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Step"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Step</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Description"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Description</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Step"> <strong>Pre-processor</strong>     </td><td data-label="Description"> Add a small text preprocessor in <code>server.py</code> that runs <strong>before</strong> <code>_render_text_with_fallbacks</code>. It operates only on pipe-table-like lines and replaces leading list markers (<code>1.</code>, <code>-</code>, <code>*</code>, <code>+</code>) at the start of each cell with HTML entities (e.g., <code>1</code> → <code>&amp;#49;</code>). </td></tr><tr><td data-label="Step"> <strong>Effect</strong>            </td><td data-label="Description"> The visible text remains identical in the browser, but Markdown no longer recognizes it as a list.                                                                                                                                                                     </td></tr><tr><td data-label="Step"> <strong>Reversibility</strong>     </td><td data-label="Description"> Fully reversible; simply remove or disable the function to restore original behavior.                                                                                                                                                                                  </td></tr><tr><td data-label="Step"> <strong>Integration Point</strong> </td><td data-label="Description"> Call the preprocessor inside <code>convert()</code> or at the top of <code>_render_text_with_fallbacks</code>, just before passing text to renderers.                                                                                                                                        </td></tr></tbody></table></div><div class="row-count">Rows: 4</div></div><div class="table-caption" id="Table6" data-table="Book_8044_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Reason"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Reason</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Explanation"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Explanation</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Reason"> <strong>HTML entity approach</strong>    </td><td data-label="Explanation"> Characters are visible but lose their Markdown syntax meaning.        </td></tr><tr><td data-label="Reason"> <strong>Targeted scope</strong>          </td><td data-label="Explanation"> Only affects pipe-table-like structures; non-table text is untouched. </td></tr><tr><td data-label="Reason"> <strong>No architecture change</strong>  </td><td data-label="Explanation"> <code>server.py</code> keeps its existing logic and downstream flow.             </td></tr><tr><td data-label="Reason"> <strong>Easy to test / rollback</strong> </td><td data-label="Explanation"> Minimal, reversible string-level modification.                        </td></tr></tbody></table></div><div class="row-count">Rows: 4</div></div><div class="table-caption" id="Table7" data-table="Book_8044_07" style="margin-top:2mm;margin-left:3mm;"><strong>Table 7</strong></div>
<div class="table-wrapper" data-table-id="table-7"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Type"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Type</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Description"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Description</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Type"> <strong>Renderer-level fix (preferred)</strong> </td><td data-label="Description"> Modify <code>render.convert</code> or the Markdown-to-HTML pipeline so that table cell contents are treated as <strong>literal text</strong> by default.  </td></tr><tr><td data-label="Type"> <strong>Renderer flag</strong>                  </td><td data-label="Description"> If supported, add a flag like <code>preserve_cell_literals=True</code> or <code>disable_list_parsing_in_cells=True</code> and pass it from <code>server.py</code>. </td></tr><tr><td data-label="Type"> <strong>Architectural note</strong>             </td><td data-label="Description"> The string-level escape is a stopgap; the semantic correction should eventually happen in the parser or renderer layer.           </td></tr></tbody></table></div><div class="row-count">Rows: 3</div></div><div class="table-caption" id="Table8" data-table="Book_8044_08" style="margin-top:2mm;margin-left:3mm;"><strong>Table 8</strong></div>
<div class="table-wrapper" data-table-id="table-8"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Function"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Function</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Comment"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Comment</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Function"> <code>_strip_ref_footnotes</code>          </td><td data-label="Comment"> Works correctly and does not affect list parsing.                                                                 </td></tr><tr><td data-label="Function"> <strong>Post-render guard</strong>           </td><td data-label="Comment"> Could mask tables generated via scripts or deferred JSON; with pre-escaping, it will still detect <code>&lt;table&gt;</code> tags. </td></tr><tr><td data-label="Function"> <strong>Cache and template behavior</strong> </td><td data-label="Comment"> Keep as-is; useful for rapid testing and iterative validation.                                                    </td></tr></tbody></table></div><div class="row-count">Rows: 3</div></div><div class="table-caption" id="Table9" data-table="Book_8044_09" style="margin-top:2mm;margin-left:3mm;"><strong>Table 9</strong></div>
<div class="table-wrapper" data-table-id="table-9"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Level"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Level</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Assessment"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Assessment</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Level"> <strong>High</strong>                         </td><td data-label="Assessment"> The proposed server-side preprocessing will immediately and safely mitigate list misinterpretation in table cells.                                                                                      </td></tr><tr><td data-label="Level"> <strong>Preferred long-term solution</strong> </td><td data-label="Assessment"> Implement the proper fix in the renderer or parser so table cell content is treated as literal text.                                                                                                    </td></tr><tr><td data-label="Level"> <strong>Next step</strong>                    </td><td data-label="Assessment"> You can either <strong>(A)</strong> add this safe preprocessor patch to <code>server.py</code> now, or <strong>(B)</strong> move the logic into the Markdown conversion layer (<code>convert.py</code> / renderer pipeline) for a clean, permanent fix. </td></tr></tbody></table></div><div class="row-count">Rows: 3</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>