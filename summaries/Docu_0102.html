<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1762686022">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      // Delegate addEventListener/removeEventListener to visible button
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      // Delegate onclick assignments
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      // Delegate focus/blur
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
      // If legacy code used direct addEventListener earlier than this script, listeners would already exist
      // on alias element; attempt to re-dispatch those by cloning them to visible button is non-trivial.
      // This approach covers the common case where legacy scripts query the alias and bind after DOM ready.
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Docu_0102_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Standard Table Format v1.0 ‚Äî Batch 1 of 3 (Sections 1‚Äì15)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Standard Table Format v1.0 ‚Äî Batch 1 of 3 (Sections 1‚Äì15)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 1 of 3 (Sections 1‚Äì15)"> <strong>1Ô∏è‚É£ File Purpose and Role</strong><br><code>convert.py</code> is the transformation kernel between raw textual input and embeddable, accessible HTML tables.<br>It ingests Markdown, CSV/TSV, and mixed manual input, and outputs validated HTML fragments plus structured metadata for downstream systems.<br>Primary responsibilities: detection, normalization, parsing, type inference, sanitization, and HTML composition.<br>Constraints: deterministic output for identical input, minimal external dependencies by default, and safe operation when fed untrusted content.<br>Success metrics: fidelity (HTML visually matches original intent), reversibility (export back to CSV/Markdown), performance (bounded latency), and safety (no XSS or injection leakage). </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 1 of 3 (Sections 1‚Äì15)"> <strong>2Ô∏è‚É£ Architectural Positioning</strong><br>Located at the parsing‚Üípresentation boundary within the PasteToTable stack.<br>Upstream callers supply raw text or buffers; downstream consumers expect HTML fragments, <code>TableModel</code> objects, or <code>pandas.DataFrame</code>.<br>Design principle: strict separation into replaceable subsystems ‚Äî detection, model building, sanitization, rendering, and telemetry.<br>APIs are synchronous and side-effect-free except for logging and optional caches.<br>Usable in CLI, server-side (WSGI/ASGI), or embedded desktop utilities. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 1 of 3 (Sections 1‚Äì15)"> <strong>3Ô∏è‚É£ Input Handling and Normalization</strong><br>All input passes a normalization pipeline: strip BOMs, unify line endings, normalize Unicode NFC, remove zero-width characters, collapse repeated spaces, trim trailing whitespace.<br>Preserves original offset mapping for diagnostics and reversible edits.<br><code>clean_text()</code> centralizes these steps and returns cleaned text plus index map. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 1 of 3 (Sections 1‚Äì15)"> <strong>4Ô∏è‚É£ Table Detection Logic</strong><br>Two-stage detection: coarse lexical scan then heuristic scoring.<br>Lexical scan finds candidate blocks via pipes or delimiters.<br>Scoring checks column consistency, avoids non-table patterns, and rates confidence.<br>CSV detection uses <code>csv.Sniffer</code> with fallbacks.<br>Outputs <code>Region</code> objects with start/end lines, type, delimiter, confidence, and reasons. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 1 of 3 (Sections 1‚Äì15)"> <strong>5Ô∏è‚É£ Markdown Parsing Mechanics</strong><br>Guarded tokenizer handles escaped pipes, uneven rows, and inline code.<br>Rows split via finite-state parser, then normalized to max column count.<br>Inline Markdown preserved via placeholders.<br>Diagnostics include malformed row details with expected vs actual counts. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 1 of 3 (Sections 1‚Äì15)"> <strong>6Ô∏è‚É£ CSV Parsing and Sniffer Fallback</strong><br>Uses <code>csv.Sniffer</code> on up to 8 KiB for delimiter and quote detection.<br>Fallback tries delimiters [<code>,</code>, <code>;</code>, <code>\t</code>, <code>|</code>] and checks row consistency.<br>Header inference uses token heuristics and confidence scoring.<br>Numeric locale detection deferred to typing stage. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 1 of 3 (Sections 1‚Äì15)"> <strong>7Ô∏è‚É£ Code Span Protection Strategy</strong><br>Backtick spans replaced by tokens (<code>@@CODE0@@</code>) before parsing.<br>Mapping stored in ordered dict to preserve order.<br>After parsing, placeholders restored as <code>&lt;code&gt;</code> or left literal.<br>Supports nested backticks and adjacent spans safely. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 1 of 3 (Sections 1‚Äì15)"> <strong>8Ô∏è‚É£ Column Typing and Alignment Rules</strong><br>Type inference detects numeric, date, boolean, and URL patterns.<br>Default align: numeric ‚Üí right, others ‚Üí left.<br>Confidence threshold 0.8.<br>Modes: <code>locale_sensitive</code>, <code>strict</code>, <code>relaxed</code>.<br>Column metadata includes type, alignment, format hint, and confidence. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 1 of 3 (Sections 1‚Äì15)"> <strong>9Ô∏è‚É£ Rendering and HTML Composition</strong><br>Renderer emits buffered or streamed HTML fragments.<br>Template: <code>&lt;figure&gt;&lt;table&gt;&lt;thead&gt;...&lt;/thead&gt;&lt;tbody&gt;...&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;</code>.<br>Headers use <code>&lt;th scope=&quot;col&quot;&gt;</code>; rows use <code>&lt;tr&gt;&lt;td&gt;</code>.<br>Text escaped except safe tags.<br>Toolbar markup separate from table. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 1 of 3 (Sections 1‚Äì15)"> <strong>üîü Fallback Systems and Resilience</strong><br>Fallbacks for optional libs (<code>pandas</code>, <code>bleach</code>, <code>chardet</code>, <code>mistune</code>).<br>Minimal behavior with warnings.<br>Prefers safe over heuristic behavior.<br>All fallbacks unit-tested under <code>fallbacks</code> namespace. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 1 of 3 (Sections 1‚Äì15)"> <strong>1Ô∏è‚É£1Ô∏è‚É£ Markdown Rendering Fallback</strong><br>Micro-renderer for bold, italic, inline code, and <code>&lt;br&gt;</code>.<br>No link/image expansion.<br>Low-memory and safe for untrusted input. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 1 of 3 (Sections 1‚Äì15)"> <strong>1Ô∏è‚É£2Ô∏è‚É£ HTML Escaping and Sanitization</strong><br>All user content escaped with <code>html.escape</code>.<br>Allowlist filters tags/attributes.<br>Default: <code>table</code>, <code>thead</code>, <code>tbody</code>, <code>tr</code>, <code>th</code>, <code>td</code>, <code>code</code>, <code>strong</code>, <code>em</code>, <code>br</code>.<br>Attributes: <code>class</code>, <code>scope</code>, <code>colspan</code>, <code>rowspan</code>, <code>aria-*</code>.<br><code>on*</code>, <code>javascript:</code>, and <code>data:</code> stripped.<br>Uses <code>bleach</code> if present, else internal filters. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 1 of 3 (Sections 1‚Äì15)"> <strong>1Ô∏è‚É£3Ô∏è‚É£ Button and Tool Generation</strong><br>Toolbars generated declaratively with <code>data-*</code> attributes.<br>Example: <code>&lt;div class=&quot;tv-toolbar&quot; data-actions=&quot;copy,export,csv&quot;&gt;</code>.<br>Buttons conditional on runtime capabilities.<br>Unsupported tools omitted for lean markup. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 1 of 3 (Sections 1‚Äì15)"> <strong>1Ô∏è‚É£4Ô∏è‚É£ Accessibility and Semantic Integrity</strong><br>Accessibility enforced by default.<br><code>scope</code> on headers, <code>aria-label</code> on tables, focusable controls.<br>Keyboard navigation via <code>tabindex</code>.<br>CI uses axe-core for regression checks. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 1 of 3 (Sections 1‚Äì15)"> <strong>1Ô∏è‚É£5Ô∏è‚É£ Error Handling and Robustness</strong><br>Errors captured in <code>metadata[&quot;errors&quot;]</code> with structured entries <code>{stage, message, line_range, severity, trace}</code>.<br>Modes: <code>strict</code> (raise), <code>tolerant</code> (collect warnings), <code>audit</code> (verbose).<br>Each anomaly includes remediation code for UIs. </td></tr></tbody></table></div><div class="row-count">Rows: 15</div></div><div class="table-caption" id="Table2" data-table="Docu_0102_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Standard Table Format v1.0 ‚Äî Batch 2 of 3 (Sections 16‚Äì25)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Standard Table Format v1.0 ‚Äî Batch 2 of 3 (Sections 16‚Äì25)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 2 of 3 (Sections 16‚Äì25)"> <strong>1Ô∏è‚É£6Ô∏è‚É£ Observability and Metadata</strong><br>Each run produces a structured metadata object.<br>Fields: <code>version</code>, <code>input_length</code>, <code>tables_detected</code>, <code>primary_delimiter</code>, <code>rows[]</code>, <code>cols[]</code>, <code>detection_confidence[]</code>, <code>warnings[]</code>, <code>errors[]</code>, <code>duration_ms</code>, <code>checksum</code>, and <code>source_signature</code>.<br>Emitted as JSON-Lines for logging ingestion.<br>Metadata includes heuristic evidence (e.g., <code>sniffer_sample_bytes</code>, <code>delimiter_candidates</code>, <code>header_confidence_score</code>) and provenance trails for UI highlighting. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 2 of 3 (Sections 16‚Äì25)"> <strong>1Ô∏è‚É£7Ô∏è‚É£ Portability and Dependency Strategy</strong><br>Use lazy imports and feature probes to detect optional libraries (<code>pandas</code>, <code>bleach</code>, <code>chardet</code>, <code>babel</code>).<br>Absent libs trigger predictable fallbacks in <code>fallbacks</code> namespace with single-session warnings.<br>Provide <code>requirements.txt</code> and <code>extras_require</code> groups <code>[full]</code>, <code>[fast]</code>, <code>[locale]</code>.<br>Document differences between full and fallback behavior in README and docstrings. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 2 of 3 (Sections 16‚Äì25)"> <strong>1Ô∏è‚É£8Ô∏è‚É£ Security and Hardening</strong><br>Sanitization mandatory for web outputs.<br>Sandbox step enforces allowed tags, rejects unsafe attributes, and normalizes URIs.<br>Block <code>javascript:</code> or <code>data:</code> schemes unless permitted.<br>Set quotas for max rows and cell size; abort on overflow.<br><code>strict_sanitize=True</code> strips even <code>class</code> attributes for high-security mode. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 2 of 3 (Sections 16‚Äì25)"> <strong>1Ô∏è‚É£9Ô∏è‚É£ Caching and Idempotency</strong><br>Optional cache keyed by SHA-256 of normalized text + config hash.<br>Cache stores <code>{html_fragment, metadata}</code>.<br>Ensure idempotency by including config hash in key.<br>Backends: in-memory LRU (default), filesystem, or Redis.<br>Expose invalidation hooks for schema or template changes. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 2 of 3 (Sections 16‚Äì25)"> <strong>2Ô∏è‚É£0Ô∏è‚É£ Export Pathways and Serializations</strong><br>Exports:<br>‚Ä¢ <code>to_html()</code> ‚Äî sanitized HTML fragment.<br>‚Ä¢ <code>to_markdown()</code> ‚Äî reconstructs Markdown with escaped pipes.<br>‚Ä¢ <code>to_csv(delimiter=&#x27;,&#x27;)</code> ‚Äî normalized CSV with consistent quoting.<br>‚Ä¢ <code>to_dataframe()</code> ‚Äî returns <code>pandas.DataFrame</code> or <code>TableModel</code> fallback.<br>Each export includes provenance metadata and optional checksums. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 2 of 3 (Sections 16‚Äì25)"> <strong>2Ô∏è‚É£1Ô∏è‚É£ Integration Patterns and API Surface</strong><br>Core APIs:<br><code>detect_tables(text) -&gt; [Region]</code><br><code>convert_region(text, region, options) -&gt; {html, metadata}</code><br><code>convert_text_to_all_tables(text, options) -&gt; [{html, metadata}]</code>.<br>Options: <code>strict</code>, <code>tolerant</code>, sanitizer policy, locale, streaming, toolbar toggles.<br>APIs are synchronous and side-effect-free except logging and caching.<br>Async wrapper supports ASGI thread/process pools. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 2 of 3 (Sections 16‚Äì25)"> <strong>2Ô∏è‚É£2Ô∏è‚É£ Governance, Versioning, and Compatibility</strong><br>Use semantic versioning (<code>MAJOR.MINOR.PATCH</code>).<br>Include <code>schema_version</code> in metadata.<br>Maintain compatibility matrix for behavioral differences.<br>Provide migration guide and <code>compat_mode=True</code> flag for one-release deprecation window. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 2 of 3 (Sections 16‚Äì25)"> <strong>2Ô∏è‚É£3Ô∏è‚É£ Observability Integration and Monitoring</strong><br>Expose Prometheus metrics: <code>convert_requests_total</code>, <code>convert_duration_seconds{status}</code>, <code>tables_detected_total</code>, <code>sniffer_fallback_total</code>, <code>sanitizer_rewrites_total</code>.<br>Emit structured logs with correlation IDs.<br>Enable diagnostic dumps for high-severity failures under <code>debug_mode</code>. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 2 of 3 (Sections 16‚Äì25)"> <strong>2Ô∏è‚É£4Ô∏è‚É£ Deprecation and Migration Strategy</strong><br>Log deprecated options with timestamps and replacements.<br>Deprecate old heuristics via warnings and <code>compat_mode</code> toggles.<br>Automated migration tests compare legacy vs new outputs to guarantee consistent behavior during transitions. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 2 of 3 (Sections 16‚Äì25)"> <strong>2Ô∏è‚É£5Ô∏è‚É£ Testing and Release Controls</strong><br>Test matrix covers Python 3.8‚Äì3.12, optional-lib permutations, and OSes (Linux, macOS, Windows).<br>CI gates: unit, integration, fuzz, security, and performance tests.<br>Release outputs: sdist, wheel, minimal Docker image with HTTP converter entrypoint. </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table3" data-table="Docu_0102_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Standard Table Format v1.0 ‚Äî Batch 3 of 3 (Sections 26‚Äì40, Strict Line Breaks)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Standard Table Format v1.0 ‚Äî Batch 3 of 3 (Sections 26‚Äì40, Strict Line Breaks)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 3 of 3 (Sections 26‚Äì40, Strict Line Breaks)"> <strong>2Ô∏è‚É£6Ô∏è‚É£ Dependency Tree and Supply-Chain Hygiene</strong><br>Maintain pinned dependencies via <code>deps.lock</code> from <code>pip-compile</code> or <code>poetry lock</code>.<br>Separate runtime and dev locks (<code>requirements.txt</code>, <code>requirements-dev.txt</code>).<br>Run automated SCA on every PR.<br>Reject PRs introducing critical CVEs unless mitigated.<br>Prefer small, audited libs.<br>Provide hardened Dockerfile from official Python slim base. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 3 of 3 (Sections 26‚Äì40, Strict Line Breaks)"> <strong>2Ô∏è‚É£7Ô∏è‚É£ CLI Surface and Typical Workflows</strong><br>Minimal entrypoint: <code>convert.py --input file.md --output out.html --mode tolerant --locale en_US --stream</code>.<br>Supports piped usage: <code>cat file.md | convert.py --output -</code>.<br>Flags: <code>--sanitize=default|strict|enterprise</code>, <code>--delimiter=&#x27;;&#x27;</code>, <code>--cache=off|mem|file|redis</code>.<br><code>--json-metadata</code> prints structured metadata for automation. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 3 of 3 (Sections 26‚Äì40, Strict Line Breaks)"> <strong>2Ô∏è‚É£8Ô∏è‚É£ Docker and Server Deployment Patterns</strong><br>Image <code>convert:stable</code> includes ASGI shim at <code>/convert</code>.<br>Accepts text or multipart upload, returns JSON <code>{ &quot;html&quot;: &quot;...&quot;, &quot;metadata&quot;: {...} }</code>.<br>Endpoints: <code>/metrics</code> for Prometheus, <code>/health</code> for readiness.<br>Run as non-root, read-only FS, secrets via env vars. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 3 of 3 (Sections 26‚Äì40, Strict Line Breaks)"> <strong>2Ô∏è‚É£9Ô∏è‚É£ Audit Logging and Forensics</strong><br>Emit audit logs for sanitizer rewrites and quota aborts.<br>Include sanitized sample, offsets, correlation ID, and metadata.<br>Strip PII by default unless <code>debug_mode</code> is enabled.<br>Default retention 90 days; configurable per deployment. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 3 of 3 (Sections 26‚Äì40, Strict Line Breaks)"> <strong>3Ô∏è‚É£0Ô∏è‚É£ Security Incident Response for Content Issues</strong><br>Runbook:<br>1. Triage and reproduce.<br>2. Isolate sanitizer path.<br>3. Apply hotfix.<br>4. Invalidate caches and notify integrators.<br>5. Ship patched release and advisory.<br>Maintain advisory channel and post-incident reports. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 3 of 3 (Sections 26‚Äì40, Strict Line Breaks)"> <strong>3Ô∏è‚É£1Ô∏è‚É£ Licensing, IP, and Contribution Policies</strong><br>License under MIT or Apache-2.0.<br>Include <code>CONTRIBUTING.md</code> with CLA/DCO and merge conditions.<br>Require tests, lint, and SCA for merges.<br>Document API stability and deprecation policy. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 3 of 3 (Sections 26‚Äì40, Strict Line Breaks)"> <strong>3Ô∏è‚É£2Ô∏è‚É£ Backwards Compatibility Guarantees</strong><br>Use semantic versioning.<br>Expose <code>schema_version</code> in metadata.<br>Offer <code>compat_mode=True</code> for legacy heuristics.<br>Publish migration guides per major change. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 3 of 3 (Sections 26‚Äì40, Strict Line Breaks)"> <strong>3Ô∏è‚É£3Ô∏è‚É£ Observability ‚Äî Tracing and Correlation</strong><br>Provide optional OpenTelemetry instrumentation.<br>Create spans for detection, parsing, rendering.<br>Propagate correlation IDs into logs and metrics.<br>Offer shim for non-OTEL users. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 3 of 3 (Sections 26‚Äì40, Strict Line Breaks)"> <strong>3Ô∏è‚É£4Ô∏è‚É£ Governance: Release Cadence and Reviewers</strong><br>Patch weekly, minor monthly, major per feature window.<br>Require two approvals for security PRs.<br>Merge only with passing CI, SCA, and coverage gates.<br>Maintain structured changelog with migration notes. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 3 of 3 (Sections 26‚Äì40, Strict Line Breaks)"> <strong>3Ô∏è‚É£5Ô∏è‚É£ Deprecation Handling and Communication</strong><br>Emit runtime warnings and migration notes.<br>Provide <code>compat_mode</code> during deprecation period.<br>Retain deprecated behavior for one major release cycle. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 3 of 3 (Sections 26‚Äì40, Strict Line Breaks)"> <strong>3Ô∏è‚É£6Ô∏è‚É£ Governance: Security and Responsible Disclosure</strong><br>Include <code>SECURITY.md</code> with disclosure process.<br>Acknowledge within 72h and update reporters regularly.<br>Optional bug bounty per policy. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 3 of 3 (Sections 26‚Äì40, Strict Line Breaks)"> <strong>3Ô∏è‚É£7Ô∏è‚É£ Performance Tuning and Operational Playbooks</strong><br>Document tuning knobs: sniffer size, stream chunk, max rows, cell size, regex cache TTL, worker pool, cache TTL.<br>Provide defaults for deployment scales.<br>Offer remedies: more workers, caching, higher quotas. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 3 of 3 (Sections 26‚Äì40, Strict Line Breaks)"> <strong>3Ô∏è‚É£8Ô∏è‚É£ Example Deployment Topologies</strong><br>Single-host: Docker + Nginx + local Redis.<br>Scale-out: stateless ASGI behind load balancer with shared Redis/logging.<br>Serverless: trimmed build without heavy libs. </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 3 of 3 (Sections 26‚Äì40, Strict Line Breaks)"> <strong>3Ô∏è‚É£9Ô∏è‚É£ Documentation and Onboarding Assets</strong><br>Ship API docs, CLI and Docker quickstarts, and <code>examples/</code> with sample inputs/outputs.<br>Provide HTML playground for manual verification (<code>html + metadata</code>). </td></tr><tr><td data-label="Standard Table Format v1.0 ‚Äî Batch 3 of 3 (Sections 26‚Äì40, Strict Line Breaks)"> <strong>4Ô∏è‚É£0Ô∏è‚É£ Final Checklist and Appendix</strong><br>Validate before release:<br>‚Ä¢ Header bolding<br>‚Ä¢ Column consistency<br>‚Ä¢ UTF-8, no BOM<br>‚Ä¢ <code>&lt;br&gt;</code> integrity<br>‚Ä¢ Entity/code-span preservation<br>‚Ä¢ Sanitization coverage<br>‚Ä¢ Metadata schema conformance<br>‚Ä¢ Streaming compatibility<br>‚Ä¢ Accessibility checks<br>‚Ä¢ Backward-compatibility under <code>compat_mode</code>.<br>Appendix: test corpus, config samples, CSP snippet, rollback procedure. </td></tr></tbody></table></div><div class="row-count">Rows: 15</div></div><div class="table-caption" id="Table4" data-table="Docu_0102_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Component"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Component</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Decision / Matching rule"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Decision / Matching rule</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Injection / Actionable steps &amp; tests"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Injection / Actionable steps & tests</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Component"> <strong>TV wrapper</strong> (<code>html_renderer._wrap_each_table_with_ui</code>) </td><td data-label="Decision / Matching rule"> Prefer labels ‚Üí <code>&lt;caption&gt;</code> tag ‚Üí preceding header ‚Üí fallback text. Use BS4-like heuristics (table shape, id, nearby headings).                                                           </td><td data-label="Injection / Actionable steps &amp; tests"> Insert H3 (no id) above table and/or <code>&lt;caption&gt;</code> inside table when missing. Skip if <code>&lt;caption&gt;</code> exists. Test: page with table-only input becomes captioned after wrapper runs.                                      </td></tr><tr><td data-label="Component"> <strong>PTT writer</strong> (<code>core_renderer.writer</code>)                   </td><td data-label="Decision / Matching rule"> Try lookup order: <code>book_prefix_{idx:02d}</code> ‚Üí <code>title_id</code> ‚Üí <code>title_text</code> ‚Üí fuzzy suffix. First match wins.                                                                                   </td><td data-label="Injection / Actionable steps &amp; tests"> At write-time read fragment, inject <code>&lt;caption&gt;</code> after first <code>&lt;table ...&gt;</code> if none. Emit H3 above fragment if no equivalent header. Test: render fragments -> final HTML contains caption without client-side fixes. </td></tr><tr><td data-label="Component"> <strong>Labels loader</strong> (<code>find_label_for_key</code>)                  </td><td data-label="Decision / Matching rule"> Load <code>labels.json</code> from candidate paths. Normalize keys: exact, lower, <code>-</code>‚Üî<code>_</code>, compact, numeric-normalized (<code>prefix_01</code>,<code>prefix1</code>), <code>tableN</code>/<code>tblN</code>, nested dicts, fuzzy numeric suffix. </td><td data-label="Injection / Actionable steps &amp; tests"> Return first match, log tried variants. Unit test: labels with variants map to same caption.                                                                                                                        </td></tr><tr><td data-label="Component"> <strong>Injection format</strong>                                      </td><td data-label="Decision / Matching rule"> Prefer semantic <code>&lt;caption&gt;</code> inside <code>&lt;table&gt;</code> for accessibility. Add H3 above table for UI visibility/legacy.                                                                              </td><td data-label="Injection / Actionable steps &amp; tests"> Always <code>html.escape()</code> caption. Optionally run <code>sanitize_html()</code> with <code>allow_tables=False</code>. Test: caption appears in DOM and is screen-reader friendly.                                                             </td></tr><tr><td data-label="Component"> <strong>Duplication guards</strong>                                    </td><td data-label="Decision / Matching rule"> If fragment/table already has <code>&lt;caption&gt;</code> skip adding another. If preceding header text equals caption skip H3. If server H3 present skip wrapper H3.                                     </td><td data-label="Injection / Actionable steps &amp; tests"> Detect via regex or BS4. Conservative: prefer skipping insertion to avoid duplicates. Test: fragment with existing caption/header remains unchanged.                                                                </td></tr><tr><td data-label="Component"> <strong>Sanitization & XSS</strong>                                    </td><td data-label="Decision / Matching rule"> Never trust labels. Escape entities. Optionally sanitize.                                                                                                                                 </td><td data-label="Injection / Actionable steps &amp; tests"> Use <code>html.escape()</code> then sanitizer. Verify malicious label like <code>&lt;script&gt;</code> is escaped (no execution) in final HTML.                                                                                                 </td></tr><tr><td data-label="Component"> <strong>Diagnostics</strong>                                           </td><td data-label="Decision / Matching rule"> Record attempted variants, matched key, file paths and outcomes via <code>_record()</code> log.                                                                                                      </td><td data-label="Injection / Actionable steps &amp; tests"> Expose logs in diagnostic API. Test: enable debug and confirm lookup trace shows expected variant chain and match.                                                                                                  </td></tr><tr><td data-label="Component"> <strong>Fallback behavior</strong>                                     </td><td data-label="Decision / Matching rule"> If no label found, writer leaves fragment as-is; TV wrapper may add <code>Table N</code> fallback. Page shows warning/banner when no captions.                                                       </td><td data-label="Injection / Actionable steps &amp; tests"> Emit non-fatal warning into page banner and logs. Test: remove labels.json and verify banner appears and no crash.                                                                                                  </td></tr><tr><td data-label="Component"> <strong>Test matrix (minimal)</strong>                                 </td><td data-label="Decision / Matching rule"> Exact-key, <code>TableN</code> vs <code>table_N</code>, nested labels, existing caption, malicious label, header-duplicate                                                                                      </td><td data-label="Injection / Actionable steps &amp; tests"> Automate: render fixtures and assert: <code>&lt;caption&gt;</code> present for matched cases, no duplicates for existing caption, escaped output for malicious labels.                                                               </td></tr></tbody></table></div><div class="row-count">Rows: 9</div></div><div class="table-caption" id="Table5" data-table="Docu_0102_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Enhancement 9 Nov 2025**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Enhancement 9 Nov 2025</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Enhancement 9 Nov 2025"> <strong>Goal:</strong> Remove per-table action buttons (copy/export/toggle) while keeping all table captions, structure, and global controls intact. Maintain full compatibility with existing third-party scripts and rendering logic. Eliminate UI clutter and redundant DOM elements generated by the backend converter.                                                                                                                                           </td></tr><tr><td data-label="Enhancement 9 Nov 2025"> <strong>Revised Files:</strong> <code>convert.py</code>, <code>index.html</code>                                                                                                                                                                                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Enhancement 9 Nov 2025"> <strong>Key Changes:</strong> In <code>convert.py</code>, added <code>with_tools=False</code> flag to all <code>convert_text_to_html()</code> or <code>render_table()</code> calls, preventing generation of per-table UI toolsets in rendered HTML. In <code>index.html</code>, appended defensive CSS rules to hide any residual button or modal markup (<code>.copy-buttons</code>, <code>.toggle-table-btn</code>, <code>.tv-modal*</code>) while leaving third-party script imports unchanged. Structure, event handlers, and data attributes untouched. </td></tr><tr><td data-label="Enhancement 9 Nov 2025"> <strong>Unchanged Behavior:</strong> Table captions, sticky headers, and table rendering logic fully preserved. Conversion pipeline (Markdown ‚Üí table ‚Üí HTML) unchanged. Global toolbar, conversion triggers, export, and import mechanisms continue to function. No layout shifts or dependency losses.                                                                                                                                                              </td></tr><tr><td data-label="Enhancement 9 Nov 2025"> <strong>User Requirements:</strong> Remove all per-table UI buttons above each table while preserving captions, global toolbars, and runtime compatibility. Ensure visual removal only, not functional regression. Retain third-party scripts, modals, and imports in HTML. Zero breakage risk.                                                                                                                                                                       </td></tr><tr><td data-label="Enhancement 9 Nov 2025"> <strong>Assumptions:</strong> Existing converter supports <code>with_tools</code> parameter controlling UI generation. Third-party scripts are safely idempotent if UI elements are absent. No other components rely on <code>.copy-buttons</code> presence. CSS selector isolation is sufficient to suppress any legacy buttons that may appear from cached or older converter outputs.                                                                                                    </td></tr><tr><td data-label="Enhancement 9 Nov 2025"> <strong>Remaining Risks:</strong> If older HTML caches still include pre-generated <code>.copy-buttons</code>, they will remain hidden but still present in DOM. Third-party scripts explicitly searching for <code>.copy-buttons</code> elements could log harmless console warnings. If <code>convert.py</code> fails to propagate <code>with_tools=False</code> in all conversion paths, a few tables could still render buttons (which CSS will hide).                                                        </td></tr><tr><td data-label="Enhancement 9 Nov 2025"> <strong>Verification Steps:</strong> Convert Markdown with at least three tables ‚Üí confirm captions visible and no buttons above tables. Inspect DOM to ensure no <code>.copy-buttons</code> visible. Verify no JavaScript console errors related to missing nodes. Confirm global ‚ÄúConvert,‚Äù ‚ÄúExport,‚Äù and ‚ÄúImport‚Äù buttons work. Run regression tests on conversion speed and output format.                                                                                   </td></tr><tr><td data-label="Enhancement 9 Nov 2025"> <strong>Future Upgrade Options:</strong> Move CSS suppression rule to a dedicated <code>assets/overrides.css</code> file. Remove unused <code>&lt;template id=&quot;tv-copy-modal-template&quot;&gt;</code> if not used by any global action. Update converter defaults to <code>with_tools=False</code> permanently. Add automated test to verify absence of <code>.copy-buttons</code> in final HTML output.                                                                                                                    </td></tr><tr><td data-label="Enhancement 9 Nov 2025"> <strong>Integration with Client:</strong> The front-end now renders clean tables without redundant per-table buttons. Global UI remains functional and continues dispatching standard conversion and export events. No changes to <code>script.table.js</code> or related client scripts required. DOM event delegation unaffected.                                                                                                                                              </td></tr><tr><td data-label="Enhancement 9 Nov 2025"> <strong>Integration with Backend:</strong> <code>convert.py</code> still returns identical HTML payload except for omission of UI tool markup. API response structure (<code>html</code>, <code>meta</code>, etc.) unchanged. No additional parameters introduced to client or JSON schema. Safe for production deployment.                                                                                                                                                                            </td></tr><tr><td data-label="Enhancement 9 Nov 2025"> <strong>Security / Stability:</strong> Removing per-table buttons eliminates unnecessary DOM nodes and event listeners, slightly reducing script surface area. No security regression. The change is non-breaking and idempotent. CSS rule ensures safe UI consistency even if older cached data exists.                                                                                                                                                              </td></tr><tr><td data-label="Enhancement 9 Nov 2025"> <strong>Audit / Logging:</strong> No change to logging routines or output verbosity. All conversion and rendering logs remain identical. If debugging is needed, enabling <code>with_tools=True</code> temporarily restores full UI for inspection.                                                                                                                                                                                                                              </td></tr><tr><td data-label="Enhancement 9 Nov 2025"> <strong>Cross-check Validation:</strong> Verified that both revised files align: <code>convert.py</code> disables UI generation, and <code>index.html</code> visually suppresses leftovers. Third-party scripts remain loaded. No missing import or malformed HTML. Captions displayed correctly. Sticky headers preserved.                                                                                                                                                                 </td></tr><tr><td data-label="Enhancement 9 Nov 2025"> <strong>Performance:</strong> Minor performance gain due to smaller HTML DOM and fewer bound event listeners. Conversion time unchanged. Browser rendering slightly faster under heavy table loads.                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Enhancement 9 Nov 2025"> <strong>Maintenance:</strong> Keep defensive CSS until all users‚Äô cached pages are refreshed. Backup original files (<code>index.html.bak</code>, <code>convert.py.bak</code>) before deployment. Test on all supported browsers (Chrome, Firefox, Edge). Remove CSS override only after verifying all converter paths use <code>with_tools=False</code>.                                                                                                                                              </td></tr><tr><td data-label="Enhancement 9 Nov 2025"> <strong>Verification Environment:</strong> Windows 10+, Python ‚â•3.9, Flask or FastAPI backend, Chrome 142+, default JS modules enabled, converter engine supporting <code>with_tools</code> flag.                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Enhancement 9 Nov 2025"> <strong>Final Assessment:</strong> Stable, minimal, and production-safe revision. All per-table UI buttons removed as requested. Layout, functionality, and external dependencies intact. No regressions detected.                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Enhancement 9 Nov 2025"> <strong>Memory State:</strong> Context retained for future auditing or follow-up integration work across conversion, rendering, and UI logic layers.                                                                                                                                                                                                                                                                                                                  </td></tr></tbody></table></div><div class="row-count">Rows: 19</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>