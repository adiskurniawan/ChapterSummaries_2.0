<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1768716775">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Docu_0170_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Accruals Policy — Multi-Funder NGOs"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Accruals Policy — Multi-Funder NGOs</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Purpose</strong><br>Provide a consistent, auditable framework for recognising, allocating, reversing and reporting accruals that affect grant budgets, restricted funds, and consolidated financial statements. The policy supports transparent donor accounting, reproducible month-end close and a documented audit trail for internal and external reviewers. Examples: (a) country office records monthly utility accruals for program sites to ensure P&L reflects service consumption even if invoices arrive late; (b) pooled procurement accrual recorded to a holding fund pending donor allocation confirmation; (c) year-end accruals recorded in detail for audit pack and schedule that show source documents and calculation steps.<br><strong>Expanded guidance</strong><br>- Objective: ensure uniform treatment across entities, reduce manual errors, and provide a deterministic mapping from request → posted journal → clearance. Include this policy as an annex to the month-end SOP and link to ERP posting templates and the AccrualRequest form.<br>- One-line acceptance test: every material accrual must be traceable from AccrualRequest → supporting evidence → posted JE → clearance invoice with an unbroken audit trail. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Scope</strong><br>Applies to all program and operational accruals across the organisation, including project-level, pooled and corporate overhead accruals. Covers preparer, reviewer and approver activities, GL posting conventions, FX treatment and reconciliation to AP. Assumes accrual-basis financial reporting. Examples: (a) staff travel delivered in December but invoiced in January—accrual created in December; (b) repair services delivered at sub-office at period end—captured in accrual register and reflected in donor reports; (c) monthly deferred grant expense recognition for multi-period services.<br><strong>Expanded guidance</strong><br>- Entities: country offices, sub-offices, regional hubs and HQ. Specify which legal entity books the accrual (entity that received the service or that has the contractual liability).<br>- Materiality and consolidation thresholds must be harmonised across entities to ensure comparable reporting. Document local thresholds in LocalAppendix sheets if they differ due to currency or operational scale. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Definitions</strong><br>Accrual — An amount recorded to recognise goods or services received, or an obligation incurred, where an invoice has not been received by the reporting date. Example: unpaid electricity usage for the month. <br>Reversing accrual — A routine, period-end estimate posted with a scheduled reversal in the subsequent period to prevent duplicate expense recognition. Example: estimated office utilities accrual reversed next month when invoice posts. <br>Non-reversing accrual — An accrual recorded for definitive liabilities, multi-period obligations, or where donor reporting requires retention in the original period. Example: litigation settlement accrual that remains until settled. <br>Holding/clearing accrual — Temporary booking to a holding fund used when donor allocation is uncertain pending confirmation. Example: large pooled procurement ordered centrally where donor beneficiary split is unknown.<br><strong>Expanded guidance (additional terms)</strong><br>- Prepayment — cash paid in advance for goods/services delivered in a later period (classified as asset).<br>- Cut-off evidence — the minimal acceptable proof to support recognition (GRN/acceptance, service completion note, timesheet, signed contract clause).<br>- RequestID — unique identifier (format recommendation: ACC-YYYYMM-####). Use RequestID in all related documents and journal narratives. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Policy statements — Recognition, Allocation, Reversal, Materiality</strong><br>Recognition<br>Record accruals when goods/services are received or an obligation is incurred, supported by evidence (GRN, service completion note, timesheet, contract clause) and using the grant COA coding required by donors. Examples: (a) GRN from logistics confirming receipt of medical supplies; (b) signed consultant timesheet confirming days worked; (c) delivery note from transport provider with delivered quantity and date. <br>Allocation<br>Allocate accruals to donor funds in order of precedence: donor contract instruction; signed budget or grant agreement; pre-approved allocation matrix; standard allocation formula (for example: % effort, direct cost driver). Document allocation rationale on every request. Examples: (a) explicit donor clause: telecom cost split 70/30 recorded accordingly; (b) allocation matrix: overheads split by FTE weighting across projects; (c) formula: allocate vehicle fuel by mileage logged per project. <br>Reversal<br>Default treatment for routine period-end estimates is to post a reversing journal on the first working day of the subsequent period. Non-reversing treatment is permitted for definitive legal/contractual liabilities or when donor reporting prohibits reversal; exception approvals and rationale must be retained with the posted journal. Examples: (a) routine travel per diem accrual = reversing; (b) final settlement accrual for vendor dispute = non-reversing and documented. <br>Materiality<br>Finance leadership will publish a materiality threshold (currency and/or % of monthly burn). Accruals immaterial under the threshold need not be booked if documented and approved. Review threshold at least annually. Examples: (a) USD 200 threshold for local field offices; (b) 0.25% of monthly program burn for major country offices; (c) automatic rounding rules for micro-accruals below threshold.<br><strong>Expanded guidance</strong><br>- Evidence matrix: provide table listing acceptable evidence per accrual type (services vs goods vs salary vs travel) and minimum supporting items (e.g., GRN + PO for goods; timesheet + contract for consultants).<br>- Allocation override log: when allocation deviates from matrix, record reason, approver and related agreement reference. This log feeds Exceptions and Audit_Log.<br>- Materiality governance: specify who can authorise aggregation of immaterial items (e.g., Country FD can approve aggregation up to local threshold; above that require Regional FD). </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Procedures (month-end) — Full workflow</strong><br>Cut-off confirmation — Program managers confirm goods/services received up to reporting date and initiate an Accrual Request Form with supporting evidence links. Example: program manager ticks receipt checklist and uploads GRN and signed delivery note. <br>Intake validation — Finance checks sufficiency of evidence, validates GL/project/donor codes and returns incomplete requests with a tracking ID. Example: finance returns request asking for missing timesheet or PO number and logs tracking ID ACC-2025-00123. <br>Allocation calculation — Apply allocation rule and compute local currency amount; convert to reporting currency using period-end FX rate from FX_Rates and record FX source and timestamp. Example: convert LKR amounts to USD using June 30 closing rate from Treasury feed and record rate 1 USD = 320 LKR with timestamp. <br>Journal preparation — Create accrual journal with unique RequestID and narrative “Accrual — [Vendor/Service] — YYYY-MM — ReqID”; attach supporting documents; set ReversingFlag as applicable. Example: JE0001234 created with clear memo and link to evidence stored in SharePoint or the workbook. <br>Approval — Route per Delegation of Authority; capture approver name, role and timestamp; approvals must be immutable. Example: manager approves via electronic signature system; approval captured in Audit_Log. <br>Posting and register update — Post journal to ledger and update Accrual Register with status = Posted and PostedJERef. Example: Register updated with PostedJERef = ERP-2025-06-JE0001234; ageing calculation triggered. <br>Invoice matching and clearance — On invoice receipt match to accrual: if accrual was reversed, post invoice to expense and clear reversal; if accrual not reversed, clear accrual against AP; book FX variances at clearance and document reconciling differences. Example: invoice invo-987 matched to RequestID; difference of 2% coded to project contingency or overhead per policy. <br>Reporting — Produce accrual schedule (by donor, project, consolidated) with narrative for material items and include in month-end pack. Example: month-end pack includes top-10 accruals by value with attached evidence and explanation.<br><strong>Expanded guidance — step-by-step checklists</strong><br>- Pre-close 7-days checklist (to be run by program managers): confirm receipt, upload GRN/acceptance, estimate if invoice missing, propose allocation, set ReversingFlag.<br>- Finance intake checklist: verify evidence, check PO match, compute accrual amount and currency conversion formula, validate donor allocation rules.<br>- Journal checklist: narrative, RequestID, exact GL lines, reversing indicator, supporting doc links, approver signature. Retain a signed list of journals for audit.<br>- Post-close validation: run register ↔ GL reconciliation and top-10 checks; escalate variances above materiality. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Allocation examples</strong><br>Example 1 — Shared salary: apportion monthly salary by agreed donor percentages and record allocation note linked to RequestID. Worked numeric example: Monthly salary 5,000 LC; Project A 60% → 3,000 LC to Donor A, Project B 40% → 2,000 LC to Donor B; record RequestID and supporting timesheets. <br>Example 2 — Pooled procurement: book full amount to Holding fund, create open-item and allocate once donor shares confirmed; update register monthly. Worked numeric example: Procurement invoice 50,000 LC booked to Holding Fund (Clearing); once donor split confirmed (Donor A 70%, Donor B 30%) create allocation journals: 35,000 LC & 15,000 LC respectively and clear open-item. <br>Example 3 — Overhead allocation by activity driver: rent 10,000 LC allocated by floor area or headcount across projects with worked allocation table saved in AllocationDetail.<br><strong>Expanded guidance — additional worked examples</strong><br>- Example 4: Consultant month-end accrual where timesheets available but final invoice pending: accumulate approved timesheets × daily rate; accrual = sum(approved days × rate) less any advance payments. Post reversing accrual if vendor invoice expected next month. <br>- Example 5: Service delivered across donors with partial contract-based allocation: apply contract formula (e.g., activity-based %). Document contract clause reference in AllocationNotes. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>FX treatment</strong><br>Convert accruals to reporting currency at the official period-end closing rate recorded in FX_Rates. On clearance, recognise FX gains/losses to finance income/expense per policy and disclose material FX effects; retain FX source and timestamp. Examples: (a) accrual in local currency posted at closing rate 31/03; invoice paid next month at weaker currency → recognise FX loss to FXVariance account and note impact in month-end commentary; (b) for donor reports in donor currency, translate at donor-requested rate and include reconciliation to group reporting currency in disclosure schedule.<br><strong>Expanded guidance</strong><br>- FX handling rules: (1) use period-end closing rate for balance-sheet accruals; (2) use average rate for P&L allocations only where policy permits; (3) when invoice posts in different currency, compute clearance FX gain/loss as: (InvoiceAmount_ReportCurrency at invoice date rate) − (AccrualAmount_ReportCurrency at accrual rate). Document the calculation in clearance notes.<br>- FX documentation: store rate source (vendor feed or central treasury), API file or manual entry, and approver for any overrides. Keep FX revaluation schedule in Reports_Output. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Reversal decision matrix</strong><br>Reverse when accrual is a routine estimate for suppliers, salaries, utilities or travel where timing is the sole issue. Examples: (a) monthly utilities estimate reversed next month; (b) expected small petty cash expense estimated and reversed once receipts processed. <br>Do not reverse when accrual documents a definitive legal/contractual liability or when donor reporting requires recognition to remain in the original period. Examples: (a) indemnity payment due under a signed settlement; (b) grant-specific in-period expense required by donor. <br>Decision checklist — evidence present; estimate reliable; reversal does not contravene donor/statutory rules; DoA approval captured for non-standard cases. Example checklist entries: Evidence=true, Material=false, DonorRule=OK, Approver=Finance Director.<br><strong>Expanded guidance — decision matrix table (summary)</strong><br>- Routine estimate (utilities, travel, payroll accruals) → Reversing (auto).<br>- Accrual for legal/settlement/definitive liability → Non-reversing (manual monitoring).<br>- Donor-specific retention required (contract clause) → Non-reversing.<br>- If reversing accrual remains outstanding after 3 months, escalate and investigate: possible invoice missing, dispute, or error — move to Exceptions. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Controls and audit trail — Forms, Register, Audit Log</strong><br>Accrual Request Form fields: RequestID, RequestDate, Period(YYYY-MM), VendorName, VendorID, Description, Amount_Local, Currency, FXRate(PeriodEnd), Amount_ReportCurrency, ProjectCode, DonorCode(s) with % split, AllocationMethod, AllocationDetail, SupportingDocsLink(s), PreparerName, PreparerDate, ApproverName(s), ApproverDate(s), ReversingFlag(Y/N), ScheduledReversalDate, Status, PostedJERef, Notes. Example filled form row provided as sample: RequestID=ACC-2025-06-001, VendorName=Acme Supplies, Amount_Local=15000, Currency=KES, FXRate=0.0082, Amount_ReportCurrency=123.00, ProjectCode=PRJ-100, DonorCode=DN-A(60%), DN-B(40%), AllocationMethod=BudgetSplit, PreparerName=J.Smith, Approver=F. Gomez. <br>Accrual Register schema: RequestID, Period, Project, Donor, Amount_Local, Currency, Amount_ReportCurrency, FXRate, Status, PostedJERef, MatchedInvoiceRef, ClearedDate, AgingDays, CreatedDate, CreatedBy, ApprovedDate, ApprovedBy, ResolutionNotes. Example register reporting row with aging calculation and open-item flag. <br>Audit log: capture immutable entries for each change (who, when, old/new values, reason). Retain supporting evidence per statutory/donor retention requirements. Example audit entry: Mapping changed for RequestID ACC-2024-11-045 from Donor X to Donor Y with ChangeReason = Contract amendment and Approver=Head of Grants.<br><strong>Expanded guidance — control matrix & segregation of duties</strong><br>- Segregation: Preparer ≠ Approver ≠ Poster. Reconciliation owner should not be the preparer of accruals for same project. <br>- Mandatory controls: evidence present; DoA sign-off for journals; central register reconciliation to AP; monthly supervisor review for top 10 accruals. <br>- Audit readiness checklist: top-line accrual schedule, sample supporting document pack (RequestID + evidence + posted JE + invoice), reconciliation file and exception log. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Donor reporting and compliance</strong><br>Map accruals to donor reporting lines and attach required evidence (PO, contract clause, GRN, timesheet, donor authorisation). For donors that accept only cash accounting confirm permitted practice; for donors that accept accruals ensure reversal and re-posting processes comply with donor rules and reporting periods. Examples: (a) USAID/USG awards may have specific definitions of accrued/unexpended obligations—capture and document; (b) FCDO may require evidence of activity within award period—attach activity reports to accrual request; (c) local donor may disallow accruals past final report date—process extension or reclassification as host country expense.<br><strong>Expanded guidance — donor-specific notes (practical checklist)</strong><br>- Always confirm donor policy before booking to SOF. If donor policy unclear, obtain written confirmation from grants/compliance.<br>- USAID/USG: capture unliquidated obligations and ensure accruals do not inflate unexpended obligated balances incorrectly; follow agency guidance on reporting periods.<br>- FCDO/ECHO: attach narrative describing work completion date and evidence if accrual spans close to award end. <br>- Donor exceptions: record donor-specific acceptance or rejection in Grant_Metadata and store with RequestID. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Exceptions and dispute handling</strong><br>Log disputes in an Exceptions register with SLA targets (initial owner assignment within 2 business days; resolution within 15 business days). Place conflicting invoices in a clearing account while disputes are resolved. Capture resolution entries, approver and date; update request status to Closed when resolved. Examples: (a) supplier invoice allocation differs—log dispute, notify grants manager and donor contact if required; (b) amount variance after delivery—book temporary adjustment and escalate if >materiality threshold; (c) long-outstanding accrual moved to Contingency and flagged for CFO review.<br><strong>Expanded guidance — dispute lifecycle & templates</strong><br>- Exception lifecycle states: New → Assigned → In Progress → Awaiting Evidence → Escalated → Resolved → Closed.<br>- Mandatory fields for exception creation: RootCauseTag (Evidence/Mapping/FX/Invoice/Procurement), SLA target, OwnerAssigned, SuggestedFix.<br>- Escalation matrix: after SLA breach 2 days → regional escal; after 7 days → CFO notification. Record all communications and decisions in Exceptions. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Journal templates (examples)</strong><br>Accrual (period end) — Dr Expense — Project A (Donor X) 10,000 / Cr Accrued Liabilities — Project A (Donor X) 10,000. Example narrative: “Accrual — Stationery Delivery — 2025-06 — ACC-2025-06-015”.<br>Reversal (first working day next period) — Dr Accrued Liabilities 10,000 / Cr Expense 10,000. Example automation: ERP reversing flag schedule posts auto reversal on first business day. <br>Invoice posted after reversal — Dr Expense 10,000 / Cr Accounts Payable 10,000. <br>Invoice posted when accrual not reversed — Dr Accrued Liabilities 10,000 / Cr Accounts Payable 10,000. Example of clearing: match AP invoice to RequestID and post clearing JE.<br><strong>Expanded guidance — multi-currency and variance entries</strong><br>- Example multi-currency clearance: Accrual booked in local LC at closing rate → AcctgEntry (local). When invoice paid in foreign currency, convert using payment date rate and record FX variance:<br> 1) At accrual: Dr Expense LC / Cr Accrual LC (at accrual FX)  <br> 2) On payment/invoice: Dr Accrual_ReportCurrency (cleared) / Cr Bank_ReportCurrency; difference → FXVariance. <br>- Variance handling policy: small variances (below immaterial threshold) can be charged to country overhead with documented approval; material variances require project-level correction. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Accrued and prepaid expenditure (single grouped section — FULL combined content, do not reduce anything)</strong><br><strong>2.7	Accrued and prepaid expenditure — complete consolidated group</strong><br><br>Key points<br><br>•	Accruals/prepayments of a material amount should be recorded as follows:<br>o	at a minimum quarterly for quarterly reporting<br>o	monthly for an item that would materially affect the accounts<br>o	in detail at the year-end<br>o	for donor reporting as required. <br>•	Each accrual/ prepayment must have supporting documentation sufficient for audit purposes.  This should be a document either produced or signed by the supplier of the goods or services, which confirms the date of the transaction, the agreed price and payment details. This can be a dated agreement, delivery note, air ticket etc. <br>•	Where an accrual is posted which WILL reverse in either the following month or later, you MUST keep track of when the entries will reverse and then determine the relevant entry depending on whether the payment has been made. An example accruals tracker entitled “Finance Toolkit – Accruals Tracker” is available on the OneNet here.<br>•	Where an accrual is posted which WILL NOT reverse, you must still monitor the accrual and determine the relevant entry depending on whether the payment has been made.<br>•	At the end of each accounting period (including the year-end) the balance on the accruals and prepayments balance sheet accounts must be reconciled to the list of current accruals and prepayments.<br><br>Responsibilities:<br>•	the country finance director is responsible for ensuring that accruals and prepayments are recorded in line with the accruals policy and guidance below<br>•	budget holders are responsible for identifying accruals and prepayments relating to their awards, with assistance from finance and logistics staff<br><br>Definitions and explanations<br>Accruals accounting requires revenue and expenditure to be brought to account as and when they are earned or incurred and not when money is received or paid.  This is the point at which an asset or liability can be recorded.<br><br>Examples of situations where an accrual would be required are as follows:<br>•	the electricity for the office for the last 3 months has not yet been paid for (and no liability has been recorded for this)<br>•	goods that were ordered have been received, but either the supplier has not yet invoiced for them, or the invoice has been received but not recorded.<br><br>Example of a situation where an accrual would not be required:<br>•	the award is ending, the purchase order has been raised, but the goods or services have not been delivered yet. <br>An accrual can only be used once the goods or services have been delivered (or the expense posted to the accounts if the invoice has been received and approved – see Section 2.4: Payments for further details).<br><br>In the examples where an accrual is required, the obligation has been incurred and there is a liability.  An accrual is recorded as follows:<br><br>Dr Expense<br>Cr Accrual (liability) 2150/2100/2130/2140<br><br>It is possible (but much less likely) that there will be revenue to accrue.  This would occur if, for example, a section of the country office is sub-let (eg to another NGO) and this tenant has not paid SCI the rent for a previous period.  In this instance we have a debtor, as the tenant owes us rental income.  This would be recorded as follows:<br><br>Dr Accrued income 1130<br>Cr Revenue<br><br>This process does not cover the situation of award funds received locally, for example from UNICEF or Global Fund.  Refer to Section 2.10.1: Locally received funds for the procedure for this.<br><br>A prepayment exists if money has been paid for an expense that relates to the following accounting period.  For example, at 31 December rent has been paid that covers the period 1 January – 31 March:<br><br>Dr Expense (rent)<br>Cr Cash<br><br>In this situation an asset exists and expenditure needs to be reduced in the current period.  The accounting entry is:<br><br>Dr Prepayment (asset) 1122/1121/1120<br>Cr Expense (rent)<br><br>For procedures on how to record Accruals and prepayments in Agresso, please refer to the Introduction to Agresso FMS and General Ledger Manual - section ‘Accruals and prepayments’ on the OneNet here.<br><br><strong>2.7.1	Foreign exchange impacts (complete)</strong><br>Accruals made in local currency will result in foreign exchange gains and losses as part of the monthly revaluation process. This will need to be managed by the country office and covered as part of the country office overhead.<br><br><strong>Expanded guidance</strong><br>- Monthly revaluation process: list steps — extract accrual balances by currency → apply closing rate from FX_Rates → compute FX revaluation movement → post revaluation JE to FXVariance (or other P&L account) with narrative and RequestID references for significant items.<br><br><strong>2.7.2	Differences between amounts accrued and actual expense (complete)</strong><br>There may be differences between amounts accrued and the actual expense when received, if the accrual was made on the basis of an estimate.  Where possible the difference should be coded to the budget against which the accrued expenditure was originally recorded.  If this is not possible then the difference will need to be covered by country office overhead.<br><br><strong>Expanded guidance</strong><br>- Difference handling workflow: small difference (<threshold) → code to original budget or overhead with preparer note; material difference → require budget holder sign-off and reclass journal; document root cause (estimation method, vendor pricing). Maintain monthly variance report.<br><br><strong>2.7.3	Donor guidelines (complete)</strong><br>When recording accruals and prepayments country office staff must ensure they are familiar with any relevant donor regulations. Some donors will not accept expenditure that has been paid outside of the award period, i.e. they work on a cash accounting basis. Other donors will accept expenditure paid outside the award period, provided the activity occurred in the award period and the amount is paid before the date of the final report. What about those that accept accruals that are settled after the report date?<br><br>Accruals and prepaid expenditure must not be charged to a SOF if it will not comply with donor regulations.  Country office staff must therefore work together to ensure that expenses are incurred and paid within the relevant donor regulations. The following should cover all donor award situations: <br><br>2.	Donor which only accepts cash based accounting (donor normally accepts the expense to be incurred and accounted for after the end of the award implementation period). Needs to be verified whether the donor accepts this practice.<br><br>The SOF will become inactive after the final posting date, (set after the end of the date of the award period to ensure such expenses can be posted to the SOF).<br><br>3.	Donor which accepts accruals accounting — the accrual is made during the award period, and therefore the SOF is active. As the accrual is reversed each month it must be re-posted until the invoice is paid. If the award is ending, the purchase order has been raised, but the goods or services have not been delivered yet, extention of the award should be requested rather than an accrual recorded as this approach does not comply with the accounting standards,  <br><br>When the invoice is received the accounting entries would be:<br><br>Dr Accrual<br>Cr Bank<br><br>NB. Reporting on the SOF from Agresso, the donor report will include the transactions based on the period selected. For example, if an audit expense which related to period 2 is posted as an adjustment to period 2 in period 5, then the report must be run up to period 5.<br><br><strong>Expanded guidance — donor practical checklist</strong><br>- Before booking to SOF, confirm: donor accepts accruals (yes/no), permitted timing for payments post-award, evidence standard, whether accrual reversals are acceptable for donor reporting. Record confirmation in Grants_Metadata and attach to RequestID.<br><br><strong>2.7.4	Accruals and Prepayments Process (complete — all stages combined)</strong><br><br>Stage — Notify budget holders<br><br>Prior to the period end (quarter end, year-end, end of donor reporting period as appropriate) finance should notify budget holders and the logistics department of the need to identify material accruals/ prepayments (and state what value is considered material). This identification needs to occur both at the country office and at the sub-offices. Logistics should assist with identification but ultimately it is the responsibility of the budget holders.  As an example of how logistics might help, they could produce a list of goods/ services received by the end of the period but for which no invoice had been received, detailing:<br>• goods/ services received<br>• value<br>• coding as per the purchase order<br>• budget holder.<br>This could be accompanied by a copy of the supporting documentation (goods received note etc).  In addition to goods/ services procured via logistics, budget holders should consider costs relating to property, staff/ consultants etc that might not have passed though logistics.  They should also review prior period accruals (which will have now reversed) to see if they are still outstanding and need to be accrued again. Examples: (a) logistics run a weekly GRN extract and send to budget holders; (b) budget holders run prior-month accrual aging and re-request accrual if outstanding; (c) sub-office reconciles receiving report list against central register. <br><br>Stage — Budget holders identify accruals/prepayments<br><br>Budget holders must complete the accruals/ prepayment template, sign to authorise the adjustments, and submit to finance with documentation to support the accruals/ prepayments.  <br>In the template the budget holders should identify the reversing period.  They should set this as the following month unless it is known that the period will be longer.<br><br>At sub-office level, finance should coordinate this process and then send all the documentation to the country office finance department for processing. Examples: (a) completed template sample included in workbook; (b) budget holder signs electronically and attaches delivery note and PO; (c) sub-office compiles batch and forwards to country office with summary cover sheet. <br><br>Stage — Register in Agresso<br><br>One member of the finance team should register the accruals/ prepayments journals in Agresso and print a copy. Examples: (a) junior accountant creates preliminary draft journals in sandbox and supervisor reviews; (b) posted journals receive auto-generated JE numbers which are recorded in AccrualRegister; (c) printed copy saved to physical or electronic file with the RequestID. <br><br>Stage — Review, authorisation and posting<br><br>A supervisor in the finance team should review the journals to ensure they are correct and agree to the supporting documentation and authorisations. When satisfied, they should sign the list of registered journals and templates to authorise.<br><br>The supervisor should update the journals to include the reversing period and post the journals in Agresso.  Once all the accruals/ prepayments have been posted, finance should run an enquiry on the accruals and prepayments accounts to ensure all have been set to reverse.  If the reversal has been forgotten then a manual reversal journal will be required in the following month, and should be tracked against an accruals listing maintained each month. Examples: (a) supervisor checklist includes verification of RequestID, evidence, allocation split and GL codes; (b) exception process requires escalation to Country Finance Director for any accrual > materiality threshold; (c) monthly report flagged to CFO for accruals not set to reverse.<br><br>Stage — Filing<br><br>The authorised accruals/ prepayments journals and the supporting documentation should be filed. Examples: (a) electronic folder structure: /Archive/Accruals/YYYY/MM/RequestID with zipped supporting docs; (b) retention rules: 7 years for donor-funded accruals, or donor-mandated period if longer; (c) indexing standard includes RequestID, Vendor, Period and PostedJERef.<br><br><strong>Expanded guidance — step-by-step process checklist (concise)</strong><br>1. Notify (T-7 days): send cut-off reminder and materiality thresholds.<br>2. Identify (T-5 days): budget holders compile template and evidence.<br>3. Submit (T-3 days): AccrualRequest submitted and initial validations pass.<br>4. Approve & Post (T0): Finance posts accruals with ApprovedBy and PostedJERef.<br>5. Reversal scheduling (T+1 business day): auto or scheduled reversal posted.<br>6. Invoice matching (ongoing): match and clear accruals; record variances.<br>7. Reconcile (T+5–10 days): reconciliation to AP and GL; close exceptions.<br><br><strong>Expanded guidance — monitoring & sample templates</strong><br>- Quarterly vs monthly rule: provide decision table showing examples of when monthly accruals are required (rental, significant service contracts, grants with monthly donor reporting) vs quarterly (small recurring subscriptions).<br>- Supporting documentation checklist for auditors: RequestID cover page; PO; GRN; delivery note; timesheets; contract clause; email confirmation; approver sign-off; invoice when received. Arrange into a zip bundle named ACC-<Period>-<RequestID>.zip for archival.<br>- Sample prepayment amortisation schedule: show rows for prepayment date, total paid, months covered, monthly amortisation, remaining balance. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Templates and automation guidance</strong><br>Table names — Use exact names: AccrualRequests for the request table and AccrualRegister for the register. <br>Power Query guidance — Load AccrualRequests as a structured table, validate required columns, perform numeric and currency checks, compute Amount_ReportCurrency = Amount_Local <em> FXRate and publish consolidated AccrualRegister view. Use incremental refresh where appropriate. Example Power Query steps: (1) Source → Excel Table AccrualRequests; (2) Remove rows with null RequestID; (3) Validate Currency codes against Lookups table; (4) Add custom column Amount_ReportCurrency = Amount_Local </em> FXRate; (5) Publish to Power BI / data model. <br>ERP automation — Where ERP supports reversing flags, implement reversing journal template and schedule automatic reversal; store ERP posting reference in PostedJERef. Example ERP process: create recurring reversing JE template for monthly utilities; attach token for automated reversal posting.<br><strong>Expanded guidance — automation recipes & Excel formulas</strong><br>- Recommended RequestID formula (Excel): =CONCAT("ACC-",TEXT(Period,"YYYYMM"), "-", TEXT(ROW()-headerRow,"000")).<br>- Amount_ReportCurrency formula: =IF(FXRate>0,Amount_Local*FXRate,NA()) and validation conditional formatting if NA.<br>- Power Query notes: (a) apply currency code validation early to allow query folding; (b) avoid Table.Buffer on large tables; (c) create incremental load using Period partition.<br>- ERP export file schema: Date, JERef, LineNumber, Account, CostCenter, ProjectCode, DonorCode, Debit, Credit, Narrative, RequestID. Provide CSV template with sample lines. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Implementation roadmap</strong><br>Phase 1 (2–4 weeks) — adopt templates, configure Power Query table load and train core finance users. Example tasks: template distribution, Power Query connection, smoke tests with sample data, 1-hour training sessions. <br>Phase 2 (4–8 weeks) — pilot across selected projects, refine allocation matrix and validate FX workflows. Example tasks: pilot in 3 country offices, collect feedback, adjust allocation drivers and threshold rules. <br>Phase 3 (8–12 weeks) — full rollout, integrate ERP reversing automation and formalise SOPs and SLAs. Example tasks: deploy ERP reversing templates, produce SOPs, SLA sign-offs, executive sign-off and audit readiness testing.<br><strong>Expanded guidance — project plan checklist</strong><br>- Pre-deployment: configure Control sheet, load historical accruals into AccrualRegister, set MaterialityThreshold, populate FX_Rates.<br>- Pilot metrics: % completeness of AccrualRequests, average time from request to post, number of exceptions. Use pilot results to tune templates and rules. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>KPIs and reporting</strong><br>Suggested KPIs — % accruals with complete evidence; average age of open accruals; % matched within 1 month; monthly accrual variance vs budget; number of disputed accruals and average time to resolution. Include KPI dashboard in management pack and review weekly during close. Examples of target values: (a) 95% accruals with evidence within 3 working days; (b) average age of open accruals < 30 days; (c) disputes closed within 15 business days for 90% of cases.<br><strong>Expanded guidance — dashboard fields</strong><br>- Suggested dashboard tiles: Total Accruals (count & value), Open >30/60/90 days, Top 10 by value, % with evidence, % cleared within SLA, FX variance summary. Provide drill-to RequestID for each tile. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Roles and responsibilities</strong><br>Program managers — Confirm cut-off and supply supporting evidence; provide narrative for accrual rationale and estimate methodology. <br>Country Finance Director — Ensure accruals and prepayments are recorded in line with policy and guidance; approve exceptions above threshold. <br>Budget Holders — Identify accruals/prepayments relating to awards and complete templates; confirm allocation and expected reversal period. <br>Finance team — Validate requests, prepare and post journals, maintain Accrual Register and reconcile to AP; escalate anomalies. <br>Approvers (per DoA) — Review and approve accruals and exceptions; ensure segregation of duties. <br>Grants/Compliance — Advise on donor-specific allocation and reporting requirements and confirm donor acceptability of accruals. Examples: delegation matrix with named approvers for thresholds, cross-check schedule for management sign-offs.<br><strong>Expanded guidance — RACI matrix (summary)</strong><br>- Preparer: Program Manager (R)<br>- Reviewer: Local Finance (A/C)<br>- Approver: Budget Holder / DoA sign-off (A)<br>- Poster: Finance Ledger Team (R)<br>- Reconciler: Reconciliations Lead (C)<br>- Auditor evidence custodian: Records/Compliance (I). </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Training and change control</strong><br>Deliver targeted training for program owners, finance preparers and approvers before rollout. Maintain a versioned SOP and change log; require Finance leadership approval for permanent changes to allocation rules, materiality thresholds or reversal approach and record approvals in the change log. Examples: training modules (30–60 minutes), recorded walkthroughs, test dataset run book, change-control request template with impact assessment.<br><strong>Expanded guidance — training plan</strong><br>- Training modules: (1) Accrual basics for program teams (30 min); (2) Using AccrualRequests form (45 min); (3) Finance posting & reconciliations (60 min); (4) Power Query / BI users (60 min). Provide recorded sessions and quick reference cheat-sheets. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Effective date and review</strong><br>This policy is effective immediately. Review annually or earlier when accounting standards, donor rules or significant process changes occur. Examples: schedule annual policy review in Q4, trigger ad-hoc review on donor regulation changes or ERP upgrades.<br><strong>Expanded guidance — governance</strong><br>- Assign Policy Owner (Global Finance Director) and Review Committee (Finance, Grants, Operations, Audit). Maintain version history and publish change summaries with impact analysis. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Annexes (templates, sample forms, calculation sheets)</strong><br>Include (attached or in workbook): AccrualRequest template (Excel), AccrualRegister schema, AccrualsTracker, Exceptions template, Journal export CSV template for ERP, Power Query M-code snippets (documented), Sample month-end pack (PDF/Word template), Reconciliation workbook and Archive manifest sample. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Quick reference: month-end timeline (example)</strong><br>Day -7: Controller issues cut-off reminder and materiality thresholds.<br>Day -5: Budget holders return draft AccrualRequests with evidence.<br>Day -3: Finance validates and routes for approvals.<br>Day 0: Journals posted; Reversing flags scheduled.<br>Day +1 to +5: Reconciliation to AP and GL; escalate exceptions.<br>Day +7: Finalise month-end pack and publish to management. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>FAQ (short)</strong><br>Q: What if vendor invoice arrives in next quarter? A: Match invoice to accrual and clear; if accrual was reversed, post invoice to expense and keep audit trail showing original accrual and reversal. <br>Q: Who sets reversal date? A: Preparer recommends; Finance sets ScheduledReversalDate when posting per policy; default first working day next period for routine accruals. <br>Q: Can small accruals be aggregated? A: Yes where below materiality and with documented aggregation rule. </td></tr><tr><td data-label="Accruals Policy — Multi-Funder NGOs"> <strong>Final operational tips</strong><br>- Use named RequestID on every supporting document.<br>- Prioritise accruals by donor risk and materiality for early review.<br>- Automate as much validation as possible (donor split sum, FX presence, required docs) and surface failures as Exceptions. <br>- Keep a short “lessons learned” log after each month-end to tune thresholds and mapping rules. </td></tr></tbody></table></div><div class="row-count">Rows: 23</div></div><div class="table-caption" id="Table2" data-table="Docu_0170_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Accruals Workbook — Sheet-by-sheet explanation"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Accruals Workbook — Sheet-by-sheet explanation</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Control (central control panel)</strong><br><strong>Purpose</strong><br> Single control surface to select Period, ReportingCurrency, Refresh actions and quick links to key sheets, and to surface close status KPIs and exceptions summary.<br><strong>Key fields / cells</strong><br> Period selector (YYYY-MM), ReportingCurrency, CloseStatus (Open/In Review/Closed), LastRefreshTimestamp, Runbook_Link, Owner, MaterialityThreshold, RefreshQueries button (macro), SnapshotNow button.<br><strong>Populated</strong><br> Manual by controller or via named ranges / macros; linked to workbook parameters used by Power Query and formulas.<br><strong>Validations</strong><br> Period required; ReportingCurrency limited to ISO3 list (Lookup_Currencies); MaterialityThreshold numeric >0; CloseStatus dropdown.<br><strong>User action</strong><br> Set reporting period and currency, run refresh, check LastRefreshTimestamp and KPIs, open high-priority exceptions and drill to supporting sheets.<br><strong>Owner</strong><br> Consolidation/Controller.<br><strong>Beginner explanation</strong><br> This is the “home” sheet — change only here. Changing the period or currency affects every query and report. Use the large Refresh button rather than refreshing individual queries to keep logs consistent.<br><strong>Detailed narrative & practical tips</strong><br> Top-left place Period and ReportingCurrency as named cells that feed Power Query parameters. Show three big status tiles: Ingestion (green/amber/red), Mapping health, Reconciliation completeness. Add a short checklist: verify period, check LastRefreshTimestamp, run RefreshQueries, review top 5 KPIs. Add one-click links to: AccrualRequests, AccrualRegister, Exceptions, Approvals, Reports_Output, Audit_Log. Store pre-close notes here (locked edits for auditors) and a snapshot history table showing who ran refresh and why.<br><strong>Extended narrative</strong><br> Include a lightweight audit snippet showing last 10 control changes from Audit_Log (read-only). For automation, hook RefreshQueries to a Power Automate flow (if available) via a macro that writes a refresh-timestamp and user. Provide a “Pre-close sign-off” checklist that captures preparer and reviewer electronic initials (string + timestamp). Add an emergency fallback link to a “manual ingest” sheet for when feeds fail.<br><strong>Practical examples & troubleshooting</strong><br> If Ingestion shows red, open Raw_Documents and Upload_Tracker to find missing files. If the period is wrong, revert to prior Period value from Audit_Log and re-run refresh to reproduce previous output. If ReportingCurrency is wrong, change back and re-run; show “why this matters” numeric example on the Control sheet (sample row that simulates FX impact). </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>AccrualRequests (data entry form)</strong><br><strong>Purpose</strong><br> Capture preparer-submitted accrual requests in a controlled, validation-driven table ready for Power Query ingestion and approval workflow.<br><strong>Key columns</strong><br> RequestID, RequestDate, Period(YYYY-MM), VendorName, VendorID, Description, Amount_Local, Currency, FXRateUsed, Amount_ReportCurrency, ProjectCode, DonorCode(s) & SplitPct, AllocationMethod, AllocationNotes, SupportingDocsLink, PreparerName, PreparerDate, ApproverName, ApproverDate, ReversingFlag (Y/N), ScheduledReversalDate, Status (Draft/Submitted/Approved/Posted/Closed), Comments.<br><strong>Populated</strong><br> Manual entry via protected table entry form or via a controlled SharePoint/Forms intake that writes to the table. Accepts file links (SharePoint/OneDrive) for evidence.<br><strong>Validations</strong><br> Required fields: RequestDate, Period, Amount_Local, Currency, ProjectCode. Currency validated against Lookup_Currencies. Donor splits must sum 100% if multiple donors. FXRateUsed positive and present when converting to report currency. Status step validation (cannot move to Approved without ApproverName and ApproverDate).<br><strong>User action</strong><br> Program managers or local finance submit an accrual request with evidence and suggested allocation; Finance reviews and approves in the Approvals sheet or workflow.<br><strong>Owner</strong><br> Local preparer / Finance intake owner.<br><strong>Beginner explanation</strong><br> Fill out one row per accrual request. Attach supporting evidence (link). Don't change RequestID (auto-generated). Use the ReversingFlag to indicate whether to schedule a reversal. If you are unsure how to allocate, enter “TBD” in AllocationNotes and set Status = Submitted; Finance will follow up.<br><strong>Detailed narrative & practical tips</strong><br> Provide a small instruction card at top explaining evidence types acceptable and a mini validation summary (row count, total amount, top vendors). Implement dropdowns for ProjectCode, DonorCode and AllocationMethod to reduce errors. Offer an inline helper formula to calculate Amount_ReportCurrency if FXRateUsed present. For multi-donor splits, include a linked subtable (AccrualRequest_Splits) to store row-level donor split detail. Optionally include an “Impact Preview” that shows the effect of the accrual on consolidated P&L for the period using snapshot sample rates.<br><strong>Extended narrative</strong><br> Build a “submit” macro that locks the row upon submission and moves Status to Submitted while writing an entry to Audit_Log. Integrate with Approvals (Power Automate / Power Query) to create an approval task that captures digital signature / approver identity and timestamp. Keep a sandbox area that allows test submissions and training entries which do not flow to production queries.<br><strong>Practical examples & troubleshooting</strong><br> Example: Program A requests accrual for training: RequestAmount 5,000 LC, Currency LKR; FXRateUsed 0.0051; Amount_ReportCurrency calculated; Donor split 60/40. If the Donor split fails sum=100 validation, the submission is rejected and flagged in the validation column with an error tooltip. If supporting docs link broken, automated check sends request back to preparer. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>AccrualRegister (central ledger of accrual lifecycle)</strong><br><strong>Purpose</strong><br>Canonical table aggregating all accrual requests, posted journals, match status and aging — the single source for reconciliations and reporting.<br><strong>Key columns</strong><br> RequestID, SourceRequestRef, Period, Project, Donor, RequestAmount_Local, RequestCurrency, RequestAmount_ReportCurrency, FXRateUsed, PostedJERef, PostedDate, MatchedInvoiceRef, ClearedDate, Status (Posted/Reversed/Cleared/Disputed), AgingDays, Owner, Notes.<br><strong>Populated</strong><br> Power Query loads AccrualRequests plus posting metadata from ERP/Agresso and manual postings from Elimination_Staging or Adjustments_Journal. The register merges request-level data with ledger posting info using RequestID as key.<br><strong>Validations</strong><br> Reconciles sum(RequestAmount_ReportCurrency) to GL account balances; PostedJERef must exist for Posted status; ClearedDate must be >= PostedDate. AgingDays computed automatically. Any mismatch triggers an exception flag.<br><strong>User action</strong><br> Controllers review register daily during close, filter outstanding accruals by aging and value, and assign owners for resolution. Reconcile to AP ledger monthly.<br><strong>Owner</strong><br> Consolidation Accountant / Finance team.<br><strong>Beginner explanation</strong><br> This is the truth table that shows what has been requested, what was posted to the ledger, and whether invoices have cleared. Use it to identify stale accruals and to produce month-end schedules.<br><strong>Detailed narrative & practical tips</strong><br> Keep an attachments column linking to the AccrualRequests evidence and ERP posting PDF. Add a computed column showing “Days to Clear” and a conditional formatting band for items aged >30/60/90 days. Provide pivot-friendly fields (Project, Donor, GLGroup) to create management summary tables. Store both local and report currency amounts to facilitate FX variance analysis. Build a reconciler macro that compares GL balances (Accrued Liabilities) to the register sums and writes a recon variance row with drill-to links.<br><strong>Extended narrative</strong><br> Instrument automated alerts (email / Teams) for accruals aging beyond SLA. Provide a reconciliation workflow where recon differences automatically spawn Exceptions entries. Maintain monthly snapshots (Archive) of the register to preserve reproducibility. For audit, include a “Why not cleared” narrative field capturing the reason (e.g., invoice delay, dispute, PO mismatch).<br><strong>Practical examples & troubleshooting</strong><br> If register totals differ from GL by 10k, filter by PostedJERef null to find requests not posted; locate RequestIDs and escalate. For repeated late clears for a vendor, analyze supplier patterns and update supplier terms or follow up with procurement. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Accruals_Tracker (Finance Toolkit — canonical tracker)</strong><br><strong>Purpose</strong><br>Operational tracker used by month-end operations to monitor reversals, scheduled reversals, matched invoices and open items across sub-offices; designed for daily operational chasing.<br><strong>Key fields</strong><br> RequestID, Period, Vendor, Amount_Local, Currency, Amount_ReportCurrency, FXRate, Project, Donor, ReversingFlag, ScheduledReversalDate, ExpectedClearDate, MatchedInvoiceRef, ClearingAccountRef, Status, Owner, EscalationLevel, LastContactDate, Notes.<br><strong>Populated</strong><br> Primarily via Power Query merging AccrualRequests, AccrualRegister and AP ledger extracts; manual note updates by operations team to record chase activity.<br><strong>Validations</strong><br> ReversingFlag must correspond to ScheduledReversalDate present; ExpectedClearDate can't be earlier than ScheduledReversalDate for reversing accruals; EscalationLevel updated if LastContactDate older than SLA.<br><strong>User action</strong><br> Operations staff update LastContactDate, set EscalationLevel, chase supporting docs and flag disputes into Exceptions. Use the tracker board to allocate follow-ups to local finance leads.<br><strong>Owner</strong><br> Consolidation Operations / Finance Operations.<br><strong>Beginner explanation</strong><br> This is the daily to-do board for accruals. Use filters by Owner and EscalationLevel to focus on actions. Add notes each time you contact a vendor or program owner.<br><strong>Detailed narrative & practical tips</strong><br> Add a Kanban-style status column (To chase / Chasing / Pending supplier / Escalated / Cleared). Provide a computed SLA field that calculates remaining days before escalation. Include a “contact history” column storing time-stamped notes (or link to a centralized log file). Build a pivot showing top 10 vendors by outstanding accruals to prioritize.</br><strong>Extended narrative</strong><br> For high-volume operations, link this sheet to automated email templates (mail-merge) that populate vendor, invoice, RequestID and evidence links to reduce manual chasing. Maintain a “fast-track” flag for critical donor-funded accruals so they get immediate attention. Keep a weekly report to management showing trends in aging and root causes of late clears.<br><strong>Practical examples & troubleshooting</strong><br> If scheduled reversal is due but reversal missing in ledger, check PostedJERef and ReversingFlag; post manual reversal and log in Audit_Log. If vendor never replies, escalate per EscalationLevel and document in Exceptions. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Raw_Documents (supporting evidence landing)</strong><br><strong>Purpose</strong><br>Central index of uploaded supporting documents (GRNs, contracts, timesheets, invoices) with checksum and access links to ensure auditability and traceability.<br><strong>Key fields</strong><br> FileID, FileName, FileType, UploadedBy, UploadDate, RequestID(s) linked, DocumentDate, Vendor, Hash/Checksum, StoragePath, ValidationStatus, Notes.<br><strong>Populated</strong><br> Via file upload UI or manual link paste; ideally mirrored from SharePoint/Document Management with automated index feed.<br><strong>Validations</strong><br> Checksum calculation (MD5/SHA256) to detect tampering; FileType allowed list; DocumentDate must be <= Period(related) where applicable; FileName convention validation.<br><strong>User action</strong><br> Attach evidence when submitting AccrualRequests; controllers use this sheet to pull documents for reviewers and auditors. Use validation status to record missing pages or redactions needed.<br><strong>Owner</strong><br> Records/Finance.<br><strong>Beginner explanation</strong><br> Don’t edit files here — files are references only. Always attach the FileID in requests. If a document needs redaction, create a redacted copy and upload as a new FileID with note referencing original.<br><strong>Detailed narrative & practical tips</strong><br> Maintain a small evidence checklist column for each row: required_fields_present (Yes/No), signature_present, dated, PO_ref. Implement a search index to find documents by vendor, RequestID, or PO. Snapshot critical source docs into Archive for the close. Provide a link-out to exact location for auditors. Flag missing supporting docs via a “ValidationStatus” that is picked up by Exceptions.<br><strong>Practical examples & troubleshooting</strong><br> If an auditor requests the GRN for RequestID ACC-2025-06-045, filter Raw_Documents for that RequestID and export PDF bundle; if hash mismatch, provide the original file and Audit_Log to explain changes and use Archive snapshot to prove historical copy. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Allocation_Matrix (pre-approved allocation rules)</strong><br><strong>Purpose</strong><br>Store allocation matrices, rule precedence, wildcard rules and approved formulas to apply consistent allocations across recurring accrual types.<br><strong>Key fields</strong><br> RuleID, RuleName, Pattern (project/account regex), AllocationType (Fixed%, Driver-based), Parameters (e.g., % per donor), EffectiveFrom, EffectiveTo, ActiveFlag, Owner, Notes.<br><strong>Populated</strong><br> Maintained by Grants/Mapping Steward via controlled UI; rule history maintained in Mapping_Change_Log.<br><strong>Validations</strong><br> EffectiveFrom/To non-overlap for same pattern; allocation percentages sum to 100% where applicable; ActiveFlag consistency checks.<br><strong>User action</strong><br> Mapping Steward updates when new grant rules or budget changes occur; Finance references matrix when applying allocations to AccrualRequests.<br><strong>Owner</strong><br> Mapping Steward / Grants.<br><strong>Beginner explanation</strong><br> The matrix automates how costs split across donors for standard items; don’t edit live without following change protocol. Test rules in Test_Data & QA first.<br><strong>Detailed narrative & practical tips</strong><br> Include worked examples for common patterns (salaries, shared vehicles, office rent). Provide “test” toggle per rule and a small simulation table where a sample accrual amount shows split outputs per rule. Add a rule priority column so specific mapping beats wildcard (precedence). Provide a “why” note for auditors describing rationale (e.g., donor A funds salary 60% per contract clause 4.2).<br><strong>Practical examples & troubleshooting</strong><br> If many accruals remain unmapped, run a rule-coverage report showing unmatched patterns; add or refine wildcard rules carefully. To revert a problematic rule, set ActiveFlag false and apply previous rule effective-to adjustment. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>FX_Rates</strong><br><strong>Purpose</strong><br>Canonical FX table for period-end and average rates used to translate accruals to reporting currency and to record FX source and overrides.<br><strong>Key fields</strong><br> Currency, Period(YYYY-MM), RateType (Closing/Average/Spot), Rate, Source, EffectiveDate, OverrideFlag, EnteredBy, Notes.<br><strong>Populated</strong><br> Automated feed from Treasury or manual entry by Treasury/Controller with override capture. Support multiple rate types per currency-period.<br><strong>Validations</strong><br> Rate > 0; required rates for entity currencies for selected period; check for duplicate (Currency+Period+RateType).<br><strong>User action</strong><br> Treasury updates rates, Finance references them when converting AccrualRequests and generating reports. Finance documents any manual override with reason. <br><strong>Owner</strong><br> Treasury / Controller.<br><strong>Beginner explanation</strong><br> This is the price list for currencies. Use Closing rates for balance-sheet items and Average rates for P&L where policy requires. Always note Overrides and reason. <br><strong>Detailed narrative & practical tips</strong><br> Add a small “rate provenance” column showing time-stamped feed file name or API response ID. Implement a fallback chain: Closing → Spot → Historical snapshot with audit flag. Provide a small worked example demonstrating the P&L translation difference using average vs closing rate to help controllers choose correct rate type. <br><strong>Practical examples & troubleshooting</strong><br> If a currency rate is missing for period, register an exception and use an approved fallback (documented). When a rate is overridden, append the justification and approver to Audit_Log. If large FX variance appears after revaluation, run a sample recalculation of a handful of accruals with both rates and present to controller for review. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Approvals (electronic sign-off queue)</strong><br><strong>Purpose</strong><br> Manage approval workflow for accrual requests and manual journals, capture approver metadata and support auditability of approvals.<br><strong>Key fields</strong><br> WorkflowID, RequestID, StepName, Approver, ApproverRole, Status (Pending/Approved/Rejected), Comments, ApprovedAt, DigitalSignatureHash, EscalationFlag.<br><strong>Populated</strong><br> Populated automatically when AccrualRequests move to Submitted; integrates with Power Automate or email/Teams approvals where available; otherwise updated manually by approver. <br><strong>Validations</strong><br> Approver must be authorised for level per DoA; ApprovedAt required for Approved status. DigitalSignatureHash stored for electronic approvals.<br><strong>User action</strong><br> Approvers review supporting docs (link to Raw_Documents), check allocation and sign-off; if rejecting, add reasons and return to preparer. <br><strong>Owner</strong><br> Controller / Process Lead.<br><strong>Beginner explanation</strong><br> Each journal requires a chain of approval. Record why you approved or rejected; approvals are part of the audit trail. <br><strong>Detailed narrative & practical tips</strong><br> Provide a one-click “open supporting docs” link from the approval row to the Raw_Documents. Implement auto-escalation logic when pending beyond SLA and provide delegated approver option for absent approvers. Keep sign-off comments short but required; rejection reasons should map to exceptions for remediation tracking. <br><strong>Practical examples & troubleshooting</strong><br> If approver missing, follow delegated approver matrix recorded in Security_Settings. For repeated rejections on same supplier, run supplier quality review with procurement and record findings in the Runbook_Readme. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Exceptions (exception manager)</strong><br><strong>Purpose</strong><br>Central register of validation failures and disputes that require remediation: missing evidence, mapping mismatches, FX rate gaps, reconciliation variances, supplier disputes. <br><strong>Key fields</strong><br> ExceptionID, Category (Evidence/Mapping/FX/Match/Reconcile), Severity, RelatedRef (RequestID/JE/Invoice), Description, SuggestedFix, OwnerAssigned, SLA_TargetDays, Status, Notes, CreatedDate, ResolvedDate, EvidenceLink.<br><strong>Populated</strong><br> Auto-generated from validation rules in Power Query and manual entry by controllers or operations. <br><strong>Validations</strong><br> Severity must map to action (High→Controller review within 2 days). RelatedRef must be present. SLA logic enabled. <br><strong>User action</strong><br> Assign owner, track progress, attach resolution evidence, escalate when SLA breached. Use filters to prioritise high-severity items. <br><strong>Owner</strong><br> Process Coordinator / Consolidation Operations. <br><strong>Beginner explanation</strong><br> Treat this as your to-do list for problems detected during ingestion and reconciliation. Each exception must have an owner and closure evidence. <br><strong>Detailed narrative & practical tips</strong><br> Provide auto-email notification when new high-severity exceptions created. Maintain an “aging heatmap” so management sees stale exceptions. Include suggested fix templates to speed remediation (e.g., “request missing timesheet from program owner, attach to RequestID”). Record root cause tags (data, process, vendor, mapping) for long-term remediation analytics. <br><strong>Practical examples & troubleshooting</strong><br> Example: Missing FX rate generates FX exception — owner is Treasury with SLA 1 business day. If owner fails to act, auto-escalate to Controller. If mapping exceptions proliferate, run batch review with Mapping Steward and apply wildcard rule only after testing in Test_Data. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Reconciliations (register and procedures)</strong><br><strong>Purpose</strong><br>Automated and manual reconciliation worksheets proving the AccrualRegister ties to AP ledger and the consolidated TB, with variance drill paths and reconciliation sign-off. <br><strong>Key fields</strong><br> ReconID, EntityID, Period, SourceTotal, MappedTotal, Difference, Status, Owner, LastUpdated, Notes, SupportingRefs. <br><strong>Populated</strong><br> Power Query extracts entity GL totals and maps via Mappings_COA to group accounts then compares to AccrualRegister sums. Manual adjustments recorded with JE references. <br><strong>Validations</strong><br> Differences above Materiality flagged; recon status required (Reconciled/Exception/Pending). <br><strong>User action</strong><br> Controllers run recon, identify top differences, drill to source lines using hyperlinks, and resolve via journal or mapping fix. <br><strong>Owner</strong><br> Consolidation Accountant. <br><strong>Beginner explanation</strong><br> Reconciliation proves that accruals in the register equal amounts in the ledger. If not, fix source or post correcting journal and re-run. <br><strong>Detailed narrative & practical tips</strong><br> Provide a triage matrix to decide whether to correct immediately or document as timing difference. Keep top-10 differences report with drill-to links for auditors. Add a sign-off table capturing preparer and reviewer and store snapshots in Archive at close. <br><strong>Practical examples & troubleshooting</strong><br> If recon shows periodic persistent 500 difference per entity, investigate rounding rules or FX rate mismatch; compare FXRateUsed in AccrualRegister to FX_Rates for the period. If mapping error found (wrong GroupAccount), add mapping change with effective date and document impact. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Reports_Output (month-end packaging & disclosure)</strong><br><strong>Purpose</strong><br>Generate final deliverables: accrual schedules by donor/project, supporting notes for auditors, journal export files for ERP, and consolidated disclosures for financial statements. <br><strong>Key fields / outputs</strong><br> Accrual schedule (detailed), Top exceptions summary, Reconciliation pack, Export CSV for ERP (export filename + mapping), Audit evidence bundle list, Management commentary. <br><strong>Populated</strong><br> Auto-generated from AccrualRegister, Reconciliations and Exceptions; user may add narrative text blocks and attach supporting docs. <br><strong>Validations</strong><br> Ensure export file matches ERP import spec (column order, field types). Check that all material accrual narrative paragraphs present. <br><strong>User action</strong><br> Prepare final pack, attach signed approval evidence, create Archive snapshot, export CSV for ledger import. <br><strong>Owner</strong><br> Reporting / Controller. <br><strong>Beginner explanation</strong><br> This is the “final” sheet used to create the month-end pack and upload approved journals to the ERP. Confirm approvals and run final checks before exporting. <br><strong>Detailed narrative & practical tips</strong><br> Provide standardized cover page template and table of contents that auto-populates with key metrics and attachments. Include an “Export dry-run” button that validates CSV file against ERP field rules (length, mandatory columns). Keep an ExportLog table capturing who exported what and ERP response codes. For auditors, provide zipped evidence bundle with RequestIDs and checksums. <br><strong>Practical examples & troubleshooting</strong><br> If ERP rejects import due to unknown cost center, use ExportLog to find offending line, correct mapping in Mappings_COA and re-export. Maintain a sandbox ERP instance for dry runs when structural changes implemented. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Audit_Log (immutable change history)</strong><br><strong>Purpose</strong><br>Append-only log capturing changes to critical configuration, approvals, FX overrides, posting actions and any manual journal changes for forensic trail and auditor review. <br><strong>Key fields</strong><br> LogID, Table/Sheet, RecordKey, FieldName, OldValue, NewValue, ChangedBy, ChangedAt, ChangeReason, EvidenceLink. <br><strong>Populated</strong><br> Via macros, Power Query append steps or API hooks that record every configuration or journal change. Controls enforce append-only and restrict delete by file protection/permissions. <br><strong>Validations</strong><br> No null ChangedBy or ChangedAt; ChangeReason required for overrides. <br><strong>User action</strong><br> Use for audit queries, to reconstruct who changed what and when. Ensure ChangeReason is descriptive. <br><strong>Owner</strong><br> Audit / Controller. <br><strong>Beginner explanation</strong><br> This is your forensic record. Never edit or delete log rows; create corrective rows for changes instead. <br><strong>Detailed narrative & practical tips</strong><br> Provide quick filters: last 30 days, mapping changes, FX overrides, posting reversals. Create automated monthly summary of high-risk changes (e.g., frequent mapping churn) and route to Audit. For secure environments, export periodic snapshots and store in WORM or secure archive with checksums. <br><strong>Practical examples & troubleshooting</strong><br> If auditors request mapping history for SourceAccount 1234, filter Audit_Log for mapping table entries and export with related RequestIDs. If suspicious pattern found (same user overriding FX rates often), escalate to IT for permissions review and require dual-approval for FX overrides. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Test_Data & QA (sandbox)</strong><br><strong>Purpose</strong><br>Safe sandbox for testing mapping changes, wildcard rules, elimination tuning and Power Query M-code edits using representative test cases before deploying to production. <br><strong>Key fields</strong><br> TestCaseID, Description, InputFiles, ExpectedOutcome, TestStatus (NotRun/Passed/Failed), ExecutedBy, ExecDate, Notes. <br><strong>Populated</strong><br> Managed by QA/ETL developers; copies of sample accruals, invoices, FX scenarios and prior problem cases included. <br><strong>Validations</strong><br> Test coverage matrix and regression suite passing requirement before promoting changes. <br><strong>User action</strong><br> Run regression suite after mapping or rule changes and document results here. <br><strong>Owner</strong><br> QA / ETL Developer. <br><strong>Beginner explanation</strong><br> Use this sheet to safely trial rule changes; never modify production sheets directly from here. <br><strong>Detailed narrative & practical tips</strong><br> Keep a small but representative dataset including edge cases (currency missing, multi-donor split, unusually large amounts). Automate minimal tests (ingest → map → convert → consolidate) and capture output snapshots. Maintain a test-change log with M-code diffs and results. <br><strong>Practical examples & troubleshooting</strong><br> Before enabling a wildcard mapping rule that previously caused false positives, run a targeted test-case that replicates the false-positive scenario and confirm new parameters fix it. If a test fails unexpectedly after a mapping change, revert mapping in Test_Data, diagnose, and record resolve steps. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>PowerQuery_Staging (queries & data model notes)</strong><br><strong>Purpose</strong><br>Hidden/query-only tables that manage Power Query steps, M-code snippets, dependency map and notes on query folding, performance and transformations used to produce AccrualRegister view. <br><strong>Key fields / contents</strong><br> QueryName, SourcePath, LastRefreshDuration, M_CodeSnippet, UpstreamDependencies, FoldingAllowedFlag, Notes. <br><strong>Populated</strong><br> Maintained by ETL/Power Query developer; M-code snippets embedded for versioning; dependency map updated when queries changed. <br><strong>Validations</strong><br> Query names unique; source paths reachable; key transformation steps commented. <br><strong>User action</strong><br> ETL developers edit M-code here and then publish changes after testing in Test_Data. Controllers read Notes for impact. <br><strong>Owner</strong><br> ETL Developer. <br><strong>Beginner explanation</strong><br> Power Query does the heavy lifting; avoid editing M-code unless you can test in Test_Data. Document every change. <br><strong>Detailed narrative & practical tips</strong><br> Keep a query dependency diagram on this sheet, annotate folding-breakers and recommended optimisations such as applying filters early to enable folding. Store M-code versions (exported text) for version control and maintain changelog entries detailing why a change occurred and performance impact observed. Provide a small troubleshooting checklist for slow queries (check source network, evaluate Table.Buffer usage, move heavy joins to database). <br><strong>Practical examples & troubleshooting</strong><br> If refresh time spikes after a change, use LastRefreshDuration to isolate slow query; check for new steps that disable folding (Table.Buffer, custom functions). Revert to prior M-code from version history if needed. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>PowerBI_Export (semantic layer & exports)</strong><br><strong>Purpose</strong><br>Parameters and table selection details used when publishing to Power BI — ensures report dataset parameters (Period, ReportingCurrency) are synchronized with the workbook control settings and documents PBIX paths and last publish times. <br><strong>Key fields</strong><br> DatasetName, PBIX_Path, TablesIncluded, LastPublish, DatasetParameters (Period, Currency), IncrementalRefreshToken, Owner, Notes. <br><strong>Populated</strong><br> Manually by BI Developer during publish; parameter snapshots captured to ensure reproducibility. <br><strong>Validations</strong><br> DatasetParameters must match Control sheet values for published period; TablesIncluded must include AccrualRegister and Consolidated_TB. <br><strong>User action</strong><br> BI Developer updates before publishing; report authors ensure visuals align with model fields. <br><strong>Owner</strong><br> BI Developer. <br><strong>Beginner explanation</strong><br> Ensure the workbook period selector and published dataset parameter are aligned to avoid mismatched visuals. <br><strong>Detailed narrative & practical tips</strong><br> Keep PBIX version naming convention; include publish notes and dataset ID for traceability. Run a smoke test after publish verifying top visuals and data freshness. For incremental refresh ensure partitions align to Period field. <br><strong>Practical examples & troubleshooting</strong><br> If Power BI shows older data, check LastPublish and dataset parameters; republish PBIX after verifying PowerQuery refresh completes successfully. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Reports_Template_Library (templates & sample narratives)</strong><br><strong>Purpose</strong><br>Store standardized report templates, narrative boilerplates for accrual disclosures, sample audit notes and cover pages to speed pack production and ensure consistent messaging. <br><strong>Key fields</strong><br> TemplateID, TemplateName, FilePath, UseCase, LastUpdated, Owner, Notes. <br><strong>Populated</strong><br> Maintained by Reporting with approved language for material accrual explanations and donor-specific disclosure templates. <br><strong>Validations</strong><br> All templates must include placeholders for RequestIDs, JE refs and links to supporting files; last-updated and owner information mandatory. <br><strong>User action</strong><br> Use templates to populate Reports_Output; update versions when policy changes. <br><strong>Owner</strong><br> Reporting. <br><strong>Beginner explanation</strong><br> Use approved templates to avoid last-minute freehand text and ensure audit-ready packs. <br><strong>Practical examples & troubleshooting</strong><br> If auditors request a specific wording, use template v2.1 stored here and attach mapping change logs. Keep version history for legal review. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Archive (read-only snapshots)</strong><br><strong>Purpose</strong><br>Immutable period snapshots of AccrualRegister, supporting evidence lists and Reports_Output retained for audit and comparability (WORM-like behavior recommended). <br><strong>Key fields</strong><br> SnapshotID, Period, SnapshotDate, FileRefs, ManifestChecksum, ArchiveLocation, RetentionExpiry. <br><strong>Populated</strong><br> Created at close sign-off; automated macro zips relevant sheets/documents and records checksums. <br><strong>Validations</strong><br> Checksum verification on write; SnapshotDate = close sign-off date; read-only permissions. <br><strong>User action</strong><br> Retrieve prior-period snapshots for audit queries; use manifests to prove immutability. <br><strong>Owner</strong><br> Records / IT. <br><strong>Beginner explanation</strong><br> Snapshots are frozen views of what was reported at close. Don't modify; if you need historic data, extract from Archive rather than re-run with changed mappings. <br><strong>Detailed narrative & practical tips</strong><br> Store manifest including mapping versions, FX rates used, and runbook note for that close. Keep a short “what changed vs prior snapshot” summary to help auditors understand adjustments or restatements. Consider moving older snapshots to colder storage with retrieval SLA documented. <br><strong>Practical examples & troubleshooting</strong><br> If auditors challenge a prior-period mapping, provide Snapshot manifest with Mapping_Change_Log and Audit_Log entries to demonstrate rationale and timing. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Runbook_Readme (procedures & contacts)</strong><br><strong>Purpose</strong><br>Operational runbook: step-by-step close checklist, troubleshooting steps for common failures, escalation contacts and links to training materials and templates. <br><strong>Key fields / contents</strong><br> Close checklist, contact matrix (name/email/backup), top-10 troubleshooting flows, links to key sheets, training video links, change log of runbook edits. <br><strong>Populated</strong><br> Maintained by Process Lead; updated after each close with learnings and post-mortem notes. <br><strong>Validations</strong><br> Contact list up-to-date periodically (quarterly) and last-updated timestamp visible. <br><strong>User action</strong><br> Follow runbook daily during close; consult troubleshooting flows before escalating to IT. <br><strong>Owner</strong><br> Process Lead. <br><strong>Beginner explanation</strong><br> Read this first when you join the close team; it contains the checklists and who to call for common issues. <br><strong>Detailed narrative & practical tips</strong><br> Provide simulated “rehearsal” scripts for new starters and a short “if X then do Y” table for top 8 failures (e.g., missing uploads, FX feed failure, mapping drift). Add runbook sign-off and update history. Include links to critical templates (AccrualRequests template, AccrualsTracker) and sample emails for chasing missing docs. <br><strong>Practical examples & troubleshooting</strong><br> Example run: missing FX feed — run steps: check Treasury feed credentials → fallback to manual FX input in FX_Rates → log override in Audit_Log and notify Controller. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Security_Settings (roles and masks)</strong><br><strong>Purpose</strong><br>Define sheet-level permissions, masked fields (PII), role definitions and emergency access procedures. <br><strong>Key fields</strong><br> RoleName, PermissionsList (View/Edit/Approve), MaskingRules (columns masked), AdminContact, DelegationRules. <br><strong>Populated</strong><br> Maintained by IT Security and Controller. <br><strong>Validations</strong><br> Ensure at least one Admin and at least one backup for roles; masking rules enforced by macros or workbook protection. <br><strong>User action</strong><br> Request access via the documented access request flow; approvers verify DoA before granting. <br><strong>Owner</strong><br> IT Security / Controller. <br><strong>Beginner explanation</strong><br> Some sensitive fields are masked by default (vendor bank details); request temporary access only when needed and approvals are recorded in Audit_Log. <br><strong>Detailed narrative & practical tips</strong><br> Implement periodic access reviews, dual-control for FX overrides and mapping changes, and logging of temporary elevated access. For auditors, use temporary auditor access with read-only view and an expiry timestamp. <br><strong>Practical examples & troubleshooting</strong><br> If a user reports missing sheet access, check Security_Settings and membership in the appropriate AD/SSO group. For emergency auditor access, follow documented temporary access process and record in Audit_Log. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Guidance per sheet (top-left instruction block)</strong><br><strong>Purpose</strong><br>Every sheet should have a mini-instruction card: purpose, quick actions, owner contact and known issues. <br><strong>Contents</strong><br> Purpose summary, Quick Actions (3 items), Who to contact, Known issues, Last updated timestamp, Link to Runbook_Readme. <br><strong>Practical tip</strong><br> Keep the instruction block short and consistent across sheets to reduce onboarding friction; include a “What to check after refresh” checklist (row count, sample lines, top 5 amounts). </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Testing & QA (acceptance & regression)</strong><br><strong>Purpose</strong><br>Define acceptance criteria for any change (mapping rules, wildcard patterns, FX overrides) and the regression tests to run before deploying to production. <br><strong>Key contents</strong><br> Test suite list, test case owners, pass/fail criteria, baseline outputs. <br><strong>Practical tip</strong><br> Require at least one smoke test (ingest → map → convert → consolidate) and a regression run on a small but representative dataset for every production change. Keep test results stored in Test_Data & QA. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Implementation notes & quick checklist for rollout</strong><br><strong>Action list</strong><br> 1) Configure Control named ranges and period parameter. 2) Deploy AccrualRequests template and link Raw_Documents. 3) Configure Power Query sources and perform initial refresh in Test_Data. 4) Populate FX_Rates for current and prior periods. 5) Run reconciliation and validate totals to GL. 6) Pilot with 2 country offices and capture feedback. 7) Document SOP and train users. 8) Snapshot Archive post-pilot. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Appendix: sample automation recipes & macros</strong><br><strong>Recipes</strong><br> - Auto-generate RequestID (prefix ACC-<Period>-NNN) on new AccrualRequests row.<br> - RefreshQueries macro updates LastRefreshTimestamp, writes to Audit_Log and triggers Power Automate approval tasks.<br> - Export_CSV macro validates Adjustments_Journal format and writes ExportLog with checksum.<br> - Snapshot macro zips AccrualRegister + supporting manifests and writes Archive row with checksum. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Appendix: troubleshooting playbook (top 10 issues)</strong><br><strong>Issue & immediate step</strong><br> 1) Missing uploads — check Upload_Tracker, contact preparer, accept conditional late file with note. <br>2) FX rate missing — use approved fallback, log override, notify Treasury. <br>3) Many unmapped rows — check Mappings_Config precedence, run top unmapped accounts frequency report, add mapping test entry in Test_Data. <br>4) Reconciliation difference — reconcile by entity▶mapping▶FX; check rounding. <br>5) Approval bottleneck — use delegated approver recorded in Security_Settings. <br>6) ERP import rejected — use ExportLog to find offending line and fix mapping. <br>7) Reversal missing — check ReversingFlag and ERP reversing schedule; post manual reversal if needed and log in Audit_Log. <br>8) Stale exceptions — escalate via SLA rules. <br>9) Data refresh slow — review PowerQuery folding, push filters upstream. <br>10) Auditor requests prior period — supply Archive snapshot manifest, checksums and supporting docs. </td></tr><tr><td data-label="Accruals Workbook — Sheet-by-sheet explanation"> <strong>Final notes</strong><br>Design the workbook for discoverability and minimal manual edits: use named ranges for parameters, protect configuration sheets, keep mapping and FX owners documented, and maintain a short monthly “lessons learned” note in Runbook_Readme after each close to continuously improve processes. </td></tr></tbody></table></div><div class="row-count">Rows: 25</div></div><div class="table-caption" id="Table3" data-table="Docu_0170_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Comprehensive Bonus Accrual**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Comprehensive Bonus Accrual</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Executive summary</strong><br>This is an end-to-end master manual for monthly bonus accruals in complex funding environments (multi-donor NGOs, mixed legal-entity groups). It combines accounting principles (short-term employee benefits), donor compliance, measurement and allocation rules, operational procedures, automation architecture (Power Query + orchestrator + optional SQL), orchestration runbooks (non-code and code patterns), controls and test scripts, reconciliation procedures, audit-pack standards, KPIs, training/competency frameworks, security hardening, implementation roadmaps and continuous improvement practices. The single audit key is the <strong>RequestID</strong> (<code>ACC-BONUS-YYYYMM-CC-####</code>). The <strong>AccrualRegister</strong> is the canonical single table of record for month-end reporting, donor schedules and audit evidence. This document is implementation-ready for Finance, Grants, HR/Payroll, Internal Audit and IT/Automation teams. <strong>How to use:</strong> copy the AccrualRegister CSV header into ETL; adapt RequestID naming; run the operational runbook; apply validations; capture evidence; upload JE to ERP; archive the audit pack. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Purpose & outcomes</strong><br><strong>(1)</strong> Provide a consistent, auditable process to measure and record monthly bonus accruals for service rendered.<br><strong>(2)</strong> Deterministically allocate costs across donors/projects/overheads.<br><strong>(3)</strong> Produce donor-ready schedules and disclosures.<br><strong>(4)</strong> Provide automation and tooling to enforce validations and evidence capture.<br><strong>(5)</strong> Deliver audit packs meeting external audit and donor audit standards.<br><strong>(6)</strong> Minimise financial statement restatements and donor disputes.<br><strong>(7)</strong> Provide clear ownerable controls and remediation paths for variances.<br><strong>(8)</strong> Build a continuous improvement loop that reduces manual exceptions and improves forecast accuracy.<br><strong>(9)</strong> Ensure deterministic traceability from AccrualRequest → supporting evidence → posted JE → clearance. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Scope & exclusions</strong><br><strong>Scope:</strong> annual pro-rata, quarterly, spot awards, retention/contractual bonuses, sign-on/exit payments, commissioned/incentive arrangements (contract-defined), consultant contractual bonuses where contract stipulates payment; applies to HQ, country offices, sub-offices, branch offices, pooled funds, shared service centres and intercompany secondments.<br><strong>Exclusions:</strong> equity-based compensation (RSUs, options), actuarial long-term employee benefits (defined benefit pension liabilities), litigated settlements until legally settled, payroll taxes requiring actuarial models.<br><strong>Boundary rule:</strong> any arrangement with vesting or settlement beyond 12 months must be escalated to payroll tax and actuarial specialists for separate treatment.<br><strong>Local law note:</strong> always consult local payroll/tax teams for statutory exceptions; document legal opinion in RequestID folder. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Accounting framework & principles</strong><br><strong>Recognition principle:</strong> recognise undiscounted liabilities and matching expense for bonuses when service is rendered and a present obligation exists (short-term employee benefit).<br><strong>Measurement principle:</strong> measure at the best estimate of the amount payable; document assumptions, drivers and evidence.<br><strong>Standards references:</strong> IAS 19 / local GAAP short-term employee benefits; where local practice diverges, document deviations and approvals.<br><strong>Presentation & disclosure:</strong> record accruals as current liabilities (Accrued Bonuses) and present expense under staff costs; disclose measurement policies, donor-specific treatments, and material restatements.<br><strong>Judgement policy:</strong> any management judgement that materially affects accrual must be described in the calculation worksheet and supported by a rationale signed by Country FD. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Core measurement model (conceptual)</strong><br><strong>Inputs (per employee):</strong> EstimatedAnnualBonus, ServiceFractionForMonth (days/hours), EligibilityFactor, AdvancesPaid, ConfidenceLevel, ContractualObligationFlag, PayoutTrigger, PaymentGrossOrNet.<br><strong>Calculation:</strong> <code>MonthlyAccrual = EstimatedAnnualBonus × (ServiceFractionForMonth / 12) × EligibilityFactor − AdvancesAllocatedThisMonth</code>.<br><strong>ConfidenceLevel:</strong> High (contract + timesheet), Medium (HR estimate + manager cert), Low (management estimate) — route to approval tiers based on confidence.<br><strong>Audit rule:</strong> save calculation workbook and M-code snapshot in RequestID folder.<br><strong>Rounding:</strong> use country-specific rounding rules and record residual distribution policy (usually overhead). </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Allocation governance (source of truth & precedence)</strong><br><strong>Allocation precedence:</strong> <br>(1) donor contract clause; <br>(2) award/budget amendment; <br>(3) Grants-approved allocation matrix; (4) validated timesheets/effort logs; <br>(5) default budgeted FTE.<br><strong>Driver hierarchy:</strong> prefer timesheets; if absent, use Grants matrix.<br><strong>Multi-entity:</strong> split into RequestIDs per legal entity or use multiple JE lines where ERP supports cross-entity JEs; always retain per-employee breakdown.<br><strong>Allocation metadata:</strong> store driver, source file, timestamp and Grants approver in AccrualRegister.<br><strong>Tie-breaker:</strong> if two drivers conflict, require written Grants exception and DoA approval referencing RequestID. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Accrual lifecycle & states</strong><br><strong>State machine:</strong> Draft → PendingApproval → PendingPost → Posted → Matched/PartiallyMatched → Cleared → Disputed → Adjusted/ADJ → Closed.<br><strong>Audit trail:</strong> each state change must be timestamped, user-attributed and saved to <strong>AutomationLog</strong> with run hash and reference to snapshot files.<br><strong>Roles:</strong> Preparer, Allocator, Approver, Poster, Reconciler, AutomationOps, InternalAudit.<br><strong>Security rule:</strong> only Poster can set Posted; Posted snapshots are immutable.<br><strong>Exception handling:</strong> transitions to Disputed or Adjusted require a DisputeRegister entry and documented sign-off path. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>RequestID & AccrualRegister standards</strong><br><strong>RequestID format:</strong> <code>ACC-BONUS-YYYYMM-CC-####</code> with optional suffixes: <code>-ADJ</code> (adjustment), <code>-EXC</code> (exception), <code>-AGG</code> (aggregation).<br><strong>AccrualRegister canonical fields (minimum):</strong> RequestID, SchemaVersion, Period, LegalEntity, CountryCode, EmployeeID, EmployeeName, PayrollID, JobTitle, Department, ContractType, ContractRef, EstimatedAnnualBonus, ServiceFractionForMonth, ServiceDays, EligibilityFactor, ConfidenceLevel, AdvancePaid_Local, MonthlyAccrual_Local, Currency, FXRate, Amount_ReportCurrency, TotalAllocationPct, AllocationMethod, AllocationDriverFile, ProjectLines_JSON, DonorLines_JSON, SupportingDocsLinks, Preparer, PreparerDate, Allocator, AllocatorDate, Approver, ApproverDate, PostedJERef, PostedDate, MatchedPaymentRef, ClearedDate, Status, StateHistory_JSON, Notes, SchemaHash.<br><strong>Single-source rule:</strong> AccrualRegister is canonical — reconcile any local spreadsheets to it before posting.<br><strong>Naming governance:</strong> reserve RequestID sequences per country to prevent collisions; persist sequences centrally (DB or SharePoint list). </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Documentation & minimum evidence pack</strong><br><strong>Minimum evidence per RequestID (zipped audit pack):</strong> payroll extract or contract clause showing entitlement, timesheet/effort logs or allocation matrix, manager certification (signed/timestamped email acceptable), Grants approval for donor splits, DoA approval if required, calculation workbook (XLSX/PDF), PQ/ETL snapshot (M-code capture), GL posting export (ERP), bank/payment advice or remittance evidence, variance memos and resolution emails.<br><strong>Folder structure (recommended):</strong> <code>&lt;BaseFolder&gt;/&lt;Period&gt;/&lt;RequestID&gt;/calc.xlsx</code><br><code>timesheet.csv</code><br><code>manager_cert.pdf</code><br><code>grants_approval.pdf</code><br><code>doa_approval.pdf</code><br><code>je_export.csv</code><br><code>bank_advice.pdf</code><br><code>validation_report.pdf</code><br><code>readme.txt</code>.<br><strong>Retention:</strong> retain per the longer of statutory or donor retention (document retention policy in Config).<br><strong>Indexing:</strong> include <code>manifest.csv</code> with SHA256 checksums for files in pack. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Validation rules (pre-post gates)</strong><br><strong>ValidationReport row fields:</strong> RequestID, CheckCode, CheckName, Severity (CRITICAL/HIGH/MEDIUM/LOW), Result (PASS/FAIL), Details, FixAction, Owner, DueDate.<br><strong>Blocker rules (must pass to post):</strong><br>1) Allocation sums equal 100% (timesheet-based).<br>2) Project→Donor splits sum to 100% per project line.<br>3) Supporting docs present (payroll/contract, timesheet/alloc matrix, manager cert).<br>4) DonorCashOnlyFlag prohibits donor charge and requires reallocation.<br>5) FXRate provided for non-functional currencies.<br>6) ConfidenceLevel set and material accruals signed-off by Country FD.<br><strong>Validation metadata:</strong> capture who ran the validation and parameter values used. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>GL mapping & journal presentation</strong><br><strong>Journal pattern:</strong> Debit Staff Expense (split by project/donor) — Credit Accrued Bonuses (current liability).<br><strong>On payment:</strong> Debit Accrued Bonuses — Credit Bank/Cash; if payment differs, record variance to BonusVariance GL or FXVariance.<br><strong>JE narrative mandatory:</strong> <code>Accrual — Monthly Bonus — YYYY-MM — &lt;RequestID&gt; — EmpID &lt;ID&gt; — &lt;AllocationSummary&gt;</code>.<br><strong>JE export CSV header:</strong> <code>JE_ID,JE_LineNo,JE_Date,AccountCode,Debit,Credit,CostCenter,ProjectCode,DonorCode,EmployeeID,Narrative,RequestID,IntercompanyFlag,IntercompanyCounterparty</code>.<br><strong>Intercompany:</strong> when cross-entity, include intercompany memo lines and record receivable/payable; reconcile monthly. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>FX & reporting currency policy</strong><br><strong>Functional currency:</strong> book accruals in legal-entity functional currency.<br><strong>Group reporting:</strong> translate using period-end closing rate; store FXRate source and timestamp in AccrualRegister.<br><strong>Payment currency mismatch:</strong> remeasure at payment date and post FX variance; allocate variance to donors per award clause or to overhead if silent.<br><strong>FX source:</strong> maintain central FX table (daily close rates) with provenance noted (central bank/vendor) in Config.<br><strong>Disclosure:</strong> disclose material FX variances and methodology in donor reconciliations. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Tax & payroll statutory treatment (practical)</strong><br><strong>Decision matrix (per jurisdiction):</strong> tax timing (accrual/payment), statutory social obligations (accrual/payment), withholding execution rules, reporting thresholds.<br><strong>Action rules:</strong> tag RequestIDs by jurisdiction for statutory treatment; generate statutory workpapers where accrual triggers statutory liabilities.<br><strong>Consultant gross-up rule:</strong> <code>Gross = Net / (1 - WithholdingRate)</code> and store gross-up worksheet in RequestID folder.<br><strong>Escalation:</strong> material tax ambiguity → payroll tax advisor & Legal sign-off; attach legal opinion to RequestID if required. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Aggregation & materiality policy</strong><br><strong>Threshold policy:</strong> define per-country per-employee threshold (example: IDR 50,000).<br><strong>Aggregation rule:</strong> if per-employee accrual < threshold, create aggregated RequestID <code>-AGG</code> and store per-employee breakout spreadsheet in the pack (encrypted or restricted).<br><strong>Donor visibility:</strong> donor schedules are computed from per-employee breakout to preserve donor-level reporting.<br><strong>Approval:</strong> Country FD sign-off required for aggregation.<br><strong>Auditability:</strong> aggregated RequestID must support drill-down; maintain encrypted breakouts or restricted folder access. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Variance management & rounding handling</strong><br><strong>Rounding policy:</strong> round to smallest local currency unit; residuals < roundingTolerance allocate to overhead or specified bucket; log rounding line with approver.<br><strong>Variance thresholds:</strong> define absolute and percentage thresholds; exceedances require variance memo, approver sign-off, corrective JE and RCA.<br><strong>Recurring variances:</strong> document RCA and implement fixes (improve calculation, time capture, allocation rules).<br><strong>Variance reporting:</strong> monthly pack showing accrual vs payment by RequestID, donor, project, and legal entity. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Restatements & adjustments</strong><br><strong>Retroactive policy:</strong> quantify period-by-period impact; if material per group thresholds, consult external auditor and create ADJ RequestIDs dated to affected periods where permitted.<br><strong>Naming convention:</strong> suffix <code>-ADJ</code> and reference original RequestID in notes.<br><strong>Workpapers:</strong> include redline pre/post calculations and approvals.<br><strong>Disclosure:</strong> prepare restatement memo for external audit and donor reporting when required.<br><strong>Controls:</strong> require sign-off chain for restatements including Country FD and Global Finance Director. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Donor-specific controls & reporting</strong><br><strong>Donor matrix:</strong> maintain Grants metadata linking RequestIDs to award, budget line, donor terms (cash-only, disallowances, documentation).<br><strong>Cash-only handling:</strong> reclassify donor-charged accruals to internal funding and mark as <code>Not claimed — cash-only</code> in donor schedule.<br><strong>Donor schedule template:</strong> <code>DonorCode,DonorName,AccrualAmount,PaymentsClaimed,NotClaimed_CashOnly,Notes,RequestIDs</code>.<br><strong>Pooled funds:</strong> distribute accruals per pool agreement; store pool allocation memo in RequestID pack.<br><strong>Donor audit requests:</strong> supply zipped audit packs with manifest and checksums; use signed readme. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Dispute & escalation workflow</strong><br><strong>Lifecycle:</strong> New → Assigned → Investigating → Resolved → Closed.<br><strong>SLA targets:</strong> assignment ≤ 2 business days; resolution ≤ 15 business days.<br><strong>Escalation path:</strong> unresolved > 30 days → Country FD; > 60 days → Regional FD/Head of Grants.<br><strong>DisputeRegister fields:</strong> DisputeID, RequestID, RaisedBy, RaisedDate, IssueSummary, EvidenceLinks, AssignedTo, Status, TargetResolutionDate, ResolutionDate, Outcome, Notes.<br><strong>Communication trail:</strong> store all emails and approvals in RequestID folder for audit; log remediation plan for systemic issues. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Automation architecture (principles & stack)</strong><br><strong>Principles:</strong> single source of truth (AccrualRegister), idempotent transforms, parameterised queries, separation of compute & orchestration, auditability, RBAC, immutability of Posted records.<br><strong>Recommended stack:</strong> Excel + Power Query (pilot) → Power BI dataset or SQL staging (scale) → central RequestID sequence service (REST/DB) → orchestration (Power Automate / Azure Functions / serverless) → ERP integration (file/SFTP/API).<br><strong>Design rule:</strong> PQ reads only; orchestrator performs writes, sequence persistence and folder management.<br><strong>Observability:</strong> central AutomationLog with run hashes, file references and health metrics. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Automation operational design patterns</strong><br><strong>PQ parameters:</strong> Period, BaseFolder, CountryCode, RunID.<br><strong>PQ outputs:</strong> AccrualRegister_Draft.csv, ExpandedAllocationLines.csv, JE_Export.csv, ValidationReport.pdf, pq_manifest.json.<br><strong>Orchestrator tasks:</strong> run preflight checks, generate RequestIDs, run validations, create RequestID folder, snapshot calc workbook to PDF, export JE files, submit to ERP with idempotencyKey = RunID+RequestID, poll for PostedJERef, zip audit packs, sign manifest, update AutomationLog.<br><strong>AutomationLog fields:</strong> RunID, Step, SubStep, RequestID(optional), User, Service, StartUTC, EndUTC, DurationSeconds, Status, ErrorCode, ErrorMessage, FilesCreatedJSON, ChecksumsJSON, CommitHash, Environment, Notes (append-only).<br><strong>Locking:</strong> use strong DB/ticket lease patterns for posting; allow one poster per legal-entity/period. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Data model & schema governance</strong><br><strong>Schema contract:</strong> versioned AccrualRegister schema; include SchemaVersion and SchemaHash on each run.<br><strong>Essential fields (reference):</strong> RequestID, SchemaVersion, Period, LegalEntity, EmployeeID, PayrollID, JobTitle, EstimatedAnnualBonus, MonthlyAccrual_Local, Currency, FXRate, Amount_ReportCurrency, ProjectLines_JSON, DonorLines_JSON, SupportingDocsLinks, ConfidenceLevel, Preparer/Approver metadata, PostedJERef, Status, StateHistory_JSON, Notes.<br><strong>ETL note:</strong> store M-code snapshot or PQ query text in per-run snapshot file for auditor verification.<br><strong>Schema evolution:</strong> add fields compatibly and include schema version in file metadata; reject runs if required fields missing. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Sample AccrualRegister CSV header (copy-ready)</strong><br><code>RequestID,SchemaVersion,Period,LegalEntity,CountryCode,EmployeeID,EmployeeName,PayrollID,JobTitle,Department,ContractType,ContractRef,EstimatedAnnualBonus,ServiceFractionForMonth,ServiceDays,EligibilityFactor,ConfidenceLevel,AdvancePaid_Local,MonthlyAccrual_Local,Currency,FXRate,Amount_ReportCurrency,TotalAllocationPct,AllocationMethod,AllocationDriverFile,ProjectLines_JSON,DonorLines_JSON,SupportingDocsLinks,Preparer,PreparerDate,Allocator,AllocatorDate,Approver,ApproverDate,PostedJERef,PostedDate,MatchedPaymentRef,ClearedDate,Status,StateHistory_JSON,Notes,SchemaHash</code> </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Operational runbook (detailed step-by-step)</strong><br><strong>Pre-close (T-20 → T-10):</strong> validate Config, GLMap, GrantsMatrix, FX table, input file placement, DoA list, confirm payroll extract schedule.<br><strong>T-10 → T-6:</strong> run PQ (draft) → AccrualRegister_Draft; managers provide timesheets & certs; Grants confirm donor splits; run pre-validation and log exceptions.<br><strong>T-5 → T-3:</strong> remediate validation failures; prepare ApprovalBatch and ValidationReport; escalate unresolved items to Country FD.<br><strong>T-2:</strong> capture final approvals; Grants final sign-off for donor-split exceptions.<br><strong>T-1:</strong> orchestrator issues RequestIDs, creates audit folders, snapshots calc workbook to PDF and attaches ValidationReport.<br><strong>T0 (close):</strong> Poster runs Post job to export JE_Export.csv and import into ERP; capture PostedJERef and export GL reconciliation.<br><strong>T+0–T+5:</strong> reconcile ERP GL balances to AccrualRegister and resolve posting discrepancies.<br><strong>T+5–T+30:</strong> match bank payments, clear RequestIDs and post variance JEs as required; archive completed RequestIDs to period archive.<br><strong>Post-close:</strong> produce KPI package, run retrospective, schedule remediation backlog. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Controls & test scripts (auditor-focused)</strong><br><strong>Control objectives:</strong> Existence, Completeness, Accuracy, Allocation, Presentation, Automation integrity.<br><strong>Monthly test script (example):</strong><br>1) Extract AccrualRegister for period P.<br>2) Random stratified sample N = min(30, 5% of Posted RequestIDs, at least 10).<br>3) For each sample RequestID: open audit pack and verify payroll extract, manager cert, timesheet and Grants approval.<br>4) Recalculate MonthlyAccrual and compare to posted value within rounding tolerance.<br>5) Verify allocation splits sum to 100% and donor splits derive from driver.<br>6) Trace PostedJERef in ERP and confirm GL lines and narrative include RequestID.<br>7) Review AutomationLog for run and M-code snapshot matching files.<br>8) Document exceptions and require remediation owner and ETA. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>KPIs, dashboard items & targets</strong><br><strong>KPIs:</strong> Evidence completeness ≥95%; Average open accrual age <30 days; % accruals cleared within month+1 ≥90%; Number of material variances ≤5/month; Automation error rate <2% first-run; %ConfidenceLevel=High target >80%.<br><strong>Dashboard items:</strong> open exceptions by type, accrual by donor vs budget, variance trend, automation run health, top recurring issues by employee/project.<br><strong>Sample SQL (open exceptions):</strong> <code>SELECT Period, COUNT(*) AS OpenExceptions FROM AccrualRegister WHERE Status IN (&#x27;Draft&#x27;,&#x27;PendingApproval&#x27;,&#x27;Disputed&#x27;) GROUP BY Period;</code> </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>RACI matrix (core roles & thresholds)</strong><br><strong>Preparer:</strong> HR/Payroll — prepare payroll extract and draft accruals.<br><strong>Allocator:</strong> Grants/Program — validates donor splits and allocation drivers.<br><strong>Approver:</strong> Manager/Country FD — approves eligibility and amounts per DoA thresholds.<br><strong>Poster:</strong> Finance Ledger — validates JE export and posts to ERP.<br><strong>AutomationOps:</strong> run orchestration, maintain PQ and sequence service.<br><strong>Internal Audit:</strong> periodic sample testing and controls review.<br><strong>Security owner:</strong> IT Security — RBAC and key vault management. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Training & competency framework</strong><br><strong>Role-specific modules:</strong><br>Payroll (4 hrs): accrual formula, PQ preview, inputs.<br>Grants (3 hrs): donor rules, allocation matrix, cash-only handling.<br>Finance Poster (6 hrs): JE mapping, ERP import, reconciliation.<br>Approvers (2 hrs): DoA, evidence expectations.<br>Automation Ops (6 hrs): PQ parameterisation, orchestration runbook, manual fallback.<br><strong>Deliverables:</strong> slide decks, job-aids, recorded sessions, competency quizzes and sign-off logs.<br><strong>Assessment:</strong> pass rate 90% for role sign-off; maintain training logs for audit. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Security, privacy & operational compliance</strong><br><strong>Data protection:</strong> RBAC least privilege — restrict AccrualRegister_Posted and supporting docs to authorised roles.<br><strong>PII handling:</strong> mask/pseudonymise PII in shared reports; store full PII in secure HR systems only.<br><strong>Encryption:</strong> encrypt audit backups at rest and in transit; use SFTP/HTTPS.<br><strong>Credentials:</strong> use key vault/service accounts; avoid embedded credentials in PQ.<br><strong>Audit trail:</strong> log all access and changes to AccrualRegister in AutomationLog.<br><strong>Breach response:</strong> include forensic capture of AutomationLog and evidence packs in incident plan. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Change control, versioning & exceptions</strong><br><strong>Change log template:</strong> <code>Version,Date,ChangeSummary,Owner,Approver,ImpactNotes</code>.<br><strong>Release process:</strong> dev→test→release with change request and sign-off by Global Finance Director for PQ/orchestration changes.<br><strong>Exceptions register:</strong> track PolicyExceptions with rationale, approver and expiry.<br><strong>Rollback:</strong> keep pre-run backups for 30-day rollback window; record rollback action in AutomationLog and remediation plan. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Implementation roadmap (phased)</strong><br><strong>Phase 0 — Governance & design:</strong> policy, DoA, GLMap, GrantsMatrix, thresholds and sample data.<br><strong>Phase 1 — Pilot (1 country):</strong> build PQ transforms, test with sample inputs, manual review and audit sample.<br><strong>Phase 2 — Orchestration:</strong> implement RequestID sequence service, folder automation, JE export and audit-pack zipping.<br><strong>Phase 3 — Scale:</strong> central sequence service, approvals UI, migrate PQ to central dataset or SQL staging.<br><strong>Phase 4 — Stabilise:</strong> KPI monitoring, internal audit cycle, fix recurring issues.<br><strong>Phase 5 — Continuous improvement:</strong> forecasting, improved time capture, periodic external assurance. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Migration to central platform (target architecture & API contract)</strong><br><strong>Target stack:</strong> Source systems → SQL staging → Power BI dataset/data warehouse → approvals UI → orchestration service → ERP integration.<br><strong>RequestID API (contract):</strong> <code>POST /requestid</code> <code>{period,legalEntity,createdBy,runId,count,idempotencyKey}</code> → returns <code>{requestIds,runId,issuedAt}</code>; <code>PATCH /requestid/{id}/approve</code> <code>{approver,role,approvedAt,notes}</code> → returns <code>{requestId,status}</code>; <code>GET /requestid/{id}</code> returns metadata.<br><strong>Idempotency:</strong> endpoints support idempotency keys; transactional NextVal logic per (country,period) namespace. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Sample governance templates & narratives</strong><br><strong>Journal narrative:</strong> <code>Accrual — Monthly Bonus — 2026-01 — ACC-BONUS-202601-ID-0001 — EmpID 12345 — 60% ProjA (DonorX) / 40% Overhead.</code><br><strong>Donor email template:</strong> <code>Attached are management accruals for [Period]. Donor-charged amounts are supported by allocation drivers and approvals (RequestIDs: ...). Donors requiring cash-basis are excluded and shown separately; full audit packs available on request.</code><br><strong>Variance memo:</strong> <code>RequestID X: accrual {A} vs payment {B}. Cause: {reason}. Proposal: {treatment}. Approval: {name/date}.</code> </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Sample audit-pack index & manifest</strong><br><strong>Manifest header:</strong> <code>Filename,RelPath,FileSizeBytes,SHA256Hex,MimeType,Creator,CreatedUTC,Notes</code>.<br><strong>Pack contents per RequestID:</strong> calc.xlsx, timesheet, manager_cert, grants_approval, doa_approval, je_export, bank_advice, validation_report, automation_log snippet, pq_snapshot.<br><strong>Integrity:</strong> provide SHA256 checksums and HMAC-signed manifest; provide read-only links with expiry for auditors. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Operational QA & go-live acceptance</strong><br><strong>Pre-go-live criteria:</strong> successful pilot month with internal audit sample pass; KPIs meeting targets; automation error rate <2% first-run; training sign-offs completed; fallback manual runbook validated; PQ/orchestration code versioned in repository; stakeholder sign-off (Payroll, Grants, Finance, IT documented).<br><strong>Go-live actions:</strong> controlled go-live month, expanded audit sample, KPI monitoring daily for first month, defects in 14-day sprints.<br><strong>Hypercare:</strong> daily stand-ups for first 10 business days then weekly until stable. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Continuous monitoring & improvement</strong><br><strong>Monthly:</strong> KPI review, top 10 variances, automation failures, exceptions and dispute metrics; log RCA and prioritise fixes.<br><strong>Quarterly:</strong> control self-assessment, training refresh, donor spot-checks.<br><strong>Semi-annual:</strong> internal audit sample and remediation follow-up.<br><strong>Annual:</strong> policy review and major roadmap planning. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Appendix: operational examples & forensic recipes</strong><br><strong>Example A — Single-fund numeric:</strong> Employee J AnnualBonus 24,000,000 IDR ServiceFraction 1.0 Eligibility 1.0 MonthlyAccrual 2,000,000 IDR → JE DR ProjectA Expense 2,000,000 / CR Accrued Bonuses 2,000,000; Payment 1,950,000 → variance 50,000 to BonusVariance GL.<br><strong>Example B — Multi-funder with timesheets:</strong> Employee K monthly accrual 1,200,000 IDR; timesheet 160h: ProjectX 120h (75%), ProjectY 40h (25%); ProjectX donors Donor1 60% Donor2 40% → allocation lines: ProjectX-Donor1 540,000 IDR; ProjectX-Donor2 360,000 IDR; ProjectY-Overhead 300,000 IDR.<br><strong>Example C — FX & consolidation:</strong> Local accrual 1,500,000 IDR; period-end FX 15,000 IDR/USD → USD 100 reported; Payment in USD 98 → FX variance USD 2 (IDR 30,000) allocated per donor split.<br><strong>Example D — Probationary mid-period leaver:</strong> Employee L AnnualBonus 12,000,000 IDR probation 6 months, left day 10 service fraction 10/30 = 0.333 preliminary accrual 333,333 IDR EligibilityFactor 0.0 → accrual zero create <code>-EXC</code> RequestID; store termination letter and manager discretion; if later approved create ADJ RequestID.<br><strong>Example E — Spot award mid-month:</strong> Spot award 5,000,000 IDR covering days 1–12 ServiceFraction 0.4 MonthlyAccrual 2,000,000 IDR allocate 100% to ProjectZ DonorA; evidence: approval email timestamp and manager cert.<br><strong>Example F — Retention bonus multi-month:</strong> Contract 12,000,000 IDR paid after 6 months earned evenly monthly 2,000,000 IDR terminate after 4 months reverse unearned 4,000,000 IDR with ADJ RequestID and HR sign-off.<br><strong>Example G — Consultant gross-up:</strong> Net USD 2,000 withholding 10% Gross = 2,000/0.9 = 2,222.22 → Accrual DR Consultant Expense 2,222.22 / CR Accrued Liabilities 2,222.22; Payment: DR Accrued 2,222.22 CR Cash 2,000 CR Tax Payable 222.22.<br><strong>Example H — Aggregation:</strong> threshold IDR 50,000; 40 employees ×30,000 = AGG RequestID 1,200,000; store per-employee breakout for audit and derive donor schedule from breakout.<br><strong>Example I — Restatement due to formula bug:</strong> underaccrual across 3 months total 330,000 IDR → create ADJ RequestIDs per period, include M-code bug snapshot, prepare restatement memo and consult external auditors.<br><strong>Example J — Negative accrual (advance recover):</strong> Advance 6,000,000 recoup 2,000,000 monthly → recovery JE DR Accrued Bonuses 2,000,000 / CR Payroll Recoveries 2,000,000 until recovered.<br><strong>Forensic recipe (copy-ready):</strong><br>1) Identify suspect RequestIDs/periods.<br>2) Pull AccrualRegister snapshots for runs R1..Rn.<br>3) Extract pq_manifest and M-code snapshots for first divergent run.<br>4) Recompute accruals from preserved inputs using previous M-code snapshot.<br>5) Document deltas per RequestID & aggregate.<br>6) Create <code>-ADJ</code> RequestIDs per period with redline workbook showing pre/post; obtain approvals and notify auditor if material. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Appendix: copy-ready artifacts & specs (quick)</strong><br><strong>AccrualRegister CSV header:</strong> see sample header above.<br><strong>ProjectLines_JSON sample:</strong> <code>[{&quot;ProjectCode&quot;:&quot;PRJ-100&quot;,&quot;ProjectName&quot;:&quot;Health&quot;,&quot;ProjectAllocationPct&quot;:60},{&quot;ProjectCode&quot;:&quot;PRJ-200&quot;,&quot;ProjectName&quot;:&quot;WASH&quot;,&quot;ProjectAllocationPct&quot;:40}]</code>.<br><strong>DonorLines_JSON sample:</strong> <code>[{&quot;DonorCode&quot;:&quot;DNR-A&quot;,&quot;DonorName&quot;:&quot;Donor A&quot;,&quot;DonorAllocationPct&quot;:60},{&quot;DonorCode&quot;:&quot;DNR-B&quot;,&quot;DonorName&quot;:&quot;Donor B&quot;,&quot;DonorAllocationPct&quot;:40}]</code>.<br><strong>RequestID API sample requests/responses:</strong> see RequestID Sequence Service — API contract above.<br><strong>AutomationLog schema:</strong> see AutomationLog fields above.<br><strong>Manifest spec:</strong> <code>Filename,RelPath,FileSizeBytes,SHA256Hex,MimeType,Creator,CreatedUTC,Notes</code> signed with HMAC-SHA256.<br><strong>Validation codes list:</strong> V001–V014 as defined in Validation rules section. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Implementation immediate next-steps (operational)</strong><br>1) Approve RequestID API contract and provision SequenceService (DB schema + REST).<br>2) Build PQ transforms and pq_manifest capture; store M-code snapshot per run.<br>3) Implement Validation engine with codes V001–V014 and ValidationReport output.<br>4) Run pilot month and perform internal audit sample (N≥30).<br>5) Harden secret storage (KeyVault) and enable AutomationLog replication.<br>6) Publish SOPs, train users and record approvals. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Governance, risk & retention</strong><br><strong>Risk matrix (top risks & mitigations):</strong><br>1) Sequence collisions → central DB sequences + transactional issuance.<br>2) Missing evidence → validation gates block posting.<br>3) Donor disputes → Grants pre-confirmation & donor schedule transparency.<br>4) Tax mis-treatment → payroll tax advisor involvement & legal opinion retention.<br>5) Automation outages → fallback manual runbook & TMP mapping.<br>6) Data tampering → manifest checksums, HMAC-signed manifests, immutable AutomationLog.<br><strong>Retention baseline:</strong> donor-funded accruals 7 years (or donor-specific period if longer); automation logs & pq_manifest 7 years; ADJ/restatement memos indefinite. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Change log & versioning</strong><br><code>change_log.csv</code> template: <code>Version,Date,ChangeSummary,Owner,Approver,ImpactNotes</code> — required for policy, schema or PQ/orchestrator change; store in Config and include commit hashes for M-code/orchestrator artifacts. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Acceptance & sign-off (go-live)</strong><br><strong>Acceptance criteria (must all be met):</strong><br>1) Pilot month executed and internal audit sample pass ≥90%.<br>2) PQ M-code snapshot stored and test harness passed.<br>3) AutomationLog entries present and replicated.<br>4) RequestID service returns unique IDs under load test.<br>5) JE import tested with ERP sandbox and PostedJERef captured.<br>6) Evidence manifest produced and HMAC-signed.<br>7) Training sign-offs recorded and fallback runbook validated.<br><strong>Sign-off owners:</strong> Country FD, Global Finance Director, Head of Grants, IT Security. </td></tr><tr><td data-label="Comprehensive Bonus Accrual"> <strong>Final operational guidance</strong><br>Implement conservatively: pilot with 1–2 countries (one complex multi-donor, one simple), enforce strict validation, centralise sequence service early, instrument heavy observability, and maintain conservative donor treatment defaults (do not charge donor where ambiguous). Prioritise immutability of posted evidence, idempotent side-effects and a clear reconciliation path for temporary states. </td></tr></tbody></table></div><div class="row-count">Rows: 42</div></div><div class="table-caption" id="Table4" data-table="Docu_0170_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Conceptual VBA &amp; Power Query (PQ)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual VBA & Power Query (PQ)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Preface & intent</strong><br>This expansion deepens the conceptual patterns, operational controls and governance principles for VBA orchestration and Power Query transforms. It is deliberately non-code: focused on design, failure modes, observability, security, scalability and auditability so implementers, architects and auditors can translate to their technical stack without accidental coupling to particular implementations. Use this as a prescriptive checklist and architecture playbook. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Principles & separation of concerns</strong><br><strong>Separation of concerns:</strong> PQ = pure, idempotent read/transform logic (no side-effects). VBA/orchestrator = deterministic side-effects (sequence requests, folder creation, REST calls, uploads, zips).<br><strong>One-way contracts:</strong> define interfaces: PQ inputs (staging files, config), PQ outputs (draft CSVs, validation table, metadata). Orchestrator consumes outputs and performs side-effects.<br><strong>Design intent:</strong> reduce blast radius; allow safe PQ re-runs; ensure orchestrator can replay side-effects idempotently. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Run parameters & reproducibility</strong><br><strong>Run descriptor:</strong> every run produces an immutable descriptor: <code>RunID</code>, <code>Period</code>, <code>LegalEntity</code>, <code>Mode</code> (Draft/Post), <code>ConfigHash</code>, <code>InputChecksums</code>.<br><strong>Reproducibility:</strong> store descriptor, M-code snapshot, parameter file and input checksums to enable reruns and forensic comparisons.<br><strong>Promotion:</strong> promote identical parameter sets between dev/test/prod; parameter changes require documented release notes. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Idempotency & safe side-effects (conceptual)</strong><br><strong>Idempotency keys:</strong> all side-effect operations (sequence requests, uploads, ERP posts) invoked with an idempotency key derived from RunID + deterministic element (employee+period).<br><strong>Two-phase effect model:</strong> prepare → execute → confirm. Orchestrator must support safe replay using idempotency keys.<br><strong>Temporary identifiers:</strong> generate <code>TMP-</code> IDs when sequence service unavailable and reconcile TMP→official later. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Sequence generation & reconciliation</strong><br><strong>Central sequence service:</strong> authoritative sequence per (country,period) namespace to avoid collisions.<br><strong>Fallback & reconciliation:</strong> if offline, produce TMP IDs, save TMP manifest, and automate TMP→official reconciliation when service restores.<br><strong>Audit linkage:</strong> always include TMP→official mapping file in run folder with operator and timestamp. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Locking & concurrency control (conceptual)</strong><br><strong>Lock types:</strong> soft locks for read/validation; strong locks for posting.<br><strong>Lock acquisition:</strong> prefer DB/ticket-based leases (with TTL and auto-renew) over filesystem heuristics.<br><strong>Concurrency strategy:</strong> orchestrator queues posts and permits one poster per legal-entity/period to avoid double-posts. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Validation gating & approval choreography</strong><br><strong>Validation levels:</strong> Gate 1 — syntactic (types/nulls); Gate 2 — business (allocation sums, donor rules); Gate 3 — managerial (manager certs, Grants approval); Gate 4 — FD sign-off for material items.<br><strong>Approval choreography:</strong> support bulk approvals and line-by-line approvals; capture approver identity, timestamp and comments; persist audit trail linking approvals to RequestIDs.<br><strong>Soft-fail vs hard-fail:</strong> soft-fail → exception workflow; hard-fail → block posting. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Evidence capture & immutable snapshots</strong><br><strong>Snapshot policy:</strong> on final approval orchestrator snapshots: final AccrualRegister, M-code text, input checksums, ValidationReport and calculation workbook PDF.<br><strong>Immutable storage:</strong> store snapshots in write-once or versioned object store with strict ACLs.<br><strong>Manifest:</strong> each RequestID folder includes manifest listing files with SHA256 and signed run descriptor. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>AutomationLog & telemetry design</strong><br><strong>Log model:</strong> append-only AutomationLog with structured entries: RunID, Step, SubStep, User, Machine, StartUTC, EndUTC, Status, FilesCreated, Checksums, Error codes.<br><strong>Storage:</strong> central DB or ELK-like store for search, reporting and alerting.<br><strong>Correlation:</strong> correlate AutomationLog with ERP PostedJERefs, SFTP logs and bank-matching events for end-to-end traceability. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Observability, metrics & dashboards</strong><br><strong>Key telemetry:</strong> run success rate, validation failure rate, evidence completeness %, avg time to clear accruals, JE post latency, number of TMP RequestIDs, dispute counts, automation error rate.<br><strong>Dashboards:</strong> per-country and global with trend lines and exception drill-downs.<br><strong>Alerts:</strong> threshold-based alerting for failed runs, missing sequence service, evidence completeness below threshold. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Error handling & remediation framework</strong><br><strong>Error classification:</strong> transient (network/timeout), permanent (data/contract rule), operational (missing approvals), systemic (sequence service outage).<br><strong>Remediation patterns:</strong> automatic retry with exponential backoff for transient issues; flag manual intervention for permanent; auto-create operational tickets for systemic issues with SLAs.<br><strong>Retry windows:</strong> define safe retry windows for each irreversible side-effect; prevent blind retries without idempotency. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Security, secrets & token lifecycle</strong><br><strong>Secrets model:</strong> orchestrator retrieves secrets at runtime from secure vault (KeyVault); never embed secrets in PQ or signed macros.<br><strong>Token lifecycle:</strong> short-lived tokens; runtime refresh; log secret-access events without logging secret contents.<br><strong>Least privilege:</strong> service accounts scoped narrowly; avoid using human admin credentials for automation. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Credentials & local-run patterns</strong><br><strong>Local developer runs:</strong> use local OS credential manager and separate test environment.<br><strong>Production credentials:</strong> stored in vault, retrievable only by orchestrator under secure identity.<br><strong>Rotation:</strong> rotate quarterly or after an incident; record rotation audit trail. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Deployment & change control</strong><br><strong>Env separation:</strong> dev/test/prod parity with environment-specific endpoints and thresholds.<br><strong>Promotion:</strong> PQ M-code or orchestrator changes require code review, automated tests and a release ticket.<br><strong>Versioning:</strong> commit M-code snapshots and orchestrator artifacts to VCS; include commit hash in run descriptor.<br><strong>Hotfixes:</strong> emergency patches require documented approver and post-deploy acceptance run. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Testing & QA (conceptual)</strong><br><strong>Unit tests:</strong> cover PQ transforms on synthetic datasets including edge cases.<br><strong>Integration tests:</strong> end-to-end with ERP sandbox, staging SequenceService and synthetic bank payments.<br><strong>Regression suite:</strong> run before each release; include negative cases (missing docs, donor cash-only).<br><strong>Chaos testing:</strong> simulate network and service downtimes to validate retries and alerts. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Performance & scaling</strong><br><strong>Scaling patterns:</strong> push-down transforms to SQL staging for large datasets; partition orchestrator work by legal-entity/period.<br><strong>Batch sizing:</strong> tune JE export and zip batch sizes to avoid memory pressure; prefer streaming where possible.<br><strong>Monitoring:</strong> track PQ refresh duration, memory usage, queue depth and SFTP throughput. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Data governance & schema evolution</strong><br><strong>Schema contract:</strong> version AccrualRegister outputs; include SchemaVersion in metadata.<br><strong>Evolutions:</strong> maintain backward compatibility; accept multi-version reads; include schema diff in run artifacts.<br><strong>Data quality gates:</strong> reject runs missing required fields; log schema diffs. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Forensics & audit readiness</strong><br><strong>Artifacts:</strong> run descriptors, M-code snapshots, input checksums, manifest with SHA256 and AutomationLog entries retained per retention policy.<br><strong>Reconstruction:</strong> document steps to rebuild a run from artifacts; test annually.<br><strong>Auditor access:</strong> provide read-only snapshots and manifest with redaction controls; include run readme mapping evidence to controls. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Operational runbooks & incident playbooks</strong><br><strong>Runbook elements:</strong> pre-flight checks, lock acquisition, sequence service fallback, manual post procedure, reconciliation steps, contact lists and escalation matrix.<br><strong>Incident playbooks:</strong> sequence service outage, ERP import failure, massive validation failure, evidence store corruption — include impact, mitigation, approvers and donor communications.<br><strong>Drills:</strong> annual tabletop exercises simulating key incidents. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>KPIs, SLOs & SLAs (operational)</strong><br><strong>Suggested SLOs:</strong> run success rate ≥ 99% monthly; evidence completeness ≥ 95%; JE posted & PostedJERef captured within 24 hours ≥ 95%; SequenceService availability ≥ 99.5%.<br><strong>Escalation SLAs:</strong> major outages page ops within 15 minutes. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Roles, responsibilities & approvals model</strong><br><strong>Core roles:</strong> Preparer, Allocator, Approver, Poster, AutomationOps, Country FD, Grants, Internal Audit, IT Security.<br><strong>Operational ownership:</strong> AutomationOps owns orchestration availability; Finance owns posting and reconciliation; Grants owns donor splits and approvals. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Integration patterns: approvals UI, ERP, bank matching</strong><br><strong>Approvals UI:</strong> store approver identity and timestamp; approvals trigger orchestrator.<br><strong>ERP integration:</strong> prefer API/file import with idempotency; capture PostedJERef and reconcile automatically.<br><strong>Bank matching:</strong> match payments to RequestIDs by reference, amount-window and suggest matches for manual override. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Continuous improvement & retrospectives</strong><br><strong>Monthly retrospectives:</strong> review KPIs, top variances and automation failures; convert findings into prioritized backlog items.<br><strong>Root cause disciplines:</strong> use 5-why, blameless post-mortems, and track remediation with owners and ETA. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Failure-mode catalogue & remediation matrix (compact)</strong><br><strong>Sequence service down:</strong> fallback TMP IDs → reconcile when up; alert operations.<br><strong>Partial ERP import:</strong> mark RequestIDs PartiallyPosted; create remediation ticket and hold clearing until reconciled.<br><strong>Missing evidence at close:</strong> block post if material; escalate for manual exception with DoA sign-off.<br><strong>PQ transform error:</strong> rollback to previous snapshot and run regression tests. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Operational checklists</strong><br><strong>Pre-run:</strong> inputs staged; FX table current; GLMap validated; SequenceService healthy; run-hash ready.<br><strong>Run day:</strong> execute PQ, review ValidationReport, obtain approvals, run orchestrator, confirm PostedJERefs.<br><strong>Post-run:</strong> match bank payments, clear RequestIDs, generate donor schedule and archive audit packs. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Governance & compliance alignment</strong><br><strong>Policy mapping:</strong> map automation controls to policy clauses and donor requirements; maintain evidence for audit sampling.<br><strong>Third-party assurance:</strong> schedule periodic third-party reviews of automation controls and evidence practices. </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>Additional PQ operational details</strong><br><strong>M-code snapshot policy:</strong> store full Advanced Editor text as <code>pq_mcode_&lt;runId&gt;.txt</code> and compute SHA256; include <code>mCodeHash</code> in <code>pq_manifest.json</code>.<br><strong>PQ manifest recommended fields (extended):</strong> <code>{&quot;runId&quot;,&quot;period&quot;,&quot;legalEntity&quot;,&quot;mCodeHash&quot;,&quot;inputChecksums&quot;:{&quot;payroll&quot;,&quot;timesheet&quot;,&quot;grantsMatrix&quot;},&quot;parameters&quot;:{&quot;materiality&quot;,&quot;aggregationThreshold&quot;,&quot;maxBatchSize&quot;},&quot;createdUTC&quot;,&quot;pqVersion&quot;}</code>.<br><strong>PQ naming conventions:</strong> parameter names must be snake_case and documented in <code>pq_manifest.json</code>.<br><strong>PQ memory/time guidance:</strong> if PQ refresh exceeds target (example 15 minutes) send alert and escalate to AutomationOps; pre-filter large sources in SQL staging to keep PQ in-memory transforms small.<br><strong>Validation engine contract:</strong> PQ must output <code>validation_input.csv</code> (row-level) and <code>validation_summary.json</code> (counts by severity, top failure codes). </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>PQ developer checklist</strong><br>1) Save M-code snapshot with commit hash and runId in <code>pq_snapshot/</code> folder.<br>2) Verify inputChecksums match expected vendor files.<br>3) Run unit tests on synthetic edge-case datasets.<br>4) Confirm <code>validation_summary.json</code> shows zero CRITICAL failures before preparing ApprovalBatch.<br>5) Tag run with <code>pqVersion</code> and document parameter changes in <code>change_log.csv</code> (see Table 4). </td></tr><tr><td data-label="Conceptual VBA &amp; Power Query (PQ)"> <strong>PQ operational exceptions</strong><br><strong>Large-file pattern:</strong> for payroll > 200k rows push to SQL staging and read subset into PQ.<br><strong>Offline mode:</strong> PQ should still be able to produce draft AccrualRegister using last-known-valid <code>grantsMatrix</code> with a flag <code>useStaleGrantsMatrix:true</code> in <code>pq_manifest.json</code> and a mandatory override note with approver sign-off. </td></tr></tbody></table></div><div class="row-count">Rows: 29</div></div><div class="table-caption" id="Table5" data-table="Docu_0170_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Advanced conceptual**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Advanced conceptual</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Advanced conceptual"> <strong>Advanced purpose & approach</strong><br><strong>Objective:</strong> Extend Accrual/RequestID playbook into enterprise-grade operations, governance and control frameworks.<br><strong>Approach:</strong> strengthen separation of concerns, harden idempotency guarantees, secure secrets, codify donor treatments, provide forensic primitives, define maturity model and acceptance gates. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Advanced orchestration architecture (conceptual)</strong><br><strong>Pattern — orchestration fabric vs compute layer:</strong> <em>Compute layer</em> (PQ/SQL) does pure transforms and validations; <em>Orchestration fabric</em> manages transactional side-effects. <br><strong>Service primitives:</strong> SequenceService (transactional monotonic sequences), LockService (leases), ArtifactStore (versioned, WORM options), IdempotencyStore, AuditStream (append-only event bus).<br><strong>Interaction contract:</strong> minimal, strongly typed REST/messaging contracts; orchestrator must support resume/replay using idempotency tokens. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Advanced Power Query patterns — conceptual</strong><br><strong>Immutable outputs:</strong> PQ writes final outputs to run-scoped folder with run descriptor (RunID, M-code hash).<br><strong>Deterministic transforms:</strong> avoid time-based randomness in PQ.<br><strong>Parameter governance:</strong> single config manifest per run included in snapshot.<br><strong>Validation-first:</strong> PQ outputs row-level failure codes plus severity summary for orchestrator routing. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Advanced VBA / Orchestrator patterns — conceptual</strong><br><strong>Side-effect atomicity:</strong> two-phase commit style for each RequestID: Prepare → Execute → Confirm.<br><strong>Idempotency design:</strong> deterministic idempotency keys (RequestID+RunID+OperationType).<br><strong>Partial outcome semantics:</strong> Prepared → ExecutedPendingConfirmation → Confirmed → RemediationRequired. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Enterprise security & secrets (conceptual)</strong><br><strong>Secret-minimisation:</strong> no long-lived secrets stored locally; short-lived tokens per operation.<br><strong>Tamper-evidence:</strong> HMAC/SHA for manifests stored in immutable object store.<br><strong>Separation of duties:</strong> two distinct roles required for posting and approval above materiality thresholds.<br><strong>Log tamper-resilience:</strong> replicate AutomationLog to append-only/cold storage. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Donor-specific compliance (expert rules & mapping)</strong><br><strong>Donor rule engine:</strong> rules per donor: allowed cost objects, cash-only flags, documentation standards and disallowance rules.<br><strong>Interpretation layer:</strong> mapping rules convert allocation lines to donor-claimable vs not-claimable outcomes.<br><strong>Audit mapping:</strong> each donor rule includes the exact evidence checklist required. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Tax & statutory nuance matrix (decision rules)</strong><br><strong>Matrix:</strong> for each jurisdiction record: (A) tax timing, (B) statutory social obligations, (C) withholding rules, (D) reporting thresholds.<br><strong>Action rules:</strong> auto-tag RequestIDs and generate statutory workpapers where required; escalate to Legal when ambiguous. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Data lineage, provenance & reproducibility</strong><br><strong>Lineage:</strong> every AccrualRegister row references upstream sources (payroll extract id, timesheet snapshot id, GrantsMatrix version, GLMap version).<br><strong>Provenance artifact:</strong> <code>provenance.json</code> per run listing file ids, checksums, transforms and M-code hash.<br><strong>Repro test:</strong> one-command rebuild using provenance.json in test environment for auditors. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Forensic primitives & root-cause tooling</strong><br><strong>Minimal forensic set:</strong> Run descriptor, M-code snapshot, AccrualRegister history, AutomationLog, RequestID pack manifest.<br><strong>Forensic workflows:</strong> generate period-level diffs across runs, identify first divergent run, map commits to runs and create ADJ RequestIDs per period if needed. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Bank matching & reconciliation rules (advanced)</strong><br><strong>Multi-pass matching:</strong> exact ref → fuzzy ref → amount-window matching → donor-split reconciliation.<br><strong>Unmatched handling:</strong> create <code>UnmatchedPayment</code> tickets with suggested RequestIDs and evidence requirements; SLA for resolution. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Operational resilience & DR (conceptual)</strong><br><strong>Critical components:</strong> SequenceService, ArtifactStore, AutomationLog, Orchestrator workers, Approval UI, ERP endpoint.<br><strong>RTO/RPO:</strong> define per component (e.g., SequenceService RTO <1 hour, RPO <5 minutes).<br><strong>Fallback modes:</strong> manual RequestID issuance runbook, manual JE import with two-approver sign-off to compensate for automation loss. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Scaling & partitioning (enterprise)</strong><br><strong>Partitioning:</strong> partition AccrualRegister by legal entity and period; workers process partitions.<br><strong>Sequence scalability:</strong> sharded sequences but monotonic per (country,period) namespace.<br><strong>Throughput tuning:</strong> batch JE exports by legal entity; prefer streaming zips for audit packs. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Audit-ready controls & evidence automation</strong><br><strong>Control-evidence mapping:</strong> each control maps to required artefacts and automated extraction queries.<br><strong>Automated audit-pack producer:</strong> nightly job to produce auditor-specific zipped packs with manifest and signed run descriptor. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Maturity model & KPIs</strong><br><strong>Levels:</strong><br>1) Manual — spreadsheets, ad-hoc.<br>2) Repeatable — PQ + manual orchestration.<br>3) Controlled — orchestrator, SequenceService, approvals UI.<br>4) Managed — central dataset, audit-pack automation, donor-rule engine.<br>5) Optimised — real-time observability, rare manual exceptions.<br><strong>KPIs per level:</strong> automation success rate, evidence completeness, mean time to reconcile, dispute trend. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Acceptance criteria & go-live controls</strong><br><strong>System acceptance:</strong> pilot month with zero critical validation failures; evidence completeness ≥95%; AutomationLog completeness ≥99%; end-to-end JE post with idempotency verified; internal audit sample pass ≥90%.<br><strong>Operational readiness:</strong> SequenceService HA test, PQ test harness passed, training & hypercare completed.<br><strong>Sign-off:</strong> Country FD + Global Finance Director + Head of Grants + IT Security. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Operational playbooks & decision trees</strong><br><strong>Playbooks:</strong> SequenceService outage; partial ERP import; donor cash-only reclass; evidence missing at close; ADJ/restatement lifecycle; forensic rebuild.<br><strong>Decision trees:</strong> materiality thresholds determine whether to pause posting, require FD/legal sign-off, or proceed with reclassification. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Donor & legal communications</strong><br><strong>Rules:</strong> pre-approved language for accruals, cash-only reclassifications, restatements and audit requests.<br><strong>Timing:</strong> donor notice for restatements within configured business days; immediate notification for donor-impacting restatements above materiality with legal review. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Training, competence & change adoption</strong><br><strong>Role-based learning:</strong> operators, approvers, Grants, Finance Posters, IT.<br><strong>Assessment:</strong> scenario-based tests and quarterly certification.<br><strong>Knowledge base:</strong> living runbook, decision trees and FAQ. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Vendor & ERP integration checklist</strong><br><strong>ERP requirements:</strong> idempotency support, ability to attach RequestID to JE header, retrieval API for PostedJERef.<br><strong>SFTP/Storage:</strong> signed upload receipts, encryption-at-rest, WORM options. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Metric-driven continuous improvement cadence</strong><br><strong>Monthly:</strong> KPI review and remediation backlog grooming.<br><strong>Quarterly:</strong> donor spot-checks and control self-assessment.<br><strong>Bi-annual:</strong> forensic drills and restatement exercises.<br><strong>Annual:</strong> policy review and roadmap planning. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Advanced additions</strong><br><strong>Idempotency key format (recommended):</strong> <code>ORG-RunID-RequestID-OpType-HASH</code> where <code>HASH = SHA256(user|timestamp|payload)</code> truncated to 16 chars.<br><strong>SequenceService pseudocode (transactional):</strong> <code>BEGIN; SELECT nextval(&#x27;seq_cc_period&#x27;); INSERT sequence_audit(request_id,issuer,runid,created_at); COMMIT; RETURN request_id;</code> — require audit row in same transaction.<br><strong>DR drill steps (short):</strong><br>1) Simulate SequenceService down; fallback to TMP issuance; ensure TMP manifests created.<br>2) Restore SequenceService; run TMP→official mapping tool; verify 1:1 mapping and update JEs.<br>3) Confirm no duplicate RequestIDs in AccrualRegister.<br><strong>Monitoring thresholds (suggested):</strong><br>- PQ refresh time > 900s → alert.<br>- Validation CRITICAL count > 0 → block posting and page ops.<br>- TMP IDs generated in run > 0 → alert to AutomationOps and create incident ticket. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Forensic SQL & queries (examples)</strong><br><code>-- Find runs where accrual total changed &gt; materiality</code><br><code>SELECT period, request_id, posted_je_ref, monthly_accrual_local FROM accrual_register_history WHERE run_id IN (...)</code><br><code>-- Diff two runs</code><br><code>SELECT a.request_id, a.monthly_accrual_local AS runA, b.monthly_accrual_local AS runB, (b.runA - a.runB) AS delta FROM accrual_register_runA a JOIN accrual_register_runB b USING (request_id) WHERE ABS(b.monthly_accrual_local - a.monthly_accrual_local) &gt; 0.01;</code><br><strong>Commit mapping:</strong> store git commit hash in <code>AutomationLog.CommitHash</code> and use it in forensic reports. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Control matrix excerpt (sample)</strong><br><code>Control: AllocationSum100</code> → Evidence: <code>AccrualRegister, ExpandedAllocationLines, ValidationReport</code> → Test: recalc allocation sums for sample N & confirm =100 → Frequency: monthly → Owner: Grants. </td></tr><tr><td data-label="Advanced conceptual"> <strong>Expansion: donor-rule engine (concept)</strong><br><strong>Rule format:</strong> JSON rules <code>{id,donorCode,allowAccrual:boolean,docChecklist:[...],allowedGL:[...],poolHandling: enum}</code>.<br><strong>Engine behavior:</strong> evaluate allocation lines before approvals; attach <code>donorComplianceFlag</code> to RequestID when rule fails. </td></tr></tbody></table></div><div class="row-count">Rows: 24</div></div><div class="table-caption" id="Table6" data-table="Docu_0170_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Comprehensive Bonus Accrual — Supplement**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Comprehensive Bonus Accrual — Supplement</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Purpose of this expansion</strong><br>This supplement extends the master manual with additional operational detail, schemas, API contracts, runbook fragments, governance artifacts, forensic recipes, sampling plans, donor notes, security hardening and pragmatic templates so an implementation team can execute end-to-end with minimal gaps. It is prescriptive and contains copy-ready artifacts (CSV/JSON examples, SQL DDL, Validation codes, Manifest spec, RequestID API contract, AutomationLog spec, JE templates and acceptance forms). </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Shipped deliverables (what you now have)</strong><br>1) Policy & controls (full).<br>2) Canonical AccrualRegister schema.<br>3) Validation rules and codes.<br>4) Automation design (PQ + orchestrator patterns).<br>5) RequestID sequence service API contract.<br>6) AutomationLog & manifest specs.<br>7) JE export templates & sample rows.<br>8) Forensic & restatement recipe.<br>9) Training curricula & tests.<br>10) Donor quick-rules.<br>11) Security hardening checklist.<br>12) Implementation task plan & milestones. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Canonical artifacts — copy-ready</strong><br><strong>AccrualRegister CSV header (full):</strong><br><code>RequestID,SchemaVersion,Period,LegalEntity,CountryCode,EmployeeID,EmployeeName,PayrollID,JobTitle,Department,ContractType,ContractRef,EstimatedAnnualBonus,ServiceFractionForMonth,ServiceDays,EligibilityFactor,ConfidenceLevel,AdvancePaid_Local,MonthlyAccrual_Local,Currency,FXRate,Amount_ReportCurrency,TotalAllocationPct,AllocationMethod,AllocationDriverFile,ProjectLines_JSON,DonorLines_JSON,SupportingDocsLinks,Preparer,PreparerDate,Allocator,AllocatorDate,Approver,ApproverDate,PostedJERef,PostedDate,MatchedPaymentRef,ClearedDate,Status,StateHistory_JSON,Notes,SchemaHash</code> </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>JSON examples (ProjectLines / DonorLines)</strong><br><code>ProjectLines_JSON = [{&quot;ProjectCode&quot;:&quot;PRJ-100&quot;,&quot;ProjectName&quot;:&quot;Health&quot;,&quot;ProjectAllocationPct&quot;:60},{&quot;ProjectCode&quot;:&quot;PRJ-200&quot;,&quot;ProjectName&quot;:&quot;WASH&quot;,&quot;ProjectAllocationPct&quot;:40}]</code><br><code>DonorLines_JSON = [{&quot;DonorCode&quot;:&quot;DNR-A&quot;,&quot;DonorName&quot;:&quot;Donor A&quot;,&quot;DonorAllocationPct&quot;:60},{&quot;DonorCode&quot;:&quot;DNR-B&quot;,&quot;DonorName&quot;:&quot;Donor B&quot;,&quot;DonorAllocationPct&quot;:40}]</code> </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>RequestID Sequence Service — API contract (complete) — expanded examples</strong><br><code>POST /api/v1/requestid</code> body example (batch): <code>{ &quot;period&quot;:&quot;2026-01&quot;,&quot;countryCode&quot;:&quot;ID&quot;,&quot;legalEntity&quot;:&quot;LE-01&quot;,&quot;createdBy&quot;:&quot;alice@org&quot;,&quot;runId&quot;:&quot;RUN-202601-01&quot;,&quot;count&quot;:10,&quot;idempotencyKey&quot;:&quot;RUN-202601-01-ISSUE10&quot; }</code> → response <code>{ &quot;requestIds&quot;:[&quot;ACC-BONUS-202601-ID-0001&quot;,...,&quot;ACC-BONUS-202601-ID-0010&quot;], &quot;runId&quot;:&quot;RUN-202601-01&quot;,&quot;issuedAt&quot;:&quot;2026-01-31T18:00:00Z&quot; }</code>.<br><code>PATCH /api/v1/requestid/{id}/approve</code> body example: <code>{ &quot;approver&quot;:&quot;fd@org&quot;,&quot;role&quot;:&quot;CountryFD&quot;,&quot;approvedAt&quot;:&quot;2026-01-31T19:00:00Z&quot;,&quot;notes&quot;:&quot;Material approval&quot; }</code> → response <code>{ &quot;requestId&quot;:&quot;ACC-BONUS-202601-ID-0001&quot;,&quot;status&quot;:&quot;Approved&quot; }</code>.<br><code>GET /api/v1/requestid/{id}</code> returns metadata including <code>stateHistory</code> and <code>artifactLinks</code>.<br><strong>Behavioral rules:</strong> idempotency keys supported; monotonic sequences per (country,period); transactional NextVal; audit trail required; support bulk issuance mode with <code>count</code> and return array. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>AutomationLog schema (append-only)</strong><br><code>AutomationLog</code> fields (DB/CSV): <code>RunID,Step,SubStep,RequestID(optional),User,Service,StartUTC,EndUTC,DurationSeconds,Status,ErrorCode,ErrorMessage,FilesCreatedJSON,ChecksumsJSON,CommitHash,Environment,Notes</code> — store immutable; replicate to cold storage daily; include partition by period for scale. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Manifest spec (per RequestID pack)</strong><br><code>manifest.csv</code> header: <code>Filename,RelPath,FileSizeBytes,SHA256Hex,MimeType,Creator,CreatedUTC,Notes</code> — manifest placed at root of RequestID folder and HMAC-SHA256 signed by AutomationOps using vault HMAC key; include <code>manifestSig</code> in root. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>ValidationReport expanded (fields & severity)</strong><br><code>ValidationReport</code> row: <code>RequestID,CheckCode,CheckName,Severity(CRITICAL/HIGH/MEDIUM/LOW),Result(PASS/FAIL),Details,FixAction,Owner,DueDate</code>.<br><strong>Severity policy:</strong> CRITICAL = block posting; HIGH = FD sign-off to override; MEDIUM = resolve within SLA; LOW = log for remediation. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Validation codes (copy-ready)</strong><br><code>V001 MissingPayrollRecord (CRITICAL)</code><br><code>V002 EmployeeNotInHRMaster (CRITICAL)</code><br><code>V003 AllocationSumNot100 (CRITICAL)</code><br><code>V004 DonorCashOnlyCharge (HIGH)</code><br><code>V005 FXRateMissing (HIGH)</code><br><code>V006 ConfidenceLow_Material (HIGH)</code><br><code>V007 MissingManagerCert (MEDIUM)</code><br><code>V008 AggregationBreakoutMissing (HIGH)</code><br><code>V009 DuplicateRequestID (CRITICAL)</code><br><code>V010 NegativeAccrualWithoutAdvancePlan (MEDIUM)</code><br><code>V011 UnsupportedCurrencyCode (CRITICAL)</code><br><code>V012 IntercompanyMemoMissing (MEDIUM)</code><br><code>V013 TaxOpinionMissingWhenRequired (HIGH)</code><br><code>V014 TimesheetGranularityInsufficient (MEDIUM)</code> </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>JE export specification (CSV) — mandatory fields & expanded notes</strong><br><code>JE_ID,JE_LineNo,JE_Date,AccountCode,Debit,Credit,CostCenter,ProjectCode,DonorCode,EmployeeID,Narrative,RequestID,IntercompanyFlag,IntercompanyCounterparty</code>.<br><strong>Narrative:</strong> include RequestID and EmployeeID and allocation summary when multi-line.<br><strong>Import rules:</strong> ERP import must support idempotencyKey and return <code>PostedJERef</code> and <code>ImportStatus</code> per JE. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Sample JE rows (expanded)</strong><br><code>JE0001,1,2026-01-31,6100-1000,1400000,0,CC-HQ-01,PRJ-100,DNR-A,EMP-123,&quot;Accrual — Monthly Bonus — 2026-01 — ACC-BONUS-202601-ID-0001 — EmpID EMP-123&quot;,ACC-BONUS-202601-ID-0001,FALSE,</code><br><code>JE0001,2,2026-01-31,2200-2000,0,1400000,CC-HQ-01,,,,,&quot;Accrual liability — ACC-BONUS-202601-ID-0001&quot;,ACC-BONUS-202601-ID-0001,FALSE,</code><br><code>JE0002,1,2026-01-31,6100-1010,540000,0,CC-CO-02,PRJ-100,DNR-A,EMP-456,&quot;Accrual — Monthly Bonus — 2026-01 — ACC-BONUS-202601-ID-0023 — EmpID EMP-456&quot;,ACC-BONUS-202601-ID-0023,FALSE,</code> </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>SQL DDL: AccrualRegister (example) — extended columns</strong><br>``<code>sql&lt;br&gt;CREATE TABLE accrual_register (&lt;br&gt;  request_id varchar(50) PRIMARY KEY,&lt;br&gt;  schema_version varchar(10),&lt;br&gt;  period date,&lt;br&gt;  legal_entity varchar(50),&lt;br&gt;  country_code varchar(5),&lt;br&gt;  employee_id varchar(50),&lt;br&gt;  payroll_id varchar(50),&lt;br&gt;  job_title varchar(200),&lt;br&gt;  estimated_annual_bonus numeric(18,2),&lt;br&gt;  monthly_accrual_local numeric(18,2),&lt;br&gt;  currency varchar(3),&lt;br&gt;  fx_rate numeric(18,6),&lt;br&gt;  amount_report_currency numeric(18,2),&lt;br&gt;  total_allocation_pct numeric(5,2),&lt;br&gt;  allocation_method varchar(50),&lt;br&gt;  project_lines jsonb,&lt;br&gt;  donor_lines jsonb,&lt;br&gt;  supporting_docs jsonb,&lt;br&gt;  status varchar(20),&lt;br&gt;  posted_je_ref varchar(50),&lt;br&gt;  matched_payment_ref varchar(50),&lt;br&gt;  created_at timestamptz,&lt;br&gt;  updated_at timestamptz&lt;br&gt;);&lt;br&gt;</code>`` </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>PQ manifest recommended file (example)</strong><br><code>pq_manifest.json</code> example: <code>{&quot;runId&quot;:&quot;RUN-202601-01&quot;,&quot;period&quot;:&quot;2026-01&quot;,&quot;legalEntity&quot;:&quot;LE-01&quot;,&quot;mCodeHash&quot;:&quot;&lt;sha256&gt;&quot;,&quot;inputChecksums&quot;:{&quot;payroll&quot;:&quot;&lt;sha256&gt;&quot;,&quot;timesheet&quot;:&quot;&lt;sha256&gt;&quot;,&quot;grantsMatrix&quot;:&quot;&lt;sha256&gt;&quot;},&quot;parameters&quot;:{&quot;materiality&quot;:50000,&quot;aggregationThreshold&quot;:50000},&quot;createdUTC&quot;:&quot;2026-01-31T17:45:00Z&quot;,&quot;pqVersion&quot;:&quot;v1.2.3&quot;}</code> — store with each run. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Orchestration pseudorun (detailed steps + timings)</strong><br>1) Preflight check (T-3 days): SequenceService, FX table, GLMap, DoA list.<br>2) Run PQ (T-2 days) with parameters → draft CSVs + pq_manifest (target: complete by T-2 12:00).<br>3) Run Validation engine → ValidationReport (fail-fast).<br>4) Route failures, collect approvals; generate ApprovalBatch (T-1 day).<br>5) For each approved line call RequestID service to issue RequestIDs (T-1 evening).<br>6) Snapshot calc workbook → PDF; save to RequestID folder; generate manifest.<br>7) Export JE_Export.csv and submit to ERP with idempotencyKey = RunID+RequestID (T0 close window).<br>8) Poll ERP for PostedJERef (within 24 hours); update AccrualRegister.<br>9) Zip audit packs, sign manifest and persist to ArchiveStore; store manifestSig in AutomationLog.<br>10) Post-run reconciliation and produce reconciliation report (T+1). </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Manual fallback steps (runbook snippet) — expanded</strong><br>If SequenceService offline:<br>1) Orchestrator generates TMP IDs <code>TMP-ACC-BONUS-YYYYMM-CC-XXXX</code> and writes <code>tmp_manifest.csv</code>.<br>2) Proceed with approvals and JE export, tag JEs as <code>TMP_PENDING</code> and include <code>TMP_Map</code> placeholder in narrative.<br>3) When SequenceService returns, call mapping endpoint to exchange TMP→official RequestIDs and update AccrualRegister, JEs and audit packs.<br>4) Store <code>TMP_Map_&lt;run&gt;.csv</code> and include mapping in AutomationLog; require reconciliation sign-off. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Security hardening checklist (practical)</strong><br>- Use KeyVault for all secrets; rotate quarterly.<br>- Short-lived tokens (OAuth2/JWT) for API calls.<br>- MFA for approvers.<br>- Enforce RBAC for Preparer/Approver/Poster/AutomationOps.<br>- Log all access to AccrualRegister and artifacts; retain logs per donor retention.<br>- Store manifest HMAC key in vault and rotate.<br>- Encrypt artifacts at rest and in transit.<br>- Deploy orchestration in private VNET with restricted IP egress. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Evidence & approval matrix (by ConfidenceLevel)</strong><br><strong>Confidence=High:</strong> payroll extract, timesheet, manager cert, Grants approval; approver = Manager.<br><strong>Confidence=Medium:</strong> Country FD sign-off for accruals > CountryMateriality.<br><strong>Confidence=Low:</strong> Country FD & Global Finance Director approvals for accruals > immaterial threshold. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Donor quick rules (practical)</strong><br>- Cash-only donors: require written Grants confirmation before charging.<br>- Donor allows accruals: attach activity evidence and post in award period; if award ends verify allowable post-reporting payments.<br>- Pool-funded awards: apply pool governance memo and store pool allocation decision in RequestID pack.<br>- Donor audit requests: supply zipped audit pack with manifest and signed readme. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Tax & payroll annex (sample)</strong><br>- Withholding at payment: accrue gross; post tax payable on payment and attach remittance.<br>- Tax at accrual: create separate tax liability line and store legal opinion.<br>- Consultant net requirement: compute gross-up worksheet and store in RequestID folder. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Reconciliation & matching rules</strong><br>- Match payments by bank reference, amount within tolerance and employee ID.<br>- VarianceRecord fields: <code>RequestID,AccruedAmount,PaymentAmount,Variance,VarianceType(Rounding/FX/Tax/NetPay),Owner,ActionPlan</code>.<br>- Post variance JE per policy; approver required if material. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Forensic recipe (copy-ready) — expanded</strong><br>1) Identify suspect RequestIDs/periods.<br>2) Pull AccrualRegister snapshots for affected runs R1..Rn.<br>3) Extract pq_manifest and M-code snapshots for first divergent run.<br>4) Recompute accruals from preserved inputs using prior M-code snapshot.<br>5) Document deltas by RequestID and aggregate; prepare <code>-ADJ</code> RequestIDs per period.<br>6) Include M-code commit hash and AutomationLog run entries in forensic pack; seek external audit when above materiality. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Sampling & audit testing plan (monthly)</strong><br>- Sample size: stratified N = min(30, 5% of Posted RequestIDs, ≥10).<br>- Strata: legal entity, donor-charged vs overhead, ConfidenceLevel.<br>- Tests: evidence existence, recalculation accuracy (± rounding tolerance), allocation correctness, JE traceability, payment clearing.<br>- Report: findings, RCA, remediation owner and ETA. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Training & assessments (sample)</strong><br>Sample questions:<br>1) Mandatory docs for High-confidence accrual?<br>2) How to handle donor cash-only?<br>3) RequestID naming convention?<br>4) Recalculate MonthlyAccrual given Annual=24,000 SF=0.5 Eligibility=1.0 → result 1,000. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Implementation Gantt-level checklist (milestones & owners)</strong><br>1) Week 0–2: Governance sign-off (Policy owner & FD).<br>2) Week 2–6: Build PQ transforms & pq_manifest, load pilot payroll & timesheet.<br>3) Week 6–8: Implement Validation engine + ValidationReport.<br>4) Week 8–10: Implement RequestID service & orchestrator basic flows.<br>5) Week 10: Pilot month run + internal audit sample.<br>6) Week 11–12: Remediation & go/no-go.<br>7) Week 12+: Scale rollout & KPI monitoring. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Acceptance checklist (operational)</strong><br>Before go-live confirm:<br>1) Pilot month complete & sample pass ≥90%.<br>2) PQ M-code snapshot stored.<br>3) AutomationLog entries exist and replicated.<br>4) RequestID service returns unique IDs under load test.<br>5) JE import tested with ERP sandbox and PostedJERef captured.<br>6) Evidence manifest produced & HMAC-signed.<br>7) Training sign-offs recorded and fallback runbook validated. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Risk matrix (top risks & mitigations)</strong><br>1) Sequence collisions → central DB sequences & transactional issuance.<br>2) Missing evidence → validation gates block posting.<br>3) Donor disputes → Grants pre-confirmation & transparent donor schedule.<br>4) Tax mis-treatment → payroll tax advisor involvement & legal opinion retention.<br>5) Automation outages → fallback manual runbook & TMP mapping.<br>6) Data tampering → manifest checksums, HMAC-signed manifests, immutable AutomationLog. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Retention schedule (baseline)</strong><br>- Donor-funded accruals: 7 years or donor-specific longer.<br>- Statutory/tax documents: per statutory requirement.<br>- Automation logs & pq_manifest: retain 7 years (or donor requirement).<br>- ADJ/restatement memos: retain indefinitely with finance records. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Change log & versioning</strong><br><code>change_log.csv</code> template: <code>Version,Date,ChangeSummary,Owner,Approver,ImpactNotes,CommitHash</code> — required for policy, schema or PQ/orchestrator change; store in Config and include commit hashes for M-code/orchestrator artifacts. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Common exception templates (copy-ready)</strong><br><strong>Exception email to Grants:</strong> <code>Subject: Exception — ACC-BONUS-{RequestID} — Donor split query. Body: {short issue summary}. Action required: Confirm donor split or confirm reallocation to overhead. Please reply by {due date}.</code><br><strong>Dispute creation (ticket text):</strong> <code>DisputeID,RequestID,IssueType,RootCauseTag,Owner,TargetDate,Details</code> </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Operational QA & go-live acceptance (added)</strong><br><strong>Pre-go-live tests:</strong> end-to-end run with test payroll & timesheet; negative case injection (missing docs); automation failure simulation; TMP fallback drill; external auditor access verification.<br><strong>Hypercare:</strong> daily incident review for 10 business days; weekly for next 2 months. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Final pragmatic next-steps</strong><br>1) Approve RequestID API contract and provision SequenceService (DB + REST).<br>2) Build PQ manifest pattern and implement <code>pq_manifest.json</code> capture.<br>3) Implement Validation engine with V001–V014.<br>4) Run pilot month with internal audit sample (N≥30).<br>5) Harden secret storage and enable AutomationLog replication.<br>6) Publish SOPs & training schedule and record approvals. </td></tr><tr><td data-label="Comprehensive Bonus Accrual — Supplement"> <strong>Closing capability offers</strong><br>If you want, I can now produce (choose one):<br>1) Zipped starter template (CSV + pq_manifest + sample calc workbook + sample JE export).<br>2) Implementation checklist in Excel with tasks, owners and deadlines.<br>3) A compact one-page operator runbook (PDF).<br>Tell me which and I will generate it. </td></tr></tbody></table></div><div class="row-count">Rows: 32</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>