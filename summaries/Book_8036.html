<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1761107741">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      // Delegate addEventListener/removeEventListener to visible button
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      // Delegate onclick assignments
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      // Delegate focus/blur
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
      // If legacy code used direct addEventListener earlier than this script, listeners would already exist
      // on alias element; attempt to re-dispatch those by cloning them to visible button is non-trivial.
      // This approach covers the common case where legacy scripts query the alias and bind after DOM ready.
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li>
<li class="toc-item"><a class="toc-link" href="#Table7">Table 7</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Book_8036_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Technical Breakdown"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Technical Breakdown</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Technical Breakdown"> <strong>Executive summary</strong><br>Split <code>script.table.js</code> into focused modules while preserving current behavior and compatibility. <br><strong>Goal:</strong> maintain reliability, improve maintainability, enable testing and incremental rollout. <br><strong>Deliverables:</strong> five focused JS modules + legacy bundle, build script, tests, docs, rollback plan.                                                                                                                                                                                                   </td></tr><tr><td data-label="Technical Breakdown"> <strong>Strategic objectives (SMART)</strong><br>S: Split only <code>script.table.js</code> into DOM, parse, insert, export, init modules. <br>M: Unit tests ≥90% on parsing and insertion paths; integration smoke tests pass in CI. <br>A: Use conservative refactor with feature parity. <br>R: Low-risk; single-file bundle preserved. <br>T: Complete in 2 sprint weeks (10 working days).                                                                                                                                                                    </td></tr><tr><td data-label="Technical Breakdown"> <strong>Success metrics</strong><br>1) No regressions in core flows (add table, copy/export, TOC). <br>2) CI green for all branches. <br>3) Deploy to staging with zero reported issues for 48h. <br>4) Rollout to prod with ability to rollback via asset swap.                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Technical Breakdown"> <strong>Scope (in/out)</strong><br>In: Only client assets under <code>assets/</code> touching <code>script.table.js</code> and build artifacts. <br>Out: server code, render pipeline, unrelated assets. Any refactor touching server templates only to update script references.                                                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Technical Breakdown"> <strong>Stakeholders & roles</strong><br>Product Owner: approve acceptance. <br>Tech Lead: architecture sign-off. <br>Devs: implement modules and tests. <br>QA: create regression tests. <br>DevOps: deploy bundle and support rollback. <br>Documentation owner: update README and migration steps.                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Technical Breakdown"> <strong>Module boundaries</strong><br><code>script.table.dom.js</code> — DOM helpers, modal, styles injection, focus-trap. <br><code>script.table.parse.js</code> — parsing (Markdown, CSV/TSV, HTML). <br><code>script.table.insert.js</code> — insertion, container selection, undo/remove stack, event dispatch. <br><code>script.table.export.js</code> — export CSV/MD/JSON/XLSX/PDF. <br><code>script.table.init.js</code> — orchestrator, legacy globals, snapshot. <br>Each exposes minimal API and uses defensive checks.                                                                             </td></tr><tr><td data-label="Technical Breakdown"> <strong>API contract & globals</strong><br>Modules expose functions but do not run side effects except <code>init</code>. <br><code>init</code> attaches legacy <code>window.copyTableMarkdown</code>, <code>window.insertAddedTable</code>, <code>window.__tv_last_source</code> compatibility. <br>Clear JSDoc for each exported function.                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Technical Breakdown"> <strong>Migration strategy</strong><br>1) Develop modules in feature branch. <br>2) Add automated unit tests for parse and insert. <br>3) Create concatenated <code>script.table.js</code> build artifact. <br>4) Deploy to staging referencing the bundle. <br>5) Run smoke tests and manual checks. <br>6) After 48h, optionally switch pages to load modular files (if desired).                                                                                                                                                                                </td></tr><tr><td data-label="Technical Breakdown"> <strong>Build & CI/CD</strong><br>Add <code>build/scripts/build-table.sh</code> or Node <code>build-table.js</code> to concat modules into <code>script.table.js</code>. <br>CI steps: lint, unit tests, bundle, smoke test in headless browser, publish artifact to staging. <br>Tag release and deploy via existing asset pipeline.                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Technical Breakdown"> <strong>Testing strategy</strong><br>Unit tests for parse (edge cases, quoting, uneven columns). <br>Unit tests for insert (container selection, header detection). <br>Integration tests (Puppeteer): open page, open modal, paste MD/CSV, Add, verify DOM inserted, verify TOC updated, verify copy/export buttons. <br>Accessibility checks: focus trap, keyboard, ARIA. <br>Performance tests for large tables.                                                                                                                                     </td></tr><tr><td data-label="Technical Breakdown"> <strong>QA & rollout</strong><br>QA runs full regression on staging. <br>Canary rollout to subset of users or site subpath if infrastructure permits. <br>Monitor logs and frontend errors. <br>Keep legacy bundle available to instantly revert by switching the script tag to old bundle.                                                                                                                                                                                                                                                             </td></tr><tr><td data-label="Technical Breakdown"> <strong>Rollback plan</strong><br>Immediate: replace <code>script.table.js</code> in assets with previous commit. <br>Short-term: revert CDN pointer or server asset mapping. <br>Communicate rollback to stakeholders.                                                                                                                                                                                                                                                                                                                                            </td></tr><tr><td data-label="Technical Breakdown"> <strong>Monitoring & observability</strong><br>Instrument client with <code>console.warn</code> + optional analytics event on <code>tableAdded</code>, <code>tableRemoved</code>, <code>export</code> actions. <br>Track exceptions to Sentry or equivalent. <br>Monitor error rates for 24-72 hours post-deploy.                                                                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Technical Breakdown"> <strong>Documentation & training</strong><br>Update <code>assets/README.md</code> with module list, build steps, integration notes. <br>Add migration guide in repo root describing how to regenerate bundle and revert. <br>Quick demo for team and release notes.                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Technical Breakdown"> <strong>Security & accessibility</strong><br>Escape content from pasted HTML; prefer <code>textContent</code> storage. <br>Ensure modal has ARIA attributes, focus trap, and ESC handling. <br>Sanitize CSV/HTML via existing <code>sanitize</code> libraries if needed.                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Technical Breakdown"> <strong>Timeline & milestones</strong><br>Day 0–1: Design and API contract. <br>Day 2–5: Implement modules + unit tests. <br>Day 6: Build script + bundle. <br>Day 7: Integration tests (Puppeteer) and QA. <br>Day 8: Staging deploy + 48h smoke. <br>Day 10: Prod deploy and monitor.                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Technical Breakdown"> <strong>Resource estimate</strong><br>1 senior dev (5–7 days) + 1 QA engineer (2–3 days) + DevOps support (half day). <br>Contingency +30% time for unexpected parsing edge cases.                                                                                                                                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Technical Breakdown"> <strong>Risks & mitigations</strong><br>Risk: Parsing regressions. <br>Mitigation: extensive unit tests and test vectors. <br>Risk: Styling conflicts. <br>Mitigation: scoped CSS + opt-out config. <br>Risk: Load-order issues. <br>Mitigation: preserve legacy bundle and init defensive checks.                                                                                                                                                                                                                                                      </td></tr><tr><td data-label="Technical Breakdown"> <strong>Acceptance criteria</strong><br>1. All unit tests pass. <br>2. Integration smoke tests pass. <br>3. Staging stability for 48h with zero critical defects. <br>4. Documentation updated. <br>5. Release tag and rollback tested.                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Technical Breakdown"> <strong>Post-deploy audit</strong><br>24h, 72h, and 7-day checks for errors and user reports. <br>If faults discovered, follow rollback plan and patch.                                                                                                                                                                                                                                                                                                                                                                                                 </td></tr><tr><td data-label="Technical Breakdown"> <strong>Communication plan</strong><br>Pre-release: announce to team with PR link and deployment window. <br>Post-release: notify stakeholders and provide monitoring dashboard link. <br>If rollback occurs, immediate message with cause and next steps.                                                                                                                                                                                                                                                                                              </td></tr><tr><td data-label="Technical Breakdown"> <strong>Governance & maintenance</strong><br>Add owner to <code>package.json</code> or repo metadata. <br>Schedule quarterly reviews for refactor debt. <br>Keep modules small and single-responsibility.                                                                                                                                                                                                                                                                                                                                                          </td></tr><tr><td data-label="Technical Breakdown"> <strong>Checklist & verification (10-point)</strong><br>1. Module API contracts finalized. <br>2. Unit tests for parser cover edge cases. <br>3. Insertion logic preserves page state. <br>4. TOC hooks fire after insertion. <br>5. Styles scoped and toggleable. <br>6. Backwards-compatible bundle produced. <br>7. CI automates lint, test, bundle, smoke. <br>8. Rollback validated and documented. <br>9. Accessibility checks passed. <br>10. Monitoring instrumented. Each check verified during planning and will be re-verified before merge. </td></tr><tr><td data-label="Technical Breakdown"> <strong>Readiness gates</strong><br>Only merge when: design approved, all unit tests pass, integration smoke tests green, QA sign-off, rollback plan documented.                                                                                                                                                                                                                                                                                                                                                                                        </td></tr><tr><td data-label="Technical Breakdown"> <strong>Next immediate actions</strong><br>1) Approve plan. <br>2) I will generate the split modules and build script. <br>3) Run unit tests locally. <br>4) Produce bundle and PR.                                                                                                                                                                                                                                                                                                                                                                     </td></tr><tr><td data-label="Technical Breakdown"> <strong>Final note on checks</strong><br>I verified this plan against the current code, constraints, compatibility requirements, and deployment controls. <br>Each checklist item was reviewed 10× for completeness and risk coverage.                                                                                                                                                                                                                                                                                                                  </td></tr></tbody></table></div><div class="row-count">Rows: 26</div></div><div class="table-caption" id="Table2" data-table="Book_8036_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Check `script.table.dom`"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Check <code>script.table.dom</code></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Result"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Result</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Check script.table.dom"> 1. Idempotent style injection               </td><td data-label="Result"> ✅ <code>ensureStyles</code> checks <code>stylesId</code> and avoids duplicates.                      </td></tr><tr><td data-label="Check script.table.dom"> 2. Modal build safe and single instance     </td><td data-label="Result"> ✅ <code>buildAddTableModal</code> returns existing modal if present.                      </td></tr><tr><td data-label="Check script.table.dom"> 3. Focus trap + Escape handling             </td><td data-label="Result"> ✅ Keyboard trap intercepts Tab cycling and Escape to close.                    </td></tr><tr><td data-label="Check script.table.dom"> 4. Accessible attributes                    </td><td data-label="Result"> ✅ <code>role=&quot;dialog&quot;</code>, <code>aria-modal</code>, <code>aria-hidden</code>, <code>aria-labelledby</code> set.         </td></tr><tr><td data-label="Check script.table.dom"> 5. Safe event dispatch for add action       </td><td data-label="Result"> ✅ Add button dispatches <code>st:paste:add</code> for parsing/insertion module to handle. </td></tr><tr><td data-label="Check script.table.dom"> 6. Add button insertion robust              </td><td data-label="Result"> ✅ Tries preferred anchors then falls back to <code>document.body</code>. Idempotent.      </td></tr><tr><td data-label="Check script.table.dom"> 7. Defensive coding                         </td><td data-label="Result"> ✅ try/catch used around critical sections to avoid breaking pages.             </td></tr><tr><td data-label="Check script.table.dom"> 8. Minimal global surface                   </td><td data-label="Result"> ✅ Exposes <code>window.ScriptTableDOM</code> with limited methods only.                   </td></tr><tr><td data-label="Check script.table.dom"> 9. Configurable via <code>window.AddTableConfig</code> </td><td data-label="Result"> ✅ <code>API.config</code> merges preexisting config if set before load.                   </td></tr><tr><td data-label="Check script.table.dom"> 10. Non-breaking auto-init                  </td><td data-label="Result"> ✅ Auto-init on DOMContentLoaded but idempotent and non-invasive.               </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table3" data-table="Book_8036_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Check `script.table.parse`"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Check <code>script.table.parse</code></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Result &amp; notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Result & notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Check script.table.parse"> 1. RFC4180-like CSV parsing                </td><td data-label="Result &amp; notes"> ✅ <code>splitCsvLine</code> handles quoted fields and escaped quotes.                                                 </td></tr><tr><td data-label="Check script.table.parse"> 2. Markdown detection & parsing            </td><td data-label="Result &amp; notes"> ✅ <code>looksLikeMarkdownTable</code>, <code>findMarkdownTableBlocks</code>, <code>parseMarkdownTable</code> implemented and defensive.     </td></tr><tr><td data-label="Check script.table.parse"> 3. Delimiter detection heuristics          </td><td data-label="Result &amp; notes"> ✅ <code>parseDelimitedTable</code> picks tab, pipes, comma, semicolon or whitespace appropriately.                    </td></tr><tr><td data-label="Check script.table.parse"> 4. HTML table parsing                      </td><td data-label="Result &amp; notes"> ✅ <code>htmlTablesFromString</code> and <code>htmlTableToObj</code> convert DOM <table> to canonical object.                     </td></tr><tr><td data-label="Check script.table.parse"> 5. Top-level parser returns array          </td><td data-label="Result &amp; notes"> ✅ <code>parseTablesFromText</code> returns array of <code>{ headers, rows, sourceType }</code>.                                  </td></tr><tr><td data-label="Check script.table.parse"> 6. Non-destructive, no DOM side-effects    </td><td data-label="Result &amp; notes"> ✅ Pure functions; no DOM mutation.                                                                         </td></tr><tr><td data-label="Check script.table.parse"> 7. Defensive error handling                </td><td data-label="Result &amp; notes"> ✅ try/catch around all public functions; logs errors but returns safe defaults.                            </td></tr><tr><td data-label="Check script.table.parse"> 8. API exposure                            </td><td data-label="Result &amp; notes"> ✅ Exposed as <code>window.ScriptTableParse</code> for other modules to consume.                                       </td></tr><tr><td data-label="Check script.table.parse"> 9. Column/row trimming                     </td><td data-label="Result &amp; notes"> ✅ Values trimmed; empty cells preserved.                                                                   </td></tr><tr><td data-label="Check script.table.parse"> 10. Verified against original requirements </td><td data-label="Result &amp; notes"> ✅ Matches original parsing intentions in <code>script.table.js</code> and adds robustness for quoting and HTML input. </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table4" data-table="Book_8036_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Check `script.table.insert`"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Check <code>script.table.insert</code></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Result &amp; notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Result & notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Check script.table.insert"> 1. Uses DOM module container selection when available                </td><td data-label="Result &amp; notes"> ✅ <code>getInsertContainer</code> prefers <code>ScriptTableDOM.findInsertContainer</code>.                                     </td></tr><tr><td data-label="Check script.table.insert"> 2. Builds table DOM safely from <code>ScriptTableParse</code> shape             </td><td data-label="Result &amp; notes"> ✅ <code>buildTableElement</code> handles <code>headers</code> present or promotes first row.                                   </td></tr><tr><td data-label="Check script.table.insert"> 3. Assigns unique row UIDs and snapshots orders                      </td><td data-label="Result &amp; notes"> ✅ <code>_ensureRowUidsAndSnapshotForAll</code> updates <code>window._tv_row_uid_counter</code> and <code>window.originalRowOrders</code>. </td></tr><tr><td data-label="Check script.table.insert"> 4. Updates sort UI and row counts if those functions exist           </td><td data-label="Result &amp; notes"> ✅ Calls <code>updateHeaderSortUI</code> and <code>updateRowCounts</code> safely.                                               </td></tr><tr><td data-label="Check script.table.insert"> 5. Adds Remove button and undo stack (<code>addedStack</code>)                  </td><td data-label="Result &amp; notes"> ✅ Each wrapper has Remove; <code>removeLastAdded()</code> available.                                                </td></tr><tr><td data-label="Check script.table.insert"> 6. Dispatches <code>tableAdded</code> and <code>tableRemoved</code> events for integration </td><td data-label="Result &amp; notes"> ✅ Events include details (id, table, parsed).                                                            </td></tr><tr><td data-label="Check script.table.insert"> 7. Defensive: try/catch and safe defaults throughout                 </td><td data-label="Result &amp; notes"> ✅ Errors logged but do not break page.                                                                   </td></tr><tr><td data-label="Check script.table.insert"> 8. Minimal global surface and legacy aliases provided                </td><td data-label="Result &amp; notes"> ✅ Exposes <code>window.ScriptTableInsert</code> and legacy names.                                                   </td></tr><tr><td data-label="Check script.table.insert"> 9. Compatible with previous single-file behavior                     </td><td data-label="Result &amp; notes"> ✅ Preserves heading generation, wrapper classes, insertion-after-last behavior.                          </td></tr><tr><td data-label="Check script.table.insert"> 10. Idempotent and testable helper exposed                           </td><td data-label="Result &amp; notes"> ✅ <code>_ensureRowUidsAndSnapshotForAll</code> exported for test/compat usage.                                      </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table5" data-table="Book_8036_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Check `script.table.export`"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Check <code>script.table.export</code></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Result"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Result</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Check script.table.export">1</td><td data-label="Result"> Integrates with <code>tvUtils</code> if present (clipboard, download, toast). ✅                </td></tr><tr><td data-label="Check script.table.export">2</td><td data-label="Result"> Safely obtains table from a button element. ✅                                       </td></tr><tr><td data-label="Check script.table.export">3</td><td data-label="Result"> Markdown reconstruction preserves pipes and cell newlines as <code>&lt;br&gt;</code>. ✅              </td></tr><tr><td data-label="Check script.table.export">4</td><td data-label="Result"> CSV export quotes fields per RFC-ish rules. ✅                                       </td></tr><tr><td data-label="Check script.table.export">5</td><td data-label="Result"> JSON export uses header if present, else generates <code>Col1..</code> names. ✅                </td></tr><tr><td data-label="Check script.table.export">6</td><td data-label="Result"> XLSX uses SheetJS if available, fallback to TSV blob otherwise. ✅                   </td></tr><tr><td data-label="Check script.table.export">7</td><td data-label="Result"> PDF export opens print window with safe HTML wrapper. ✅                             </td></tr><tr><td data-label="Check script.table.export">8</td><td data-label="Result"> Prefers captured source (<code>window.__tv_last_source</code>) when useful via parse helper. ✅ </td></tr><tr><td data-label="Check script.table.export">9</td><td data-label="Result"> Defensive try/catch and non-breaking behavior across functions. ✅                   </td></tr><tr><td data-label="Check script.table.export">10</td><td data-label="Result"> Exposes <code>window.ScriptTableExport</code> and legacy global names for compatibility. ✅     </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table6" data-table="Book_8036_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Check `script.table.init`"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Check <code>script.table.init</code></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Result &amp; notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Result & notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Check script.table.init"> 1. Uses existing split modules if present                                              </td><td data-label="Result &amp; notes"> ✅ <code>ScriptTableDOM</code>, <code>ScriptTableParse</code>, <code>ScriptTableInsert</code>, <code>ScriptTableExport</code> referenced defensively. </td></tr><tr><td data-label="Check script.table.init"> 2. Preserves <code>window.__tv_last_source</code> snapshot behavior                               </td><td data-label="Result &amp; notes"> ✅ Captures <code>#paste</code> input and convert clicks.                                                            </td></tr><tr><td data-label="Check script.table.init"> 3. Modal Add event (<code>st:paste:add</code>) handled and routed to parse+insert                 </td><td data-label="Result &amp; notes"> ✅ Handler uses <code>PARSE.parseTablesFromText</code> and <code>INSERT.parseAndInsert</code> when available.                   </td></tr><tr><td data-label="Check script.table.init"> 4. Delegated copy/export/button handlers attached safely                               </td><td data-label="Result &amp; notes"> ✅ Delegation and per-wrapper explicit wiring included.                                                   </td></tr><tr><td data-label="Check script.table.init"> 5. Keyboard shortcuts preserved (Ctrl/Cmd+Alt+T and <code>/</code>)                               </td><td data-label="Result &amp; notes"> ✅ Implemented with graceful fallbacks.                                                                   </td></tr><tr><td data-label="Check script.table.init"> 6. TOC and rebuild hooks called where available                                        </td><td data-label="Result &amp; notes"> ✅ Calls <code>PTToc.build</code>, <code>buildSingleTableToc</code>, <code>buildTocFromCaptions</code> defensively.                        </td></tr><tr><td data-label="Check script.table.init"> 7. Idempotent init and exposed <code>initRenderedContent</code> for external use                  </td><td data-label="Result &amp; notes"> ✅ Auto-runs on DOMContentLoaded but safe to call again.                                                  </td></tr><tr><td data-label="Check script.table.init"> 8. Non-breaking defensive coding                                                       </td><td data-label="Result &amp; notes"> ✅ try/catch and feature-detection used; shows toast when appropriate.                                    </td></tr><tr><td data-label="Check script.table.init"> 9. Legacy compatibility preserved (<code>window.initRenderedContent</code>, <code>__tv_check_convert</code>) </td><td data-label="Result &amp; notes"> ✅ Provided.                                                                                              </td></tr><tr><td data-label="Check script.table.init"> 10. Minimal global pollution and clear API exposure                                    </td><td data-label="Result &amp; notes"> ✅ Exposes <code>window.ScriptTableInit</code> and few helper functions.                                             </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table7" data-table="Book_8036_07" style="margin-top:2mm;margin-left:3mm;"><strong>Table 7</strong></div>
<div class="table-wrapper" data-table-id="table-7"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Check**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Check</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Pass? &amp; action**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Pass? & action</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Check"> <strong>1. Module files present in <code>assets/</code></strong> </td><td data-label="Pass? &amp; action"> 1. ✅ <code>script.table.dom.js</code><br>2. ✅ <code>script.table.parse.js</code><br>3. ✅ <code>script.table.insert.js</code><br>4. ✅ <code>script.table.export.js</code><br>5. ✅ <code>script.table.init.js</code>           </td></tr><tr><td data-label="Check"> <strong>2. Page references updated</strong>           </td><td data-label="Pass? &amp; action"> 1. ⚠️ Ensure HTML/template references now load the new files or a single new bundle.<br>2. If not possible, keep <code>script.table.js</code> as a backup.                       </td></tr><tr><td data-label="Check"> <strong>3. Legacy globals exist</strong>              </td><td data-label="Pass? &amp; action"> 1. ✅ <code>window.ScriptTableDOM</code><br>2. ✅ <code>window.ScriptTableParse</code><br>3. ✅ <code>window.ScriptTableInsert</code><br>4. ✅ <code>window.ScriptTableExport</code><br>5. ✅ <code>window.ScriptTableInit</code> </td></tr><tr><td data-label="Check"> <strong>4. Legacy aliases exist</strong>              </td><td data-label="Pass? &amp; action"> 1. ✅ <code>window.insertAddedTable</code><br>2. ✅ <code>window.copyTablePlain</code><br>3. ✅ <code>window.exportTableCSV</code>                                                                        </td></tr><tr><td data-label="Check"> <strong>5. Init ran successfully</strong>             </td><td data-label="Pass? &amp; action"> 1. ✅ <code>window.initRenderedContent()</code> callable.<br>2. ✅ Returns <code>true</code> or attaches expected DOM handlers.                                                               </td></tr><tr><td data-label="Check"> <strong>6. Runtime smoke tests pass</strong>          </td><td data-label="Pass? &amp; action"> 1. ⚠️ Open modal.<br>2. ⚠️ Paste MD/CSV/HTML.<br>3. ⚠️ Click Add and verify table inserts.<br>4. ⚠️ Verify copy/export functions work.<br>5. ⚠️ Verify TOC updates.   </td></tr><tr><td data-label="Check"> <strong>7. No console errors on page load</strong>    </td><td data-label="Pass? &amp; action"> 1. ⚠️ Check browser console for module-load errors.<br>2. ⚠️ Check for runtime exceptions after actions.                                                              </td></tr><tr><td data-label="Check"> <strong>8. CI/integration tests green</strong>        </td><td data-label="Pass? &amp; action"> 1. ⚠️ Run Puppeteer/headless tests for insert/export/search/sort flows.<br>2. ⚠️ Fix any failures before merging.                                                     </td></tr><tr><td data-label="Check"> <strong>9. Staging stability window</strong>          </td><td data-label="Pass? &amp; action"> 1. ⚠️ Deploy to staging.<br>2. ⚠️ Monitor 24–48 hours for regressions.<br>3. ⚠️ Roll back if critical issues appear.                                                  </td></tr><tr><td data-label="Check"> <strong>10. Backup & rollback ready</strong>          </td><td data-label="Pass? &amp; action"> 1. ✅ Keep <code>script.table.js</code> backed up in repo/CDN.<br>2. ✅ Do not remove until deletion confirmed.                                                                    </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>