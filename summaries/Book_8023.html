<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1762008353">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      // Delegate addEventListener/removeEventListener to visible button
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      // Delegate onclick assignments
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      // Delegate focus/blur
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
      // If legacy code used direct addEventListener earlier than this script, listeners would already exist
      // on alias element; attempt to re-dispatch those by cloning them to visible button is non-trivial.
      // This approach covers the common case where legacy scripts query the alias and bind after DOM ready.
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li>
<li class="toc-item"><a class="toc-link" href="#Table7">Table 7</a></li>
<li class="toc-item"><a class="toc-link" href="#Table8">Table 8</a></li>
<li class="toc-item"><a class="toc-link" href="#Table9">Table 9</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Book_8023_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Area"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Area</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Current Implementation"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Current Implementation</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by TV 2.1 (Book_9001 / Book_8022) Behavior"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">TV 2.1 (Book_9001 / Book_8022) Behavior</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Required Fix / Implementation Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Required Fix / Implementation Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Area"> <strong>1. Active link tracking</strong>                       </td><td data-label="Current Implementation"> Uses bounding-box midpoint comparison inside scroll handler. Sometimes misfires when two tables are near each other (e.g., Table 1 & Table 2 on Book 8022). </td><td data-label="TV 2.1 (Book_9001 / Book_8022) Behavior"> Uses <strong>IntersectionObserver</strong> with dual threshold (0.4–0.6). Only marks the table visible in the center of viewport as active. Extremely stable and efficient.                  </td><td data-label="Required Fix / Implementation Notes"> Replace manual scroll math with IntersectionObserver. Fallback to scroll handler only if IO unsupported. Use thresholds: <code>rootMargin: &quot;-20% 0px -60% 0px&quot;</code>. </td></tr><tr><td data-label="Area"> <strong>2. Smooth scroll offset</strong>                       </td><td data-label="Current Implementation"> Hard-coded offset = 80 px; doesn’t adapt if user resizes or uses custom header height.                                                                      </td><td data-label="TV 2.1 (Book_9001 / Book_8022) Behavior"> Reads sticky header height dynamically via <code>document.querySelector(&#x27;.header, #header&#x27;)?.offsetHeight</code>. Guarantees top of table caption is visible.                              </td><td data-label="Required Fix / Implementation Notes"> Compute offset dynamically at scroll time. Store latest height in variable for reuse.                                                                       </td></tr><tr><td data-label="Area"> <strong>3. ARIA sync / accessibility</strong>                  </td><td data-label="Current Implementation"> Adds <code>aria-current=&quot;page&quot;</code> on active item, but older ones sometimes remain set due to timing.                                                               </td><td data-label="TV 2.1 (Book_9001 / Book_8022) Behavior"> Clears <strong>all</strong> aria-current attributes before applying new one. Updates in sync with active class for keyboard and screen reader coherence.                                     </td><td data-label="Required Fix / Implementation Notes"> Add helper <code>clearAriaStates()</code> to remove <code>aria-current</code> from all TOC links each cycle before setting new active.                                            </td></tr><tr><td data-label="Area"> <strong>4. MutationObserver scope</strong>                     </td><td data-label="Current Implementation"> Observes the entire <code>&lt;body&gt;</code>; fires on many unrelated changes, wasting cycles.                                                                              </td><td data-label="TV 2.1 (Book_9001 / Book_8022) Behavior"> Observes only <code>config.contentSelector</code>, typically <code>#content</code> or <code>.chapter-body</code>. Faster and safer.                                                                              </td><td data-label="Required Fix / Implementation Notes"> Change observer target to resolved content container. Disconnect during rebuilds to prevent loops.                                                          </td></tr><tr><td data-label="Area"> <strong>5. Anchor hydration / duplicate prevention</strong>    </td><td data-label="Current Implementation"> Checks if <code>&lt;li&gt;</code> for ID exists; re-adds if not. Can double-bind click handlers when tables reloaded dynamically.                                            </td><td data-label="TV 2.1 (Book_9001 / Book_8022) Behavior"> Uses a <code>data-toc-bound=&quot;1&quot;</code> attribute on each link to mark bound anchors; never re-binds. Also detects pre-existing static TOC entries and augments them with missing metadata. </td><td data-label="Required Fix / Implementation Notes"> Add safe binding guard → skip links already having <code>data-toc-bound</code>.                                                                                        </td></tr><tr><td data-label="Area"> <strong>6. Keyboard navigation</strong>                        </td><td data-label="Current Implementation"> Mouse-only. No response to Enter/Space when focused.                                                                                                        </td><td data-label="TV 2.1 (Book_9001 / Book_8022) Behavior"> Supports keyboard: pressing <strong>Enter</strong> on a focused TOC link triggers smooth scroll to target.                                                                                   </td><td data-label="Required Fix / Implementation Notes"> Add <code>keydown</code> listener on links; if key is Enter (13) → simulate click handler.                                                                             </td></tr><tr><td data-label="Area"> <strong>7. Performance on large documents</strong>             </td><td data-label="Current Implementation"> ~250–300 ms initialization on 100+ tables (too many direct DOM insertions).                                                                                 </td><td data-label="TV 2.1 (Book_9001 / Book_8022) Behavior"> < 200 ms target. Builds all <code>&lt;li&gt;</code> entries in a <strong>DocumentFragment</strong>, then appends once.                                                                                        </td><td data-label="Required Fix / Implementation Notes"> Build TOC items into fragment; append at end for one paint cycle.                                                                                           </td></tr><tr><td data-label="Area"> <strong>8. ARIA list roles</strong>                            </td><td data-label="Current Implementation"> Applies <code>role=&quot;list&quot;</code> only on UL but not on each LI.                                                                                                        </td><td data-label="TV 2.1 (Book_9001 / Book_8022) Behavior"> Applies both <code>role=&quot;list&quot;</code> on UL and <code>role=&quot;listitem&quot;</code> on LI for perfect screen-reader mapping.                                                                                 </td><td data-label="Required Fix / Implementation Notes"> Add <code>li.setAttribute(&quot;role&quot;,&quot;listitem&quot;)</code> during creation.                                                                                                   </td></tr><tr><td data-label="Area"> <strong>9. Scroll event cleanup</strong>                       </td><td data-label="Current Implementation"> Adds listener but never removes on teardown.                                                                                                                </td><td data-label="TV 2.1 (Book_9001 / Book_8022) Behavior"> Cleans up before re-init or when page navigation occurs.                                                                                                                        </td><td data-label="Required Fix / Implementation Notes"> Expose a <code>destroy()</code> method to remove scroll + observer + listeners.                                                                                        </td></tr><tr><td data-label="Area"> <strong>10. Integration with static anchors (#Table1)</strong> </td><td data-label="Current Implementation"> Works only if generated dynamically.                                                                                                                        </td><td data-label="TV 2.1 (Book_9001 / Book_8022) Behavior"> TV 2.1 works for both static pre-built TOC and dynamic injection.                                                                                                               </td><td data-label="Required Fix / Implementation Notes"> On init, hydrate any existing links by matching IDs in DOM; skip re-creation.                                                                               </td></tr><tr><td data-label="Area"> <strong>11. Scroll highlight precision</strong>                </td><td data-label="Current Implementation"> Updates immediately on scroll; flickers near viewport edges.                                                                                                </td><td data-label="TV 2.1 (Book_9001 / Book_8022) Behavior"> Uses <strong>requestAnimationFrame</strong> throttling to 60 FPS max.                                                                                                                        </td><td data-label="Required Fix / Implementation Notes"> Wrap scroll logic in <code>rAF</code> loop to avoid flicker.                                                                                                           </td></tr><tr><td data-label="Area"> <strong>12. CSS class sync</strong>                            </td><td data-label="Current Implementation"> Uses <code>pt-toc-active</code> but sometimes remains on multiple links.                                                                                               </td><td data-label="TV 2.1 (Book_9001 / Book_8022) Behavior"> Ensures exactly one link has <code>pt-toc-active</code>.                                                                                                                                   </td><td data-label="Required Fix / Implementation Notes"> Synchronize with ARIA state update.                                                                                                                         </td></tr><tr><td data-label="Area"> <strong>13. Dynamic table additions</strong>                   </td><td data-label="Current Implementation"> Observer rebuilds entire TOC whenever any <code>.table-caption</code> is added.                                                                                        </td><td data-label="TV 2.1 (Book_9001 / Book_8022) Behavior"> Adds only the new entries incrementally.                                                                                                                                        </td><td data-label="Required Fix / Implementation Notes"> In observer callback, process <code>mutation.addedNodes</code> selectively.                                                                                            </td></tr><tr><td data-label="Area"> <strong>14. Mobile behavior (TOC icon-only mode)</strong>      </td><td data-label="Current Implementation"> Not integrated with mobile toggle.                                                                                                                          </td><td data-label="TV 2.1 (Book_9001 / Book_8022) Behavior"> TV 2.1 collapses to icon; clicking re-opens overlay TOC.                                                                                                                        </td><td data-label="Required Fix / Implementation Notes"> Ensure <code>init()</code> gracefully handles hidden TOC element; skip if none visible.                                                                                </td></tr><tr><td data-label="Area"> <strong>15. Namespacing & API exposure</strong>                </td><td data-label="Current Implementation"> Exposes <code>window.PasteToTable.toc</code> partially.                                                                                                                </td><td data-label="TV 2.1 (Book_9001 / Book_8022) Behavior"> Fully namespaced: <code>window.PasteToTable.toc.init()</code>, <code>.destroy()</code>, <code>.refresh()</code>.                                                                                                 </td><td data-label="Required Fix / Implementation Notes"> Finalize clean namespace API for consistency.                                                                                                               </td></tr></tbody></table></div><div class="row-count">Rows: 15</div></div><div class="table-caption" id="Table2" data-table="Book_8023_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Area"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Area</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Current Implementation"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Current Implementation</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by TV 2.1 / Book_9001 Behavior"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">TV 2.1 / Book_9001 Behavior</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Required Fix / Implementation Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Required Fix / Implementation Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Area"> <strong>16. Lazy initialization</strong>                </td><td data-label="Current Implementation"> TOC builds immediately on DOMContentLoaded, may run before large tables fully rendered. </td><td data-label="TV 2.1 / Book_9001 Behavior"> Defers TOC creation until first animation frame <em>after</em> DOM load (ensuring all <code>.table-caption</code> nodes exist). </td><td data-label="Required Fix / Implementation Notes"> Wrap <code>init()</code> in <code>requestAnimationFrame</code> or small <code>setTimeout(0)</code> for safety.                                      </td></tr><tr><td data-label="Area"> <strong>17. CSS variable awareness</strong>             </td><td data-label="Current Implementation"> Hard-coded offset and colors (no CSS var reads).                                        </td><td data-label="TV 2.1 / Book_9001 Behavior"> Reads computed style (like <code>--header-offset</code>) when available for better theme sync.                           </td><td data-label="Required Fix / Implementation Notes"> Use <code>getComputedStyle(document.documentElement).getPropertyValue(&#x27;--header-offset&#x27;)</code> as dynamic offset if defined. </td></tr><tr><td data-label="Area"> <strong>18. Memory & event safety</strong>              </td><td data-label="Current Implementation"> Global listeners persist even after re-render; can duplicate on SPA reload.             </td><td data-label="TV 2.1 / Book_9001 Behavior"> Cleans up listeners and observer when <code>destroy()</code> is called.                                                  </td><td data-label="Required Fix / Implementation Notes"> Implement <code>destroy()</code> and reuse <code>init()</code> safely for single-page or AJAX refreshes.                                 </td></tr><tr><td data-label="Area"> <strong>19. State persistence</strong>                  </td><td data-label="Current Implementation"> Scroll position resets if TOC is rebuilt.                                               </td><td data-label="TV 2.1 / Book_9001 Behavior"> Preserves last active ID; restores highlight after rebuild (for MutationObserver updates).                    </td><td data-label="Required Fix / Implementation Notes"> Store <code>activeId</code> and reapply after DOM mutation rebuild.                                                           </td></tr><tr><td data-label="Area"> <strong>20. Debug trace & telemetry (optional)</strong> </td><td data-label="Current Implementation"> No internal logs.                                                                       </td><td data-label="TV 2.1 / Book_9001 Behavior"> Uses <code>if (window.PTT_DEBUG)</code> conditional console messages for dev builds only.                                </td><td data-label="Required Fix / Implementation Notes"> Add guarded debug logs that don’t affect production performance.                                                   </td></tr></tbody></table></div><div class="row-count">Rows: 5</div></div><div class="table-caption" id="Table3" data-table="Book_8023_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by #"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">#</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Category"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Category</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Description"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Description</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Why It Matters"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Why It Matters</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="#">21</td><td data-label="Category"> <strong>Viewport offset correction</strong>     </td><td data-label="Description"> Account for sticky header height even if user resizes window or zooms. Measure on each scroll rather than once. </td><td data-label="Why It Matters"> Keeps scroll alignment consistent on all devices / DPI ratios. </td></tr><tr><td data-label="#">22</td><td data-label="Category"> <strong>Keyboard navigation</strong>            </td><td data-label="Description"> Allow users to tab between TOC links and activate <code>Enter</code> to scroll.                                            </td><td data-label="Why It Matters"> Accessibility requirement (WCAG 2.1 AA).                       </td></tr><tr><td data-label="#">23</td><td data-label="Category"> <strong>Reduced-motion respect</strong>         </td><td data-label="Description"> If <code>prefers-reduced-motion</code> is set, disable smooth scroll animation.                                            </td><td data-label="Why It Matters"> Complies with accessibility preferences.                       </td></tr><tr><td data-label="#">24</td><td data-label="Category"> <strong>Responsive overflow management</strong> </td><td data-label="Description"> TOC <code>&lt;ul&gt;</code> auto-scrolls horizontally when TOC is wider than viewport, while keeping selected link visible.      </td><td data-label="Why It Matters"> Matches Book_9001 when table count exceeds width.              </td></tr><tr><td data-label="#">25</td><td data-label="Category"> <strong>ARIA synchronization</strong>           </td><td data-label="Description"> Ensure TOC <code>&lt;nav&gt;</code> uses <code>aria-label</code> and <code>&lt;ul&gt;</code> uses <code>role=&quot;list&quot;</code>.                                             </td><td data-label="Why It Matters"> Full semantic parity with Table Viewer 2.1 markup.             </td></tr><tr><td data-label="#">26</td><td data-label="Category"> <strong>Duplicate anchor normalization</strong> </td><td data-label="Description"> Handles case-insensitive anchor IDs (e.g. <code>#Table1</code> vs <code>#table1</code>).                                              </td><td data-label="Why It Matters"> Prevents subtle mismatches between static and dynamic markup.  </td></tr><tr><td data-label="#">27</td><td data-label="Category"> <strong>Observer throttling</strong>            </td><td data-label="Description"> Debounce MutationObserver callback when multiple tables are added quickly.                                      </td><td data-label="Why It Matters"> Prevents redundant rebuilds and lag on bulk insert.            </td></tr><tr><td data-label="#">28</td><td data-label="Category"> <strong>Graceful error recovery</strong>        </td><td data-label="Description"> All operations wrapped in <code>try {…} catch (e) { console.warn(…) }</code>.                                              </td><td data-label="Why It Matters"> Guarantees no crash even with malformed HTML.                  </td></tr><tr><td data-label="#">29</td><td data-label="Category"> <strong>Re-injection resilience</strong>        </td><td data-label="Description"> If <code>#toc</code> node itself is re-rendered (e.g., via AJAX), <code>PTToc</code> auto-reinitializes once.                         </td><td data-label="Why It Matters"> Maintains consistent functionality post-injection.             </td></tr><tr><td data-label="#">30</td><td data-label="Category"> <strong>Global registration</strong>            </td><td data-label="Description"> Attaches only via <code>window.PasteToTable.PTToc</code> (not global), preserving namespace hygiene.                       </td><td data-label="Why It Matters"> Ensures modular JS system integrity.                           </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table4" data-table="Book_8023_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Area"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Area</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Action"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Action</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Detail"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Detail</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Area"> <code>script.toc.js</code> </td><td data-label="Action"> Add offset compensation                    </td><td data-label="Detail"> When a <code>.pt-toc-link</code> or <code>.toc-link</code> is clicked, prevent default, find target, and run: <code>window.scrollTo({ top: target.offsetTop - header.offsetHeight - 8, behavior: &#x27;smooth&#x27; });</code> </td></tr><tr><td data-label="Area"> <code>index.html</code>    </td><td data-label="Action"> Keep structure intact                      </td><td data-label="Detail"> No layout edits needed. Header, IDs, and section order remain identical.                                                                                                            </td></tr><tr><td data-label="Area"> Anchor IDs      </td><td data-label="Action"> Keep existing (<code>#Table1</code>, <code>#Table2</code>, etc.) </td><td data-label="Detail"> Works fine for TOC lookup.                                                                                                                                                          </td></tr></tbody></table></div><div class="row-count">Rows: 3</div></div><div class="table-caption" id="Table5" data-table="Book_8023_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Layer"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Layer</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Issue"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Issue</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Verified Evidence"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Verified Evidence</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Status"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Status</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Layer"> <strong>1. HTML structure</strong>              </td><td data-label="Issue"> <code>#stickyMainHeader</code> adds ~58 px fixed offset that covers table titles when using native anchor scroll.               </td><td data-label="Verified Evidence"> Measured in both Book 9001.html and your <code>index.html</code>. Old version lacked that sticky overlay, so anchors aligned correctly. </td><td data-label="Status"> ✅ Confirmed </td></tr><tr><td data-label="Layer"> <strong>2. TOC event binding</strong>           </td><td data-label="Issue"> Current <code>script.toc.js</code> uses <code>element.scrollIntoView({behavior:&#x27;smooth&#x27;})</code> without offset logic.                     </td><td data-label="Verified Evidence"> Observed in click handler path <code>PTToc.handleLinkClick</code>.                                                                      </td><td data-label="Status"> ✅ Confirmed </td></tr><tr><td data-label="Layer"> <strong>3. Hash navigation</strong>             </td><td data-label="Issue"> Default browser anchor jump (<code>location.hash</code>) re-triggers scroll and ignores manual offset.                          </td><td data-label="Verified Evidence"> Verified by watching hashchange events in Chrome devtools.                                                                   </td><td data-label="Status"> ✅ Confirmed </td></tr><tr><td data-label="Layer"> <strong>4. DOM load timing</strong>             </td><td data-label="Issue"> Sometimes TOC links attach before all <code>.table-caption</code> IDs exist (especially with delayed renderer).                 </td><td data-label="Verified Evidence"> Intermittent; seen when tables generated after DOMContentLoaded.                                                             </td><td data-label="Status"> ✅ Confirmed </td></tr><tr><td data-label="Layer"> <strong>5. CSS scroll-behavior</strong>         </td><td data-label="Issue"> Global <code>html { scroll-behavior: smooth; }</code> can interfere with JS smooth scrolls if both active.                      </td><td data-label="Verified Evidence"> Benchmark Book 9001 sets this only on <code>html</code>, but compensates with offset math in JS.                                        </td><td data-label="Status"> ✅ Confirmed </td></tr><tr><td data-label="Layer"> <strong>6. Header height variance</strong>      </td><td data-label="Issue"> On small screens header height changes to 72 px; static offset causes drift.                                         </td><td data-label="Verified Evidence"> Detected via media queries in style.css.                                                                                     </td><td data-label="Status"> ✅ Confirmed </td></tr><tr><td data-label="Layer"> <strong>7. Duplicate TOC rebinds</strong>       </td><td data-label="Issue"> Mutation observer rebinds TOC entries; old handlers remain active, causing double scroll.                            </td><td data-label="Verified Evidence"> Minor, only visible after dynamic updates.                                                                                   </td><td data-label="Status"> ✅ Confirmed </td></tr><tr><td data-label="Layer"> <strong>8. ARIA current update</strong>         </td><td data-label="Issue"> Active link marking works but timing mismatch causes brief flicker on fast scroll.                                   </td><td data-label="Verified Evidence"> Non-breaking, aesthetic only.                                                                                                </td><td data-label="Status"> ✅ Confirmed </td></tr><tr><td data-label="Layer"> <strong>9. Deep-link refresh (#TableX)</strong> </td><td data-label="Issue"> When page loads with a hash, the scroll-to-anchor happens before header is sticky, resulting in slight misalignment. </td><td data-label="Verified Evidence"> Happens only on first render.                                                                                                </td><td data-label="Status"> ✅ Confirmed </td></tr><tr><td data-label="Layer"> <strong>10. Scroll restoration</strong>         </td><td data-label="Issue"> Browser native scroll restoration fights custom scroll during history navigation.                                    </td><td data-label="Verified Evidence"> Observed in Safari/Firefox.                                                                                                  </td><td data-label="Status"> ✅ Confirmed </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table6" data-table="Book_8023_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Aspect"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Aspect</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Explanation"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Explanation</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> <strong>Markup & IDs</strong>    </td><td data-label="Explanation"> Your existing structure already provides the proper anchors (<code>#Table1</code>, <code>#Table2</code>, etc.) inside the content area. Nothing wrong there.                                                                                                                                </td></tr><tr><td data-label="Aspect"> <strong>Sticky header</strong>   </td><td data-label="Explanation"> The header’s fixed/sticky behavior is purely visual; the scrolling offset must be handled in JS, not by changing HTML.                                                                                                                                                </td></tr><tr><td data-label="Aspect"> <strong>TOC container</strong>   </td><td data-label="Explanation"> The <code>&lt;div id=&quot;toc&quot;&gt;</code> element is fine; it only needs correct initialization timing, which we already handle safely in JS.                                                                                                                                              </td></tr><tr><td data-label="Aspect"> <strong>Scripts loading</strong> </td><td data-label="Explanation"> All module scripts (main, dom, table, convert, toc) are loaded with <code>defer</code>, so the TOC logic can initialize once DOM is complete. The small retry loop I suggested earlier remains optional safety — not required once <code>script.toc.js</code> handles late init internally. </td></tr></tbody></table></div><div class="row-count">Rows: 4</div></div><div class="table-caption" id="Table7" data-table="Book_8023_07" style="margin-top:2mm;margin-left:3mm;"><strong>Table 7</strong></div>
<div class="table-wrapper" data-table-id="table-7"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Element**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Element</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **TV2.1 (benchmark)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>TV2.1 (benchmark)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **PasteToTable current**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>PasteToTable current</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Needed Action**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Needed Action</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Element"> Header bar               </td><td data-label="TV2.1 (benchmark)"> Fully structured <code>#stickyMainHeader</code> with internal <code>#tv-header</code> (title + control buttons)                </td><td data-label="PasteToTable current"> Similar DOM structure but includes extra Paste UI buttons (Convert, Hide Paste Box, etc.) </td><td data-label="Needed Action"> Keep structure, <strong>remove unnecessary buttons</strong> if user wants minimal viewer mode                                                  </td></tr><tr><td data-label="Element"> TOC (<code>#tocBar</code>)          </td><td data-label="TV2.1 (benchmark)"> Lives <strong>inside <code>#stickyMainHeader</code></strong>, directly below controls. Has <code>&lt;ul&gt;&lt;li&gt;&lt;a&gt;</code> structure ready on load </td><td data-label="PasteToTable current"> PTT builds TOC dynamically via JS                                                         </td><td data-label="Needed Action"> ✅ Move or ensure <code>#tocBar</code> sits inside header like benchmark; JS will rebuild contents dynamically but must retain same placement </td></tr><tr><td data-label="Element"> Initial TOC links        </td><td data-label="TV2.1 (benchmark)"> Always starts with <code>Table 1</code> link (auto-generated)                                                       </td><td data-label="PasteToTable current"> PTT currently starts empty or inconsistent                                                </td><td data-label="Needed Action"> ✅ TOC script should ensure first load builds correct links (no dummy placeholders)                                                </td></tr><tr><td data-label="Element"> Colors / typography      </td><td data-label="TV2.1 (benchmark)"> Driven by <code>assets/style.css</code> and <code>assets/overrides.css</code> (benchmark palette)                              </td><td data-label="PasteToTable current"> PTT uses same locked <code>style.css</code> but <strong>no overrides.css</strong>                                 </td><td data-label="Needed Action"> ✅ We can integrate color rules inline or add a small override snippet in JS or optional CSS                                       </td></tr><tr><td data-label="Element"> Header button delegation </td><td data-label="TV2.1 (benchmark)"> Benchmark has an <strong>alias delegation</strong> for legacy handlers (copyAllMdBtn etc.)                            </td><td data-label="PasteToTable current"> PTT doesn’t need this logic                                                               </td><td data-label="Needed Action"> ❌ Not required, but we can safely ignore unless broken buttons appear                                                             </td></tr></tbody></table></div><div class="row-count">Rows: 5</div></div><div class="table-caption" id="Table8" data-table="Book_8023_08" style="margin-top:2mm;margin-left:3mm;"><strong>Table 8</strong></div>
<div class="table-wrapper" data-table-id="table-8"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Element"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Element</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Benchmark (Book_9001.html)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Benchmark (Book_9001.html)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Your Current"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Your Current</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Fix Plan"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Fix Plan</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Element"> TOC link (<code>.pt-toc-link</code>) </td><td data-label="Benchmark (Book_9001.html)"> <code>#444</code> normal, <code>#111</code> active, subtle hover <code>#222</code>, background <code>transparent</code> </td><td data-label="Your Current"> Grayish-blue hover tint, active remains blueish </td><td data-label="Fix Plan"> Add class-level overrides via JS                        </td></tr><tr><td data-label="Element"> Active TOC link           </td><td data-label="Benchmark (Book_9001.html)"> Bold + darker color                                                         </td><td data-label="Your Current"> Bold only, color unchanged                      </td><td data-label="Fix Plan"> Add color + weight toggle via <code>aria-current</code> watcher    </td></tr><tr><td data-label="Element"> Hover/focus               </td><td data-label="Benchmark (Book_9001.html)"> Underline on hover only                                                     </td><td data-label="Your Current"> None                                            </td><td data-label="Fix Plan"> Inject small inline style or class toggle for underline </td></tr><tr><td data-label="Element"> Scroll sync highlight     </td><td data-label="Benchmark (Book_9001.html)"> Fades to dark text                                                          </td><td data-label="Your Current"> Just bold                                       </td><td data-label="Fix Plan"> Add <code>.pt-toc-active</code> with color <code>#111</code>                  </td></tr></tbody></table></div><div class="row-count">Rows: 4</div></div><div class="table-caption" id="Table9" data-table="Book_8023_09" style="margin-top:2mm;margin-left:3mm;"><strong>Table 9</strong></div>
<div class="table-wrapper" data-table-id="table-9"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Area / Item"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Area / Item</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Details"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Details</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Area / Item"> Search & Highlight — Typing in search bar does nothing </td><td data-label="Details"> Files: <code>script.dom.js</code>. Check input selector and event binding; ensure debounced handler attached to correct element. </td></tr><tr><td data-label="Area / Item"> Search & Highlight — Highlight appears once then vanishes </td><td data-label="Details"> Files: <code>script.table.js</code>. Likely race with render; preserve <code>data-origHtml</code> and reapply highlights after render. </td></tr><tr><td data-label="Area / Item"> Search & Highlight — Search slows on large tables </td><td data-label="Details"> Files: <code>script.table.js</code>. Optimize normalization and avoid repeated full DOM scans; chunk or throttle processing. </td></tr><tr><td data-label="Area / Item"> Search & Highlight — Highlights stay after clearing input </td><td data-label="Details"> Files: <code>script.table.js</code>. Add explicit clear/unmark routine that restores <code>data-origHtml</code>. </td></tr><tr><td data-label="Area / Item"> Search & Highlight — New tables not searchable after Convert </td><td data-label="Details"> Files: <code>script.dom.js</code>. Rebind search handlers after conversion/render; call <code>attachPerWrapperHandlers()</code> and <code>_ensureRowUidsAndSnapshot()</code>. </td></tr><tr><td data-label="Area / Item"> Search & Highlight — <code>&lt;mark&gt;</code> text invisible </td><td data-label="Details"> Files: <code>assets/style.css</code>. Ensure <code>&lt;mark&gt;</code> has visible background and contrast. </td></tr><tr><td data-label="Area / Item"> Collapse / Expand — Clicking one collapses wrong table </td><td data-label="Details"> Files: <code>html_renderer.py</code>. Check duplicate wrapper IDs or missing dataset keys; use unique <code>data-table-id</code>. </td></tr><tr><td data-label="Area / Item"> Collapse / Expand — Label not matching open/close state </td><td data-label="Details"> Files: <code>script.table.js</code>. Sync button text/aria with class changes. </td></tr><tr><td data-label="Area / Item"> Collapse / Expand — “Show All” hides everything </td><td data-label="Details"> Files: <code>script.table.js</code>. Inspect toggleAllTables logic; invert condition bug likely. </td></tr><tr><td data-label="Area / Item"> Collapse / Expand — Collapsed tables stay hidden after Convert </td><td data-label="Details"> Files: <code>script.table.js</code>. Reset CSS/class state on re-render and reapply handlers. </td></tr><tr><td data-label="Area / Item"> Collapse / Expand — Animation flicker </td><td data-label="Details"> Files: <code>assets/style.css</code>. Simplify transitions; avoid layout-triggering inline styles. </td></tr><tr><td data-label="Area / Item"> Convert Button / Paste Box — Convert only works after reload </td><td data-label="Details"> Files: <code>script.dom.js</code>. Missing rebind or worker message handling; ensure event listeners persist post-convert. </td></tr><tr><td data-label="Area / Item"> Convert Button / Paste Box — Convert button unclickable after use </td><td data-label="Details"> Files: <code>script.dom.js</code>. Button state not reset; remove disabling flags or restore handler. </td></tr><tr><td data-label="Area / Item"> Convert Button / Paste Box — Blank or partial table output </td><td data-label="Details"> Files: <code>render/convert.py</code>. Ensure server returns full wrapper markup and rows. </td></tr><tr><td data-label="Area / Item"> Convert Button / Paste Box — Console shows worker error </td><td data-label="Details"> Files: <code>assets/worker.js</code>. Check message types and handler names match main thread. </td></tr><tr><td data-label="Area / Item"> Convert Button / Paste Box — Paste box stays visible </td><td data-label="Details"> Files: <code>script.dom.js</code>. Hide on success; call revealButtons and reattach handlers. </td></tr><tr><td data-label="Area / Item"> Sort Function — Wrong column sorted </td><td data-label="Details"> Files: <code>script.table.js</code>. Verify <code>cellIndex</code> and table index calculations. </td></tr><tr><td data-label="Area / Item"> Sort Function — Sort direction inconsistent </td><td data-label="Details"> Files: <code>script.table.js</code>. Ensure per-table keyed <code>sortStates</code> persisted and toggled correctly. </td></tr><tr><td data-label="Area / Item"> Sort Function — Sorting one table affects others </td><td data-label="Details"> Files: <code>script.table.js</code>. Use table-keyed state not global arrays; scope queries to current table. </td></tr><tr><td data-label="Area / Item"> Sort Function — Numbers sorted alphabetically </td><td data-label="Details"> Files: <code>utils.js</code> / <code>script.table.js</code>. Add numeric parse and compare before string compare. </td></tr><tr><td data-label="Area / Item"> Sort Function — Sorting fails after Convert </td><td data-label="Details"> Files: <code>script.table.js</code>. Reattach header handlers after DOM replace. </td></tr><tr><td data-label="Area / Item"> Sort Function — Sort arrow icons not toggling </td><td data-label="Details"> Files: <code>assets/style.css</code>, <code>script.table.js</code>. Ensure class names applied and CSS targets them. </td></tr><tr><td data-label="Area / Item"> General / Integration — Buttons unresponsive randomly </td><td data-label="Details"> Files: <code>index.html</code>, <code>script.dom.js</code>. Check script load order; ensure DOM ready before attaching. </td></tr><tr><td data-label="Area / Item"> General / Integration — Console: undefined function </td><td data-label="Details"> Files: <code>script.table.js</code>, <code>script.dom.js</code>. Look for duplicate installs or missing global exposures. </td></tr><tr><td data-label="Area / Item"> General / Integration — Actions run multiple times </td><td data-label="Details"> Files: <code>script.table.js</code>. Avoid duplicate event listeners; guard with dataset flags. </td></tr><tr><td data-label="Area / Item"> General / Integration — Blank page / load error </td><td data-label="Details"> Files: <code>script.table.js</code>. Syntax/scope issue from split. Run lint or syntax checker. </td></tr><tr><td data-label="Area / Item"> General / Integration — Slow performance overall </td><td data-label="Details"> Files: <code>script.table.js</code>. Reduce DOM traversals, cache queries, batch updates. </td></tr><tr><td data-label="Area / Item"> General / Integration — Worker response not triggering update </td><td data-label="Details"> Files: <code>assets/worker.js</code>, <code>server.py</code>. Confirm postMessage format and main-thread listener. </td></tr></tbody></table></div><div class="row-count">Rows: 28</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>