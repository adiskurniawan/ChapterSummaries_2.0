<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1760589914">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      // Delegate addEventListener/removeEventListener to visible button
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      // Delegate onclick assignments
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      // Delegate focus/blur
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
      // If legacy code used direct addEventListener earlier than this script, listeners would already exist
      // on alias element; attempt to re-dispatch those by cloning them to visible button is non-trivial.
      // This approach covers the common case where legacy scripts query the alias and bind after DOM ready.
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li>
<li class="toc-item"><a class="toc-link" href="#Table5">Table 5</a></li>
<li class="toc-item"><a class="toc-link" href="#Table6">Table 6</a></li>
<li class="toc-item"><a class="toc-link" href="#Table7">Table 7</a></li>
<li class="toc-item"><a class="toc-link" href="#Table8">Table 8</a></li>
<li class="toc-item"><a class="toc-link" href="#Table9">Table 9</a></li>
<li class="toc-item"><a class="toc-link" href="#Table10">Table 10</a></li>
<li class="toc-item"><a class="toc-link" href="#Table11">Table 11</a></li>
<li class="toc-item"><a class="toc-link" href="#Table12">Table 12</a></li>
<li class="toc-item"><a class="toc-link" href="#Table13">Table 13</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Book_8020_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Module"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Module</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Purpose"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Purpose</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Module"> <code>script.main.js</code>                                   </td><td data-label="Purpose"> Lifecycle bootstrap and delegate binding.                     </td></tr><tr><td data-label="Module"> <code>script.dom.js</code>                                    </td><td data-label="Purpose"> DOM control, modal/toast UI, search, resize, TOC interaction. </td></tr><tr><td data-label="Module"> <code>script.table.js</code>                                  </td><td data-label="Purpose"> Table rendering, sorting, toggling, copy, export.             </td></tr><tr><td data-label="Module"> <code>script.convert.js</code>                                </td><td data-label="Purpose"> Conversion engine and textarea handling.                      </td></tr><tr><td data-label="Module"> <code>script.toc.js</code>                                    </td><td data-label="Purpose"> TOC builder, scroll sync, navigation.                         </td></tr><tr><td data-label="Module"> <em>(Optional future)</em> <code>script.utils.js</code>, <code>worker.js</code> </td><td data-label="Purpose"> Utilities and worker communication.                           </td></tr></tbody></table></div><div class="row-count">Rows: 6</div></div><div class="table-caption" id="Table2" data-table="Book_8020_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by File"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">File</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Proposed minimal action (why, what to change)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Proposed minimal action (why, what to change)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="File"> <code>templates/index.html</code> </td><td data-label="Proposed minimal action (why, what to change)"> Match font links, CSS order, and structural wrappers from Book_9001.html. Add missing meta or wrapper classes that affect typography. (High impact, low risk)                        </td></tr><tr><td data-label="File"> <code>assets/script.js</code>     </td><td data-label="Proposed minimal action (why, what to change)"> Neutralize any inline style injections that alter typography. Ensure DOM-ready order preserves CSS overrides. Preserve legacy global names. (JS affects layout)                      </td></tr><tr><td data-label="File"> <code>assets/worker.js</code>     </td><td data-label="Proposed minimal action (why, what to change)"> Check only. If worker injects styles or assets, adjust to avoid typographic changes. Otherwise keep. (Low likelihood)                                                                </td></tr><tr><td data-label="File"> <code>render/convert.py</code>    </td><td data-label="Proposed minimal action (why, what to change)"> Preserve classes/attributes during conversion. If sanitizer strips classes or inline attributes that affect typography, update sanitizer rules to keep them. (High impact on markup) </td></tr><tr><td data-label="File"> <code>html_renderer.py</code>     </td><td data-label="Proposed minimal action (why, what to change)"> Ensure HTML output includes same wrapper structure and class names as benchmark. Small template-level fixes only. (Medium impact)                                                    </td></tr><tr><td data-label="File"> <code>utils.py</code>             </td><td data-label="Proposed minimal action (why, what to change)"> Ensure helper functions used during rendering (e.g., inline CSS embedding, asset URL joining) match benchmark behavior. (Low impact)                                                 </td></tr><tr><td data-label="File"> <code>main.py</code>              </td><td data-label="Proposed minimal action (why, what to change)"> Confirm static file serving path order and headers so fonts/CSS load same order; adjust if necessary. (Operational)                                                                  </td></tr><tr><td data-label="File"> <code>server.py</code>            </td><td data-label="Proposed minimal action (why, what to change)"> Audit only for data flow differences. Do not change unless necessary to reproduce benchmark output. (Audit)                                                                          </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table3" data-table="Book_8020_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Tables Viewer (TV)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Tables Viewer (TV)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **PasteToTable (PTT)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>PasteToTable (PTT)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Tables Viewer (TV)"> main.py                </td><td data-label="PasteToTable (PTT)"> main.py                     </td></tr><tr><td data-label="Tables Viewer (TV)"> server.py              </td><td data-label="PasteToTable (PTT)"> server.py                   </td></tr><tr><td data-label="Tables Viewer (TV)"> html_renderer.py       </td><td data-label="PasteToTable (PTT)"> html_renderer.py            </td></tr><tr><td data-label="Tables Viewer (TV)"> utils.py               </td><td data-label="PasteToTable (PTT)"> utils.py                    </td></tr><tr><td data-label="Tables Viewer (TV)"> render/convert.py      </td><td data-label="PasteToTable (PTT)"> render/convert.py           </td></tr><tr><td data-label="Tables Viewer (TV)"> templates/index.html   </td><td data-label="PasteToTable (PTT)"> templates/index.html        </td></tr><tr><td data-label="Tables Viewer (TV)"> assets/script.js       </td><td data-label="PasteToTable (PTT)"> assets/script.js            </td></tr><tr><td data-label="Tables Viewer (TV)"> assets/worker.js       </td><td data-label="PasteToTable (PTT)"> assets/worker.js            </td></tr><tr><td data-label="Tables Viewer (TV)"> assets/style.css       </td><td data-label="PasteToTable (PTT)"> assets/style.css <em>(locked)</em> </td></tr><tr><td data-label="Tables Viewer (TV)"> render/ (others)       </td><td data-label="PasteToTable (PTT)"> render/ (locked)*           </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table4" data-table="Book_8020_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Priority**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Priority</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **File**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>File</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Reason**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Reason</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Priority">1</td><td data-label="File"> <code>templates/index.html</code> </td><td data-label="Reason"> Controls HTML structure, CSS link order, and font loading — first to fix typography alignment.      </td></tr><tr><td data-label="Priority">2</td><td data-label="File"> <code>assets/script.js</code>     </td><td data-label="Reason"> Handles DOM updates, inline styles, and dynamic table rendering — second key typography influencer. </td></tr><tr><td data-label="Priority">3</td><td data-label="File"> <code>render/convert.py</code>    </td><td data-label="Reason"> May strip classes or attributes during conversion — affects structure fidelity.                     </td></tr><tr><td data-label="Priority">4</td><td data-label="File"> <code>html_renderer.py</code>     </td><td data-label="Reason"> Renders HTML from internal data — ensures output matches Table Viewer layout.                       </td></tr><tr><td data-label="Priority">5</td><td data-label="File"> <code>utils.py</code>             </td><td data-label="Reason"> Supports text/HTML sanitization; indirect but can break styling inheritance.                        </td></tr><tr><td data-label="Priority">6</td><td data-label="File"> <code>main.py</code>              </td><td data-label="Reason"> Entry point; minimal visual impact but ensures consistent initialization.                           </td></tr><tr><td data-label="Priority">7</td><td data-label="File"> <code>assets/worker.js</code>     </td><td data-label="Reason"> Background conversion logic; low typography effect, verify compatibility.                           </td></tr><tr><td data-label="Priority">8</td><td data-label="File"> <code>server.py</code>            </td><td data-label="Reason"> Unique to PasteToTable, check only data flow — no UI/typography role.                               </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table5" data-table="Book_8020_05" style="margin-top:2mm;margin-left:3mm;"><strong>Table 5</strong></div>
<div class="table-wrapper" data-table-id="table-5"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure (current vs. target)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure (current vs. target)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes (planned edit rationale)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes (planned edit rationale)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure (current vs. target)"> <code>&lt;head&gt;</code> section currently loads local CSS and JS in variable order.                  </td><td data-label="Conceptual Notes (planned edit rationale)"> Benchmark (<code>Book_9001.html</code>) defines strict order: meta → title → inline <code>&lt;style&gt;</code> root vars → external CSS (style.css?v=timestamp) → scripts. I will reorder links to match.          </td></tr><tr><td data-label="Logic / Structure (current vs. target)"> <code>&lt;meta&gt;</code> tags incomplete (missing <code>theme-color</code>, <code>description</code>).                      </td><td data-label="Conceptual Notes (planned edit rationale)"> Copy benchmark meta sequence to ensure identical rendering hints and PWA consistency.                                                                                                  </td></tr><tr><td data-label="Logic / Structure (current vs. target)"> Font loading inconsistent; PasteToTable may rely on browser default.                  </td><td data-label="Conceptual Notes (planned edit rationale)"> Benchmark uses CSS-defined font via <code>assets/style.css</code>; confirm correct <code>&lt;link&gt;</code> path and preload sequence to ensure font weight consistency.                                          </td></tr><tr><td data-label="Logic / Structure (current vs. target)"> <code>&lt;body&gt;</code> wrappers and class names differ slightly (<code>.table-wrapper</code>, <code>.main-header</code>). </td><td data-label="Conceptual Notes (planned edit rationale)"> Match benchmark wrappers, classes, and IDs exactly. These affect inherited CSS margins and line heights.                                                                               </td></tr><tr><td data-label="Logic / Structure (current vs. target)"> Script inclusion order currently single (<code>script.js</code>).                                </td><td data-label="Conceptual Notes (planned edit rationale)"> Replace with modular sequence:<br>1. <code>assets/script.main.js</code><br>2. <code>assets/script.dom.js</code><br>3. <code>assets/script.table.js</code><br>4. <code>assets/script.convert.js</code><br>5. <code>assets/script.toc.js</code> </td></tr><tr><td data-label="Logic / Structure (current vs. target)"> <code>&lt;noscript&gt;</code> missing or different.                                                    </td><td data-label="Conceptual Notes (planned edit rationale)"> Benchmark uses <code>&lt;noscript&gt;</code> block for fallback notice; include same markup.                                                                                                            </td></tr><tr><td data-label="Logic / Structure (current vs. target)"> HTML indentation, tag order, and attribute placement differ.                          </td><td data-label="Conceptual Notes (planned edit rationale)"> Normalize to benchmark format for byte-level reproducibility and maintainability.                                                                                                      </td></tr><tr><td data-label="Logic / Structure (current vs. target)"> Footer or closing tags may include debug comments.                                    </td><td data-label="Conceptual Notes (planned edit rationale)"> Remove extraneous comments; mirror benchmark’s clean close structure.                                                                                                                  </td></tr><tr><td data-label="Logic / Structure (current vs. target)"> Timestamp or cache-busting query parameters differ.                                   </td><td data-label="Conceptual Notes (planned edit rationale)"> Adopt <code>?v=1759925496</code> pattern (static timestamp from benchmark) to preserve visual parity.                                                                                             </td></tr></tbody></table></div><div class="row-count">Rows: 9</div></div><div class="table-caption" id="Table6" data-table="Book_8020_06" style="margin-top:2mm;margin-left:3mm;"><strong>Table 6</strong></div>
<div class="table-wrapper" data-table-id="table-6"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Step"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Step</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Description"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Description</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Step"> <strong>1. Code Audit</strong>          </td><td data-label="Description"> Analyze all <code>script.js</code> logic, events, global vars, and DOM manipulation points.                                       </td><td data-label="Notes"> Track every function that touches the DOM, paste box, tables, TOC, Convert/TOC buttons.          </td></tr><tr><td data-label="Step"> <strong>2. Feature Extraction</strong>  </td><td data-label="Description"> List all features as <strong>atomic units</strong>: paste handling, table parsing, sorting, TOC navigation, formatting, UI toggles. </td><td data-label="Notes"> Each feature will later become a separate module or function.                                    </td></tr><tr><td data-label="Step"> <strong>3. Dependency Mapping</strong>  </td><td data-label="Description"> Map dependencies between features, including event listeners and shared state.                                         </td><td data-label="Notes"> This ensures modular separation without breaking event flow.                                     </td></tr><tr><td data-label="Step"> <strong>4. UX Behavior Mapping</strong> </td><td data-label="Description"> Compare <strong>current JS behaviors</strong> with <strong>Table Viewer 2.1</strong>.                                                            </td><td data-label="Notes"> Identify gaps, quirks, or misalignments (e.g., TOC row, Convert behavior, table header sorting). </td></tr><tr><td data-label="Step"> <strong>5. Module Planning</strong>     </td><td data-label="Description"> Draft initial module plan for rebuild: core, UI, TOC, parsing, utility functions.                                      </td><td data-label="Notes"> Will define <strong>function signatures</strong> and <strong>interaction contracts</strong>.                               </td></tr><tr><td data-label="Step"> <strong>6. Safety Scaffold</strong>     </td><td data-label="Description"> Prepare <code>script.js</code> placeholder that <strong>won’t break HTML</strong> but allows modular import for rebuild.                       </td><td data-label="Notes"> Ensures we can do phased rollout.                                                                </td></tr></tbody></table></div><div class="row-count">Rows: 6</div></div><div class="table-caption" id="Table7" data-table="Book_8020_07" style="margin-top:2mm;margin-left:3mm;"><strong>Table 7</strong></div>
<div class="table-wrapper" data-table-id="table-7"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Aspect"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Aspect</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Status in `script.main.js`"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Status in <code>script.main.js</code></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Aspect"> DOM-ready initialization </td><td data-label="Status in script.main.js"> ✅ wraps tables, assigns UIDs, snapshots rows                       </td></tr><tr><td data-label="Aspect"> Back-to-top button       </td><td data-label="Status in script.main.js"> ✅ created, wired, shows/hides based on scroll                      </td></tr><tr><td data-label="Aspect"> Search box               </td><td data-label="Status in script.main.js"> ✅ wired debounced input, Enter triggers search                     </td></tr><tr><td data-label="Aspect"> Keyboard shortcuts       </td><td data-label="Status in script.main.js"> ✅ <code>/</code> focuses search, <code>Escape</code> scrolls up                          </td></tr><tr><td data-label="Aspect"> Action buttons           </td><td data-label="Status in script.main.js"> ✅ wires <code>_wireAdoptedButtons</code> (from adopted JS snippet) if present </td></tr><tr><td data-label="Aspect"> TOC & row snapshots      </td><td data-label="Status in script.main.js"> ✅ builds TOC (if module exists) and tracks row UIDs                </td></tr><tr><td data-label="Aspect"> Idempotence              </td><td data-label="Status in script.main.js"> ✅ prevents multiple DOM-ready runs (<code>__tv_main_installed</code>)         </td></tr><tr><td data-label="Aspect"> Error handling           </td><td data-label="Status in script.main.js"> ✅ safe wrappers around all major DOM operations                    </td></tr></tbody></table></div><div class="row-count">Rows: 8</div></div><div class="table-caption" id="Table8" data-table="Book_8020_08" style="margin-top:2mm;margin-left:3mm;"><strong>Table 8</strong></div>
<div class="table-wrapper" data-table-id="table-8"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic/Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic/Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic/Structure"> <strong>Toast system</strong>                       </td><td data-label="Conceptual Notes"> <strong>script.dom.js</strong> Implements a queued toast/notification system with auto-dismiss and manual close. Dynamically creates a container if missing. Supports <code>info</code>, <code>success</code>, <code>warn</code>, <code>error</code> types, with adaptive duration based on message length. Provides <code>showToast</code> API and dismiss by ID. </td></tr><tr><td data-label="Logic/Structure"> <strong>Copy modal</strong>                         </td><td data-label="Conceptual Notes"> Generates a modal overlay for displaying and copying large text content. Supports <code>Select All</code>, <code>Copy</code>, <code>Download</code> buttons. Provides <code>showCopyModal</code> function and fallback to <code>alert</code> if DOM fails.                                                                          </td></tr><tr><td data-label="Logic/Structure"> <strong>Utilities</strong>                          </td><td data-label="Conceptual Notes"> Functions: <code>getSearchEl()</code> to find search input; <code>getTableFromButton(btn)</code> to resolve table from any related button; <code>safeGetTBody(table)</code> to safely access <code>&lt;tbody&gt;</code>.                                                                                                       </td></tr><tr><td data-label="Logic/Structure"> <strong>Row UID & snapshot</strong>                 </td><td data-label="Conceptual Notes"> Assigns unique IDs (<code>data-tv-uid</code>) to table rows and stores original row order in <code>window.originalRowOrders</code>. Maintains <code>window.sortStates</code> for column sort state. <code>_ensureRowUidsAndSnapshot(table, tableIdx)</code> ensures these snapshots exist.                               </td></tr><tr><td data-label="Logic/Structure"> <strong>Header sort UI & sorting</strong>           </td><td data-label="Conceptual Notes"> <code>updateHeaderSortUI</code> updates visual and ARIA attributes of sort buttons. <code>sortTableByColumn</code> sorts table rows by column, supports numeric and text sorting, toggles ascending/descending/reset. Preserves original order. Includes <code>headerSortButtonClicked</code> wrapper.        </td></tr><tr><td data-label="Logic/Structure"> <strong>Table toggle</strong>                       </td><td data-label="Conceptual Notes"> Functions <code>toggleTable(btn)</code> and <code>toggleAllTables()</code> collapse/expand individual or all tables. Updates button text dynamically.                                                                                                                                              </td></tr><tr><td data-label="Logic/Structure"> <strong>Row count update</strong>                   </td><td data-label="Conceptual Notes"> <code>updateRowCounts()</code> shows “Showing X of Y rows” in each <code>.row-count</code> div, reflecting filtered/visible rows.                                                                                                                                                                  </td></tr><tr><td data-label="Logic/Structure"> <strong>Copy/export table</strong>                  </td><td data-label="Conceptual Notes"> <code>copyTablePlain</code>, <code>copyTableMarkdown</code>, <code>copyAllTablesPlain</code>, <code>copyAllTablesMarkdown</code>. Formats table data for plain text or Markdown, supports fallback modal if clipboard fails.                                                                                             </td></tr><tr><td data-label="Logic/Structure"> <strong>TOC builder</strong>                        </td><td data-label="Conceptual Notes"> <code>buildSingleTableToc()</code> builds a clickable Table of Contents for single-table pages. Ensures unique row IDs, smooth scrolling, accessible labels, and focus management.                                                                                                      </td></tr><tr><td data-label="Logic/Structure"> <strong>Search & highlights</strong>                </td><td data-label="Conceptual Notes"> <code>searchTable()</code> performs normalized, accent-insensitive search. Highlights matches using <code>&lt;mark&gt;</code> elements. Supports per-cell normalization and handles complex Unicode characters. Updates visible rows dynamically.                                                        </td></tr><tr><td data-label="Logic/Structure"> <strong>Mobile/table controls optimization</strong> </td><td data-label="Conceptual Notes"> <code>optimizeTableControls()</code> reorganizes table header controls for small screens (<600px). Groups copy buttons, adjusts toggle button, applies flexible styling. Debounced on resize or media query change.                                                                     </td></tr><tr><td data-label="Logic/Structure"> <strong>Exposure</strong>                           </td><td data-label="Conceptual Notes"> Exposes key functions globally via <code>window</code> to allow other modules to interact: toasts, copy modal, table search, sort, toggle, row UID, Markdown export, highlights, TOC.                                                                                                   </td></tr><tr><td data-label="Logic/Structure"> <strong>Safety / Fallbacks</strong>                 </td><td data-label="Conceptual Notes"> Most operations wrapped in <code>try/catch</code> to prevent page errors. Fallbacks: alert, copy modal, no-op on missing elements. Silent error handling ensures robustness on malformed DOM.                                                                                           </td></tr></tbody></table></div><div class="row-count">Rows: 13</div></div><div class="table-caption" id="Table9" data-table="Book_8020_09" style="margin-top:2mm;margin-left:3mm;"><strong>Table 9</strong></div>
<div class="table-wrapper" data-table-id="table-9"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes (responsibilities &amp; dependencies)**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes (responsibilities & dependencies)</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Self-contained IIFE</strong>                                         </td><td data-label="Conceptual Notes (responsibilities &amp; dependencies)"> Prevents multiple installations (<code>window.__tv_table_installed</code>) and isolates XLSX builder + export logic.                                                                                                                                                                                                     </td></tr><tr><td data-label="Logic / Structure"> <strong>Dependencies</strong>                                                </td><td data-label="Conceptual Notes (responsibilities &amp; dependencies)"> Relies on <code>window.__tv_utils</code> or global helpers (<code>copyToClipboard</code>, <code>downloadBlob</code>, <code>sanitizeFileName</code>, <code>safeSetHTML</code>). Safe fallback if absent.                                                                                                                                                              </td></tr><tr><td data-label="Logic / Structure"> <strong>Embedded XLSX builder</strong>                                       </td><td data-label="Conceptual Notes (responsibilities &amp; dependencies)"> Implements low-level XLSX export without external libraries: UTF-8 encoding, CRC32, ZIP construction, worksheet/workbook XML, styles, content types, relationships. Fully idempotent and compatible with XLSX consumers.                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Column name conversion (<code>__ptt_colName</code>)</strong>                    </td><td data-label="Conceptual Notes (responsibilities &amp; dependencies)"> Converts numeric column index to Excel-style letters (A, B, …, Z, AA, AB…).                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>Export functions</strong>                                            </td><td data-label="Conceptual Notes (responsibilities &amp; dependencies)"> <code>exportTableCSV</code>, <code>exportTableMarkdown</code>, <code>exportAllTablesMarkdown</code>, <code>exportTableJSON</code>, <code>exportTableXLSX</code>, <code>exportTablePDF</code>. Each function: finds table via button wrapper, normalizes data, creates Blob, triggers download or print. Includes fallback paths (e.g., TSV for XLSX if embedded builder fails). </td></tr><tr><td data-label="Logic / Structure"> <strong>Reset / row handling (<code>resetAllTables</code>)</strong>                     </td><td data-label="Conceptual Notes (responsibilities &amp; dependencies)"> Restores original row order (<code>window.originalRowOrders</code>) and HTML cell snapshots, resets sort states, search box, table collapse/expand state, updates row counts, shows toast notifications.                                                                                                                 </td></tr><tr><td data-label="Logic / Structure"> <strong>Hide/reset/reveal buttons</strong>                                   </td><td data-label="Conceptual Notes (responsibilities &amp; dependencies)"> <code>hideResetAllTablesOption</code>, <code>hideExportMarkdownOption</code>, <code>markButtonsHiddenForAllWrappers</code>, <code>revealButtonsForRenderedTables</code>. Supports hiding UI elements until Convert is run. Uses CSS class <code>tv-hidden-before-convert</code>.                                                                                     </td></tr><tr><td data-label="Logic / Structure"> <strong>Per-wrapper handler attachment (<code>attachPerWrapperHandlers</code>)</strong> </td><td data-label="Conceptual Notes (responsibilities &amp; dependencies)"> Idempotent attachment of click events to toggle, copy, export buttons. Skips already attached handlers or buttons with inline <code>onclick</code>.                                                                                                                                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Global exposure</strong>                                             </td><td data-label="Conceptual Notes (responsibilities &amp; dependencies)"> Exposes all major functions to <code>window</code> for external calls. No internal state leaks.                                                                                                                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>Performance & safety</strong>                                        </td><td data-label="Conceptual Notes (responsibilities &amp; dependencies)"> Try/catch on all DOM ops and exports to prevent breaking the page. Handles missing tables gracefully. Silent failures for non-critical actions.                                                                                                                                                               </td></tr><tr><td data-label="Logic / Structure"> <strong>Integration points</strong>                                          </td><td data-label="Conceptual Notes (responsibilities &amp; dependencies)"> Hooks for <code>window.toggleTable</code>, <code>copyTablePlain</code>, <code>copyTableMarkdown</code>, <code>updateRowCounts</code>, <code>optimizeTableControls</code>, <code>searchTable</code>. Optional external SheetJS detection for XLSX export.                                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>UX / accessibility</strong>                                          </td><td data-label="Conceptual Notes (responsibilities &amp; dependencies)"> Uses toast messages (<code>window.showToast</code>) to report export/reset success or failures. Smooth progressive enhancement without blocking.                                                                                                                                                                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Idempotence</strong>                                                 </td><td data-label="Conceptual Notes (responsibilities &amp; dependencies)"> All functions safe to call multiple times without side effects (e.g., multiple <code>attachPerWrapperHandlers</code> calls).                                                                                                                                                                                             </td></tr></tbody></table></div><div class="row-count">Rows: 13</div></div><div class="table-caption" id="Table10" data-table="Book_8020_10" style="margin-top:2mm;margin-left:3mm;"><strong>Table 10</strong></div>
<div class="table-wrapper" data-table-id="table-10"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Logic / Structure"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic / Structure</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Module Wrapper</strong>: IIFE to prevent global namespace pollution; guards against multiple installations with <code>window.__tv_convert_installed</code>.                                                                                                                      </td><td data-label="Conceptual Notes"> Ensures idempotent load; prevents duplicate event bindings or redundant logic execution.                                                  </td></tr><tr><td data-label="Logic / Structure"> <strong>Selector Utilities</strong>: <code>_$(alias)</code> returns first matching element, <code>_all(alias)</code> returns unique array of all matches. Uses <code>_ADOPTED_CONFIG.SELECTORS</code> with fallback arrays.                                                                                    </td><td data-label="Conceptual Notes"> Flexible DOM resolution for UI elements; accommodates multiple possible element IDs or classes in different HTML layouts.                 </td></tr><tr><td data-label="Logic / Structure"> <strong>API Helpers</strong>: <code>_fetchWithRetries</code> with exponential backoff and jitter; <code>_parseResponseSafely</code> to handle JSON or HTML gracefully; <code>apiPost</code>, <code>apiRender</code>, <code>apiConvert</code>, <code>apiSave</code>.                                                                             </td><td data-label="Conceptual Notes"> Robust network layer with retries, timeouts, safe parsing. Supports server-render, conversion, and save endpoints with graceful fallback. </td></tr><tr><td data-label="Logic / Structure"> <strong>Paste Panel & Textarea Access</strong>: <code>getPastePanel()</code>, <code>getPasteTextarea()</code> resolve actual editable area and panel container dynamically.                                                                                                                         </td><td data-label="Conceptual Notes"> Ensures compatibility across multiple UI variations; fallback search handles missing IDs or contenteditable divs.                         </td></tr><tr><td data-label="Logic / Structure"> <strong>Download Helper</strong>: <code>_downloadBlob</code> for local HTML download.                                                                                                                                                                                                    </td><td data-label="Conceptual Notes"> Provides offline fallback if server-side save fails; uses blob URL and programmatic click.                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Notification</strong>: <code>_toast(msg)</code> uses <code>window.showToast</code> if available, else injects temporary DOM element, else console.info.                                                                                                                                     </td><td data-label="Conceptual Notes"> Lightweight, non-blocking user feedback; works even if no toast system is installed.                                                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Render Flow</strong>: <code>doRender({inline})</code> validates input size, prevents concurrent renders, calls <code>apiRender</code> or local parser (<code>parseFirstTableFromText</code> + <code>convertToConceptualRows</code> + <code>renderConceptualTable</code>) as fallback; updates UI buttons and table controls. </td><td data-label="Conceptual Notes"> Full render flow with in-flight guard; fallback ensures offline rendering; maintains UX parity with benchmark Table Viewer 2.1.           </td></tr><tr><td data-label="Logic / Structure"> <strong>Convert Flow</strong>: <code>doConvert()</code> similar to render but uses <code>apiConvert</code>; also supports local fallback; updates buttons and table controls.                                                                                                                       </td><td data-label="Conceptual Notes"> Provides independent conversion step; consistent with server API; offline fallback ensures robust UX.                                     </td></tr><tr><td data-label="Logic / Structure"> <strong>Save Flow</strong>: <code>doSave()</code> sends container HTML to <code>/save</code> API; falls back to local HTML download with embedded CSS; button state management.                                                                                                                     </td><td data-label="Conceptual Notes"> Guarantees user can export table content even if server unavailable; ensures filename is timestamped; consistent UX.                      </td></tr><tr><td data-label="Logic / Structure"> <strong>Reset Flow</strong>: <code>resetAll()</code> clears tables container; calls <code>window.resetAllTables()</code> if present; rebuilds TOC if available.                                                                                                                                     </td><td data-label="Conceptual Notes"> Provides unified reset for paste-to-table session; preserves fallback for varying HTML layouts.                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>UI Cleanup</strong>: Removes <code>#togglePasteBtn</code> and similar hide-paste elements proactively.                                                                                                                                                                           </td><td data-label="Conceptual Notes"> Simplifies interface automatically; reduces user confusion.                                                                               </td></tr><tr><td data-label="Logic / Structure"> <strong>Button Wiring</strong>: <code>_wireAdoptedButtons()</code> attaches click listeners to render, convert, save, export, and clear buttons; guards with <code>_pttAdopted</code> to prevent duplicate bindings.                                                                                </td><td data-label="Conceptual Notes"> Ensures idempotent button wiring; supports multiple HTML variations; provides fail-safes and inline error handling.                       </td></tr><tr><td data-label="Logic / Structure"> <strong>Debug Exposure</strong>: Exposes main functions to <code>window</code> for debugging (<code>doRender</code>, <code>doConvert</code>, <code>doSave</code>, <code>resetAll</code>, <code>getPasteTextarea</code>).                                                                                                                        </td><td data-label="Conceptual Notes"> Allows external scripts or console testing without breaking encapsulation.                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Load Handling</strong>: Waits for DOMContentLoaded if page still loading; otherwise wires buttons immediately.                                                                                                                                                        </td><td data-label="Conceptual Notes"> Guarantees early availability without race conditions.                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Logging</strong>: Console info on successful module load.                                                                                                                                                                                                             </td><td data-label="Conceptual Notes"> Simple developer feedback; confirms script activation.                                                                                    </td></tr></tbody></table></div><div class="row-count">Rows: 15</div></div><div class="table-caption" id="Table11" data-table="Book_8020_11" style="margin-top:2mm;margin-left:3mm;"><strong>Table 11</strong></div>
<div class="table-wrapper" data-table-id="table-11"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by Logic/Structure"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Logic/Structure</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Conceptual Notes"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Conceptual Notes</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic/Structure"> Immediately-invoked function expression (IIFE) to isolate TOC logic and avoid global pollution. Guards with <code>window.__tv_toc_installed</code> to prevent multiple installations. </td><td data-label="Conceptual Notes"> Ensures idempotence for repeated script loads.                                                      </td></tr><tr><td data-label="Logic/Structure"> Defines small helper functions: <code>safe(fn, alt)</code> for try/catch execution, <code>isString(x)</code> to check type, and <code>safeGetTBody(table)</code> to reliably return <code>tbody</code> or fallback.    </td><td data-label="Conceptual Notes"> Provides lightweight, reusable utilities that avoid breaking on malformed tables.                   </td></tr><tr><td data-label="Logic/Structure"> <code>buildSingleTableToc()</code> function: Detects <code>.table-wrapper</code> elements and ensures there is exactly one table to build a TOC.                                                 </td><td data-label="Conceptual Notes"> Limits TOC generation to single-table pages; prevents multiple TOCs.                                </td></tr><tr><td data-label="Logic/Structure"> Locates TOC container via multiple selectors: <code>#tocBar</code>, <code>#toc-bar</code>, <code>#toc-container</code>, <code>.toc-bar</code>.                                                                         </td><td data-label="Conceptual Notes"> Makes script robust across varied HTML structures.                                                  </td></tr><tr><td data-label="Logic/Structure"> Iterates over table rows, assigning unique IDs (<code>tv-row-1</code>, <code>tv-row-2</code>, etc.) with collision handling.                                                                     </td><td data-label="Conceptual Notes"> Guarantees anchor links are valid and unique even if HTML already has IDs.                          </td></tr><tr><td data-label="Logic/Structure"> Creates a <code>ul</code> element with <code>flex</code> styling and <code>gap</code> for horizontal TOC display. Each row becomes an <code>li</code> with a link (<code>a</code>) to scroll smoothly to the row.                 </td><td data-label="Conceptual Notes"> Accessibility considered: <code>aria-label</code> and <code>title</code> set to row text; smooth scrolling for better UX. </td></tr><tr><td data-label="Logic/Structure"> Adds <code>click</code> listener to each TOC link: prevents default, scrolls into view, updates URL hash, focuses row without scrolling.                                              </td><td data-label="Conceptual Notes"> Full interactive TOC behavior while preserving browser history and keyboard accessibility.          </td></tr><tr><td data-label="Logic/Structure"> Removes existing TOC list if present before appending a new one.                                                                                                           </td><td data-label="Conceptual Notes"> Avoids duplicate TOC elements on re-render.                                                         </td></tr><tr><td data-label="Logic/Structure"> Exposes <code>buildSingleTableToc</code> to <code>window</code> if not already defined.                                                                                                          </td><td data-label="Conceptual Notes"> Makes function externally callable for manual re-rendering or after table updates.                  </td></tr><tr><td data-label="Logic/Structure"> Logs <code>&quot;tv:toc loaded&quot;</code> on successful script load.                                                                                                                          </td><td data-label="Conceptual Notes"> Simple console confirmation for debugging.                                                          </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table12" data-table="Book_8020_12" style="margin-top:2mm;margin-left:3mm;"><strong>Table 12</strong></div>
<div class="table-wrapper" data-table-id="table-12"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Logic / Structure**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Logic / Structure</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by **Conceptual Notes**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Conceptual Notes</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Logic / Structure"> <strong>Export Functions</strong> (<code>exportTableJSON</code>, <code>exportTableXLSX</code>, <code>exportTablePDF</code>)                                 </td><td data-label="Conceptual Notes"> Provides table export in JSON, XLSX (with SheetJS fallback to TSV), and PDF/print format. Handles filename sanitization, toast notifications, and blob download. Robust error handling ensures fallback and user feedback if native XLSX or PDF support fails. XLSX export checks for SheetJS methods <code>book_new</code>, <code>book_append_sheet</code>, and <code>writeFile</code> or <code>write</code>, falling back to TSV with BOM for Excel compatibility. </td></tr><tr><td data-label="Logic / Structure"> <strong>Reset / Restore Functions</strong> (<code>resetAllTables</code>)                                                              </td><td data-label="Conceptual Notes"> Restores original row order from <code>originalRowOrders</code>, restores per-cell HTML snapshots, resets sort state (<code>sortStates</code>), collapses/expands tables, clears search box, updates row counts, and notifies user via toast. Silent error handling ensures resilience.                                                                                                                                                        </td></tr><tr><td data-label="Logic / Structure"> <strong>UI Hiding / Option Removal</strong> (<code>hideResetAllTablesOption</code>, <code>hideExportMarkdownOption</code>)                       </td><td data-label="Conceptual Notes"> Hides UI elements related to reset and Markdown export by querying multiple selectors, button labels, and toolbar menus. Only hides UI; functions retained for potential internal use.                                                                                                                                                                                                                                   </td></tr><tr><td data-label="Logic / Structure"> <strong>Search / Highlighting</strong> (<code>searchTable</code>, <code>highlightMatches</code>, <code>buildNormalizedMapForCell</code>, <code>clearHighlights</code>) </td><td data-label="Conceptual Notes"> Supports live search with normalization (Unicode NFD, stripping diacritics, filtering non-alphanumeric). Highlights matches using <code>&lt;mark&gt;</code>. Handles multi-node text splits and surrogate pairs for robust Unicode support. Scrolls smoothly to first match and updates virtualized tables if present.                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Table Control Optimization</strong> (<code>optimizeTableControls</code>)                                                      </td><td data-label="Conceptual Notes"> Adjusts table headers and button layouts for mobile (<600px) and desktop. Wraps copy buttons into <code>.copy-buttons</code> container, reorders toggle buttons, applies inline styling only for mobile viewport. Uses debounce to reduce repeated layout recalculations on resize or media query changes.                                                                                                                          </td></tr><tr><td data-label="Logic / Structure"> <strong>DOM Initialization</strong> (<code>DOMContentLoaded</code> listener)                                                          </td><td data-label="Conceptual Notes"> Wraps tables in <code>.table-container</code> if missing, builds single-table TOC, assigns row UIDs and snapshots, sets sortStates, attaches original HTML to each cell, updates toggle button text, attaches search debounce, and ensures <code>backToTop</code> button exists. Also hides UI for reset/Markdown export. Silent error handling throughout for resilience.                                                                     </td></tr><tr><td data-label="Logic / Structure"> <strong>Event Delegation</strong>                                                                                          </td><td data-label="Conceptual Notes"> Global delegated click handlers for sorting headers and TOC anchors. Smooth scroll with header offset, URL state updates, and focus handling. Scroll listener toggles <code>backToTop</code> visibility. Single keydown listener handles <code>/</code> (focus search) and <code>Escape</code> (back to top).                                                                                                                                             </td></tr><tr><td data-label="Logic / Structure"> <strong>Global Function Exposure</strong>                                                                                  </td><td data-label="Conceptual Notes"> Exposes all main actions (<code>headerSortButtonClicked</code>, <code>toggleTable</code>, <code>copyTablePlain</code>, etc.) on <code>window</code> to allow HTML inline handlers or external scripts to call them safely.                                                                                                                                                                                                                                           </td></tr><tr><td data-label="Logic / Structure"> <strong>Theme Toggle</strong> (<code>toggleMode</code>)                                                                               </td><td data-label="Conceptual Notes"> Switches between dark and light modes with localStorage persistence, updates button text.                                                                                                                                                                                                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Debug Info Logging</strong>                                                                                        </td><td data-label="Conceptual Notes"> Logs base paths and URLs (<code>TV_BASE</code>, <code>data-index-url</code>, <code>data-worker-url</code>) to console.                                                                                                                                                                                                                                                                                                                                    </td></tr><tr><td data-label="Logic / Structure"> <strong>Extra Script Loader / Topic Fallback</strong> (<code>extra.js loader</code>)                                                  </td><td data-label="Conceptual Notes"> Attempts to load <code>extra.js</code> from multiple candidate paths, fallback to minimal <code>Table → Topic</code> replacement if no extra script loads. Detects single table or single TOC anchor for patching. Idempotent, safe, and silent error handling.                                                                                                                                                                                </td></tr><tr><td data-label="Logic / Structure"> <strong>Diagnostics</strong> (<code>__tv_patch_diag</code>)                                                                           </td><td data-label="Conceptual Notes"> Provides small report of loaded extra script, topic patch status, and up to 10 anchors matching <code>Table \d+</code>. Useful for debugging and monitoring.                                                                                                                                                                                                                                                                        </td></tr></tbody></table></div><div class="row-count">Rows: 12</div></div><div class="table-caption" id="Table13" data-table="Book_8020_13" style="margin-top:2mm;margin-left:3mm;"><strong>Table 13</strong></div>
<div class="table-wrapper" data-table-id="table-13"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by File"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">File</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Proposed Upgrade Scope"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Proposed Upgrade Scope</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Notes / Inspiration from TV 2.1"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Notes / Inspiration from TV 2.1</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="File"> <strong>script.main.js</strong>    </td><td data-label="Proposed Upgrade Scope"> Entry point, DOMContentLoaded, attach global handlers, load modules.       </td><td data-label="Notes / Inspiration from TV 2.1"> Like TV 2.1, central bootstrap, attach table events, search box, back-to-top.               </td></tr><tr><td data-label="File"> <strong>script.dom.js</strong>     </td><td data-label="Proposed Upgrade Scope"> Safe DOM manipulation, snapshots, UID assignment, container wrapping.      </td><td data-label="Notes / Inspiration from TV 2.1"> Mirrors TV’s row UID & table-container logic.                                               </td></tr><tr><td data-label="File"> <strong>script.table.js</strong>   </td><td data-label="Proposed Upgrade Scope"> Sorting, collapse/expand tables, toggle all, row order management.         </td><td data-label="Notes / Inspiration from TV 2.1"> Adapt TV’s <code>headerSortButtonClicked</code>, toggleTable, sortStates, originalRowOrders.           </td></tr><tr><td data-label="File"> <strong>script.convert.js</strong> </td><td data-label="Proposed Upgrade Scope"> Export functions: CSV/JSON/XLSX/PDF, copy to clipboard.                    </td><td data-label="Notes / Inspiration from TV 2.1"> Inspired by TV exportTableCSV/JSON/XLSX/PDF, with safe fallbacks and sanitized filenames.   </td></tr><tr><td data-label="File"> <strong>script.toc.js</strong>     </td><td data-label="Proposed Upgrade Scope"> TOC creation, single-table fallback, smooth scroll.                        </td><td data-label="Notes / Inspiration from TV 2.1"> TV’s single-table TOC, minimal topic fallback, anchor scroll with sticky header adjustment. </td></tr><tr><td data-label="File"> <strong>script.utils.js</strong>   </td><td data-label="Proposed Upgrade Scope"> Utilities: debounce, normalize string, highlight, backToTop, safeGetTBody. </td><td data-label="Notes / Inspiration from TV 2.1"> TV normalization, highlightMatches, clearHighlights, searchTable helpers.                   </td></tr><tr><td data-label="File"> <strong>worker.js</strong>         </td><td data-label="Proposed Upgrade Scope"> Web Worker logic, heavy conversion tasks, optional async processing.       </td><td data-label="Notes / Inspiration from TV 2.1"> Keep mostly unchanged; TV doesn’t have workers, but can be inspired by safe modular async.  </td></tr></tbody></table></div><div class="row-count">Rows: 7</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>