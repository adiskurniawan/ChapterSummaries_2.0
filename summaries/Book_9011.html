<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;}</style>
<link rel="stylesheet" href="assets/style.css?v=1758615669">
<link rel="stylesheet" href="assets/overrides.css?v=1758615669">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header"><div><h1>Tables Viewer v2.1</h1></div><div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" type="search" placeholder="Search" aria-label="Search tables" style="min-width:420px; width:44ch;"/>
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllMdBtn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy all tables as markdown">Copy All Tables (Markdown)</button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset all tables">Reset All Tables</button>
</div></div>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#table-1">Table 1</a></li></ul></div></div>
<div class="table-wrapper" data-table-id="table-1"><h3 id="table-1">Table 1</h3><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr>
        <th style="width:28.57%;" onclick="sortTableByColumn(0,0)" role="button" aria-label="Sort by Issue (observed)">
          <div class="th-with-sort">
            <div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Issue (observed)</div>
            <button class="sort-btn sort-state-0" onclick="event.stopPropagation(); headerSortButtonClicked(0,0, this)" title="Toggle sort" aria-label="Toggle sort">
              <span class="sort-icon" aria-hidden="true"></span>
            </button>
          </div>
        </th>
        <th style="width:71.43%;" onclick="sortTableByColumn(0,1)" role="button" aria-label="Sort by Repair for generator (what .py must do)">
          <div class="th-with-sort">
            <div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Repair for generator (what .py must do)</div>
            <button class="sort-btn sort-state-0" onclick="event.stopPropagation(); headerSortButtonClicked(0,1, this)" title="Toggle sort" aria-label="Toggle sort">
              <span class="sort-icon" aria-hidden="true"></span>
            </button>
          </div>
        </th></tr></thead><tbody><tr><td data-label="Issue (observed)"><p><strong>Missing `<title>`</strong></p></td><td data-label="Repair for generator (what .py must do)"><p>Insert `<title>` into `<head>` (use page title variable).</p></td></tr>
<tr><td data-label="Issue (observed)"><p><strong>`data-label` contains raw HTML (`"Summary"`)</strong></p></td><td data-label="Repair for generator (what .py must do)"><p>Escape or serialize labels as plain text. Use `html.escape()` before writing into `data-label`.</p></td></tr>
<tr><td data-label="Issue (observed)"><p><strong>Buttons lack `type="button"`</strong></p></td><td data-label="Repair for generator (what .py must do)"><p>Always emit `type="button"` for `<button>` to avoid accidental form submits.</p></td></tr>
<tr><td data-label="Issue (observed)"><p><strong>Inline `onclick` with hard-coded table indices</strong></p></td><td data-label="Repair for generator (what .py must do)"><p>Emit `data-table-index` and `data-col-index` attributes instead of hard-coded JS calls. Attach listeners from `assets/script.js` (no inline handlers).</p></td></tr>
<tr><td data-label="Issue (observed)"><p><strong>Many inline `style="..."` attributes</strong></p></td><td data-label="Repair for generator (what .py must do)"><p>Move styling to classes. Generator should emit classes (e.g. `class="search-input"`) and avoid inline `style`.</p></td></tr>
<tr><td data-label="Issue (observed)"><p><strong>Inline JS that assumes optional DOM elements (`exportBtn`) or external worker may be missing</strong></p></td><td data-label="Repair for generator (what .py must do)"><p>Only emit code referencing elements that exist, or guard at generation time: include export button when you also write `worker.js`. Otherwise remove export snippet or leave guard and ensure assets exist.</p></td></tr>
<tr><td data-label="Issue (observed)"><p><strong>Inline script executes immediately (possible ordering issues)</strong></p></td><td data-label="Repair for generator (what .py must do)"><p>Defer inline behaviour by wrapping in `DOMContentLoaded` or move into external script file. Generator should output inline snippets inside `document.addEventListener('DOMContentLoaded', ...)`.</p></td></tr>
<tr><td data-label="Issue (observed)"><p><strong>`role="application"` on root element</strong></p></td><td data-label="Repair for generator (what .py must do)"><p>Prefer `role="region"` with `aria-label` or no role. Generator should not set `role="application"` unless verified accessible behavior.</p></td></tr>
<tr><td data-label="Issue (observed)"><p><strong>`data-&#42;` values occasionally contain `{html}` template tokens</strong></p></td><td data-label="Repair for generator (what .py must do)"><p>Sanitize/template-replace safely. Remove unintended placeholders like `replace('{user}', '')` unless used.</p></td></tr>
<tr><td data-label="Issue (observed)"><p><strong>Hard-coded table indices can go out of sync</strong></p></td><td data-label="Repair for generator (what .py must do)"><p>When generating multiple tables compute and emit the index dynamically (incrementing counter) and/or use `data-table-id` that the script resolves by querySelector.</p></td></tr>
<tr><td data-label="Issue (observed)"><p><strong>Potential XSS from untrusted content (table cell HTML inserted raw)</strong></p></td><td data-label="Repair for generator (what .py must do)"><p>If source text is untrusted, escape it. Offer an option `render&#95;html=True/False`. Default to escaping.</p></td></tr>
<tr><td data-label="Issue (observed)"><p><strong>Missing `<caption>` for tables</strong></p></td><td data-label="Repair for generator (what .py must do)"><p>Emit `<caption>` from generator when a title exists for better accessibility.</p></td></tr>
<tr><td data-label="Issue (observed)"><p><strong>Missing ARIA labels on some control buttons</strong></p></td><td data-label="Repair for generator (what .py must do)"><p>Emit `aria-label` for all controls: Copy Plain, Copy Markdown, Collapse, with descriptive text.</p></td></tr>
<tr><td data-label="Issue (observed)"><p><strong>Large single-file export check in page JS</strong></p></td><td data-label="Repair for generator (what .py must do)"><p>Generator should provide an export-size guard on server side or split long content. If producing self-contained HTML, warn or chunk when document size exceeds threshold.</p></td></tr>
<tr><td data-label="Issue (observed)"><p><strong>References to `assets/worker.js` or `assets/overrides.css` not present</strong></p></td><td data-label="Repair for generator (what .py must do)"><p>Ensure generator copies/writes all referenced assets. Otherwise drop references or inline the assets.</p></td></tr>
<tr><td data-label="Issue (observed)"><p><strong>`thead th` sticky offset not computed</strong></p></td><td data-label="Repair for generator (what .py must do)"><p>Emit a CSS var `--main-header-height` in head calculated from generator config or measured header height class. Example: `:root{--main-header-height:56px}`. Or ensure script sets it at runtime.</p></td></tr>
<tr><td data-label="Issue (observed)"><p><strong>Mixed external linking vs inlined mode</strong></p></td><td data-label="Repair for generator (what .py must do)"><p>If user requested self-contained output, generator must inline CSS/JS consistently rather than outputting `<link>` to missing assets. Provide a single `mode` flag.</p></td></tr>
</tbody></table></div>
  <div class='row-count'></div>
</div>
<script src="assets/xlsx.full.min.js?v=1758615669" defer></script>
<script src="assets/script.js?v=1758615669" defer></script>
<script src="assets/worker.js?v=1758615669" defer></script>

<script>
(function(){
  const template = "{table}_{date}";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', '');
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) {
          alert('Export refused: html too large');
          return;
        }
        if(window.Worker) {
          const worker = new Worker((function(){
            try{ return 'assets/worker.js'; }catch(e){ return null; }
          })());
          if(worker){
            worker.postMessage({html:html, format:'pdf'});
            worker.onmessage = function(e){ console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
          } else {
            alert('Worker not available');
          }
        } else {
          alert('Export worker not supported in this environment.');
        }
      } catch(err) {
        console.warn('Export failed', err);
        alert('Export worker not available. See console for details.');
      }
    });
  }
})();
</script>

</div>
</body>
</html>