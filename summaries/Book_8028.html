<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'>
<title>Tables Viewer v2.1</title>
<style>:root{--main-header-height:56px;} .table-wrapper{opacity:0;min-height:24px;transition:opacity .12s linear}</style>
<link rel="stylesheet" href="assets/style.css?v=1759925496">
<link rel="stylesheet" href="assets/overrides.css?v=1761407186">
</head><body>
<div id="tables-viewer" role="region" aria-label="Tables viewer">
<div id="stickyMainHeader">
<div id="tv-header">
<div><h1>Tables Viewer v2.1</h1></div>
<div style="display:flex;gap:8px;align-items:center;">
<input id="searchBox" class="tv-search" type="search" placeholder="Search" aria-label="Search tables" />
<button id="modeBtn" type="button" onclick="toggleMode()" aria-label="Toggle theme">Theme</button>
<button id="toggleAllBtn" type="button" aria-label="Toggle all" onclick="toggleAllTables()">Collapse All Tables</button>
<button id="copyAllPlainBtn" class="copy-btn" type="button" onclick="copyAllTablesPlain()" aria-label="Copy all tables as plain text">Copy All Tables (Plain Text)</button>
<button id="copyAllTablesBtn" class="copy-all-btn" type="button" onclick="copyAllTablesMarkdown()" aria-label="Copy All Tables (Markdown)">Copy All Tables (Markdown)</button>
<button id="copyAllMdBtn" style="display:none" aria-hidden="true"></button>
<button id="resetAllBtn" type="button" onclick="resetAllTables()" aria-label="Reset All Tables">Reset All Tables</button>
</div></div>
<script>
(function(){
  function ensureDelegation(){
    try {
      var vis = document.getElementById('copyAllTablesBtn');
      var alias = document.getElementById('copyAllMdBtn');
      if(!vis || !alias) return;
      // Delegate addEventListener/removeEventListener to visible button
      alias.addEventListener = function(type, listener, options){
        vis.addEventListener(type, listener, options);
      };
      alias.removeEventListener = function(type, listener, options){
        vis.removeEventListener(type, listener, options);
      };
      // Delegate onclick assignments
      Object.defineProperty(alias, 'onclick', {
        set: function(fn){ vis.onclick = fn; },
        get: function(){ return vis.onclick; },
        configurable: true
      });
      // Delegate focus/blur
      alias.focus = function(){ vis.focus(); };
      alias.blur = function(){ vis.blur(); };
      // If legacy code used direct addEventListener earlier than this script, listeners would already exist
      // on alias element; attempt to re-dispatch those by cloning them to visible button is non-trivial.
      // This approach covers the common case where legacy scripts query the alias and bind after DOM ready.
    } catch(e) {
      try{ console && console.warn && console.warn('alias delegation failed', e); }catch(_){} 
    }
  }
  if(document.readyState === 'loading'){
    document.addEventListener('DOMContentLoaded', ensureDelegation);
  } else {
    ensureDelegation();
  }
})();
</script>
<noscript><div style='color:#b91c1c'>JavaScript is disabled. Tables will be shown statically. For large tables enable JS for virtualization.</div></noscript>
<div id="tocBar" role="navigation" aria-label="Table of contents"><ul><li class="toc-item"><a class="toc-link" href="#Table1">Table 1</a></li>
<li class="toc-item"><a class="toc-link" href="#Table2">Table 2</a></li>
<li class="toc-item"><a class="toc-link" href="#Table3">Table 3</a></li>
<li class="toc-item"><a class="toc-link" href="#Table4">Table 4</a></li></ul></div></div>
<div class="table-caption" id="Table1" data-table="Book_8028_01" style="margin-top:2mm;margin-left:3mm;"><strong>Table 1</strong></div>
<div class="table-wrapper" data-table-id="table-1"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Symptom**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Symptom</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Explanation &amp; likely causes (line breaks for clarity)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Explanation & likely causes (line breaks for clarity)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Symptom"> <strong>Convert button does nothing</strong>                    </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> Button click produces no network call.<br>Likely: convert handler not attached or <code>convertButtonHandler</code> overwritten/absent.<br>Check: <code>attachHeaderHandlersOnce</code> / delegated convert listener near the end of core file.<br>Fix: ensure <code>script.core.js</code> loads (and not blocked), and look for duplicate listeners that <code>.preventDefault()</code> without calling handler.                                                                                            </td></tr><tr><td data-label="Symptom"> <strong>POST to <code>/api/render</code> returns 0/empty response</strong> </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> Network request made but response body empty or fetch fails.<br>Likely: server error, CORS, or fetch fallback logic triggered then errors out.<br>Check: network tab for request/response status and content-type; examine the fallback form-encoded branch in <code>convertButtonHandler</code>.<br>Fix: confirm server returns JSON/HTML and not blocked by CORS; observe console for caught errors.                                                                      </td></tr><tr><td data-label="Symptom"> <strong>Conversion returns HTML but not injected</strong>       </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>/api/render</code> returns HTML but nothing appears in page.<br>Likely: <code>processRenderedHtml</code> returned false or <code>PasteToTable.routeHtmlToAreas</code> not present/failed.<br>Check: <code>processRenderedHtml</code> and <code>window.PasteToTable.routeHtmlToAreas</code> existence and errors in console.<br>Fix: restore/implement <code>routeHtmlToAreas</code> or ensure <code>processRenderedHtml</code> uses fallback insertion into <code>#tables-viewer</code>.                                                           </td></tr><tr><td data-label="Symptom"> <strong>Extra.js never loads (features missing)</strong>        </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>extra.js</code> candidate loader fails silently; extra features absent.<br>Likely: wrong base path detection, CSP blocks, or candidate paths invalid.<br>Check: <code>loadExtraSequentially</code> candidates and network requests in DevTools; <code>TV_BASE</code> detection logic.\nFix: set <code>window.__tv_no_auto_extra_load</code> to true to force fallback, or correct <code>data-worker-url</code>/<code>data-index-url</code> attributes and serve <code>extra.js</code> at an available path.                             </td></tr><tr><td data-label="Symptom"> <strong>worker.js or tables_index.json not found</strong>       </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> Worker/index attr missing or 404s; some features requiring index fail.<br>Likely: <code>ensureIndexAndWorkerAttrs</code> didn't set correct <code>data-*</code> attributes or host path changed.\nCheck: <code>document.body.getAttribute(&#x27;data-index-url&#x27;)</code> and <code>data-worker-url</code>, and network tab for 404.\nFix: set explicit <code>data-index-url</code> and <code>data-worker-url</code> on <code>&lt;body&gt;</code> or ensure assets are at expected <code>TV_BASE</code>.                                                              </td></tr><tr><td data-label="Symptom"> <strong>Clipboard copy fails silently</strong>                  </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>copyToClipboard</code> promise rejects or legacy fallback fails; modal not shown.\nLikely: <code>navigator.clipboard</code> unsupported in context (insecure origin) or <code>execCommand</code> blocked.\nCheck: console warnings from <code>tryLegacyCopy</code>, and whether <code>showCopyModal</code> fallback is invoked.\nFix: ensure page served over HTTPS (or localhost), and fallback modal is reachable (not hidden by CSS).                                                                          </td></tr><tr><td data-label="Symptom"> <strong>File download opens blank or blocked</strong>           </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>downloadBlob</code> attempts but file is empty / popup blocked.\nLikely: <code>URL.createObjectURL</code> revoked too early, or browser blocked automatic download/popups.\nCheck: blob creation code, popup blockers, and dev console errors.\nFix: ensure <code>downloadBlob</code> runs in user gesture path or use <code>a.download</code> approach (already used) and avoid revoking URL before click.                                                                                            </td></tr><tr><td data-label="Symptom"> <strong>XLSX export silently gives TSV fallback</strong>        </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>SheetJS</code> (window.XLSX) not present or partial API; fallback TSV used.\nLikely: <code>xlsx.full.min.js</code> not loaded or incompatible version.\nCheck: <code>window.XLSX &amp;&amp; window.XLSX.utils</code> in console; look for SheetJS load errors.\nFix: include correct SheetJS build (<code>xlsx.full.min.js</code>) before core script or accept fallback.                                                                                                                                      </td></tr><tr><td data-label="Symptom"> <strong>Convert shows 'Converting…' toast forever</strong>      </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> Toast appears but never replaced with success/error.\nLikely: <code>convertButtonHandler</code> never reaches completion (awaiting fetch that hangs) or <code>showToast(&#x27;Converted&#x27;)</code> not called due to injection failure.\nCheck: network timing, aborted requests, or caught exceptions masking final <code>showToast</code> call.\nFix: add request timeout, inspect network for hung request, and check <code>finally</code> block re-enabling button.                                             </td></tr><tr><td data-label="Symptom"> <strong>Index/worker base detection returns wrong path</strong> </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>detectScriptBase()</code> returns an incorrect base causing asset 404s.\nLikely: currentScript missing (bundled/concatenated), or scripts hosted under different origin.\nCheck: value of <code>window.__tv_base</code> and console.info outputs in core script start.\nFix: set <code>window.__tv_base</code> before loading script or set explicit <code>data-index-url</code>/<code>data-worker-url</code> on body.                                                                                            </td></tr><tr><td data-label="Symptom"> <strong>routeHtmlToAreas hijack/fallback not used</strong>      </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>processRenderedHtml</code> calls <code>routeHtmlToAreas</code> but route isn't defined or returns false.\nLikely: <code>window.PasteToTable.routeHtmlToAreas</code> was overridden or defined later than core; injected HTML goes nowhere.\nCheck: presence and type of <code>window.PasteToTable.routeHtmlToAreas</code> before request; inspect <code>processRenderedHtml</code> logs.\nFix: ensure <code>routeHtmlToAreas</code> is defined early (in index) or <code>processRenderedHtml</code> will use <code>#tables-viewer</code> fallback. </td></tr><tr><td data-label="Symptom"> <strong>Fetch accepts non-JSON but parsing fails</strong>       </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>ctype</code> detection misreads header; <code>.json()</code> throws causing silent fallback.\nLikely: server sends incorrect Content-Type or combined handlers assume JSON first.\nCheck: response headers for <code>Content-Type</code>; examine code branches handling JSON vs text in <code>convertButtonHandler</code>.\nFix: make server send the correct content-type or adjust client to robustly attempt <code>.text()</code> fallback when <code>.json()</code> fails.                                              </td></tr></tbody></table></div><div class="row-count">Rows: 12</div></div><div class="table-caption" id="Table2" data-table="Book_8028_02" style="margin-top:2mm;margin-left:3mm;"><strong>Table 2</strong></div>
<div class="table-wrapper" data-table-id="table-2"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Symptom**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Symptom</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Explanation &amp; likely causes (line breaks for clarity)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Explanation & likely causes (line breaks for clarity)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Symptom"> <strong>Toasts never appear or are unreadable</strong>                    </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>_ensureToastContainer</code> couldn't create container or CSS variables make color invisible.<br>Likely: <code>document.head</code> missing at run time, CSS variables changed, or z-index conflicts.\nCheck: presence of <code>#tv-toast-container</code> in DOM and computed styles for background/text. \nFix: ensure core script runs after <code>&lt;head&gt;</code> exists and that CSS custom properties (<code>--panel</code>, <code>--text</code>) are present.                           </td></tr><tr><td data-label="Symptom"> <strong>Copy modal opens but textarea empty</strong>                      </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>showCopyModal</code> invoked with empty text or <code>ta.value</code> cleared by other code.\nLikely: the string passed is empty or latest value not captured before <code>showCopyModal</code> call.\nCheck: caller's variable (e.g., <code>md</code> or <code>text</code>) before invoking <code>showCopyModal</code>.\nFix: ensure copy/export functions build and pass the text synchronously before any transform that clears it.                                                       </td></tr><tr><td data-label="Symptom"> <strong>Search box (/) shortcut doesn't focus search</strong>             </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> Keydown handler ignored or prevented by other listeners; search element ID mismatch.\nLikely: search input has ID different from <code>getSearchEl()</code> expectations, or the page focus is locked by modal.\nCheck: <code>getSearchEl()</code> return value in console; verify document-level keydown handler installed in core.\nFix: ensure search ID matches (<code>search</code>, <code>searchBox</code>, or <code>searchInput</code>) and no modal interferes with key events. </td></tr><tr><td data-label="Symptom"> <strong>Row UIDs not present so reset/sort cannot restore order</strong>  </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>_ensureRowUidsAndSnapshot</code> not run or rows added later dynamically without re-init.\nLikely: <code>initRenderedContent</code> not called after injecting HTML, or injection replaced nodes after snapshot.\nCheck: <code>data-tv-uid</code> attributes on <code>tr</code> elements and whether <code>originalRowOrders</code> populated.\nFix: call <code>PasteToTable.initRenderedContent()</code> after dynamic injection or use <code>processRenderedHtml</code> which calls it.               </td></tr><tr><td data-label="Symptom"> <strong>Header sort buttons show wrong icon/state</strong>                </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>updateHeaderSortUI</code> not called or <code>sortStates</code> corrupted.\nLikely: table's <code>tHead</code> structure unexpected or <code>sortStates</code> array length mismatch.\nCheck: <code>sortStates</code> in console and cell structure for <code>th .sort-btn</code> elements.\nFix: ensure table headers have expected markup or update <code>updateHeaderSortUI</code> to tolerate missing <code>.sort-btn</code>.                                                                                  </td></tr><tr><td data-label="Symptom"> <strong>Toggle buttons show wrong text on page load</strong>              </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> Toggle initialization runs before wrapper classes set, so text flips later.\nLikely: order-of-execution race; code setting <code>btn.textContent</code> runs before <code>table-collapsed</code> class assigned.\nCheck: DOMContentLoaded timings and any other script modifying <code>.table-wrapper</code> classes.\nFix: ensure <code>initRenderedContent</code> runs after all modifications or set toggle text idempotently on a short timer.                           </td></tr><tr><td data-label="Symptom"> <strong>Back-to-top button never created or hidden</strong>               </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>backToTop</code> creation guarded and skipped if DOM not ready or id collision occurs.\nLikely: earlier code added a conflicting element or created then removed it; style <code>display</code> toggled incorrectly.\nCheck: presence of <code>#backToTop</code> and scroll listener active.\nFix: ensure creation path runs once and scroll listener executed (see core's <code>window.addEventListener(&quot;scroll&quot;)</code>).                                            </td></tr><tr><td data-label="Symptom"> <strong>Handlers not attached to server-rendered toolbar buttons</strong> </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> Buttons present but clicks do nothing — dataset guard prevented attachment.\nLikely: elements have <code>onclick</code> attribute (skips attach) or <code>data-tv-handler-attached</code> already set incorrectly.\nCheck: element attributes for <code>onclick</code> and dataset keys; console logs from handler-attachment area.\nFix: remove stale <code>data-tv-handler-attached</code> or allow attach for server-rendered cases explicitly.                           </td></tr><tr><td data-label="Symptom"> <strong>Early-hide CSS hides Markdown export permanently</strong>         </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> Early-hide CSS added for export-markdown targets but selector too broad hides valid UI.\nLikely: <code>se.setAttribute(&#x27;data-tv-early-hide-md&#x27;,&#x27;1&#x27;)</code> injected and matches other elements unexpectedly.\nCheck: which elements are hidden via devtools and their class names/attributes.\nFix: scope CSS selectors more narrowly or remove early-hide if Markdown export should be visible.                                            </td></tr><tr><td data-label="Symptom"> <strong><code>_tv_extra_loader_attached</code> prevents later valid loads</strong>   </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> Flag set early prevents a correct <code>extra.js</code> from being appended later.\nLikely: a previous failed attempt set the flag; the code then exits without retrying.\nCheck: <code>window._tv_extra_loader_attached</code> and check for existing <code>script[src*=&quot;extra.js&quot;]</code> nodes.\nFix: clear the flag in debugging or re-run loader with correct candidate path; ensure detection logic matches your hosting layout.                            </td></tr><tr><td data-label="Symptom"> <strong>Search highlighting mangles HTML (breaks links/markup)</strong>   </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>highlightMatches</code> splits text nodes and wraps with <code>&lt;mark&gt;</code> but can disrupt nested inline elements.\nLikely: complex cell content (links, spans) not handled fully by tree-walker wrapping logic.\nCheck: cell <code>innerHTML</code> before/after highlight and <code>c.dataset.origHtml</code> snapshot.\nFix: rely on <code>c.dataset.origHtml</code> to restore on clearHighlights; rework highlight logic to avoid splitting across elements if needed.     </td></tr><tr><td data-label="Symptom"> <strong>Debounce doesn't prevent duplicate rapid events</strong>          </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>debounce</code> implementation replaced or mis-configured causing too-short interval.\nLikely: <code>window.tvConfig.debounceMs</code> set to 0 or custom <code>setTvSearchConfig</code> changed value.\nCheck: value of <code>window.tvConfig.debounceMs</code> and that <code>debounce</code> used by search/optimize controls.\nFix: set sensible default (e.g., 120–200ms) and ensure <code>setTvSearchConfig</code> validations clamp values.                                           </td></tr></tbody></table></div><div class="row-count">Rows: 12</div></div><div class="table-caption" id="Table3" data-table="Book_8028_03" style="margin-top:2mm;margin-left:3mm;"><strong>Table 3</strong></div>
<div class="table-wrapper" data-table-id="table-3"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Symptom**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Symptom</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Explanation &amp; likely causes (line breaks for clarity)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Explanation & likely causes (line breaks for clarity)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Symptom"> <strong>Buttons present but do nothing</strong>                                        </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> Clicks on <code>.copy-plain</code>, <code>.export-csv</code>, <code>.toggle-table</code> produce no effect.<br>Likely: per-wrapper handler attachment skipped due to <code>onclick</code> attribute or <code>data-tv-handler-attached</code> preventing reattach.<br>Check: element attributes (<code>onclick</code>, <code>data-tv-handler-attached</code>) and console for silent exceptions during attachment.<br>Fix: remove stale <code>data-tv-handler-attached</code> for testing or allow forced attach; ensure <code>attach</code> code runs after DOM insertion.                                 </td></tr><tr><td data-label="Symptom"> <strong>Copy to clipboard opens modal but content empty</strong>                       </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>copyToClipboard</code> fallback shows modal with empty textarea.<br>Likely: the string computed for copy/export was empty or computed from wrong table reference (button not within expected wrapper).<br>Check: inspect the computed text just before calling <code>copyToClipboard</code> (use console.log or breakpoints).<br>Fix: ensure <code>getTableFromButton(btn)</code> finds the correct table; guard against missing table and call <code>showCopyModal</code> with fallback message.                                             </td></tr><tr><td data-label="Symptom"> <strong>CSV/JSON/XLSX exports generate wrong/garbled content</strong>                  </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> Exported files show HTML or escaped characters, or columns misaligned.<br>Likely: table cell <code>textContent</code> includes untrimmed whitespace, nested markup, or non-breaking characters; SheetJS fallback TSV used unexpectedly.<br>Check: sample <code>rows.map(...).join()</code> output in console before making blob; inspect <code>window.XLSX</code> presence/version.<br>Fix: sanitize cell text (trim, normalize unicode), ensure correct SheetJS is loaded before export, or use well-formed CSV quoting.                </td></tr><tr><td data-label="Symptom"> <strong>XLSX export triggers fallback warning</strong>                                 </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> Message: "XLSX exported (fallback TSV)...".<br>Likely: <code>window.XLSX</code> missing or API shape incompatible (utils missing).<br>Check: <code>console.log(window.XLSX &amp;&amp; window.XLSX.utils)</code> and network tab for <code>xlsx.full.min.js</code> 200/404.<br>Fix: include the correct SheetJS build (full) before <code>script.table.js</code> or accept fallback and label it clearly for users.                                                                                                                                          </td></tr><tr><td data-label="Symptom"> <strong>Export All produces odd sheet names or fails</strong>                          </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> Combined workbook has duplicate/long sheet names or writeFile errors.<br>Likely: sheet names exceed 31 chars, invalid characters, or SheetJS API differences.<br>Check: names passed to <code>book_append_sheet</code> and SheetJS errors in console.<br>Fix: truncate/sanitize names to 31 chars and remove illegal characters; wrap SheetJS calls in try/catch and fall back to Markdown export.                                                                                                                 </td></tr><tr><td data-label="Symptom"> <strong>Download is blocked by popup blocker</strong>                                  </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> New window or automatic download blocked; user sees no file.<br>Likely: download triggered outside a user gesture context or browser blocks data URI/action.<br>Check: whether download is triggered within click event handler and whether <code>downloadBlob</code> uses <code>a.click()</code> synchronously.<br>Fix: ensure download runs directly inside user-initiated handler; avoid async waits that may break user-gesture chain.                                                                                    </td></tr><tr><td data-label="Symptom"> <strong>Copy all / copy markdown handlers missing for server-rendered toolbar</strong> </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> Legacy hidden buttons expected by server HTML don't wire up.<br>Likely: server-supplied toolbar markup differs in selectors, or handler-attachment logic ignores some class names.\br>Check: actual DOM markup of server toolbar buttons and whether selectors in <code>handlers</code> array match.\br>Fix: broaden selector list or add data-action attributes server-side so client can reliably attach.                                                                                                        </td></tr><tr><td data-label="Symptom"> <strong>saveHtmlHandler saves truncated HTML</strong>                                  </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>page-area</code> vs <code>tables-viewer</code> selection logic picks the wrong content or strips scripts/styles.<br>Likely: <code>page-area</code> visibility logic or <code>classList.contains(&#x27;visible&#x27;)</code> check inconsistent or server HTML contains <code>&lt;base&gt;</code>/relative links causing issues.<br>Check: what <code>outer</code> contains before Blob creation; open saved HTML to inspect truncation point.\br>Fix: normalize which container is authoritative; copy full <code>outerHTML</code> including head if needed, or offer “Save full page” option. </td></tr><tr><td data-label="Symptom"> <strong>Export PDF prints wrong pagination/overflow</strong>                           </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> Printed table cells overflow page or headings repeat oddly.<br>Likely: inlined print CSS insufficient; table <code>width</code> or cell padding causing layout overflow.<br>Check: generated <code>htmlDoc</code> markup and CSS in <code>exportTablePDF</code> preview window; try <code>print()</code> manually in new window.\br>Fix: provide a print-specific stylesheet (page-break rules, font-size, table-layout: fixed; overflow-wrap) or scale content for print.                                                                          </td></tr><tr><td data-label="Symptom"> <strong>Download filename strange / sanitized poorly</strong>                          </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> Filenames contain underscores or are truncated unexpectedly.<br>Likely: <code>sanitizeFileName</code> escape or slice logic overzealous (max 200 chars then slice leads to odd results).\br>Check: actual sanitized name returned; verify edge cases (empty title, emoji) and platform filename rules.\br>Fix: adjust sanitize rules to preserve readable names, handle emoji/unicode gracefully, and avoid stripping useful separators.                                                                           </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><div class="table-caption" id="Table4" data-table="Book_8028_04" style="margin-top:2mm;margin-left:3mm;"><strong>Table 4</strong></div>
<div class="table-wrapper" data-table-id="table-4"><div class="table-heading-bar" aria-label="Table heading"></div><div class="table-container"><div class="table-header-wrapper" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;"><div class="copy-buttons"><button type="button" class="copy-plain-btn" data-action="copy-plain" onclick="copyTablePlain(this)">Copy Plain Table</button><button type="button" class="copy-markdown-btn" data-action="copy-markdown" onclick="copyTableMarkdown(this)">Copy Markdown Table</button><button type="button" class="export-csv-btn" data-action="export-csv" onclick="exportTableCSV(this)">Export CSV</button><button type="button" class="export-json-btn" data-action="export-json" onclick="exportTableJSON(this)">Export JSON</button><button type="button" class="export-xlsx-btn" data-action="export-xlsx" onclick="exportTableXLSX(this)">Export XLSX</button><button type="button" class="export-pdf-btn" data-action="export-pdf" onclick="exportTablePDF(this)">Export PDF</button><button type="button" class="export-markdown-btn export-markdown-initial" data-action="export-markdown" onclick="exportTableMarkdown(this)" style="display:none" data-initial-hidden="1">Export Markdown</button></div><div style="display:flex; align-items:center;"><button type="button" class="toggle-table-btn" data-action="toggle-collapse" onclick="toggleTable(this)">Collapse Table</button></div></div><table class="tv-table" role="table"><thead><tr><th class="tv-col-left" role="button" aria-label="Sort by **Symptom**"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;"><strong>Symptom</strong></div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th><th class="tv-col" role="button" aria-label="Sort by Explanation &amp; likely causes (line breaks for clarity)"><div class="th-with-sort"><div style="flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">Explanation & likely causes (line breaks for clarity)</div><button class="sort-btn sort-state-0" title="Toggle sort" aria-label="Toggle sort"><span class="sort-icon" aria-hidden="true"></span></button></div></th></tr></thead><tbody><tr><td data-label="Symptom"> <strong>Search highlights break markup / split links</strong>                    </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> After search, HTML inside cells is mangled: links broken, inline elements split across <code>&lt;mark&gt;</code> tags.<br>Likely: <code>highlightMatches</code> uses text-node splitting that doesn't respect element boundaries, and <code>c.dataset.origHtml</code> may not be restored in all cases.<br>Check: inspect <code>cell.dataset.origHtml</code> and <code>cell.innerHTML</code> before/after highlight; test with cells containing <code>&lt;a&gt;</code>, <code>&lt;strong&gt;</code>, <code>&lt;span&gt;</code>.\br>Fix: prefer restoring from <code>data-orig-html</code> on clear; refine highlight algorithm to avoid wrapping across element parents (or mark by cloning nodes instead of splitText across siblings). </td></tr><tr><td data-label="Symptom"> <strong>Search misses matches due to normalization differences</strong>          </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> Some accents, punctuation, or emojis cause misses when searching.<br>Likely: <code>normalizeForSearchLocal</code> attempts Unicode NFD + strip diacritics but falls back to <code>\w</code> which loses some characters; mapping in <code>buildNormalizedMapForCell</code> may differ.\br>Check: test normalize outputs for sample cell text vs query; console-log <code>normStr</code> and <code>filterNorm</code> to compare.\br>Fix: unify normalization (use consistent NFD + diacritic strip) and ensure fallback path yields same character set across both functions.                                                                                         </td></tr><tr><td data-label="Symptom"> <strong>FirstMatch scroll behavior over-scrolls or misses header offset</strong> </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> When first match is scrolled into view, sticky header covers the row or scrolling is slightly off.\br>Likely: header height detection via <code>#stickyMainHeader</code> may be zero or variable; timing of scroll vs layout shift causes mismatch.\br>Check: computed <code>headerHeight</code> when scrolling and whether header is fixed/sticky with changing height.\br>Fix: calculate headerHeight including margins, or use <code>element.scrollIntoView({ block: &#x27;center&#x27; })</code> consistently, or offset by a known constant after layout stabilizes.                                                                                </td></tr><tr><td data-label="Symptom"> <strong>Row UID snapshot missing for dynamically injected tables</strong>        </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> New tables injected by <code>processRenderedHtml</code> lack <code>data-tv-uid</code>, making reset/sort unreliable.\br>Likely: <code>initRenderedContent</code> not run after injection or run before DOM fully parsed.\br>Check: after injection, inspect <code>tr</code> elements for <code>data-tv-uid</code> and <code>originalRowOrders</code> content.\br>Fix: ensure <code>processRenderedHtml</code> calls <code>initRenderedContent</code> (it does) and consider adding a brief <code>setTimeout</code> or <code>requestAnimationFrame</code> to allow DOM to settle before snapshot.                                                                                                                            </td></tr><tr><td data-label="Symptom"> <strong>Reset to original order fails after row edits</strong>                   </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> After programmatic edits (row reordering/manipulation), <code>resetAllTables</code> can't locate original UIDs.\br>Likely: rows were cloned or recreated losing <code>data-tv-uid</code>, or <code>originalRowOrders</code> snapshot not updated for dynamic changes.\br>Check: whether DOM mutations replace rows (new nodes) and whether <code>_ensureRowUidsAndSnapshot</code> was re-run after changes.\br>Fix: avoid recreating rows when editing; if unavoidable, re-run <code>_ensureRowUidsAndSnapshot</code> after DOM updates or maintain map of row keys in server markup.                                                                                </td></tr><tr><td data-label="Symptom"> <strong>Debounce/resize optimization not firing on some devices</strong>         </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>optimizeTableControls</code> not run on orientation change or some mobile user agents.\br>Likely: <code>matchMedia</code> listeners not attached due to polyfill differences, or <code>addEventListener(&#x27;change&#x27;)</code> unsupported on older browsers.\br>Check: whether <code>mql.addEventListener</code> or <code>addListener</code> branch executed and test <code>window.innerWidth</code> path.\br>Fix: keep both event attachment methods and fallback to <code>resize</code> event; call <code>optimizeTableControls</code> on <code>orientationchange</code> too.                                                                                                                                 </td></tr><tr><td data-label="Symptom"> <strong>TOC generation yields duplicate IDs or wrong titles</strong>             </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>buildTocFromCaptions</code> or <code>buildSingleTableToc</code> generates duplicated anchors or generic "Table N" when caption exists.\br>Likely: source caption text empty or trimmed to same values; ID creation logic collides with existing DOM ids.\br>Check: captions list and resulting <code>&lt;a&gt;</code> texts and linked <code>id</code> targets; search for duplicate <code>id</code>s in DOM.\br>Fix: dedupe IDs by adding suffixes when collisions detected (already present in code — ensure it runs), and prefer caption text over generic label when available.                                                                                  </td></tr><tr><td data-label="Symptom"> <strong>TOC click scrolls to wrong container when target missing</strong>        </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> Clicking TOC anchor scrolls to container top rather than specific row/heading.\br>Likely: anchor href target not found (id mismatch) so fallback uses container bounding rect.\br>Check: compare anchor href <code>#id</code> to existence of element with that <code>id</code> and inspect history.replaceState calls.\br>Fix: ensure IDs assigned to headings/rows are unique and stable; if using <code>routeHtmlToAreas</code>, preserve ids during injection.                                                                                                                                                                             </td></tr><tr><td data-label="Symptom"> <strong>Multiple init calls create duplicate event listeners</strong>            </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> After repeated dynamic injections, handlers may be attached multiple times causing double-fires.\br>Likely: <code>initRenderedContent</code> attaches listeners without strict idempotency for some items (some guards exist but may be bypassed).\br>Check: <code>btn.dataset.tvHandlerAttached</code> presence and whether it persists between injections; inspect number of listeners on element (getEventListeners in devtools).\br>Fix: keep dataset guard checks consistent and robust; remove listeners before reattaching or ensure attach only when not already present.                                                   </td></tr><tr><td data-label="Symptom"> <strong>Mobile control grouping moves buttons out of visual order</strong>       </td><td data-label="Explanation &amp; likely causes (line breaks for clarity)"> <code>optimizeTableControls</code> reflows header controls and sometimes places buttons in unexpected DOM order.\br>Likely: code attempts to move parent nodes (<code>toggleParent</code>) into header, which can change semantic order or break CSS rules.\br>Check: wrapper <code>header</code> contents before/after optimize call and test on narrow widths.\br>Fix: instead of moving DOM nodes, clone or add ARIA-hidden buttons for mobile layout, or adjust CSS to manage layout without moving nodes.                                                                                                                                 </td></tr></tbody></table></div><div class="row-count">Rows: 10</div></div><script src="assets/xlsx.full.min.js?v=1758605028" defer></script>
<script src="assets/script.js?v=1759748863" defer></script>
<script src="assets/worker.js?v=1758331710" defer></script>
<script>
(function(){
  const template = "{table}_{date}";
  const userVal = "";
  const hrefPrefix = "assets";
  function formatName(tableName) {
    const date = (new Date()).toISOString().slice(0,10);
    return template.replace('{table}', tableName).replace('{date}', date).replace('{user}', userVal);
  }
  const btn = document.getElementById('exportBtn');
  if(btn) {
    btn.addEventListener('click', async function() {
      try {
        const html = document.documentElement.outerHTML;
        if(html.length > 2000000) { alert('Export refused: html too large'); return; }
        if(window.Worker) {
          const workerUrl = (function(){ try{ return hrefPrefix + '/worker.js'; }catch(e){ return null; } })();
          if(workerUrl) {
            try {
              const worker = new Worker(workerUrl);
              worker.postMessage({html: html, format: 'pdf'});
              worker.onmessage = function(e) { console.log('worker:', e.data); alert('Worker replied: '+(e.data.msg||e.data.status)); };
            } catch(err) { console.warn('Worker create failed', err); alert('Worker not available'); }
          } else { alert('Worker not available'); }
        } else { alert('Export worker not supported in this environment.'); }
      } catch(err) { console.warn('Export failed', err); alert('Export worker not available. See console for details.'); }
    });
  }
})();
window.addEventListener('load', function(){ try{ document.querySelectorAll('.table-wrapper').forEach(function(e){ e.style.opacity='1'; }); }catch(e){} });
</script>
</div>
</body>
</html>